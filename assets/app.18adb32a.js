var t0=Object.defineProperty,r0=Object.defineProperties;var n0=Object.getOwnPropertyDescriptors;var Du=Object.getOwnPropertySymbols;var a0=Object.prototype.hasOwnProperty,i0=Object.prototype.propertyIsEnumerable;var Ys=(e,t,r)=>t in e?t0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ct=(e,t)=>{for(var r in t||(t={}))a0.call(t,r)&&Ys(e,r,t[r]);if(Du)for(var r of Du(t))i0.call(t,r)&&Ys(e,r,t[r]);return e},eo=(e,t)=>r0(e,n0(t));var le=(e,t,r)=>(Ys(e,typeof t!="symbol"?t+"":t,r),r);const Lu={},o0="modulepreload",Uu={},s0="/vma-grid/",Qe=function(t,r){return!r||r.length===0?t():Promise.all(r.map(n=>{if(n=`${s0}${n}`,n in Uu)return;Uu[n]=!0;const a=n.endsWith(".css"),i=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${i}`))return;const s=document.createElement("link");if(s.rel=a?"stylesheet":o0,a||(s.as="script",s.crossOrigin=""),s.href=n,document.head.appendChild(s),a)return new Promise((d,h)=>{s.addEventListener("load",d),s.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>t())},l0={"v-8daa1a0e":()=>Qe(()=>import("./index.html.8b8f527c.js"),[]).then(({data:e})=>e),"v-2f4d3eda":()=>Qe(()=>import("./grid-button.html.166bc36b.js"),[]).then(({data:e})=>e),"v-7f75cc29":()=>Qe(()=>import("./grid-checkbox.html.94219792.js"),[]).then(({data:e})=>e),"v-13863eb3":()=>Qe(()=>import("./grid-icon.html.826fb976.js"),[]).then(({data:e})=>e),"v-12fb0d8a":()=>Qe(()=>import("./grid-loading.html.70dfab92.js"),[]).then(({data:e})=>e),"v-90541d2a":()=>Qe(()=>import("./grid-radio.html.243a47fd.js"),[]).then(({data:e})=>e),"v-0016c312":()=>Qe(()=>import("./grid-textarea.html.ad6dac5d.js"),[]).then(({data:e})=>e),"v-5107b6ce":()=>Qe(()=>import("./grid.html.cb30477d.js"),[]).then(({data:e})=>e),"v-1a1874fc":()=>Qe(()=>import("./index.html.15465335.js"),[]).then(({data:e})=>e),"v-e0e76f98":()=>Qe(()=>import("./modules.html.830cae3c.js"),[]).then(({data:e})=>e),"v-a9cea3dc":()=>Qe(()=>import("./index.DepParser.html.8f22b8e8.js"),[]).then(({data:e})=>e),"v-44208220":()=>Qe(()=>import("./index.FormulaError.html.ddc132fe.js"),[]).then(({data:e})=>e),"v-6da1d8db":()=>Qe(()=>import("./index.FormulaParser.html.68fb3097.js"),[]).then(({data:e})=>e),"v-cf6e5f3c":()=>Qe(()=>import("./formulas.html.32c07e31.js"),[]).then(({data:e})=>e),"v-201aed0a":()=>Qe(()=>import("./index.html.b1b772f7.js"),[]).then(({data:e})=>e),"v-3706649a":()=>Qe(()=>import("./404.html.93146c89.js"),[]).then(({data:e})=>e)};function pc(e,t){const r=Object.create(null),n=e.split(",");for(let a=0;a<n.length;a++)r[n[a]]=!0;return t?a=>!!r[a.toLowerCase()]:a=>!!r[a]}const c0="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",u0=pc(c0);function rp(e){return!!e||e===""}function Yo(e){if(ze(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],a=ft(n)?h0(n):Yo(n);if(a)for(const i in a)t[i]=a[i]}return t}else{if(ft(e))return e;if(St(e))return e}}const d0=/;(?![^(]*\))/g,f0=/:(.+)/;function h0(e){const t={};return e.split(d0).forEach(r=>{if(r){const n=r.split(f0);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function xi(e){let t="";if(ft(e))t=e;else if(ze(e))for(let r=0;r<e.length;r++){const n=xi(e[r]);n&&(t+=n+" ")}else if(St(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const p0=e=>ft(e)?e:e==null?"":ze(e)||St(e)&&(e.toString===op||!We(e.toString))?JSON.stringify(e,np,2):String(e),np=(e,t)=>t&&t.__v_isRef?np(e,t.value):fa(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,a])=>(r[`${n} =>`]=a,r),{})}:ap(t)?{[`Set(${t.size})`]:[...t.values()]}:St(t)&&!ze(t)&&!sp(t)?String(t):t,dt={},da=[],Ar=()=>{},g0=()=>!1,m0=/^on[^a-z]/,Ti=e=>m0.test(e),gc=e=>e.startsWith("onUpdate:"),Ht=Object.assign,mc=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},v0=Object.prototype.hasOwnProperty,Ze=(e,t)=>v0.call(e,t),ze=Array.isArray,fa=e=>qo(e)==="[object Map]",ap=e=>qo(e)==="[object Set]",We=e=>typeof e=="function",ft=e=>typeof e=="string",vc=e=>typeof e=="symbol",St=e=>e!==null&&typeof e=="object",ip=e=>St(e)&&We(e.then)&&We(e.catch),op=Object.prototype.toString,qo=e=>op.call(e),b0=e=>qo(e).slice(8,-1),sp=e=>qo(e)==="[object Object]",bc=e=>ft(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,si=pc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Xo=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},y0=/-(\w)/g,Lr=Xo(e=>e.replace(y0,(t,r)=>r?r.toUpperCase():"")),E0=/\B([A-Z])/g,Wn=Xo(e=>e.replace(E0,"-$1").toLowerCase()),jo=Xo(e=>e.charAt(0).toUpperCase()+e.slice(1)),qs=Xo(e=>e?`on${jo(e)}`:""),vi=(e,t)=>!Object.is(e,t),Xs=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},Oo=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},lp=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Fu;const w0=()=>Fu||(Fu=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let or;class _0{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&or&&(this.parent=or,this.index=(or.scopes||(or.scopes=[])).push(this)-1)}run(t){if(this.active){const r=or;try{return or=this,t()}finally{or=r}}}on(){or=this}off(){or=this.parent}stop(t){if(this.active){let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.scopes)for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);if(this.parent&&!t){const a=this.parent.scopes.pop();a&&a!==this&&(this.parent.scopes[this.index]=a,a.index=this.index)}this.active=!1}}}function N0(e,t=or){t&&t.active&&t.effects.push(e)}function A0(){return or}function C0(e){or&&or.cleanups.push(e)}const yc=e=>{const t=new Set(e);return t.w=0,t.n=0,t},cp=e=>(e.w&yn)>0,up=e=>(e.n&yn)>0,x0=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=yn},T0=e=>{const{deps:t}=e;if(t.length){let r=0;for(let n=0;n<t.length;n++){const a=t[n];cp(a)&&!up(a)?a.delete(e):t[r++]=a,a.w&=~yn,a.n&=~yn}t.length=r}},xl=new WeakMap;let ni=0,yn=1;const Tl=30;let wr;const Un=Symbol(""),Rl=Symbol("");class Ec{constructor(t,r=null,n){this.fn=t,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,N0(this,n)}run(){if(!this.active)return this.fn();let t=wr,r=vn;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=wr,wr=this,vn=!0,yn=1<<++ni,ni<=Tl?x0(this):Bu(this),this.fn()}finally{ni<=Tl&&T0(this),yn=1<<--ni,wr=this.parent,vn=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){wr===this?this.deferStop=!0:this.active&&(Bu(this),this.onStop&&this.onStop(),this.active=!1)}}function Bu(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}let vn=!0;const dp=[];function Ia(){dp.push(vn),vn=!1}function Ma(){const e=dp.pop();vn=e===void 0?!0:e}function cr(e,t,r){if(vn&&wr){let n=xl.get(e);n||xl.set(e,n=new Map);let a=n.get(r);a||n.set(r,a=yc()),fp(a)}}function fp(e,t){let r=!1;ni<=Tl?up(e)||(e.n|=yn,r=!cp(e)):r=!e.has(wr),r&&(e.add(wr),wr.deps.push(e))}function Jr(e,t,r,n,a,i){const s=xl.get(e);if(!s)return;let d=[];if(t==="clear")d=[...s.values()];else if(r==="length"&&ze(e))s.forEach((h,c)=>{(c==="length"||c>=n)&&d.push(h)});else switch(r!==void 0&&d.push(s.get(r)),t){case"add":ze(e)?bc(r)&&d.push(s.get("length")):(d.push(s.get(Un)),fa(e)&&d.push(s.get(Rl)));break;case"delete":ze(e)||(d.push(s.get(Un)),fa(e)&&d.push(s.get(Rl)));break;case"set":fa(e)&&d.push(s.get(Un));break}if(d.length===1)d[0]&&Ol(d[0]);else{const h=[];for(const c of d)c&&h.push(...c);Ol(yc(h))}}function Ol(e,t){const r=ze(e)?e:[...e];for(const n of r)n.computed&&Vu(n);for(const n of r)n.computed||Vu(n)}function Vu(e,t){(e!==wr||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const R0=pc("__proto__,__v_isRef,__isVue"),hp=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(vc)),O0=wc(),k0=wc(!1,!0),I0=wc(!0),zu=M0();function M0(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const n=rt(this);for(let i=0,s=this.length;i<s;i++)cr(n,"get",i+"");const a=n[t](...r);return a===-1||a===!1?n[t](...r.map(rt)):a}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){Ia();const n=rt(this)[t].apply(this,r);return Ma(),n}}),e}function wc(e=!1,t=!1){return function(n,a,i){if(a==="__v_isReactive")return!e;if(a==="__v_isReadonly")return e;if(a==="__v_isShallow")return t;if(a==="__v_raw"&&i===(e?t?q0:bp:t?vp:mp).get(n))return n;const s=ze(n);if(!e&&s&&Ze(zu,a))return Reflect.get(zu,a,i);const d=Reflect.get(n,a,i);return(vc(a)?hp.has(a):R0(a))||(e||cr(n,"get",a),t)?d:Gt(d)?s&&bc(a)?d:d.value:St(d)?e?Ac(d):Cr(d):d}}const P0=pp(),S0=pp(!0);function pp(e=!1){return function(r,n,a,i){let s=r[n];if(bi(s)&&Gt(s)&&!Gt(a))return!1;if(!e&&!bi(a)&&(kl(a)||(a=rt(a),s=rt(s)),!ze(r)&&Gt(s)&&!Gt(a)))return s.value=a,!0;const d=ze(r)&&bc(n)?Number(n)<r.length:Ze(r,n),h=Reflect.set(r,n,a,i);return r===rt(i)&&(d?vi(a,s)&&Jr(r,"set",n,a):Jr(r,"add",n,a)),h}}function L0(e,t){const r=Ze(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&r&&Jr(e,"delete",t,void 0),n}function $0(e,t){const r=Reflect.has(e,t);return(!vc(t)||!hp.has(t))&&cr(e,"has",t),r}function D0(e){return cr(e,"iterate",ze(e)?"length":Un),Reflect.ownKeys(e)}const gp={get:O0,set:P0,deleteProperty:L0,has:$0,ownKeys:D0},U0={get:I0,set(e,t){return!0},deleteProperty(e,t){return!0}},F0=Ht({},gp,{get:k0,set:S0}),_c=e=>e,Qo=e=>Reflect.getPrototypeOf(e);function to(e,t,r=!1,n=!1){e=e.__v_raw;const a=rt(e),i=rt(t);r||(t!==i&&cr(a,"get",t),cr(a,"get",i));const{has:s}=Qo(a),d=n?_c:r?xc:yi;if(s.call(a,t))return d(e.get(t));if(s.call(a,i))return d(e.get(i));e!==a&&e.get(t)}function ro(e,t=!1){const r=this.__v_raw,n=rt(r),a=rt(e);return t||(e!==a&&cr(n,"has",e),cr(n,"has",a)),e===a?r.has(e):r.has(e)||r.has(a)}function no(e,t=!1){return e=e.__v_raw,!t&&cr(rt(e),"iterate",Un),Reflect.get(e,"size",e)}function Gu(e){e=rt(e);const t=rt(this);return Qo(t).has.call(t,e)||(t.add(e),Jr(t,"add",e,e)),this}function Hu(e,t){t=rt(t);const r=rt(this),{has:n,get:a}=Qo(r);let i=n.call(r,e);i||(e=rt(e),i=n.call(r,e));const s=a.call(r,e);return r.set(e,t),i?vi(t,s)&&Jr(r,"set",e,t):Jr(r,"add",e,t),this}function Wu(e){const t=rt(this),{has:r,get:n}=Qo(t);let a=r.call(t,e);a||(e=rt(e),a=r.call(t,e)),n&&n.call(t,e);const i=t.delete(e);return a&&Jr(t,"delete",e,void 0),i}function Ku(){const e=rt(this),t=e.size!==0,r=e.clear();return t&&Jr(e,"clear",void 0,void 0),r}function ao(e,t){return function(n,a){const i=this,s=i.__v_raw,d=rt(s),h=t?_c:e?xc:yi;return!e&&cr(d,"iterate",Un),s.forEach((c,o)=>n.call(a,h(c),h(o),i))}}function io(e,t,r){return function(...n){const a=this.__v_raw,i=rt(a),s=fa(i),d=e==="entries"||e===Symbol.iterator&&s,h=e==="keys"&&s,c=a[e](...n),o=r?_c:t?xc:yi;return!t&&cr(i,"iterate",h?Rl:Un),{next(){const{value:l,done:u}=c.next();return u?{value:l,done:u}:{value:d?[o(l[0]),o(l[1])]:o(l),done:u}},[Symbol.iterator](){return this}}}}function on(e){return function(...t){return e==="delete"?!1:this}}function B0(){const e={get(i){return to(this,i)},get size(){return no(this)},has:ro,add:Gu,set:Hu,delete:Wu,clear:Ku,forEach:ao(!1,!1)},t={get(i){return to(this,i,!1,!0)},get size(){return no(this)},has:ro,add:Gu,set:Hu,delete:Wu,clear:Ku,forEach:ao(!1,!0)},r={get(i){return to(this,i,!0)},get size(){return no(this,!0)},has(i){return ro.call(this,i,!0)},add:on("add"),set:on("set"),delete:on("delete"),clear:on("clear"),forEach:ao(!0,!1)},n={get(i){return to(this,i,!0,!0)},get size(){return no(this,!0)},has(i){return ro.call(this,i,!0)},add:on("add"),set:on("set"),delete:on("delete"),clear:on("clear"),forEach:ao(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{e[i]=io(i,!1,!1),r[i]=io(i,!0,!1),t[i]=io(i,!1,!0),n[i]=io(i,!0,!0)}),[e,r,t,n]}const[V0,z0,G0,H0]=B0();function Nc(e,t){const r=t?e?H0:G0:e?z0:V0;return(n,a,i)=>a==="__v_isReactive"?!e:a==="__v_isReadonly"?e:a==="__v_raw"?n:Reflect.get(Ze(r,a)&&a in n?r:n,a,i)}const W0={get:Nc(!1,!1)},K0={get:Nc(!1,!0)},Y0={get:Nc(!0,!1)},mp=new WeakMap,vp=new WeakMap,bp=new WeakMap,q0=new WeakMap;function X0(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function j0(e){return e.__v_skip||!Object.isExtensible(e)?0:X0(b0(e))}function Cr(e){return bi(e)?e:Cc(e,!1,gp,W0,mp)}function Q0(e){return Cc(e,!1,F0,K0,vp)}function Ac(e){return Cc(e,!0,U0,Y0,bp)}function Cc(e,t,r,n,a){if(!St(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=a.get(e);if(i)return i;const s=j0(e);if(s===0)return e;const d=new Proxy(e,s===2?n:r);return a.set(e,d),d}function ha(e){return bi(e)?ha(e.__v_raw):!!(e&&e.__v_isReactive)}function bi(e){return!!(e&&e.__v_isReadonly)}function kl(e){return!!(e&&e.__v_isShallow)}function yp(e){return ha(e)||bi(e)}function rt(e){const t=e&&e.__v_raw;return t?rt(t):e}function Ep(e){return Oo(e,"__v_skip",!0),e}const yi=e=>St(e)?Cr(e):e,xc=e=>St(e)?Ac(e):e;function wp(e){vn&&wr&&(e=rt(e),fp(e.dep||(e.dep=yc())))}function _p(e,t){e=rt(e),e.dep&&Ol(e.dep)}function Gt(e){return!!(e&&e.__v_isRef===!0)}function Se(e){return Ap(e,!1)}function Np(e){return Ap(e,!0)}function Ap(e,t){return Gt(e)?e:new Z0(e,t)}class Z0{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:rt(t),this._value=r?t:yi(t)}get value(){return wp(this),this._value}set value(t){t=this.__v_isShallow?t:rt(t),vi(t,this._rawValue)&&(this._rawValue=t,this._value=this.__v_isShallow?t:yi(t),_p(this))}}function Fn(e){return Gt(e)?e.value:e}const J0={get:(e,t,r)=>Fn(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const a=e[t];return Gt(a)&&!Gt(r)?(a.value=r,!0):Reflect.set(e,t,r,n)}};function Cp(e){return ha(e)?e:new Proxy(e,J0)}function WF(e){const t=ze(e)?new Array(e.length):{};for(const r in e)t[r]=tb(e,r);return t}class eb{constructor(t,r,n){this._object=t,this._key=r,this._defaultValue=n,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}}function tb(e,t,r){const n=e[t];return Gt(n)?n:new eb(e,t,r)}class rb{constructor(t,r,n,a){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new Ec(t,()=>{this._dirty||(this._dirty=!0,_p(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!a,this.__v_isReadonly=n}get value(){const t=rt(this);return wp(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function nb(e,t,r=!1){let n,a;const i=We(e);return i?(n=e,a=Ar):(n=e.get,a=e.set),new rb(n,a,i||!a,r)}function bn(e,t,r,n){let a;try{a=n?e(...n):e()}catch(i){Ri(i,t,r)}return a}function gr(e,t,r,n){if(We(e)){const i=bn(e,t,r,n);return i&&ip(i)&&i.catch(s=>{Ri(s,t,r)}),i}const a=[];for(let i=0;i<e.length;i++)a.push(gr(e[i],t,r,n));return a}function Ri(e,t,r,n=!0){const a=t?t.vnode:null;if(t){let i=t.parent;const s=t.proxy,d=r;for(;i;){const c=i.ec;if(c){for(let o=0;o<c.length;o++)if(c[o](e,s,d)===!1)return}i=i.parent}const h=t.appContext.config.errorHandler;if(h){bn(h,null,10,[e,s,d]);return}}ab(e,r,a,n)}function ab(e,t,r,n=!0){console.error(e)}let ko=!1,Il=!1;const sr=[];let Qr=0;const li=[];let ai=null,oa=0;const ci=[];let fn=null,sa=0;const xp=Promise.resolve();let Tc=null,Ml=null;function pt(e){const t=Tc||xp;return e?t.then(this?e.bind(this):e):t}function ib(e){let t=Qr+1,r=sr.length;for(;t<r;){const n=t+r>>>1;Ei(sr[n])<e?t=n+1:r=n}return t}function Rc(e){(!sr.length||!sr.includes(e,ko&&e.allowRecurse?Qr+1:Qr))&&e!==Ml&&(e.id==null?sr.push(e):sr.splice(ib(e.id),0,e),Tp())}function Tp(){!ko&&!Il&&(Il=!0,Tc=xp.then(Op))}function ob(e){const t=sr.indexOf(e);t>Qr&&sr.splice(t,1)}function Rp(e,t,r,n){ze(e)?r.push(...e):(!t||!t.includes(e,e.allowRecurse?n+1:n))&&r.push(e),Tp()}function sb(e){Rp(e,ai,li,oa)}function lb(e){Rp(e,fn,ci,sa)}function Zo(e,t=null){if(li.length){for(Ml=t,ai=[...new Set(li)],li.length=0,oa=0;oa<ai.length;oa++)ai[oa]();ai=null,oa=0,Ml=null,Zo(e,t)}}function Io(e){if(Zo(),ci.length){const t=[...new Set(ci)];if(ci.length=0,fn){fn.push(...t);return}for(fn=t,fn.sort((r,n)=>Ei(r)-Ei(n)),sa=0;sa<fn.length;sa++)fn[sa]();fn=null,sa=0}}const Ei=e=>e.id==null?1/0:e.id;function Op(e){Il=!1,ko=!0,Zo(e),sr.sort((r,n)=>Ei(r)-Ei(n));const t=Ar;try{for(Qr=0;Qr<sr.length;Qr++){const r=sr[Qr];r&&r.active!==!1&&bn(r,null,14)}}finally{Qr=0,sr.length=0,Io(),ko=!1,Tc=null,(sr.length||li.length||ci.length)&&Op(e)}}function cb(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||dt;let a=r;const i=t.startsWith("update:"),s=i&&t.slice(7);if(s&&s in n){const o=`${s==="modelValue"?"model":s}Modifiers`,{number:l,trim:u}=n[o]||dt;u&&(a=r.map(f=>f.trim())),l&&(a=r.map(lp))}let d,h=n[d=qs(t)]||n[d=qs(Lr(t))];!h&&i&&(h=n[d=qs(Wn(t))]),h&&gr(h,e,6,a);const c=n[d+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[d])return;e.emitted[d]=!0,gr(c,e,6,a)}}function kp(e,t,r=!1){const n=t.emitsCache,a=n.get(e);if(a!==void 0)return a;const i=e.emits;let s={},d=!1;if(!We(e)){const h=c=>{const o=kp(c,t,!0);o&&(d=!0,Ht(s,o))};!r&&t.mixins.length&&t.mixins.forEach(h),e.extends&&h(e.extends),e.mixins&&e.mixins.forEach(h)}return!i&&!d?(n.set(e,null),null):(ze(i)?i.forEach(h=>s[h]=null):Ht(s,i),n.set(e,s),s)}function Jo(e,t){return!e||!Ti(t)?!1:(t=t.slice(2).replace(/Once$/,""),Ze(e,t[0].toLowerCase()+t.slice(1))||Ze(e,Wn(t))||Ze(e,t))}let Kt=null,Ip=null;function Mo(e){const t=Kt;return Kt=e,Ip=e&&e.type.__scopeId||null,t}function ub(e,t=Kt,r){if(!t||e._n)return e;const n=(...a)=>{n._d&&ad(-1);const i=Mo(t),s=e(...a);return Mo(i),n._d&&ad(1),s};return n._n=!0,n._c=!0,n._d=!0,n}function js(e){const{type:t,vnode:r,proxy:n,withProxy:a,props:i,propsOptions:[s],slots:d,attrs:h,emit:c,render:o,renderCache:l,data:u,setupState:f,ctx:m,inheritAttrs:g}=e;let b,v;const w=Mo(e);try{if(r.shapeFlag&4){const _=a||n;b=Er(o.call(_,_,l,i,f,u,m)),v=h}else{const _=t;b=Er(_.length>1?_(i,{attrs:h,slots:d,emit:c}):_(i,null)),v=t.props?h:db(h)}}catch(_){di.length=0,Ri(_,e,1),b=kt(lr)}let y=b;if(v&&g!==!1){const _=Object.keys(v),{shapeFlag:T}=y;_.length&&T&7&&(s&&_.some(gc)&&(v=fb(v,s)),y=En(y,v))}return r.dirs&&(y=En(y),y.dirs=y.dirs?y.dirs.concat(r.dirs):r.dirs),r.transition&&(y.transition=r.transition),b=y,Mo(w),b}const db=e=>{let t;for(const r in e)(r==="class"||r==="style"||Ti(r))&&((t||(t={}))[r]=e[r]);return t},fb=(e,t)=>{const r={};for(const n in e)(!gc(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r};function hb(e,t,r){const{props:n,children:a,component:i}=e,{props:s,children:d,patchFlag:h}=t,c=i.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&h>=0){if(h&1024)return!0;if(h&16)return n?Yu(n,s,c):!!s;if(h&8){const o=t.dynamicProps;for(let l=0;l<o.length;l++){const u=o[l];if(s[u]!==n[u]&&!Jo(c,u))return!0}}}else return(a||d)&&(!d||!d.$stable)?!0:n===s?!1:n?s?Yu(n,s,c):!0:!!s;return!1}function Yu(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let a=0;a<n.length;a++){const i=n[a];if(t[i]!==e[i]&&!Jo(r,i))return!0}return!1}function pb({vnode:e,parent:t},r){for(;t&&t.subTree===e;)(e=t.vnode).el=r,t=t.parent}const gb=e=>e.__isSuspense;function Mp(e,t){t&&t.pendingBranch?ze(e)?t.effects.push(...e):t.effects.push(e):lb(e)}function wt(e,t){if($t){let r=$t.provides;const n=$t.parent&&$t.parent.provides;n===r&&(r=$t.provides=Object.create(n)),r[e]=t}}function _t(e,t,r=!1){const n=$t||Kt;if(n){const a=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(a&&e in a)return a[e];if(arguments.length>1)return r&&We(t)?t.call(n.proxy):t}}function mb(e,t){return Oc(e,null,{flush:"post"})}const qu={};function rr(e,t,r){return Oc(e,t,r)}function Oc(e,t,{immediate:r,deep:n,flush:a,onTrack:i,onTrigger:s}=dt){const d=$t;let h,c=!1,o=!1;if(Gt(e)?(h=()=>e.value,c=kl(e)):ha(e)?(h=()=>e,n=!0):ze(e)?(o=!0,c=e.some(v=>ha(v)||kl(v)),h=()=>e.map(v=>{if(Gt(v))return v.value;if(ha(v))return Dn(v);if(We(v))return bn(v,d,2)})):We(e)?t?h=()=>bn(e,d,2):h=()=>{if(!(d&&d.isUnmounted))return l&&l(),gr(e,d,3,[u])}:h=Ar,t&&n){const v=h;h=()=>Dn(v())}let l,u=v=>{l=b.onStop=()=>{bn(v,d,4)}};if(wa)return u=Ar,t?r&&gr(t,d,3,[h(),o?[]:void 0,u]):h(),Ar;let f=o?[]:qu;const m=()=>{if(!!b.active)if(t){const v=b.run();(n||c||(o?v.some((w,y)=>vi(w,f[y])):vi(v,f)))&&(l&&l(),gr(t,d,3,[v,f===qu?void 0:f,u]),f=v)}else b.run()};m.allowRecurse=!!t;let g;a==="sync"?g=m:a==="post"?g=()=>tr(m,d&&d.suspense):g=()=>sb(m);const b=new Ec(h,g);return t?r?m():f=b.run():a==="post"?tr(b.run.bind(b),d&&d.suspense):b.run(),()=>{b.stop(),d&&d.scope&&mc(d.scope.effects,b)}}function vb(e,t,r){const n=this.proxy,a=ft(e)?e.includes(".")?Pp(n,e):()=>n[e]:e.bind(n,n);let i;We(t)?i=t:(i=t.handler,r=t);const s=$t;Ea(this);const d=Oc(a,i.bind(n),r);return s?Ea(s):Bn(),d}function Pp(e,t){const r=t.split(".");return()=>{let n=e;for(let a=0;a<r.length&&n;a++)n=n[r[a]];return n}}function Dn(e,t){if(!St(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Gt(e))Dn(e.value,t);else if(ze(e))for(let r=0;r<e.length;r++)Dn(e[r],t);else if(ap(e)||fa(e))e.forEach(r=>{Dn(r,t)});else if(sp(e))for(const r in e)Dn(e[r],t);return e}function bb(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return xr(()=>{e.isMounted=!0}),ki(()=>{e.isUnmounting=!0}),e}const dr=[Function,Array],yb={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:dr,onEnter:dr,onAfterEnter:dr,onEnterCancelled:dr,onBeforeLeave:dr,onLeave:dr,onAfterLeave:dr,onLeaveCancelled:dr,onBeforeAppear:dr,onAppear:dr,onAfterAppear:dr,onAppearCancelled:dr},setup(e,{slots:t}){const r=Sc(),n=bb();let a;return()=>{const i=t.default&&$p(t.default(),!0);if(!i||!i.length)return;let s=i[0];if(i.length>1){for(const g of i)if(g.type!==lr){s=g;break}}const d=rt(e),{mode:h}=d;if(n.isLeaving)return Qs(s);const c=Xu(s);if(!c)return Qs(s);const o=Pl(c,d,n,r);Sl(c,o);const l=r.subTree,u=l&&Xu(l);let f=!1;const{getTransitionKey:m}=c.type;if(m){const g=m();a===void 0?a=g:g!==a&&(a=g,f=!0)}if(u&&u.type!==lr&&(!Ln(c,u)||f)){const g=Pl(u,d,n,r);if(Sl(u,g),h==="out-in")return n.isLeaving=!0,g.afterLeave=()=>{n.isLeaving=!1,r.update()},Qs(s);h==="in-out"&&c.type!==lr&&(g.delayLeave=(b,v,w)=>{const y=Lp(n,u);y[String(u.key)]=u,b._leaveCb=()=>{v(),b._leaveCb=void 0,delete o.delayedLeave},o.delayedLeave=w})}return s}}},Sp=yb;function Lp(e,t){const{leavingVNodes:r}=e;let n=r.get(t.type);return n||(n=Object.create(null),r.set(t.type,n)),n}function Pl(e,t,r,n){const{appear:a,mode:i,persisted:s=!1,onBeforeEnter:d,onEnter:h,onAfterEnter:c,onEnterCancelled:o,onBeforeLeave:l,onLeave:u,onAfterLeave:f,onLeaveCancelled:m,onBeforeAppear:g,onAppear:b,onAfterAppear:v,onAppearCancelled:w}=t,y=String(e.key),_=Lp(r,e),T=(C,N)=>{C&&gr(C,n,9,N)},A=(C,N)=>{const P=N[1];T(C,N),ze(C)?C.every(z=>z.length<=1)&&P():C.length<=1&&P()},x={mode:i,persisted:s,beforeEnter(C){let N=d;if(!r.isMounted)if(a)N=g||d;else return;C._leaveCb&&C._leaveCb(!0);const P=_[y];P&&Ln(e,P)&&P.el._leaveCb&&P.el._leaveCb(),T(N,[C])},enter(C){let N=h,P=c,z=o;if(!r.isMounted)if(a)N=b||h,P=v||c,z=w||o;else return;let K=!1;const q=C._enterCb=W=>{K||(K=!0,W?T(z,[C]):T(P,[C]),x.delayedLeave&&x.delayedLeave(),C._enterCb=void 0)};N?A(N,[C,q]):q()},leave(C,N){const P=String(e.key);if(C._enterCb&&C._enterCb(!0),r.isUnmounting)return N();T(l,[C]);let z=!1;const K=C._leaveCb=q=>{z||(z=!0,N(),q?T(m,[C]):T(f,[C]),C._leaveCb=void 0,_[P]===e&&delete _[P])};_[P]=e,u?A(u,[C,K]):K()},clone(C){return Pl(C,t,r,n)}};return x}function Qs(e){if(Oi(e))return e=En(e),e.children=null,e}function Xu(e){return Oi(e)?e.children?e.children[0]:void 0:e}function Sl(e,t){e.shapeFlag&6&&e.component?Sl(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function $p(e,t=!1,r){let n=[],a=0;for(let i=0;i<e.length;i++){let s=e[i];const d=r==null?s.key:String(r)+String(s.key!=null?s.key:i);s.type===Qt?(s.patchFlag&128&&a++,n=n.concat($p(s.children,t,d))):(t||s.type!==lr)&&n.push(d!=null?En(s,{key:d}):s)}if(a>1)for(let i=0;i<n.length;i++)n[i].patchFlag=-2;return n}function it(e){return We(e)?{setup:e,name:e.name}:e}const pa=e=>!!e.type.__asyncLoader;function Dt(e){We(e)&&(e={loader:e});const{loader:t,loadingComponent:r,errorComponent:n,delay:a=200,timeout:i,suspensible:s=!0,onError:d}=e;let h=null,c,o=0;const l=()=>(o++,h=null,u()),u=()=>{let f;return h||(f=h=t().catch(m=>{if(m=m instanceof Error?m:new Error(String(m)),d)return new Promise((g,b)=>{d(m,()=>g(l()),()=>b(m),o+1)});throw m}).then(m=>f!==h&&h?h:(m&&(m.__esModule||m[Symbol.toStringTag]==="Module")&&(m=m.default),c=m,m)))};return it({name:"AsyncComponentWrapper",__asyncLoader:u,get __asyncResolved(){return c},setup(){const f=$t;if(c)return()=>Zs(c,f);const m=w=>{h=null,Ri(w,f,13,!n)};if(s&&f.suspense||wa)return u().then(w=>()=>Zs(w,f)).catch(w=>(m(w),()=>n?kt(n,{error:w}):null));const g=Se(!1),b=Se(),v=Se(!!a);return a&&setTimeout(()=>{v.value=!1},a),i!=null&&setTimeout(()=>{if(!g.value&&!b.value){const w=new Error(`Async component timed out after ${i}ms.`);m(w),b.value=w}},i),u().then(()=>{g.value=!0,f.parent&&Oi(f.parent.vnode)&&Rc(f.parent.update)}).catch(w=>{m(w),b.value=w}),()=>{if(g.value&&c)return Zs(c,f);if(b.value&&n)return kt(n,{error:b.value});if(r&&!v.value)return kt(r)}}})}function Zs(e,{vnode:{ref:t,props:r,children:n,shapeFlag:a},parent:i}){const s=kt(e,r,n);return s.ref=t,s}const Oi=e=>e.type.__isKeepAlive;function Eb(e,t){Dp(e,"a",t)}function wb(e,t){Dp(e,"da",t)}function Dp(e,t,r=$t){const n=e.__wdc||(e.__wdc=()=>{let a=r;for(;a;){if(a.isDeactivated)return;a=a.parent}return e()});if(es(t,n,r),r){let a=r.parent;for(;a&&a.parent;)Oi(a.parent.vnode)&&_b(n,t,r,a),a=a.parent}}function _b(e,t,r,n){const a=es(t,e,n,!0);Ii(()=>{mc(n[t],a)},r)}function es(e,t,r=$t,n=!1){if(r){const a=r[e]||(r[e]=[]),i=t.__weh||(t.__weh=(...s)=>{if(r.isUnmounted)return;Ia(),Ea(r);const d=gr(t,r,e,s);return Bn(),Ma(),d});return n?a.unshift(i):a.push(i),i}}const en=e=>(t,r=$t)=>(!wa||e==="sp")&&es(e,t,r),Up=en("bm"),xr=en("m"),Nb=en("bu"),Ab=en("u"),ki=en("bum"),Ii=en("um"),Cb=en("sp"),xb=en("rtg"),Tb=en("rtc");function Rb(e,t=$t){es("ec",e,t)}function KF(e,t){const r=Kt;if(r===null)return e;const n=ns(r)||r.proxy,a=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[s,d,h,c=dt]=t[i];We(s)&&(s={mounted:s,updated:s}),s.deep&&Dn(d),a.push({dir:s,instance:n,value:d,oldValue:void 0,arg:h,modifiers:c})}return e}function kr(e,t,r,n){const a=e.dirs,i=t&&t.dirs;for(let s=0;s<a.length;s++){const d=a[s];i&&(d.oldValue=i[s].value);let h=d.dir[n];h&&(Ia(),gr(h,r,8,[e.el,d,e,t]),Ma())}}const Fp="components";function Ut(e,t){return kb(Fp,e,!0,t)||e}const Ob=Symbol();function kb(e,t,r=!0,n=!1){const a=Kt||$t;if(a){const i=a.type;if(e===Fp){const d=c1(i,!1);if(d&&(d===t||d===Lr(t)||d===jo(Lr(t))))return i}const s=ju(a[e]||i[e],t)||ju(a.appContext[e],t);return!s&&n?i:s}}function ju(e,t){return e&&(e[t]||e[Lr(t)]||e[jo(Lr(t))])}function YF(e,t,r,n){let a;const i=r&&r[n];if(ze(e)||ft(e)){a=new Array(e.length);for(let s=0,d=e.length;s<d;s++)a[s]=t(e[s],s,void 0,i&&i[s])}else if(typeof e=="number"){a=new Array(e);for(let s=0;s<e;s++)a[s]=t(s+1,s,void 0,i&&i[s])}else if(St(e))if(e[Symbol.iterator])a=Array.from(e,(s,d)=>t(s,d,void 0,i&&i[d]));else{const s=Object.keys(e);a=new Array(s.length);for(let d=0,h=s.length;d<h;d++){const c=s[d];a[d]=t(e[c],c,d,i&&i[d])}}else a=[];return r&&(r[n]=a),a}function Bp(e,t,r={},n,a){if(Kt.isCE||Kt.parent&&pa(Kt.parent)&&Kt.parent.isCE)return kt("slot",t==="default"?null:{name:t},n&&n());let i=e[t];i&&i._c&&(i._d=!1),ts();const s=i&&Vp(i(r)),d=Zp(Qt,{key:r.key||`_${t}`},s||(n?n():[]),s&&e._===1?64:-2);return!a&&d.scopeId&&(d.slotScopeIds=[d.scopeId+"-s"]),i&&i._c&&(i._d=!0),d}function Vp(e){return e.some(t=>$o(t)?!(t.type===lr||t.type===Qt&&!Vp(t.children)):!0)?e:null}const Ll=e=>e?tg(e)?ns(e)||e.proxy:Ll(e.parent):null,Po=Ht(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Ll(e.parent),$root:e=>Ll(e.root),$emit:e=>e.emit,$options:e=>Gp(e),$forceUpdate:e=>e.f||(e.f=()=>Rc(e.update)),$nextTick:e=>e.n||(e.n=pt.bind(e.proxy)),$watch:e=>vb.bind(e)}),Ib={get({_:e},t){const{ctx:r,setupState:n,data:a,props:i,accessCache:s,type:d,appContext:h}=e;let c;if(t[0]!=="$"){const f=s[t];if(f!==void 0)switch(f){case 1:return n[t];case 2:return a[t];case 4:return r[t];case 3:return i[t]}else{if(n!==dt&&Ze(n,t))return s[t]=1,n[t];if(a!==dt&&Ze(a,t))return s[t]=2,a[t];if((c=e.propsOptions[0])&&Ze(c,t))return s[t]=3,i[t];if(r!==dt&&Ze(r,t))return s[t]=4,r[t];$l&&(s[t]=0)}}const o=Po[t];let l,u;if(o)return t==="$attrs"&&cr(e,"get",t),o(e);if((l=d.__cssModules)&&(l=l[t]))return l;if(r!==dt&&Ze(r,t))return s[t]=4,r[t];if(u=h.config.globalProperties,Ze(u,t))return u[t]},set({_:e},t,r){const{data:n,setupState:a,ctx:i}=e;return a!==dt&&Ze(a,t)?(a[t]=r,!0):n!==dt&&Ze(n,t)?(n[t]=r,!0):Ze(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:a,propsOptions:i}},s){let d;return!!r[s]||e!==dt&&Ze(e,s)||t!==dt&&Ze(t,s)||(d=i[0])&&Ze(d,s)||Ze(n,s)||Ze(Po,s)||Ze(a.config.globalProperties,s)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:Ze(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};let $l=!0;function Mb(e){const t=Gp(e),r=e.proxy,n=e.ctx;$l=!1,t.beforeCreate&&Qu(t.beforeCreate,e,"bc");const{data:a,computed:i,methods:s,watch:d,provide:h,inject:c,created:o,beforeMount:l,mounted:u,beforeUpdate:f,updated:m,activated:g,deactivated:b,beforeDestroy:v,beforeUnmount:w,destroyed:y,unmounted:_,render:T,renderTracked:A,renderTriggered:x,errorCaptured:C,serverPrefetch:N,expose:P,inheritAttrs:z,components:K,directives:q,filters:W}=t;if(c&&Pb(c,n,null,e.appContext.config.unwrapInjectedRef),s)for(const G in s){const j=s[G];We(j)&&(n[G]=j.bind(r))}if(a){const G=a.call(r,r);St(G)&&(e.data=Cr(G))}if($l=!0,i)for(const G in i){const j=i[G],ie=We(j)?j.bind(r,r):We(j.get)?j.get.bind(r,r):Ar,fe=!We(j)&&We(j.set)?j.set.bind(r):Ar,ve=Ge({get:ie,set:fe});Object.defineProperty(n,G,{enumerable:!0,configurable:!0,get:()=>ve.value,set:xe=>ve.value=xe})}if(d)for(const G in d)zp(d[G],n,r,G);if(h){const G=We(h)?h.call(r):h;Reflect.ownKeys(G).forEach(j=>{wt(j,G[j])})}o&&Qu(o,e,"c");function V(G,j){ze(j)?j.forEach(ie=>G(ie.bind(r))):j&&G(j.bind(r))}if(V(Up,l),V(xr,u),V(Nb,f),V(Ab,m),V(Eb,g),V(wb,b),V(Rb,C),V(Tb,A),V(xb,x),V(ki,w),V(Ii,_),V(Cb,N),ze(P))if(P.length){const G=e.exposed||(e.exposed={});P.forEach(j=>{Object.defineProperty(G,j,{get:()=>r[j],set:ie=>r[j]=ie})})}else e.exposed||(e.exposed={});T&&e.render===Ar&&(e.render=T),z!=null&&(e.inheritAttrs=z),K&&(e.components=K),q&&(e.directives=q)}function Pb(e,t,r=Ar,n=!1){ze(e)&&(e=Dl(e));for(const a in e){const i=e[a];let s;St(i)?"default"in i?s=_t(i.from||a,i.default,!0):s=_t(i.from||a):s=_t(i),Gt(s)&&n?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>s.value,set:d=>s.value=d}):t[a]=s}}function Qu(e,t,r){gr(ze(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function zp(e,t,r,n){const a=n.includes(".")?Pp(r,n):()=>r[n];if(ft(e)){const i=t[e];We(i)&&rr(a,i)}else if(We(e))rr(a,e.bind(r));else if(St(e))if(ze(e))e.forEach(i=>zp(i,t,r,n));else{const i=We(e.handler)?e.handler.bind(r):t[e.handler];We(i)&&rr(a,i,e)}}function Gp(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:a,optionsCache:i,config:{optionMergeStrategies:s}}=e.appContext,d=i.get(t);let h;return d?h=d:!a.length&&!r&&!n?h=t:(h={},a.length&&a.forEach(c=>So(h,c,s,!0)),So(h,t,s)),i.set(t,h),h}function So(e,t,r,n=!1){const{mixins:a,extends:i}=t;i&&So(e,i,r,!0),a&&a.forEach(s=>So(e,s,r,!0));for(const s in t)if(!(n&&s==="expose")){const d=Sb[s]||r&&r[s];e[s]=d?d(e[s],t[s]):t[s]}return e}const Sb={data:Zu,props:In,emits:In,methods:In,computed:In,beforeCreate:Xt,created:Xt,beforeMount:Xt,mounted:Xt,beforeUpdate:Xt,updated:Xt,beforeDestroy:Xt,beforeUnmount:Xt,destroyed:Xt,unmounted:Xt,activated:Xt,deactivated:Xt,errorCaptured:Xt,serverPrefetch:Xt,components:In,directives:In,watch:$b,provide:Zu,inject:Lb};function Zu(e,t){return t?e?function(){return Ht(We(e)?e.call(this,this):e,We(t)?t.call(this,this):t)}:t:e}function Lb(e,t){return In(Dl(e),Dl(t))}function Dl(e){if(ze(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function Xt(e,t){return e?[...new Set([].concat(e,t))]:t}function In(e,t){return e?Ht(Ht(Object.create(null),e),t):t}function $b(e,t){if(!e)return t;if(!t)return e;const r=Ht(Object.create(null),e);for(const n in t)r[n]=Xt(e[n],t[n]);return r}function Db(e,t,r,n=!1){const a={},i={};Oo(i,rs,1),e.propsDefaults=Object.create(null),Hp(e,t,a,i);for(const s in e.propsOptions[0])s in a||(a[s]=void 0);r?e.props=n?a:Q0(a):e.type.props?e.props=a:e.props=i,e.attrs=i}function Ub(e,t,r,n){const{props:a,attrs:i,vnode:{patchFlag:s}}=e,d=rt(a),[h]=e.propsOptions;let c=!1;if((n||s>0)&&!(s&16)){if(s&8){const o=e.vnode.dynamicProps;for(let l=0;l<o.length;l++){let u=o[l];if(Jo(e.emitsOptions,u))continue;const f=t[u];if(h)if(Ze(i,u))f!==i[u]&&(i[u]=f,c=!0);else{const m=Lr(u);a[m]=Ul(h,d,m,f,e,!1)}else f!==i[u]&&(i[u]=f,c=!0)}}}else{Hp(e,t,a,i)&&(c=!0);let o;for(const l in d)(!t||!Ze(t,l)&&((o=Wn(l))===l||!Ze(t,o)))&&(h?r&&(r[l]!==void 0||r[o]!==void 0)&&(a[l]=Ul(h,d,l,void 0,e,!0)):delete a[l]);if(i!==d)for(const l in i)(!t||!Ze(t,l)&&!0)&&(delete i[l],c=!0)}c&&Jr(e,"set","$attrs")}function Hp(e,t,r,n){const[a,i]=e.propsOptions;let s=!1,d;if(t)for(let h in t){if(si(h))continue;const c=t[h];let o;a&&Ze(a,o=Lr(h))?!i||!i.includes(o)?r[o]=c:(d||(d={}))[o]=c:Jo(e.emitsOptions,h)||(!(h in n)||c!==n[h])&&(n[h]=c,s=!0)}if(i){const h=rt(r),c=d||dt;for(let o=0;o<i.length;o++){const l=i[o];r[l]=Ul(a,h,l,c[l],e,!Ze(c,l))}}return s}function Ul(e,t,r,n,a,i){const s=e[r];if(s!=null){const d=Ze(s,"default");if(d&&n===void 0){const h=s.default;if(s.type!==Function&&We(h)){const{propsDefaults:c}=a;r in c?n=c[r]:(Ea(a),n=c[r]=h.call(null,t),Bn())}else n=h}s[0]&&(i&&!d?n=!1:s[1]&&(n===""||n===Wn(r))&&(n=!0))}return n}function Wp(e,t,r=!1){const n=t.propsCache,a=n.get(e);if(a)return a;const i=e.props,s={},d=[];let h=!1;if(!We(e)){const o=l=>{h=!0;const[u,f]=Wp(l,t,!0);Ht(s,u),f&&d.push(...f)};!r&&t.mixins.length&&t.mixins.forEach(o),e.extends&&o(e.extends),e.mixins&&e.mixins.forEach(o)}if(!i&&!h)return n.set(e,da),da;if(ze(i))for(let o=0;o<i.length;o++){const l=Lr(i[o]);Ju(l)&&(s[l]=dt)}else if(i)for(const o in i){const l=Lr(o);if(Ju(l)){const u=i[o],f=s[l]=ze(u)||We(u)?{type:u}:u;if(f){const m=rd(Boolean,f.type),g=rd(String,f.type);f[0]=m>-1,f[1]=g<0||m<g,(m>-1||Ze(f,"default"))&&d.push(l)}}}const c=[s,d];return n.set(e,c),c}function Ju(e){return e[0]!=="$"}function ed(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function td(e,t){return ed(e)===ed(t)}function rd(e,t){return ze(t)?t.findIndex(r=>td(r,e)):We(t)&&td(t,e)?0:-1}const Kp=e=>e[0]==="_"||e==="$stable",kc=e=>ze(e)?e.map(Er):[Er(e)],Fb=(e,t,r)=>{if(t._n)return t;const n=ub((...a)=>kc(t(...a)),r);return n._c=!1,n},Yp=(e,t,r)=>{const n=e._ctx;for(const a in e){if(Kp(a))continue;const i=e[a];if(We(i))t[a]=Fb(a,i,n);else if(i!=null){const s=kc(i);t[a]=()=>s}}},qp=(e,t)=>{const r=kc(t);e.slots.default=()=>r},Bb=(e,t)=>{if(e.vnode.shapeFlag&32){const r=t._;r?(e.slots=rt(t),Oo(t,"_",r)):Yp(t,e.slots={})}else e.slots={},t&&qp(e,t);Oo(e.slots,rs,1)},Vb=(e,t,r)=>{const{vnode:n,slots:a}=e;let i=!0,s=dt;if(n.shapeFlag&32){const d=t._;d?r&&d===1?i=!1:(Ht(a,t),!r&&d===1&&delete a._):(i=!t.$stable,Yp(t,a)),s=t}else t&&(qp(e,t),s={default:1});if(i)for(const d in a)!Kp(d)&&!(d in s)&&delete a[d]};function Xp(){return{app:null,config:{isNativeTag:g0,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let zb=0;function Gb(e,t){return function(n,a=null){We(n)||(n=Object.assign({},n)),a!=null&&!St(a)&&(a=null);const i=Xp(),s=new Set;let d=!1;const h=i.app={_uid:zb++,_component:n,_props:a,_container:null,_context:i,_instance:null,version:d1,get config(){return i.config},set config(c){},use(c,...o){return s.has(c)||(c&&We(c.install)?(s.add(c),c.install(h,...o)):We(c)&&(s.add(c),c(h,...o))),h},mixin(c){return i.mixins.includes(c)||i.mixins.push(c),h},component(c,o){return o?(i.components[c]=o,h):i.components[c]},directive(c,o){return o?(i.directives[c]=o,h):i.directives[c]},mount(c,o,l){if(!d){const u=kt(n,a);return u.appContext=i,o&&t?t(u,c):e(u,c,l),d=!0,h._container=c,c.__vue_app__=h,ns(u.component)||u.component.proxy}},unmount(){d&&(e(null,h._container),delete h._container.__vue_app__)},provide(c,o){return i.provides[c]=o,h}};return h}}function Lo(e,t,r,n,a=!1){if(ze(e)){e.forEach((u,f)=>Lo(u,t&&(ze(t)?t[f]:t),r,n,a));return}if(pa(n)&&!a)return;const i=n.shapeFlag&4?ns(n.component)||n.component.proxy:n.el,s=a?null:i,{i:d,r:h}=e,c=t&&t.r,o=d.refs===dt?d.refs={}:d.refs,l=d.setupState;if(c!=null&&c!==h&&(ft(c)?(o[c]=null,Ze(l,c)&&(l[c]=null)):Gt(c)&&(c.value=null)),We(h))bn(h,d,12,[s,o]);else{const u=ft(h),f=Gt(h);if(u||f){const m=()=>{if(e.f){const g=u?o[h]:h.value;a?ze(g)&&mc(g,i):ze(g)?g.includes(i)||g.push(i):u?(o[h]=[i],Ze(l,h)&&(l[h]=o[h])):(h.value=[i],e.k&&(o[e.k]=h.value))}else u?(o[h]=s,Ze(l,h)&&(l[h]=s)):f&&(h.value=s,e.k&&(o[e.k]=s))};s?(m.id=-1,tr(m,r)):m()}}}let sn=!1;const oo=e=>/svg/.test(e.namespaceURI)&&e.tagName!=="foreignObject",so=e=>e.nodeType===8;function Hb(e){const{mt:t,p:r,o:{patchProp:n,createText:a,nextSibling:i,parentNode:s,remove:d,insert:h,createComment:c}}=e,o=(v,w)=>{if(!w.hasChildNodes()){r(null,v,w),Io(),w._vnode=v;return}sn=!1,l(w.firstChild,v,null,null,null),Io(),w._vnode=v,sn&&console.error("Hydration completed but contains mismatches.")},l=(v,w,y,_,T,A=!1)=>{const x=so(v)&&v.data==="[",C=()=>g(v,w,y,_,T,x),{type:N,ref:P,shapeFlag:z,patchFlag:K}=w,q=v.nodeType;w.el=v,K===-2&&(A=!1,w.dynamicChildren=null);let W=null;switch(N){case wi:q!==3?w.children===""?(h(w.el=a(""),s(v),v),W=v):W=C():(v.data!==w.children&&(sn=!0,v.data=w.children),W=i(v));break;case lr:q!==8||x?W=C():W=i(v);break;case ga:if(q!==1&&q!==3)W=C();else{W=v;const ce=!w.children.length;for(let V=0;V<w.staticCount;V++)ce&&(w.children+=W.nodeType===1?W.outerHTML:W.data),V===w.staticCount-1&&(w.anchor=W),W=i(W);return W}break;case Qt:x?W=m(v,w,y,_,T,A):W=C();break;default:if(z&1)q!==1||w.type.toLowerCase()!==v.tagName.toLowerCase()?W=C():W=u(v,w,y,_,T,A);else if(z&6){w.slotScopeIds=T;const ce=s(v);if(t(w,ce,null,y,_,oo(ce),A),W=x?b(v):i(v),W&&so(W)&&W.data==="teleport end"&&(W=i(W)),pa(w)){let V;x?(V=kt(Qt),V.anchor=W?W.previousSibling:ce.lastChild):V=v.nodeType===3?Mc(""):kt("div"),V.el=v,w.component.subTree=V}}else z&64?q!==8?W=C():W=w.type.hydrate(v,w,y,_,T,A,e,f):z&128&&(W=w.type.hydrate(v,w,y,_,oo(s(v)),T,A,e,l))}return P!=null&&Lo(P,null,_,w),W},u=(v,w,y,_,T,A)=>{A=A||!!w.dynamicChildren;const{type:x,props:C,patchFlag:N,shapeFlag:P,dirs:z}=w,K=x==="input"&&z||x==="option";if(K||N!==-1){if(z&&kr(w,null,y,"created"),C)if(K||!A||N&48)for(const W in C)(K&&W.endsWith("value")||Ti(W)&&!si(W))&&n(v,W,null,C[W],!1,void 0,y);else C.onClick&&n(v,"onClick",null,C.onClick,!1,void 0,y);let q;if((q=C&&C.onVnodeBeforeMount)&&fr(q,y,w),z&&kr(w,null,y,"beforeMount"),((q=C&&C.onVnodeMounted)||z)&&Mp(()=>{q&&fr(q,y,w),z&&kr(w,null,y,"mounted")},_),P&16&&!(C&&(C.innerHTML||C.textContent))){let W=f(v.firstChild,w,v,y,_,T,A);for(;W;){sn=!0;const ce=W;W=W.nextSibling,d(ce)}}else P&8&&v.textContent!==w.children&&(sn=!0,v.textContent=w.children)}return v.nextSibling},f=(v,w,y,_,T,A,x)=>{x=x||!!w.dynamicChildren;const C=w.children,N=C.length;for(let P=0;P<N;P++){const z=x?C[P]:C[P]=Er(C[P]);if(v)v=l(v,z,_,T,A,x);else{if(z.type===wi&&!z.children)continue;sn=!0,r(null,z,y,null,_,T,oo(y),A)}}return v},m=(v,w,y,_,T,A)=>{const{slotScopeIds:x}=w;x&&(T=T?T.concat(x):x);const C=s(v),N=f(i(v),w,C,y,_,T,A);return N&&so(N)&&N.data==="]"?i(w.anchor=N):(sn=!0,h(w.anchor=c("]"),C,N),N)},g=(v,w,y,_,T,A)=>{if(sn=!0,w.el=null,A){const N=b(v);for(;;){const P=i(v);if(P&&P!==N)d(P);else break}}const x=i(v),C=s(v);return d(v),r(null,w,C,x,y,_,oo(C),T),x},b=v=>{let w=0;for(;v;)if(v=i(v),v&&so(v)&&(v.data==="["&&w++,v.data==="]")){if(w===0)return i(v);w--}return v};return[o,l]}const tr=Mp;function Wb(e){return Kb(e,Hb)}function Kb(e,t){const r=w0();r.__VUE__=!0;const{insert:n,remove:a,patchProp:i,createElement:s,createText:d,createComment:h,setText:c,setElementText:o,parentNode:l,nextSibling:u,setScopeId:f=Ar,cloneNode:m,insertStaticContent:g}=e,b=(k,B,H,re=null,ne=null,p=null,ye=!1,$=null,pe=!!B.dynamicChildren)=>{if(k===B)return;k&&!Ln(k,B)&&(re=U(k),Te(k,ne,p,!0),k=null),B.patchFlag===-2&&(pe=!1,B.dynamicChildren=null);const{type:ue,ref:Oe,shapeFlag:Ne}=B;switch(ue){case wi:v(k,B,H,re);break;case lr:w(k,B,H,re);break;case ga:k==null&&y(B,H,re,ye);break;case Qt:q(k,B,H,re,ne,p,ye,$,pe);break;default:Ne&1?A(k,B,H,re,ne,p,ye,$,pe):Ne&6?W(k,B,H,re,ne,p,ye,$,pe):(Ne&64||Ne&128)&&ue.process(k,B,H,re,ne,p,ye,$,pe,Y)}Oe!=null&&ne&&Lo(Oe,k&&k.ref,p,B||k,!B)},v=(k,B,H,re)=>{if(k==null)n(B.el=d(B.children),H,re);else{const ne=B.el=k.el;B.children!==k.children&&c(ne,B.children)}},w=(k,B,H,re)=>{k==null?n(B.el=h(B.children||""),H,re):B.el=k.el},y=(k,B,H,re)=>{[k.el,k.anchor]=g(k.children,B,H,re,k.el,k.anchor)},_=({el:k,anchor:B},H,re)=>{let ne;for(;k&&k!==B;)ne=u(k),n(k,H,re),k=ne;n(B,H,re)},T=({el:k,anchor:B})=>{let H;for(;k&&k!==B;)H=u(k),a(k),k=H;a(B)},A=(k,B,H,re,ne,p,ye,$,pe)=>{ye=ye||B.type==="svg",k==null?x(B,H,re,ne,p,ye,$,pe):P(k,B,ne,p,ye,$,pe)},x=(k,B,H,re,ne,p,ye,$)=>{let pe,ue;const{type:Oe,props:Ne,shapeFlag:ke,transition:_e,patchFlag:de,dirs:L}=k;if(k.el&&m!==void 0&&de===-1)pe=k.el=m(k.el);else{if(pe=k.el=s(k.type,p,Ne&&Ne.is,Ne),ke&8?o(pe,k.children):ke&16&&N(k.children,pe,null,re,ne,p&&Oe!=="foreignObject",ye,$),L&&kr(k,null,re,"created"),Ne){for(const ae in Ne)ae!=="value"&&!si(ae)&&i(pe,ae,null,Ne[ae],p,k.children,re,ne,I);"value"in Ne&&i(pe,"value",null,Ne.value),(ue=Ne.onVnodeBeforeMount)&&fr(ue,re,k)}C(pe,k,k.scopeId,ye,re)}L&&kr(k,null,re,"beforeMount");const D=(!ne||ne&&!ne.pendingBranch)&&_e&&!_e.persisted;D&&_e.beforeEnter(pe),n(pe,B,H),((ue=Ne&&Ne.onVnodeMounted)||D||L)&&tr(()=>{ue&&fr(ue,re,k),D&&_e.enter(pe),L&&kr(k,null,re,"mounted")},ne)},C=(k,B,H,re,ne)=>{if(H&&f(k,H),re)for(let p=0;p<re.length;p++)f(k,re[p]);if(ne){let p=ne.subTree;if(B===p){const ye=ne.vnode;C(k,ye,ye.scopeId,ye.slotScopeIds,ne.parent)}}},N=(k,B,H,re,ne,p,ye,$,pe=0)=>{for(let ue=pe;ue<k.length;ue++){const Oe=k[ue]=$?hn(k[ue]):Er(k[ue]);b(null,Oe,B,H,re,ne,p,ye,$)}},P=(k,B,H,re,ne,p,ye)=>{const $=B.el=k.el;let{patchFlag:pe,dynamicChildren:ue,dirs:Oe}=B;pe|=k.patchFlag&16;const Ne=k.props||dt,ke=B.props||dt;let _e;H&&Cn(H,!1),(_e=ke.onVnodeBeforeUpdate)&&fr(_e,H,B,k),Oe&&kr(B,k,H,"beforeUpdate"),H&&Cn(H,!0);const de=ne&&B.type!=="foreignObject";if(ue?z(k.dynamicChildren,ue,$,H,re,de,p):ye||ie(k,B,$,null,H,re,de,p,!1),pe>0){if(pe&16)K($,B,Ne,ke,H,re,ne);else if(pe&2&&Ne.class!==ke.class&&i($,"class",null,ke.class,ne),pe&4&&i($,"style",Ne.style,ke.style,ne),pe&8){const L=B.dynamicProps;for(let D=0;D<L.length;D++){const ae=L[D],Q=Ne[ae],ee=ke[ae];(ee!==Q||ae==="value")&&i($,ae,Q,ee,ne,k.children,H,re,I)}}pe&1&&k.children!==B.children&&o($,B.children)}else!ye&&ue==null&&K($,B,Ne,ke,H,re,ne);((_e=ke.onVnodeUpdated)||Oe)&&tr(()=>{_e&&fr(_e,H,B,k),Oe&&kr(B,k,H,"updated")},re)},z=(k,B,H,re,ne,p,ye)=>{for(let $=0;$<B.length;$++){const pe=k[$],ue=B[$],Oe=pe.el&&(pe.type===Qt||!Ln(pe,ue)||pe.shapeFlag&70)?l(pe.el):H;b(pe,ue,Oe,null,re,ne,p,ye,!0)}},K=(k,B,H,re,ne,p,ye)=>{if(H!==re){for(const $ in re){if(si($))continue;const pe=re[$],ue=H[$];pe!==ue&&$!=="value"&&i(k,$,ue,pe,ye,B.children,ne,p,I)}if(H!==dt)for(const $ in H)!si($)&&!($ in re)&&i(k,$,H[$],null,ye,B.children,ne,p,I);"value"in re&&i(k,"value",H.value,re.value)}},q=(k,B,H,re,ne,p,ye,$,pe)=>{const ue=B.el=k?k.el:d(""),Oe=B.anchor=k?k.anchor:d("");let{patchFlag:Ne,dynamicChildren:ke,slotScopeIds:_e}=B;_e&&($=$?$.concat(_e):_e),k==null?(n(ue,H,re),n(Oe,H,re),N(B.children,H,Oe,ne,p,ye,$,pe)):Ne>0&&Ne&64&&ke&&k.dynamicChildren?(z(k.dynamicChildren,ke,H,ne,p,ye,$),(B.key!=null||ne&&B===ne.subTree)&&Ic(k,B,!0)):ie(k,B,H,Oe,ne,p,ye,$,pe)},W=(k,B,H,re,ne,p,ye,$,pe)=>{B.slotScopeIds=$,k==null?B.shapeFlag&512?ne.ctx.activate(B,H,re,ye,pe):ce(B,H,re,ne,p,ye,pe):V(k,B,pe)},ce=(k,B,H,re,ne,p,ye)=>{const $=k.component=a1(k,re,ne);if(Oi(k)&&($.ctx.renderer=Y),i1($),$.asyncDep){if(ne&&ne.registerDep($,G),!k.el){const pe=$.subTree=kt(lr);w(null,pe,B,H)}return}G($,k,B,H,ne,p,ye)},V=(k,B,H)=>{const re=B.component=k.component;if(hb(k,B,H))if(re.asyncDep&&!re.asyncResolved){j(re,B,H);return}else re.next=B,ob(re.update),re.update();else B.el=k.el,re.vnode=B},G=(k,B,H,re,ne,p,ye)=>{const $=()=>{if(k.isMounted){let{next:Oe,bu:Ne,u:ke,parent:_e,vnode:de}=k,L=Oe,D;Cn(k,!1),Oe?(Oe.el=de.el,j(k,Oe,ye)):Oe=de,Ne&&Xs(Ne),(D=Oe.props&&Oe.props.onVnodeBeforeUpdate)&&fr(D,_e,Oe,de),Cn(k,!0);const ae=js(k),Q=k.subTree;k.subTree=ae,b(Q,ae,l(Q.el),U(Q),k,ne,p),Oe.el=ae.el,L===null&&pb(k,ae.el),ke&&tr(ke,ne),(D=Oe.props&&Oe.props.onVnodeUpdated)&&tr(()=>fr(D,_e,Oe,de),ne)}else{let Oe;const{el:Ne,props:ke}=B,{bm:_e,m:de,parent:L}=k,D=pa(B);if(Cn(k,!1),_e&&Xs(_e),!D&&(Oe=ke&&ke.onVnodeBeforeMount)&&fr(Oe,L,B),Cn(k,!0),Ne&&X){const ae=()=>{k.subTree=js(k),X(Ne,k.subTree,k,ne,null)};D?B.type.__asyncLoader().then(()=>!k.isUnmounted&&ae()):ae()}else{const ae=k.subTree=js(k);b(null,ae,H,re,k,ne,p),B.el=ae.el}if(de&&tr(de,ne),!D&&(Oe=ke&&ke.onVnodeMounted)){const ae=B;tr(()=>fr(Oe,L,ae),ne)}(B.shapeFlag&256||L&&pa(L.vnode)&&L.vnode.shapeFlag&256)&&k.a&&tr(k.a,ne),k.isMounted=!0,B=H=re=null}},pe=k.effect=new Ec($,()=>Rc(ue),k.scope),ue=k.update=()=>pe.run();ue.id=k.uid,Cn(k,!0),ue()},j=(k,B,H)=>{B.component=k;const re=k.vnode.props;k.vnode=B,k.next=null,Ub(k,B.props,re,H),Vb(k,B.children,H),Ia(),Zo(void 0,k.update),Ma()},ie=(k,B,H,re,ne,p,ye,$,pe=!1)=>{const ue=k&&k.children,Oe=k?k.shapeFlag:0,Ne=B.children,{patchFlag:ke,shapeFlag:_e}=B;if(ke>0){if(ke&128){ve(ue,Ne,H,re,ne,p,ye,$,pe);return}else if(ke&256){fe(ue,Ne,H,re,ne,p,ye,$,pe);return}}_e&8?(Oe&16&&I(ue,ne,p),Ne!==ue&&o(H,Ne)):Oe&16?_e&16?ve(ue,Ne,H,re,ne,p,ye,$,pe):I(ue,ne,p,!0):(Oe&8&&o(H,""),_e&16&&N(Ne,H,re,ne,p,ye,$,pe))},fe=(k,B,H,re,ne,p,ye,$,pe)=>{k=k||da,B=B||da;const ue=k.length,Oe=B.length,Ne=Math.min(ue,Oe);let ke;for(ke=0;ke<Ne;ke++){const _e=B[ke]=pe?hn(B[ke]):Er(B[ke]);b(k[ke],_e,H,null,ne,p,ye,$,pe)}ue>Oe?I(k,ne,p,!0,!1,Ne):N(B,H,re,ne,p,ye,$,pe,Ne)},ve=(k,B,H,re,ne,p,ye,$,pe)=>{let ue=0;const Oe=B.length;let Ne=k.length-1,ke=Oe-1;for(;ue<=Ne&&ue<=ke;){const _e=k[ue],de=B[ue]=pe?hn(B[ue]):Er(B[ue]);if(Ln(_e,de))b(_e,de,H,null,ne,p,ye,$,pe);else break;ue++}for(;ue<=Ne&&ue<=ke;){const _e=k[Ne],de=B[ke]=pe?hn(B[ke]):Er(B[ke]);if(Ln(_e,de))b(_e,de,H,null,ne,p,ye,$,pe);else break;Ne--,ke--}if(ue>Ne){if(ue<=ke){const _e=ke+1,de=_e<Oe?B[_e].el:re;for(;ue<=ke;)b(null,B[ue]=pe?hn(B[ue]):Er(B[ue]),H,de,ne,p,ye,$,pe),ue++}}else if(ue>ke)for(;ue<=Ne;)Te(k[ue],ne,p,!0),ue++;else{const _e=ue,de=ue,L=new Map;for(ue=de;ue<=ke;ue++){const $e=B[ue]=pe?hn(B[ue]):Er(B[ue]);$e.key!=null&&L.set($e.key,ue)}let D,ae=0;const Q=ke-de+1;let ee=!1,we=0;const Le=new Array(Q);for(ue=0;ue<Q;ue++)Le[ue]=0;for(ue=_e;ue<=Ne;ue++){const $e=k[ue];if(ae>=Q){Te($e,ne,p,!0);continue}let De;if($e.key!=null)De=L.get($e.key);else for(D=de;D<=ke;D++)if(Le[D-de]===0&&Ln($e,B[D])){De=D;break}De===void 0?Te($e,ne,p,!0):(Le[De-de]=ue+1,De>=we?we=De:ee=!0,b($e,B[De],H,null,ne,p,ye,$,pe),ae++)}const Be=ee?Yb(Le):da;for(D=Be.length-1,ue=Q-1;ue>=0;ue--){const $e=de+ue,De=B[$e],xt=$e+1<Oe?B[$e+1].el:re;Le[ue]===0?b(null,De,H,xt,ne,p,ye,$,pe):ee&&(D<0||ue!==Be[D]?xe(De,H,xt,2):D--)}}},xe=(k,B,H,re,ne=null)=>{const{el:p,type:ye,transition:$,children:pe,shapeFlag:ue}=k;if(ue&6){xe(k.component.subTree,B,H,re);return}if(ue&128){k.suspense.move(B,H,re);return}if(ue&64){ye.move(k,B,H,Y);return}if(ye===Qt){n(p,B,H);for(let Ne=0;Ne<pe.length;Ne++)xe(pe[Ne],B,H,re);n(k.anchor,B,H);return}if(ye===ga){_(k,B,H);return}if(re!==2&&ue&1&&$)if(re===0)$.beforeEnter(p),n(p,B,H),tr(()=>$.enter(p),ne);else{const{leave:Ne,delayLeave:ke,afterLeave:_e}=$,de=()=>n(p,B,H),L=()=>{Ne(p,()=>{de(),_e&&_e()})};ke?ke(p,de,L):L()}else n(p,B,H)},Te=(k,B,H,re=!1,ne=!1)=>{const{type:p,props:ye,ref:$,children:pe,dynamicChildren:ue,shapeFlag:Oe,patchFlag:Ne,dirs:ke}=k;if($!=null&&Lo($,null,H,k,!0),Oe&256){B.ctx.deactivate(k);return}const _e=Oe&1&&ke,de=!pa(k);let L;if(de&&(L=ye&&ye.onVnodeBeforeUnmount)&&fr(L,B,k),Oe&6)S(k.component,H,re);else{if(Oe&128){k.suspense.unmount(H,re);return}_e&&kr(k,null,B,"beforeUnmount"),Oe&64?k.type.remove(k,B,H,ne,Y,re):ue&&(p!==Qt||Ne>0&&Ne&64)?I(ue,B,H,!1,!0):(p===Qt&&Ne&384||!ne&&Oe&16)&&I(pe,B,H),re&&Me(k)}(de&&(L=ye&&ye.onVnodeUnmounted)||_e)&&tr(()=>{L&&fr(L,B,k),_e&&kr(k,null,B,"unmounted")},H)},Me=k=>{const{type:B,el:H,anchor:re,transition:ne}=k;if(B===Qt){J(H,re);return}if(B===ga){T(k);return}const p=()=>{a(H),ne&&!ne.persisted&&ne.afterLeave&&ne.afterLeave()};if(k.shapeFlag&1&&ne&&!ne.persisted){const{leave:ye,delayLeave:$}=ne,pe=()=>ye(H,p);$?$(k.el,p,pe):pe()}else p()},J=(k,B)=>{let H;for(;k!==B;)H=u(k),a(k),k=H;a(B)},S=(k,B,H)=>{const{bum:re,scope:ne,update:p,subTree:ye,um:$}=k;re&&Xs(re),ne.stop(),p&&(p.active=!1,Te(ye,k,B,H)),$&&tr($,B),tr(()=>{k.isUnmounted=!0},B),B&&B.pendingBranch&&!B.isUnmounted&&k.asyncDep&&!k.asyncResolved&&k.suspenseId===B.pendingId&&(B.deps--,B.deps===0&&B.resolve())},I=(k,B,H,re=!1,ne=!1,p=0)=>{for(let ye=p;ye<k.length;ye++)Te(k[ye],B,H,re,ne)},U=k=>k.shapeFlag&6?U(k.component.subTree):k.shapeFlag&128?k.suspense.next():u(k.anchor||k.el),me=(k,B,H)=>{k==null?B._vnode&&Te(B._vnode,null,null,!0):b(B._vnode||null,k,B,null,null,null,H),Io(),B._vnode=k},Y={p:b,um:Te,m:xe,r:Me,mt:ce,mc:N,pc:ie,pbc:z,n:U,o:e};let be,X;return t&&([be,X]=t(Y)),{render:me,hydrate:be,createApp:Gb(me,be)}}function Cn({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function Ic(e,t,r=!1){const n=e.children,a=t.children;if(ze(n)&&ze(a))for(let i=0;i<n.length;i++){const s=n[i];let d=a[i];d.shapeFlag&1&&!d.dynamicChildren&&((d.patchFlag<=0||d.patchFlag===32)&&(d=a[i]=hn(a[i]),d.el=s.el),r||Ic(s,d))}}function Yb(e){const t=e.slice(),r=[0];let n,a,i,s,d;const h=e.length;for(n=0;n<h;n++){const c=e[n];if(c!==0){if(a=r[r.length-1],e[a]<c){t[n]=a,r.push(n);continue}for(i=0,s=r.length-1;i<s;)d=i+s>>1,e[r[d]]<c?i=d+1:s=d;c<e[r[i]]&&(i>0&&(t[n]=r[i-1]),r[i]=n)}}for(i=r.length,s=r[i-1];i-- >0;)r[i]=s,s=t[s];return r}const qb=e=>e.__isTeleport,ui=e=>e&&(e.disabled||e.disabled===""),nd=e=>typeof SVGElement!="undefined"&&e instanceof SVGElement,Fl=(e,t)=>{const r=e&&e.to;return ft(r)?t?t(r):null:r},Xb={__isTeleport:!0,process(e,t,r,n,a,i,s,d,h,c){const{mc:o,pc:l,pbc:u,o:{insert:f,querySelector:m,createText:g,createComment:b}}=c,v=ui(t.props);let{shapeFlag:w,children:y,dynamicChildren:_}=t;if(e==null){const T=t.el=g(""),A=t.anchor=g("");f(T,r,n),f(A,r,n);const x=t.target=Fl(t.props,m),C=t.targetAnchor=g("");x&&(f(C,x),s=s||nd(x));const N=(P,z)=>{w&16&&o(y,P,z,a,i,s,d,h)};v?N(r,A):x&&N(x,C)}else{t.el=e.el;const T=t.anchor=e.anchor,A=t.target=e.target,x=t.targetAnchor=e.targetAnchor,C=ui(e.props),N=C?r:A,P=C?T:x;if(s=s||nd(A),_?(u(e.dynamicChildren,_,N,a,i,s,d),Ic(e,t,!0)):h||l(e,t,N,P,a,i,s,d,!1),v)C||lo(t,r,T,c,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const z=t.target=Fl(t.props,m);z&&lo(t,z,null,c,0)}else C&&lo(t,A,x,c,1)}},remove(e,t,r,n,{um:a,o:{remove:i}},s){const{shapeFlag:d,children:h,anchor:c,targetAnchor:o,target:l,props:u}=e;if(l&&i(o),(s||!ui(u))&&(i(c),d&16))for(let f=0;f<h.length;f++){const m=h[f];a(m,t,r,!0,!!m.dynamicChildren)}},move:lo,hydrate:jb};function lo(e,t,r,{o:{insert:n},m:a},i=2){i===0&&n(e.targetAnchor,t,r);const{el:s,anchor:d,shapeFlag:h,children:c,props:o}=e,l=i===2;if(l&&n(s,t,r),(!l||ui(o))&&h&16)for(let u=0;u<c.length;u++)a(c[u],t,r,2);l&&n(d,t,r)}function jb(e,t,r,n,a,i,{o:{nextSibling:s,parentNode:d,querySelector:h}},c){const o=t.target=Fl(t.props,h);if(o){const l=o._lpa||o.firstChild;if(t.shapeFlag&16)if(ui(t.props))t.anchor=c(s(e),t,d(e),r,n,a,i),t.targetAnchor=l;else{t.anchor=s(e);let u=l;for(;u;)if(u=s(u),u&&u.nodeType===8&&u.data==="teleport anchor"){t.targetAnchor=u,o._lpa=t.targetAnchor&&s(t.targetAnchor);break}c(l,t,o,r,n,a,i)}}return t.anchor&&s(t.anchor)}const Qb=Xb,Qt=Symbol(void 0),wi=Symbol(void 0),lr=Symbol(void 0),ga=Symbol(void 0),di=[];let _r=null;function ts(e=!1){di.push(_r=e?null:[])}function Zb(){di.pop(),_r=di[di.length-1]||null}let _i=1;function ad(e){_i+=e}function jp(e){return e.dynamicChildren=_i>0?_r||da:null,Zb(),_i>0&&_r&&_r.push(e),e}function Qp(e,t,r,n,a,i){return jp(eg(e,t,r,n,a,i,!0))}function Zp(e,t,r,n,a){return jp(kt(e,t,r,n,a,!0))}function $o(e){return e?e.__v_isVNode===!0:!1}function Ln(e,t){return e.type===t.type&&e.key===t.key}const rs="__vInternal",Jp=({key:e})=>e!=null?e:null,_o=({ref:e,ref_key:t,ref_for:r})=>e!=null?ft(e)||Gt(e)||We(e)?{i:Kt,r:e,k:t,f:!!r}:e:null;function eg(e,t=null,r=null,n=0,a=null,i=e===Qt?0:1,s=!1,d=!1){const h={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Jp(t),ref:t&&_o(t),scopeId:Ip,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:a,dynamicChildren:null,appContext:null};return d?(Pc(h,r),i&128&&e.normalize(h)):r&&(h.shapeFlag|=ft(r)?8:16),_i>0&&!s&&_r&&(h.patchFlag>0||i&6)&&h.patchFlag!==32&&_r.push(h),h}const kt=Jb;function Jb(e,t=null,r=null,n=0,a=null,i=!1){if((!e||e===Ob)&&(e=lr),$o(e)){const d=En(e,t,!0);return r&&Pc(d,r),_i>0&&!i&&_r&&(d.shapeFlag&6?_r[_r.indexOf(e)]=d:_r.push(d)),d.patchFlag|=-2,d}if(u1(e)&&(e=e.__vccOpts),t){t=e1(t);let{class:d,style:h}=t;d&&!ft(d)&&(t.class=xi(d)),St(h)&&(yp(h)&&!ze(h)&&(h=Ht({},h)),t.style=Yo(h))}const s=ft(e)?1:gb(e)?128:qb(e)?64:St(e)?4:We(e)?2:0;return eg(e,t,r,n,a,s,i,!0)}function e1(e){return e?yp(e)||rs in e?Ht({},e):e:null}function En(e,t,r=!1){const{props:n,ref:a,patchFlag:i,children:s}=e,d=t?t1(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:d,key:d&&Jp(d),ref:t&&t.ref?r&&a?ze(a)?a.concat(_o(t)):[a,_o(t)]:_o(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:s,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Qt?i===-1?16:i|16:i,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&En(e.ssContent),ssFallback:e.ssFallback&&En(e.ssFallback),el:e.el,anchor:e.anchor}}function Mc(e=" ",t=0){return kt(wi,null,e,t)}function qF(e,t){const r=kt(ga,null,e);return r.staticCount=t,r}function mt(e="",t=!1){return t?(ts(),Zp(lr,null,e)):kt(lr,null,e)}function Er(e){return e==null||typeof e=="boolean"?kt(lr):ze(e)?kt(Qt,null,e.slice()):typeof e=="object"?hn(e):kt(wi,null,String(e))}function hn(e){return e.el===null||e.memo?e:En(e)}function Pc(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(ze(t))r=16;else if(typeof t=="object")if(n&65){const a=t.default;a&&(a._c&&(a._d=!1),Pc(e,a()),a._c&&(a._d=!0));return}else{r=32;const a=t._;!a&&!(rs in t)?t._ctx=Kt:a===3&&Kt&&(Kt.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else We(t)?(t={default:t,_ctx:Kt},r=32):(t=String(t),n&64?(r=16,t=[Mc(t)]):r=8);e.children=t,e.shapeFlag|=r}function t1(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const a in n)if(a==="class")t.class!==n.class&&(t.class=xi([t.class,n.class]));else if(a==="style")t.style=Yo([t.style,n.style]);else if(Ti(a)){const i=t[a],s=n[a];s&&i!==s&&!(ze(i)&&i.includes(s))&&(t[a]=i?[].concat(i,s):s)}else a!==""&&(t[a]=n[a])}return t}function fr(e,t,r,n=null){gr(e,t,7,[r,n])}const r1=Xp();let n1=0;function a1(e,t,r){const n=e.type,a=(t?t.appContext:e.appContext)||r1,i={uid:n1++,vnode:e,type:n,parent:t,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,scope:new _0(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(a.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Wp(n,a),emitsOptions:kp(n,a),emit:null,emitted:null,propsDefaults:dt,inheritAttrs:n.inheritAttrs,ctx:dt,data:dt,props:dt,attrs:dt,slots:dt,refs:dt,setupState:dt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=cb.bind(null,i),e.ce&&e.ce(i),i}let $t=null;const Sc=()=>$t||Kt,Ea=e=>{$t=e,e.scope.on()},Bn=()=>{$t&&$t.scope.off(),$t=null};function tg(e){return e.vnode.shapeFlag&4}let wa=!1;function i1(e,t=!1){wa=t;const{props:r,children:n}=e.vnode,a=tg(e);Db(e,r,a,t),Bb(e,n);const i=a?o1(e,t):void 0;return wa=!1,i}function o1(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=Ep(new Proxy(e.ctx,Ib));const{setup:n}=r;if(n){const a=e.setupContext=n.length>1?l1(e):null;Ea(e),Ia();const i=bn(n,e,0,[e.props,a]);if(Ma(),Bn(),ip(i)){if(i.then(Bn,Bn),t)return i.then(s=>{id(e,s,t)}).catch(s=>{Ri(s,e,0)});e.asyncDep=i}else id(e,i,t)}else rg(e,t)}function id(e,t,r){We(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:St(t)&&(e.setupState=Cp(t)),rg(e,r)}let od;function rg(e,t,r){const n=e.type;if(!e.render){if(!t&&od&&!n.render){const a=n.template;if(a){const{isCustomElement:i,compilerOptions:s}=e.appContext.config,{delimiters:d,compilerOptions:h}=n,c=Ht(Ht({isCustomElement:i,delimiters:d},s),h);n.render=od(a,c)}}e.render=n.render||Ar}Ea(e),Ia(),Mb(e),Ma(),Bn()}function s1(e){return new Proxy(e.attrs,{get(t,r){return cr(e,"get","$attrs"),t[r]}})}function l1(e){const t=n=>{e.exposed=n||{}};let r;return{get attrs(){return r||(r=s1(e))},slots:e.slots,emit:e.emit,expose:t}}function ns(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Cp(Ep(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in Po)return Po[r](e)}}))}function c1(e,t=!0){return We(e)?e.displayName||e.name:e.name||t&&e.__name}function u1(e){return We(e)&&"__vccOpts"in e}const Ge=(e,t)=>nb(e,t,wa);function Z(e,t,r){const n=arguments.length;return n===2?St(t)&&!ze(t)?$o(t)?kt(e,null,[t]):kt(e,t):kt(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&$o(r)&&(r=[r]),kt(e,t,r))}const d1="3.2.37",f1="http://www.w3.org/2000/svg",$n=typeof document!="undefined"?document:null,sd=$n&&$n.createElement("template"),h1={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const a=t?$n.createElementNS(f1,e):$n.createElement(e,r?{is:r}:void 0);return e==="select"&&n&&n.multiple!=null&&a.setAttribute("multiple",n.multiple),a},createText:e=>$n.createTextNode(e),createComment:e=>$n.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>$n.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,r,n,a,i){const s=r?r.previousSibling:t.lastChild;if(a&&(a===i||a.nextSibling))for(;t.insertBefore(a.cloneNode(!0),r),!(a===i||!(a=a.nextSibling)););else{sd.innerHTML=n?`<svg>${e}</svg>`:e;const d=sd.content;if(n){const h=d.firstChild;for(;h.firstChild;)d.appendChild(h.firstChild);d.removeChild(h)}t.insertBefore(d,r)}return[s?s.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}};function p1(e,t,r){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}function g1(e,t,r){const n=e.style,a=ft(r);if(r&&!a){for(const i in r)Bl(n,i,r[i]);if(t&&!ft(t))for(const i in t)r[i]==null&&Bl(n,i,"")}else{const i=n.display;a?t!==r&&(n.cssText=r):t&&e.removeAttribute("style"),"_vod"in e&&(n.display=i)}}const ld=/\s*!important$/;function Bl(e,t,r){if(ze(r))r.forEach(n=>Bl(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=m1(e,t);ld.test(r)?e.setProperty(Wn(n),r.replace(ld,""),"important"):e[n]=r}}const cd=["Webkit","Moz","ms"],Js={};function m1(e,t){const r=Js[t];if(r)return r;let n=Lr(t);if(n!=="filter"&&n in e)return Js[t]=n;n=jo(n);for(let a=0;a<cd.length;a++){const i=cd[a]+n;if(i in e)return Js[t]=i}return t}const ud="http://www.w3.org/1999/xlink";function v1(e,t,r,n,a){if(n&&t.startsWith("xlink:"))r==null?e.removeAttributeNS(ud,t.slice(6,t.length)):e.setAttributeNS(ud,t,r);else{const i=u0(t);r==null||i&&!rp(r)?e.removeAttribute(t):e.setAttribute(t,i?"":r)}}function b1(e,t,r,n,a,i,s){if(t==="innerHTML"||t==="textContent"){n&&s(n,a,i),e[t]=r==null?"":r;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=r;const h=r==null?"":r;(e.value!==h||e.tagName==="OPTION")&&(e.value=h),r==null&&e.removeAttribute(t);return}let d=!1;if(r===""||r==null){const h=typeof e[t];h==="boolean"?r=rp(r):r==null&&h==="string"?(r="",d=!0):h==="number"&&(r=0,d=!0)}try{e[t]=r}catch{}d&&e.removeAttribute(t)}const[ng,y1]=(()=>{let e=Date.now,t=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const r=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(r&&Number(r[1])<=53)}return[e,t]})();let Vl=0;const E1=Promise.resolve(),w1=()=>{Vl=0},_1=()=>Vl||(E1.then(w1),Vl=ng());function N1(e,t,r,n){e.addEventListener(t,r,n)}function A1(e,t,r,n){e.removeEventListener(t,r,n)}function C1(e,t,r,n,a=null){const i=e._vei||(e._vei={}),s=i[t];if(n&&s)s.value=n;else{const[d,h]=x1(t);if(n){const c=i[t]=T1(n,a);N1(e,d,c,h)}else s&&(A1(e,d,s,h),i[t]=void 0)}}const dd=/(?:Once|Passive|Capture)$/;function x1(e){let t;if(dd.test(e)){t={};let r;for(;r=e.match(dd);)e=e.slice(0,e.length-r[0].length),t[r[0].toLowerCase()]=!0}return[Wn(e.slice(2)),t]}function T1(e,t){const r=n=>{const a=n.timeStamp||ng();(y1||a>=r.attached-1)&&gr(R1(n,r.value),t,5,[n])};return r.value=e,r.attached=_1(),r}function R1(e,t){if(ze(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>a=>!a._stopped&&n&&n(a))}else return t}const fd=/^on[a-z]/,O1=(e,t,r,n,a=!1,i,s,d,h)=>{t==="class"?p1(e,n,a):t==="style"?g1(e,r,n):Ti(t)?gc(t)||C1(e,t,r,n,s):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):k1(e,t,n,a))?b1(e,t,n,i,s,d,h):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),v1(e,t,n,a))};function k1(e,t,r,n){return n?!!(t==="innerHTML"||t==="textContent"||t in e&&fd.test(t)&&We(r)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||fd.test(t)&&ft(r)?!1:t in e}function I1(e){const t=Sc();if(!t)return;const r=()=>zl(t.subTree,e(t.proxy));mb(r),xr(()=>{const n=new MutationObserver(r);n.observe(t.subTree.el.parentNode,{childList:!0}),Ii(()=>n.disconnect())})}function zl(e,t){if(e.shapeFlag&128){const r=e.suspense;e=r.activeBranch,r.pendingBranch&&!r.isHydrating&&r.effects.push(()=>{zl(r.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)hd(e.el,t);else if(e.type===Qt)e.children.forEach(r=>zl(r,t));else if(e.type===ga){let{el:r,anchor:n}=e;for(;r&&(hd(r,t),r!==n);)r=r.nextSibling}}function hd(e,t){if(e.nodeType===1){const r=e.style;for(const n in t)r.setProperty(`--${n}`,t[n])}}const ln="transition",Ya="animation",Lc=(e,{slots:t})=>Z(Sp,M1(e),t);Lc.displayName="Transition";const ag={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Lc.props=Ht({},Sp.props,ag);const xn=(e,t=[])=>{ze(e)?e.forEach(r=>r(...t)):e&&e(...t)},pd=e=>e?ze(e)?e.some(t=>t.length>1):e.length>1:!1;function M1(e){const t={};for(const K in e)K in ag||(t[K]=e[K]);if(e.css===!1)return t;const{name:r="v",type:n,duration:a,enterFromClass:i=`${r}-enter-from`,enterActiveClass:s=`${r}-enter-active`,enterToClass:d=`${r}-enter-to`,appearFromClass:h=i,appearActiveClass:c=s,appearToClass:o=d,leaveFromClass:l=`${r}-leave-from`,leaveActiveClass:u=`${r}-leave-active`,leaveToClass:f=`${r}-leave-to`}=e,m=P1(a),g=m&&m[0],b=m&&m[1],{onBeforeEnter:v,onEnter:w,onEnterCancelled:y,onLeave:_,onLeaveCancelled:T,onBeforeAppear:A=v,onAppear:x=w,onAppearCancelled:C=y}=t,N=(K,q,W)=>{Tn(K,q?o:d),Tn(K,q?c:s),W&&W()},P=(K,q)=>{K._isLeaving=!1,Tn(K,l),Tn(K,f),Tn(K,u),q&&q()},z=K=>(q,W)=>{const ce=K?x:w,V=()=>N(q,K,W);xn(ce,[q,V]),gd(()=>{Tn(q,K?h:i),cn(q,K?o:d),pd(ce)||md(q,n,g,V)})};return Ht(t,{onBeforeEnter(K){xn(v,[K]),cn(K,i),cn(K,s)},onBeforeAppear(K){xn(A,[K]),cn(K,h),cn(K,c)},onEnter:z(!1),onAppear:z(!0),onLeave(K,q){K._isLeaving=!0;const W=()=>P(K,q);cn(K,l),$1(),cn(K,u),gd(()=>{!K._isLeaving||(Tn(K,l),cn(K,f),pd(_)||md(K,n,b,W))}),xn(_,[K,W])},onEnterCancelled(K){N(K,!1),xn(y,[K])},onAppearCancelled(K){N(K,!0),xn(C,[K])},onLeaveCancelled(K){P(K),xn(T,[K])}})}function P1(e){if(e==null)return null;if(St(e))return[el(e.enter),el(e.leave)];{const t=el(e);return[t,t]}}function el(e){return lp(e)}function cn(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.add(r)),(e._vtc||(e._vtc=new Set)).add(t)}function Tn(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.remove(n));const{_vtc:r}=e;r&&(r.delete(t),r.size||(e._vtc=void 0))}function gd(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let S1=0;function md(e,t,r,n){const a=e._endId=++S1,i=()=>{a===e._endId&&n()};if(r)return setTimeout(i,r);const{type:s,timeout:d,propCount:h}=L1(e,t);if(!s)return n();const c=s+"end";let o=0;const l=()=>{e.removeEventListener(c,u),i()},u=f=>{f.target===e&&++o>=h&&l()};setTimeout(()=>{o<h&&l()},d+1),e.addEventListener(c,u)}function L1(e,t){const r=window.getComputedStyle(e),n=m=>(r[m]||"").split(", "),a=n(ln+"Delay"),i=n(ln+"Duration"),s=vd(a,i),d=n(Ya+"Delay"),h=n(Ya+"Duration"),c=vd(d,h);let o=null,l=0,u=0;t===ln?s>0&&(o=ln,l=s,u=i.length):t===Ya?c>0&&(o=Ya,l=c,u=h.length):(l=Math.max(s,c),o=l>0?s>c?ln:Ya:null,u=o?o===ln?i.length:h.length:0);const f=o===ln&&/\b(transform|all)(,|$)/.test(r[ln+"Property"]);return{type:o,timeout:l,propCount:u,hasTransform:f}}function vd(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((r,n)=>bd(r)+bd(e[n])))}function bd(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function $1(){return document.body.offsetHeight}const D1={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},XF=(e,t)=>r=>{if(!("key"in r))return;const n=Wn(r.key);if(t.some(a=>a===n||D1[a]===n))return e(r)},jF={beforeMount(e,{value:t},{transition:r}){e._vod=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):qa(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:n}){!t!=!r&&(n?t?(n.beforeEnter(e),qa(e,!0),n.enter(e)):n.leave(e,()=>{qa(e,!1)}):qa(e,t))},beforeUnmount(e,{value:t}){qa(e,t)}};function qa(e,t){e.style.display=t?e._vod:"none"}const U1=Ht({patchProp:O1},h1);let tl,yd=!1;function F1(){return tl=yd?tl:Wb(U1),yd=!0,tl}const B1=(...e)=>{const t=F1().createApp(...e),{mount:r}=t;return t.mount=n=>{const a=V1(n);if(a)return r(a,!0,a instanceof SVGElement)},t};function V1(e){return ft(e)?document.querySelector(e):e}const z1={base:"/vma-grid/",lang:"zh-CN",title:"vma-grid",description:"vue3 calc grid - \u4E00\u4E2A\u57FA\u4E8EVue3 Typescript\u7684\u8868\u683C\u7EC4\u4EF6",head:[["link",{rel:"stylesheet",href:"//at.alicdn.com/t/font_2410206_mfj6e1vbwo.css"}]],locales:{}};var G1=([e,t,r])=>e==="meta"&&t.name?`${e}.${t.name}`:["title","base"].includes(e)?e:e==="template"&&t.id?`${e}.${t.id}`:JSON.stringify([e,t,r]),H1=e=>{const t=new Set,r=[];return e.forEach(n=>{const a=G1(n);t.has(a)||(t.add(a),r.push(n))}),r},W1=e=>/^(https?:)?\/\//.test(e),QF=e=>/^mailto:/.test(e),ZF=e=>/^tel:/.test(e),ig=e=>Object.prototype.toString.call(e)==="[object Object]",K1=e=>e.replace(/\/$/,""),Y1=e=>e.replace(/^\//,""),og=(e,t)=>{const r=Object.keys(e).sort((n,a)=>{const i=a.split("/").length-n.split("/").length;return i!==0?i:a.length-n.length});for(const n of r)if(t.startsWith(n))return n;return"/"};const sg={"v-8daa1a0e":Dt(()=>Qe(()=>import("./index.html.222244da.js"),[])),"v-2f4d3eda":Dt(()=>Qe(()=>import("./grid-button.html.854c75b6.js"),[])),"v-7f75cc29":Dt(()=>Qe(()=>import("./grid-checkbox.html.1d06dea5.js"),[])),"v-13863eb3":Dt(()=>Qe(()=>import("./grid-icon.html.7094979f.js"),[])),"v-12fb0d8a":Dt(()=>Qe(()=>import("./grid-loading.html.24478b3a.js"),[])),"v-90541d2a":Dt(()=>Qe(()=>import("./grid-radio.html.e5611bbb.js"),[])),"v-0016c312":Dt(()=>Qe(()=>import("./grid-textarea.html.7fe9b2e9.js"),[])),"v-5107b6ce":Dt(()=>Qe(()=>import("./grid.html.84db3f9d.js"),[])),"v-1a1874fc":Dt(()=>Qe(()=>import("./index.html.d22cce11.js"),[])),"v-e0e76f98":Dt(()=>Qe(()=>import("./modules.html.39b882c6.js"),[])),"v-a9cea3dc":Dt(()=>Qe(()=>import("./index.DepParser.html.1b2d0db1.js"),[])),"v-44208220":Dt(()=>Qe(()=>import("./index.FormulaError.html.47201e34.js"),[])),"v-6da1d8db":Dt(()=>Qe(()=>import("./index.FormulaParser.html.50061f97.js"),[])),"v-cf6e5f3c":Dt(()=>Qe(()=>import("./formulas.html.98d14b0e.js"),[])),"v-201aed0a":Dt(()=>Qe(()=>import("./index.html.00db95a4.js"),[])),"v-3706649a":Dt(()=>Qe(()=>import("./404.html.1da7badd.js"),[]))},q1={404:Dt(()=>Qe(()=>import("./404.a3e71a67.js"),[])),Layout:Dt(()=>Qe(()=>import("./Layout.a353c025.js"),[]))};var lg=Se(l0),cg=Ac({key:"",path:"",title:"",lang:"",frontmatter:{},excerpt:"",headers:[]}),Zr=Se(cg),Mi=()=>Zr;Lu.webpackHot&&(__VUE_HMR_RUNTIME__.updatePageData=e=>{lg.value[e.key]=()=>Promise.resolve(e),e.key===Zr.value.key&&(Zr.value=e)});var ug=Symbol(""),X1=()=>{const e=_t(ug);if(!e)throw new Error("usePageFrontmatter() is called without provider.");return e},dg=Symbol(""),j1=()=>{const e=_t(dg);if(!e)throw new Error("usePageHead() is called without provider.");return e},Q1=Symbol(""),fg=Symbol(""),Z1=()=>{const e=_t(fg);if(!e)throw new Error("usePageLang() is called without provider.");return e},$c=Symbol(""),J1=()=>{const e=_t($c);if(!e)throw new Error("useRouteLocale() is called without provider.");return e},mn=Se(z1),ey=()=>mn;Lu.webpackHot&&(__VUE_HMR_RUNTIME__.updateSiteData=e=>{mn.value=e});var hg=Symbol(""),JF=()=>{const e=_t(hg);if(!e)throw new Error("useSiteLocaleData() is called without provider.");return e},ty=Symbol(""),Mn=Cr({resolvePageData:async e=>{const t=lg.value[e],r=await(t==null?void 0:t());return r!=null?r:cg},resolvePageFrontmatter:e=>e.frontmatter,resolvePageHead:(e,t,r)=>{const n=ft(t.description)?t.description:r.description,a=[...ze(t.head)?t.head:[],...r.head,["title",{},e],["meta",{name:"description",content:n}]];return H1(a)},resolvePageHeadTitle:(e,t)=>`${e.title?`${e.title} | `:""}${t.title}`,resolvePageLang:e=>e.lang||"en",resolveRouteLocale:(e,t)=>og(e,t),resolveSiteLocaleData:(e,t)=>ct(ct({},e),e.locales[t])}),ry=it({setup(e,t){const r=Se(!1);return xr(()=>{r.value=!0}),()=>{var n,a;return r.value?(a=(n=t.slots).default)==null?void 0:a.call(n):null}}}),Dc=e=>{let t;e.pageKey?t=e.pageKey:t=Mi().value.key;const r=sg[t];return r?Z(r):Z("div","404 Not Found")};Dc.displayName="Content";Dc.props={pageKey:{type:String,required:!1}};var Ed=it({name:"Vuepress",setup(){const e=Mi(),t=Ge(()=>{let r;if(e.value.path){const n=e.value.frontmatter.layout;ft(n)?r=n:r="Layout"}else r="404";return q1[r]||Ut(r,!1)});return()=>Z(t.value)}}),ny=e=>W1(e)?e:`${ey().value.base}${Y1(e)}`,_n=e=>e;function pg(e,t,r){var n,a,i;t===void 0&&(t=50),r===void 0&&(r={});var s=(n=r.isImmediate)!=null&&n,d=(a=r.callback)!=null&&a,h=r.maxWait,c=Date.now(),o=[];function l(){if(h!==void 0){var f=Date.now()-c;if(f+t>=h)return h-f}return t}var u=function(){var f=[].slice.call(arguments),m=this;return new Promise(function(g,b){var v=s&&i===void 0;if(i!==void 0&&clearTimeout(i),i=setTimeout(function(){if(i=void 0,c=Date.now(),!s){var y=e.apply(m,f);d&&d(y),o.forEach(function(_){return(0,_.resolve)(y)}),o=[]}},l()),v){var w=e.apply(m,f);return d&&d(w),g(w)}o.push({resolve:g,reject:b})})};return u.cancel=function(f){i!==void 0&&clearTimeout(i),o.forEach(function(m){return(0,m.reject)(f)}),o=[]},u}/*!
  * vue-router v4.0.15
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const gg=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",Pa=e=>gg?Symbol(e):"_vr_"+e,ay=Pa("rvlm"),wd=Pa("rvd"),as=Pa("r"),Uc=Pa("rl"),Gl=Pa("rvl"),la=typeof window!="undefined";function iy(e){return e.__esModule||gg&&e[Symbol.toStringTag]==="Module"}const ut=Object.assign;function rl(e,t){const r={};for(const n in t){const a=t[n];r[n]=Array.isArray(a)?a.map(e):e(a)}return r}const fi=()=>{},oy=/\/$/,sy=e=>e.replace(oy,"");function nl(e,t,r="/"){let n,a={},i="",s="";const d=t.indexOf("?"),h=t.indexOf("#",d>-1?d:0);return d>-1&&(n=t.slice(0,d),i=t.slice(d+1,h>-1?h:t.length),a=e(i)),h>-1&&(n=n||t.slice(0,h),s=t.slice(h,t.length)),n=dy(n!=null?n:t,r),{fullPath:n+(i&&"?")+i+s,path:n,query:a,hash:s}}function ly(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function _d(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function cy(e,t,r){const n=t.matched.length-1,a=r.matched.length-1;return n>-1&&n===a&&_a(t.matched[n],r.matched[a])&&mg(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function _a(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function mg(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!uy(e[r],t[r]))return!1;return!0}function uy(e,t){return Array.isArray(e)?Nd(e,t):Array.isArray(t)?Nd(t,e):e===t}function Nd(e,t){return Array.isArray(t)?e.length===t.length&&e.every((r,n)=>r===t[n]):e.length===1&&e[0]===t}function dy(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),n=e.split("/");let a=r.length-1,i,s;for(i=0;i<n.length;i++)if(s=n[i],!(a===1||s==="."))if(s==="..")a--;else break;return r.slice(0,a).join("/")+"/"+n.slice(i-(i===n.length?1:0)).join("/")}var Ni;(function(e){e.pop="pop",e.push="push"})(Ni||(Ni={}));var hi;(function(e){e.back="back",e.forward="forward",e.unknown=""})(hi||(hi={}));function fy(e){if(!e)if(la){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),sy(e)}const hy=/^[^#]+#/;function py(e,t){return e.replace(hy,"#")+t}function gy(e,t){const r=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-r.left-(t.left||0),top:n.top-r.top-(t.top||0)}}const is=()=>({left:window.pageXOffset,top:window.pageYOffset});function my(e){let t;if("el"in e){const r=e.el,n=typeof r=="string"&&r.startsWith("#"),a=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!a)return;t=gy(a,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function Ad(e,t){return(history.state?history.state.position-t:-1)+e}const Hl=new Map;function vy(e,t){Hl.set(e,t)}function by(e){const t=Hl.get(e);return Hl.delete(e),t}let yy=()=>location.protocol+"//"+location.host;function vg(e,t){const{pathname:r,search:n,hash:a}=t,i=e.indexOf("#");if(i>-1){let d=a.includes(e.slice(i))?e.slice(i).length:1,h=a.slice(d);return h[0]!=="/"&&(h="/"+h),_d(h,"")}return _d(r,e)+n+a}function Ey(e,t,r,n){let a=[],i=[],s=null;const d=({state:u})=>{const f=vg(e,location),m=r.value,g=t.value;let b=0;if(u){if(r.value=f,t.value=u,s&&s===m){s=null;return}b=g?u.position-g.position:0}else n(f);a.forEach(v=>{v(r.value,m,{delta:b,type:Ni.pop,direction:b?b>0?hi.forward:hi.back:hi.unknown})})};function h(){s=r.value}function c(u){a.push(u);const f=()=>{const m=a.indexOf(u);m>-1&&a.splice(m,1)};return i.push(f),f}function o(){const{history:u}=window;!u.state||u.replaceState(ut({},u.state,{scroll:is()}),"")}function l(){for(const u of i)u();i=[],window.removeEventListener("popstate",d),window.removeEventListener("beforeunload",o)}return window.addEventListener("popstate",d),window.addEventListener("beforeunload",o),{pauseListeners:h,listen:c,destroy:l}}function Cd(e,t,r,n=!1,a=!1){return{back:e,current:t,forward:r,replaced:n,position:window.history.length,scroll:a?is():null}}function wy(e){const{history:t,location:r}=window,n={value:vg(e,r)},a={value:t.state};a.value||i(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(h,c,o){const l=e.indexOf("#"),u=l>-1?(r.host&&document.querySelector("base")?e:e.slice(l))+h:yy()+e+h;try{t[o?"replaceState":"pushState"](c,"",u),a.value=c}catch(f){console.error(f),r[o?"replace":"assign"](u)}}function s(h,c){const o=ut({},t.state,Cd(a.value.back,h,a.value.forward,!0),c,{position:a.value.position});i(h,o,!0),n.value=h}function d(h,c){const o=ut({},a.value,t.state,{forward:h,scroll:is()});i(o.current,o,!0);const l=ut({},Cd(n.value,h,null),{position:o.position+1},c);i(h,l,!1),n.value=h}return{location:n,state:a,push:d,replace:s}}function _y(e){e=fy(e);const t=wy(e),r=Ey(e,t.state,t.location,t.replace);function n(i,s=!0){s||r.pauseListeners(),history.go(i)}const a=ut({location:"",base:e,go:n,createHref:py.bind(null,e)},t,r);return Object.defineProperty(a,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(a,"state",{enumerable:!0,get:()=>t.state.value}),a}function Ny(e){return typeof e=="string"||e&&typeof e=="object"}function bg(e){return typeof e=="string"||typeof e=="symbol"}const jr={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},yg=Pa("nf");var xd;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(xd||(xd={}));function Na(e,t){return ut(new Error,{type:e,[yg]:!0},t)}function un(e,t){return e instanceof Error&&yg in e&&(t==null||!!(e.type&t))}const Td="[^/]+?",Ay={sensitive:!1,strict:!1,start:!0,end:!0},Cy=/[.+*?^${}()[\]/\\]/g;function xy(e,t){const r=ut({},Ay,t),n=[];let a=r.start?"^":"";const i=[];for(const c of e){const o=c.length?[]:[90];r.strict&&!c.length&&(a+="/");for(let l=0;l<c.length;l++){const u=c[l];let f=40+(r.sensitive?.25:0);if(u.type===0)l||(a+="/"),a+=u.value.replace(Cy,"\\$&"),f+=40;else if(u.type===1){const{value:m,repeatable:g,optional:b,regexp:v}=u;i.push({name:m,repeatable:g,optional:b});const w=v||Td;if(w!==Td){f+=10;try{new RegExp(`(${w})`)}catch(_){throw new Error(`Invalid custom RegExp for param "${m}" (${w}): `+_.message)}}let y=g?`((?:${w})(?:/(?:${w}))*)`:`(${w})`;l||(y=b&&c.length<2?`(?:/${y})`:"/"+y),b&&(y+="?"),a+=y,f+=20,b&&(f+=-8),g&&(f+=-20),w===".*"&&(f+=-50)}o.push(f)}n.push(o)}if(r.strict&&r.end){const c=n.length-1;n[c][n[c].length-1]+=.7000000000000001}r.strict||(a+="/?"),r.end?a+="$":r.strict&&(a+="(?:/|$)");const s=new RegExp(a,r.sensitive?"":"i");function d(c){const o=c.match(s),l={};if(!o)return null;for(let u=1;u<o.length;u++){const f=o[u]||"",m=i[u-1];l[m.name]=f&&m.repeatable?f.split("/"):f}return l}function h(c){let o="",l=!1;for(const u of e){(!l||!o.endsWith("/"))&&(o+="/"),l=!1;for(const f of u)if(f.type===0)o+=f.value;else if(f.type===1){const{value:m,repeatable:g,optional:b}=f,v=m in c?c[m]:"";if(Array.isArray(v)&&!g)throw new Error(`Provided param "${m}" is an array but it is not repeatable (* or + modifiers)`);const w=Array.isArray(v)?v.join("/"):v;if(!w)if(b)u.length<2&&e.length>1&&(o.endsWith("/")?o=o.slice(0,-1):l=!0);else throw new Error(`Missing required param "${m}"`);o+=w}}return o}return{re:s,score:n,keys:i,parse:d,stringify:h}}function Ty(e,t){let r=0;for(;r<e.length&&r<t.length;){const n=t[r]-e[r];if(n)return n;r++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function Ry(e,t){let r=0;const n=e.score,a=t.score;for(;r<n.length&&r<a.length;){const i=Ty(n[r],a[r]);if(i)return i;r++}return a.length-n.length}const Oy={type:0,value:""},ky=/[a-zA-Z0-9_]/;function Iy(e){if(!e)return[[]];if(e==="/")return[[Oy]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(f){throw new Error(`ERR (${r})/"${c}": ${f}`)}let r=0,n=r;const a=[];let i;function s(){i&&a.push(i),i=[]}let d=0,h,c="",o="";function l(){!c||(r===0?i.push({type:0,value:c}):r===1||r===2||r===3?(i.length>1&&(h==="*"||h==="+")&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:o,repeatable:h==="*"||h==="+",optional:h==="*"||h==="?"})):t("Invalid state to consume buffer"),c="")}function u(){c+=h}for(;d<e.length;){if(h=e[d++],h==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:h==="/"?(c&&l(),s()):h===":"?(l(),r=1):u();break;case 4:u(),r=n;break;case 1:h==="("?r=2:ky.test(h)?u():(l(),r=0,h!=="*"&&h!=="?"&&h!=="+"&&d--);break;case 2:h===")"?o[o.length-1]=="\\"?o=o.slice(0,-1)+h:r=3:o+=h;break;case 3:l(),r=0,h!=="*"&&h!=="?"&&h!=="+"&&d--,o="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${c}"`),l(),s(),a}function My(e,t,r){const n=xy(Iy(e.path),r),a=ut(n,{record:e,parent:t,children:[],alias:[]});return t&&!a.record.aliasOf==!t.record.aliasOf&&t.children.push(a),a}function Py(e,t){const r=[],n=new Map;t=Od({strict:!1,end:!0,sensitive:!1},t);function a(o){return n.get(o)}function i(o,l,u){const f=!u,m=Ly(o);m.aliasOf=u&&u.record;const g=Od(t,o),b=[m];if("alias"in o){const y=typeof o.alias=="string"?[o.alias]:o.alias;for(const _ of y)b.push(ut({},m,{components:u?u.record.components:m.components,path:_,aliasOf:u?u.record:m}))}let v,w;for(const y of b){const{path:_}=y;if(l&&_[0]!=="/"){const T=l.record.path,A=T[T.length-1]==="/"?"":"/";y.path=l.record.path+(_&&A+_)}if(v=My(y,l,g),u?u.alias.push(v):(w=w||v,w!==v&&w.alias.push(v),f&&o.name&&!Rd(v)&&s(o.name)),"children"in m){const T=m.children;for(let A=0;A<T.length;A++)i(T[A],v,u&&u.children[A])}u=u||v,h(v)}return w?()=>{s(w)}:fi}function s(o){if(bg(o)){const l=n.get(o);l&&(n.delete(o),r.splice(r.indexOf(l),1),l.children.forEach(s),l.alias.forEach(s))}else{const l=r.indexOf(o);l>-1&&(r.splice(l,1),o.record.name&&n.delete(o.record.name),o.children.forEach(s),o.alias.forEach(s))}}function d(){return r}function h(o){let l=0;for(;l<r.length&&Ry(o,r[l])>=0&&(o.record.path!==r[l].record.path||!Eg(o,r[l]));)l++;r.splice(l,0,o),o.record.name&&!Rd(o)&&n.set(o.record.name,o)}function c(o,l){let u,f={},m,g;if("name"in o&&o.name){if(u=n.get(o.name),!u)throw Na(1,{location:o});g=u.record.name,f=ut(Sy(l.params,u.keys.filter(w=>!w.optional).map(w=>w.name)),o.params),m=u.stringify(f)}else if("path"in o)m=o.path,u=r.find(w=>w.re.test(m)),u&&(f=u.parse(m),g=u.record.name);else{if(u=l.name?n.get(l.name):r.find(w=>w.re.test(l.path)),!u)throw Na(1,{location:o,currentLocation:l});g=u.record.name,f=ut({},l.params,o.params),m=u.stringify(f)}const b=[];let v=u;for(;v;)b.unshift(v.record),v=v.parent;return{name:g,path:m,params:f,matched:b,meta:Dy(b)}}return e.forEach(o=>i(o)),{addRoute:i,resolve:c,removeRoute:s,getRoutes:d,getRecordMatcher:a}}function Sy(e,t){const r={};for(const n of t)n in e&&(r[n]=e[n]);return r}function Ly(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:$y(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||{}:{default:e.component}}}function $y(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const n in e.components)t[n]=typeof r=="boolean"?r:r[n];return t}function Rd(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Dy(e){return e.reduce((t,r)=>ut(t,r.meta),{})}function Od(e,t){const r={};for(const n in e)r[n]=n in t?t[n]:e[n];return r}function Eg(e,t){return t.children.some(r=>r===e||Eg(e,r))}const wg=/#/g,Uy=/&/g,Fy=/\//g,By=/=/g,Vy=/\?/g,_g=/\+/g,zy=/%5B/g,Gy=/%5D/g,Ng=/%5E/g,Hy=/%60/g,Ag=/%7B/g,Wy=/%7C/g,Cg=/%7D/g,Ky=/%20/g;function Fc(e){return encodeURI(""+e).replace(Wy,"|").replace(zy,"[").replace(Gy,"]")}function Yy(e){return Fc(e).replace(Ag,"{").replace(Cg,"}").replace(Ng,"^")}function Wl(e){return Fc(e).replace(_g,"%2B").replace(Ky,"+").replace(wg,"%23").replace(Uy,"%26").replace(Hy,"`").replace(Ag,"{").replace(Cg,"}").replace(Ng,"^")}function qy(e){return Wl(e).replace(By,"%3D")}function Xy(e){return Fc(e).replace(wg,"%23").replace(Vy,"%3F")}function jy(e){return e==null?"":Xy(e).replace(Fy,"%2F")}function Do(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function Qy(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let a=0;a<n.length;++a){const i=n[a].replace(_g," "),s=i.indexOf("="),d=Do(s<0?i:i.slice(0,s)),h=s<0?null:Do(i.slice(s+1));if(d in t){let c=t[d];Array.isArray(c)||(c=t[d]=[c]),c.push(h)}else t[d]=h}return t}function kd(e){let t="";for(let r in e){const n=e[r];if(r=qy(r),n==null){n!==void 0&&(t+=(t.length?"&":"")+r);continue}(Array.isArray(n)?n.map(i=>i&&Wl(i)):[n&&Wl(n)]).forEach(i=>{i!==void 0&&(t+=(t.length?"&":"")+r,i!=null&&(t+="="+i))})}return t}function Zy(e){const t={};for(const r in e){const n=e[r];n!==void 0&&(t[r]=Array.isArray(n)?n.map(a=>a==null?null:""+a):n==null?n:""+n)}return t}function Xa(){let e=[];function t(n){return e.push(n),()=>{const a=e.indexOf(n);a>-1&&e.splice(a,1)}}function r(){e=[]}return{add:t,list:()=>e,reset:r}}function pn(e,t,r,n,a){const i=n&&(n.enterCallbacks[a]=n.enterCallbacks[a]||[]);return()=>new Promise((s,d)=>{const h=l=>{l===!1?d(Na(4,{from:r,to:t})):l instanceof Error?d(l):Ny(l)?d(Na(2,{from:t,to:l})):(i&&n.enterCallbacks[a]===i&&typeof l=="function"&&i.push(l),s())},c=e.call(n&&n.instances[a],t,r,h);let o=Promise.resolve(c);e.length<3&&(o=o.then(h)),o.catch(l=>d(l))})}function al(e,t,r,n){const a=[];for(const i of e)for(const s in i.components){let d=i.components[s];if(!(t!=="beforeRouteEnter"&&!i.instances[s]))if(Jy(d)){const c=(d.__vccOpts||d)[t];c&&a.push(pn(c,r,n,i,s))}else{let h=d();a.push(()=>h.then(c=>{if(!c)return Promise.reject(new Error(`Couldn't resolve component "${s}" at "${i.path}"`));const o=iy(c)?c.default:c;i.components[s]=o;const u=(o.__vccOpts||o)[t];return u&&pn(u,r,n,i,s)()}))}}return a}function Jy(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Id(e){const t=_t(as),r=_t(Uc),n=Ge(()=>t.resolve(Fn(e.to))),a=Ge(()=>{const{matched:h}=n.value,{length:c}=h,o=h[c-1],l=r.matched;if(!o||!l.length)return-1;const u=l.findIndex(_a.bind(null,o));if(u>-1)return u;const f=Md(h[c-2]);return c>1&&Md(o)===f&&l[l.length-1].path!==f?l.findIndex(_a.bind(null,h[c-2])):u}),i=Ge(()=>a.value>-1&&nE(r.params,n.value.params)),s=Ge(()=>a.value>-1&&a.value===r.matched.length-1&&mg(r.params,n.value.params));function d(h={}){return rE(h)?t[Fn(e.replace)?"replace":"push"](Fn(e.to)).catch(fi):Promise.resolve()}return{route:n,href:Ge(()=>n.value.href),isActive:i,isExactActive:s,navigate:d}}const eE=it({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Id,setup(e,{slots:t}){const r=Cr(Id(e)),{options:n}=_t(as),a=Ge(()=>({[Pd(e.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[Pd(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const i=t.default&&t.default(r);return e.custom?i:Z("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:a.value},i)}}}),tE=eE;function rE(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function nE(e,t){for(const r in t){const n=t[r],a=e[r];if(typeof n=="string"){if(n!==a)return!1}else if(!Array.isArray(a)||a.length!==n.length||n.some((i,s)=>i!==a[s]))return!1}return!0}function Md(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Pd=(e,t,r)=>e!=null?e:t!=null?t:r,aE=it({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const n=_t(Gl),a=Ge(()=>e.route||n.value),i=_t(wd,0),s=Ge(()=>a.value.matched[i]);wt(wd,i+1),wt(ay,s),wt(Gl,a);const d=Se();return rr(()=>[d.value,s.value,e.name],([h,c,o],[l,u,f])=>{c&&(c.instances[o]=h,u&&u!==c&&h&&h===l&&(c.leaveGuards.size||(c.leaveGuards=u.leaveGuards),c.updateGuards.size||(c.updateGuards=u.updateGuards))),h&&c&&(!u||!_a(c,u)||!l)&&(c.enterCallbacks[o]||[]).forEach(m=>m(h))},{flush:"post"}),()=>{const h=a.value,c=s.value,o=c&&c.components[e.name],l=e.name;if(!o)return Sd(r.default,{Component:o,route:h});const u=c.props[e.name],f=u?u===!0?h.params:typeof u=="function"?u(h):u:null,g=Z(o,ut({},f,t,{onVnodeUnmounted:b=>{b.component.isUnmounted&&(c.instances[l]=null)},ref:d}));return Sd(r.default,{Component:g,route:h})||g}}});function Sd(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const xg=aE;function iE(e){const t=Py(e.routes,e),r=e.parseQuery||Qy,n=e.stringifyQuery||kd,a=e.history,i=Xa(),s=Xa(),d=Xa(),h=Np(jr);let c=jr;la&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const o=rl.bind(null,J=>""+J),l=rl.bind(null,jy),u=rl.bind(null,Do);function f(J,S){let I,U;return bg(J)?(I=t.getRecordMatcher(J),U=S):U=J,t.addRoute(U,I)}function m(J){const S=t.getRecordMatcher(J);S&&t.removeRoute(S)}function g(){return t.getRoutes().map(J=>J.record)}function b(J){return!!t.getRecordMatcher(J)}function v(J,S){if(S=ut({},S||h.value),typeof J=="string"){const X=nl(r,J,S.path),k=t.resolve({path:X.path},S),B=a.createHref(X.fullPath);return ut(X,k,{params:u(k.params),hash:Do(X.hash),redirectedFrom:void 0,href:B})}let I;if("path"in J)I=ut({},J,{path:nl(r,J.path,S.path).path});else{const X=ut({},J.params);for(const k in X)X[k]==null&&delete X[k];I=ut({},J,{params:l(J.params)}),S.params=l(S.params)}const U=t.resolve(I,S),me=J.hash||"";U.params=o(u(U.params));const Y=ly(n,ut({},J,{hash:Yy(me),path:U.path})),be=a.createHref(Y);return ut({fullPath:Y,hash:me,query:n===kd?Zy(J.query):J.query||{}},U,{redirectedFrom:void 0,href:be})}function w(J){return typeof J=="string"?nl(r,J,h.value.path):ut({},J)}function y(J,S){if(c!==J)return Na(8,{from:S,to:J})}function _(J){return x(J)}function T(J){return _(ut(w(J),{replace:!0}))}function A(J){const S=J.matched[J.matched.length-1];if(S&&S.redirect){const{redirect:I}=S;let U=typeof I=="function"?I(J):I;return typeof U=="string"&&(U=U.includes("?")||U.includes("#")?U=w(U):{path:U},U.params={}),ut({query:J.query,hash:J.hash,params:J.params},U)}}function x(J,S){const I=c=v(J),U=h.value,me=J.state,Y=J.force,be=J.replace===!0,X=A(I);if(X)return x(ut(w(X),{state:me,force:Y,replace:be}),S||I);const k=I;k.redirectedFrom=S;let B;return!Y&&cy(n,U,I)&&(B=Na(16,{to:k,from:U}),fe(U,U,!0,!1)),(B?Promise.resolve(B):N(k,U)).catch(H=>un(H)?un(H,2)?H:ie(H):G(H,k,U)).then(H=>{if(H){if(un(H,2))return x(ut(w(H.to),{state:me,force:Y,replace:be}),S||k)}else H=z(k,U,!0,be,me);return P(k,U,H),H})}function C(J,S){const I=y(J,S);return I?Promise.reject(I):Promise.resolve()}function N(J,S){let I;const[U,me,Y]=oE(J,S);I=al(U.reverse(),"beforeRouteLeave",J,S);for(const X of U)X.leaveGuards.forEach(k=>{I.push(pn(k,J,S))});const be=C.bind(null,J,S);return I.push(be),ea(I).then(()=>{I=[];for(const X of i.list())I.push(pn(X,J,S));return I.push(be),ea(I)}).then(()=>{I=al(me,"beforeRouteUpdate",J,S);for(const X of me)X.updateGuards.forEach(k=>{I.push(pn(k,J,S))});return I.push(be),ea(I)}).then(()=>{I=[];for(const X of J.matched)if(X.beforeEnter&&!S.matched.includes(X))if(Array.isArray(X.beforeEnter))for(const k of X.beforeEnter)I.push(pn(k,J,S));else I.push(pn(X.beforeEnter,J,S));return I.push(be),ea(I)}).then(()=>(J.matched.forEach(X=>X.enterCallbacks={}),I=al(Y,"beforeRouteEnter",J,S),I.push(be),ea(I))).then(()=>{I=[];for(const X of s.list())I.push(pn(X,J,S));return I.push(be),ea(I)}).catch(X=>un(X,8)?X:Promise.reject(X))}function P(J,S,I){for(const U of d.list())U(J,S,I)}function z(J,S,I,U,me){const Y=y(J,S);if(Y)return Y;const be=S===jr,X=la?history.state:{};I&&(U||be?a.replace(J.fullPath,ut({scroll:be&&X&&X.scroll},me)):a.push(J.fullPath,me)),h.value=J,fe(J,S,I,be),ie()}let K;function q(){K||(K=a.listen((J,S,I)=>{const U=v(J),me=A(U);if(me){x(ut(me,{replace:!0}),U).catch(fi);return}c=U;const Y=h.value;la&&vy(Ad(Y.fullPath,I.delta),is()),N(U,Y).catch(be=>un(be,12)?be:un(be,2)?(x(be.to,U).then(X=>{un(X,20)&&!I.delta&&I.type===Ni.pop&&a.go(-1,!1)}).catch(fi),Promise.reject()):(I.delta&&a.go(-I.delta,!1),G(be,U,Y))).then(be=>{be=be||z(U,Y,!1),be&&(I.delta?a.go(-I.delta,!1):I.type===Ni.pop&&un(be,20)&&a.go(-1,!1)),P(U,Y,be)}).catch(fi)}))}let W=Xa(),ce=Xa(),V;function G(J,S,I){ie(J);const U=ce.list();return U.length?U.forEach(me=>me(J,S,I)):console.error(J),Promise.reject(J)}function j(){return V&&h.value!==jr?Promise.resolve():new Promise((J,S)=>{W.add([J,S])})}function ie(J){return V||(V=!J,q(),W.list().forEach(([S,I])=>J?I(J):S()),W.reset()),J}function fe(J,S,I,U){const{scrollBehavior:me}=e;if(!la||!me)return Promise.resolve();const Y=!I&&by(Ad(J.fullPath,0))||(U||!I)&&history.state&&history.state.scroll||null;return pt().then(()=>me(J,S,Y)).then(be=>be&&my(be)).catch(be=>G(be,J,S))}const ve=J=>a.go(J);let xe;const Te=new Set;return{currentRoute:h,addRoute:f,removeRoute:m,hasRoute:b,getRoutes:g,resolve:v,options:e,push:_,replace:T,go:ve,back:()=>ve(-1),forward:()=>ve(1),beforeEach:i.add,beforeResolve:s.add,afterEach:d.add,onError:ce.add,isReady:j,install(J){const S=this;J.component("RouterLink",tE),J.component("RouterView",xg),J.config.globalProperties.$router=S,Object.defineProperty(J.config.globalProperties,"$route",{enumerable:!0,get:()=>Fn(h)}),la&&!xe&&h.value===jr&&(xe=!0,_(a.location).catch(me=>{}));const I={};for(const me in jr)I[me]=Ge(()=>h.value[me]);J.provide(as,S),J.provide(Uc,Cr(I)),J.provide(Gl,h);const U=J.unmount;Te.add(J),J.unmount=function(){Te.delete(J),Te.size<1&&(c=jr,K&&K(),K=null,h.value=jr,xe=!1,V=!1),U()}}}}function ea(e){return e.reduce((t,r)=>t.then(()=>r()),Promise.resolve())}function oE(e,t){const r=[],n=[],a=[],i=Math.max(t.matched.length,e.matched.length);for(let s=0;s<i;s++){const d=t.matched[s];d&&(e.matched.find(c=>_a(c,d))?n.push(d):r.push(d));const h=e.matched[s];h&&(t.matched.find(c=>_a(c,h))||a.push(h))}return[r,n,a]}function Bc(){return _t(as)}function Vc(){return _t(Uc)}const sE=({headerLinkSelector:e,headerAnchorSelector:t,delay:r,offset:n=5})=>{const a=Bc(),i=Mi(),d=pg(()=>{var g,b,v,w;const h=Array.from(document.querySelectorAll(e)),o=Array.from(document.querySelectorAll(t)).filter(y=>h.some(_=>_.hash===y.hash)),l=Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop),u=window.innerHeight+l,f=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),m=Math.abs(f-u)<n;for(let y=0;y<o.length;y++){const _=o[y],T=o[y+1],A=l>=((b=(g=_.parentElement)==null?void 0:g.offsetTop)!=null?b:0)-n,x=!T||l<((w=(v=T.parentElement)==null?void 0:v.offsetTop)!=null?w:0)-n;if(!(A&&x))continue;const N=decodeURIComponent(a.currentRoute.value.hash),P=decodeURIComponent(_.hash);if(N===P)return;if(m){for(let z=y+1;z<o.length;z++)if(N===decodeURIComponent(o[z].hash))return}lE(a,{hash:P,force:!0});return}},r);xr(()=>{d(),window.addEventListener("scroll",d)}),ki(()=>{window.removeEventListener("scroll",d)}),rr(()=>i.value.path,d)},lE=async(e,...t)=>{const{scrollBehavior:r}=e.options;e.options.scrollBehavior=void 0,await e.replace(...t).finally(()=>e.options.scrollBehavior=r)},cE="a.sidebar-item",uE=".header-anchor",dE=300,fE=5;var hE=_n({setup(){sE({headerLinkSelector:cE,headerAnchorSelector:uE,delay:dE,offset:fE})}});const Ld=()=>window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,pE=()=>window.scrollTo({top:0,behavior:"smooth"});const gE=it({name:"BackToTop",setup(){const e=Se(0),t=Ge(()=>e.value>300),r=pg(()=>{e.value=Ld()},100);xr(()=>{e.value=Ld(),window.addEventListener("scroll",()=>r())});const n=Z("div",{class:"back-to-top",onClick:pE});return()=>Z(Lc,{name:"back-to-top"},()=>t.value?n:null)}});var mE=_n({rootComponents:[gE]});const vE=Z("svg",{class:"external-link-icon",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15"},[Z("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),Z("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})]),bE=it({name:"ExternalLinkIcon",props:{locales:{type:Object,required:!1,default:()=>({})}},setup(e){const t=J1(),r=Ge(()=>{var n;return(n=e.locales[t.value])!=null?n:{openInNewWindow:"open in new window"}});return()=>Z("span",[vE,Z("span",{class:"external-link-icon-sr-only"},r.value.openInNewWindow)])}}),yE={"/":{openInNewWindow:"open in new window"}};var EE=_n({enhance({app:e}){e.component("ExternalLinkIcon",Z(bE,{locales:yE}))}});/*! medium-zoom 1.0.6 | MIT License | https://github.com/francoischalifour/medium-zoom */var Pn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},co=function(t){return t.tagName==="IMG"},wE=function(t){return NodeList.prototype.isPrototypeOf(t)},No=function(t){return t&&t.nodeType===1},$d=function(t){var r=t.currentSrc||t.src;return r.substr(-4).toLowerCase()===".svg"},Dd=function(t){try{return Array.isArray(t)?t.filter(co):wE(t)?[].slice.call(t).filter(co):No(t)?[t].filter(co):typeof t=="string"?[].slice.call(document.querySelectorAll(t)).filter(co):[]}catch{throw new TypeError(`The provided selector is invalid.
Expects a CSS selector, a Node element, a NodeList or an array.
See: https://github.com/francoischalifour/medium-zoom`)}},_E=function(t){var r=document.createElement("div");return r.classList.add("medium-zoom-overlay"),r.style.background=t,r},NE=function(t){var r=t.getBoundingClientRect(),n=r.top,a=r.left,i=r.width,s=r.height,d=t.cloneNode(),h=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,c=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;return d.removeAttribute("id"),d.style.position="absolute",d.style.top=n+h+"px",d.style.left=a+c+"px",d.style.width=i+"px",d.style.height=s+"px",d.style.transform="",d},ta=function(t,r){var n=Pn({bubbles:!1,cancelable:!1,detail:void 0},r);if(typeof window.CustomEvent=="function")return new CustomEvent(t,n);var a=document.createEvent("CustomEvent");return a.initCustomEvent(t,n.bubbles,n.cancelable,n.detail),a},AE=function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=window.Promise||function(K){function q(){}K(q,q)},a=function(K){var q=K.target;if(q===N){m();return}y.indexOf(q)!==-1&&g({target:q})},i=function(){if(!(T||!C.original)){var K=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;Math.abs(A-K)>x.scrollOffset&&setTimeout(m,150)}},s=function(K){var q=K.key||K.keyCode;(q==="Escape"||q==="Esc"||q===27)&&m()},d=function(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},q=K;if(K.background&&(N.style.background=K.background),K.container&&K.container instanceof Object&&(q.container=Pn({},x.container,K.container)),K.template){var W=No(K.template)?K.template:document.querySelector(K.template);q.template=W}return x=Pn({},x,q),y.forEach(function(ce){ce.dispatchEvent(ta("medium-zoom:update",{detail:{zoom:P}}))}),P},h=function(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e(Pn({},x,K))},c=function(){for(var K=arguments.length,q=Array(K),W=0;W<K;W++)q[W]=arguments[W];var ce=q.reduce(function(V,G){return[].concat(V,Dd(G))},[]);return ce.filter(function(V){return y.indexOf(V)===-1}).forEach(function(V){y.push(V),V.classList.add("medium-zoom-image")}),_.forEach(function(V){var G=V.type,j=V.listener,ie=V.options;ce.forEach(function(fe){fe.addEventListener(G,j,ie)})}),P},o=function(){for(var K=arguments.length,q=Array(K),W=0;W<K;W++)q[W]=arguments[W];C.zoomed&&m();var ce=q.length>0?q.reduce(function(V,G){return[].concat(V,Dd(G))},[]):y;return ce.forEach(function(V){V.classList.remove("medium-zoom-image"),V.dispatchEvent(ta("medium-zoom:detach",{detail:{zoom:P}}))}),y=y.filter(function(V){return ce.indexOf(V)===-1}),P},l=function(K,q){var W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return y.forEach(function(ce){ce.addEventListener("medium-zoom:"+K,q,W)}),_.push({type:"medium-zoom:"+K,listener:q,options:W}),P},u=function(K,q){var W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return y.forEach(function(ce){ce.removeEventListener("medium-zoom:"+K,q,W)}),_=_.filter(function(ce){return!(ce.type==="medium-zoom:"+K&&ce.listener.toString()===q.toString())}),P},f=function(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},q=K.target,W=function(){var V={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,left:0,top:0,right:0,bottom:0},G=void 0,j=void 0;if(x.container)if(x.container instanceof Object)V=Pn({},V,x.container),G=V.width-V.left-V.right-x.margin*2,j=V.height-V.top-V.bottom-x.margin*2;else{var ie=No(x.container)?x.container:document.querySelector(x.container),fe=ie.getBoundingClientRect(),ve=fe.width,xe=fe.height,Te=fe.left,Me=fe.top;V=Pn({},V,{width:ve,height:xe,left:Te,top:Me})}G=G||V.width-x.margin*2,j=j||V.height-x.margin*2;var J=C.zoomedHd||C.original,S=$d(J)?G:J.naturalWidth||G,I=$d(J)?j:J.naturalHeight||j,U=J.getBoundingClientRect(),me=U.top,Y=U.left,be=U.width,X=U.height,k=Math.min(S,G)/be,B=Math.min(I,j)/X,H=Math.min(k,B),re=(-Y+(G-be)/2+x.margin+V.left)/H,ne=(-me+(j-X)/2+x.margin+V.top)/H,p="scale("+H+") translate3d("+re+"px, "+ne+"px, 0)";C.zoomed.style.transform=p,C.zoomedHd&&(C.zoomedHd.style.transform=p)};return new n(function(ce){if(q&&y.indexOf(q)===-1){ce(P);return}var V=function ve(){T=!1,C.zoomed.removeEventListener("transitionend",ve),C.original.dispatchEvent(ta("medium-zoom:opened",{detail:{zoom:P}})),ce(P)};if(C.zoomed){ce(P);return}if(q)C.original=q;else if(y.length>0){var G=y;C.original=G[0]}else{ce(P);return}if(C.original.dispatchEvent(ta("medium-zoom:open",{detail:{zoom:P}})),A=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,T=!0,C.zoomed=NE(C.original),document.body.appendChild(N),x.template){var j=No(x.template)?x.template:document.querySelector(x.template);C.template=document.createElement("div"),C.template.appendChild(j.content.cloneNode(!0)),document.body.appendChild(C.template)}if(document.body.appendChild(C.zoomed),window.requestAnimationFrame(function(){document.body.classList.add("medium-zoom--opened")}),C.original.classList.add("medium-zoom-image--hidden"),C.zoomed.classList.add("medium-zoom-image--opened"),C.zoomed.addEventListener("click",m),C.zoomed.addEventListener("transitionend",V),C.original.getAttribute("data-zoom-src")){C.zoomedHd=C.zoomed.cloneNode(),C.zoomedHd.removeAttribute("srcset"),C.zoomedHd.removeAttribute("sizes"),C.zoomedHd.src=C.zoomed.getAttribute("data-zoom-src"),C.zoomedHd.onerror=function(){clearInterval(ie),console.warn("Unable to reach the zoom image target "+C.zoomedHd.src),C.zoomedHd=null,W()};var ie=setInterval(function(){C.zoomedHd.complete&&(clearInterval(ie),C.zoomedHd.classList.add("medium-zoom-image--opened"),C.zoomedHd.addEventListener("click",m),document.body.appendChild(C.zoomedHd),W())},10)}else if(C.original.hasAttribute("srcset")){C.zoomedHd=C.zoomed.cloneNode(),C.zoomedHd.removeAttribute("sizes"),C.zoomedHd.removeAttribute("loading");var fe=C.zoomedHd.addEventListener("load",function(){C.zoomedHd.removeEventListener("load",fe),C.zoomedHd.classList.add("medium-zoom-image--opened"),C.zoomedHd.addEventListener("click",m),document.body.appendChild(C.zoomedHd),W()})}else W()})},m=function(){return new n(function(K){if(T||!C.original){K(P);return}var q=function W(){C.original.classList.remove("medium-zoom-image--hidden"),document.body.removeChild(C.zoomed),C.zoomedHd&&document.body.removeChild(C.zoomedHd),document.body.removeChild(N),C.zoomed.classList.remove("medium-zoom-image--opened"),C.template&&document.body.removeChild(C.template),T=!1,C.zoomed.removeEventListener("transitionend",W),C.original.dispatchEvent(ta("medium-zoom:closed",{detail:{zoom:P}})),C.original=null,C.zoomed=null,C.zoomedHd=null,C.template=null,K(P)};T=!0,document.body.classList.remove("medium-zoom--opened"),C.zoomed.style.transform="",C.zoomedHd&&(C.zoomedHd.style.transform=""),C.template&&(C.template.style.transition="opacity 150ms",C.template.style.opacity=0),C.original.dispatchEvent(ta("medium-zoom:close",{detail:{zoom:P}})),C.zoomed.addEventListener("transitionend",q)})},g=function(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},q=K.target;return C.original?m():f({target:q})},b=function(){return x},v=function(){return y},w=function(){return C.original},y=[],_=[],T=!1,A=0,x=r,C={original:null,zoomed:null,zoomedHd:null,template:null};Object.prototype.toString.call(t)==="[object Object]"?x=t:(t||typeof t=="string")&&c(t),x=Pn({margin:0,background:"#fff",scrollOffset:40,container:null,template:null},x);var N=_E(x.background);document.addEventListener("click",a),document.addEventListener("keyup",s),document.addEventListener("scroll",i),window.addEventListener("resize",m);var P={open:f,close:m,toggle:g,update:d,clone:h,attach:c,detach:o,on:l,off:u,getOptions:b,getImages:v,getZoomedImage:w};return P};function CE(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",r==="top"&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}var xE=".medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}";CE(xE);var TE=AE;const RE=Symbol("mediumZoom");const OE=".theme-default-content > img, .theme-default-content :not(a) > img",kE={},IE=300;var ME=_n({enhance({app:e,router:t}){const r=TE(kE);r.refresh=(n=OE)=>{r.detach(),r.attach(n)},e.provide(RE,r),t.afterEach(()=>{setTimeout(()=>r.refresh(),IE)})}});const Je={settings:{minimum:.08,easing:"ease",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,barSelector:'[role="bar"]',parent:"body",template:'<div class="bar" role="bar"></div>'},status:null,set:e=>{const t=Je.isStarted();e=il(e,Je.settings.minimum,1),Je.status=e===1?null:e;const r=Je.render(!t),n=r.querySelector(Je.settings.barSelector),a=Je.settings.speed,i=Je.settings.easing;return r.offsetWidth,PE(s=>{uo(n,{transform:"translate3d("+Ud(e)+"%,0,0)",transition:"all "+a+"ms "+i}),e===1?(uo(r,{transition:"none",opacity:"1"}),r.offsetWidth,setTimeout(function(){uo(r,{transition:"all "+a+"ms linear",opacity:"0"}),setTimeout(function(){Je.remove(),s()},a)},a)):setTimeout(()=>s(),a)}),Je},isStarted:()=>typeof Je.status=="number",start:()=>{Je.status||Je.set(0);const e=()=>{setTimeout(()=>{!Je.status||(Je.trickle(),e())},Je.settings.trickleSpeed)};return Je.settings.trickle&&e(),Je},done:e=>!e&&!Je.status?Je:Je.inc(.3+.5*Math.random()).set(1),inc:e=>{let t=Je.status;return t?(typeof e!="number"&&(e=(1-t)*il(Math.random()*t,.1,.95)),t=il(t+e,0,.994),Je.set(t)):Je.start()},trickle:()=>Je.inc(Math.random()*Je.settings.trickleRate),render:e=>{if(Je.isRendered())return document.getElementById("nprogress");Fd(document.documentElement,"nprogress-busy");const t=document.createElement("div");t.id="nprogress",t.innerHTML=Je.settings.template;const r=t.querySelector(Je.settings.barSelector),n=e?"-100":Ud(Je.status||0),a=document.querySelector(Je.settings.parent);return uo(r,{transition:"all 0 linear",transform:"translate3d("+n+"%,0,0)"}),a!==document.body&&Fd(a,"nprogress-custom-parent"),a==null||a.appendChild(t),t},remove:()=>{Bd(document.documentElement,"nprogress-busy"),Bd(document.querySelector(Je.settings.parent),"nprogress-custom-parent");const e=document.getElementById("nprogress");e&&SE(e)},isRendered:()=>!!document.getElementById("nprogress")},il=(e,t,r)=>e<t?t:e>r?r:e,Ud=e=>(-1+e)*100,PE=function(){const e=[];function t(){const r=e.shift();r&&r(t)}return function(r){e.push(r),e.length===1&&t()}}(),uo=function(){const e=["Webkit","O","Moz","ms"],t={};function r(s){return s.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(d,h){return h.toUpperCase()})}function n(s){const d=document.body.style;if(s in d)return s;let h=e.length;const c=s.charAt(0).toUpperCase()+s.slice(1);let o;for(;h--;)if(o=e[h]+c,o in d)return o;return s}function a(s){return s=r(s),t[s]||(t[s]=n(s))}function i(s,d,h){d=a(d),s.style[d]=h}return function(s,d){for(const h in d){const c=d[h];c!==void 0&&Object.prototype.hasOwnProperty.call(d,h)&&i(s,h,c)}}}(),Tg=(e,t)=>(typeof e=="string"?e:zc(e)).indexOf(" "+t+" ")>=0,Fd=(e,t)=>{const r=zc(e),n=r+t;Tg(r,t)||(e.className=n.substring(1))},Bd=(e,t)=>{const r=zc(e);if(!Tg(e,t))return;const n=r.replace(" "+t+" "," ");e.className=n.substring(1,n.length-1)},zc=e=>(" "+(e.className||"")+" ").replace(/\s+/gi," "),SE=e=>{e&&e.parentNode&&e.parentNode.removeChild(e)};const LE=()=>{xr(()=>{const e=Bc(),t=new Set;t.add(e.currentRoute.value.path),e.beforeEach(r=>{t.has(r.path)||Je.start()}),e.afterEach(r=>{t.add(r.path),Je.done()})})};var $E=_n({setup(){LE()}});const DE={sidebar:[{text:"\u9996\u9875",link:"/README.md"},{text:"\u516C\u5F0F\u652F\u6301",link:"/formula/modules.md"},{text:"\u57FA\u7840\u7EC4\u4EF6",children:[{text:"\u56FE\u6807",link:"/basic/grid-icon.md"},{text:"Loading",link:"/basic/grid-loading.md"},{text:"\u6309\u94AE",link:"/basic/grid-button.md"},{text:"\u5355\u9009",link:"/basic/grid-radio.md"},{text:"\u590D\u9009",link:"/basic/grid-checkbox.md"},{text:"\u591A\u884C\u6587\u672C",link:"/basic/grid-textarea.md"},{text:"\u8868\u683C",link:"/basic/grid.md"},{text:"\u5355\u5143\u683C\u6C34\u5E73\u5782\u76F4\u4F4D\u7F6E",link:"/basic/grid-column-align.md"},{text:"\u5217\u5BBD\u62D6\u52A8\u884C\u9AD8\u62D6\u52A8",link:"/basic/grid-resize-column-row.md"},{text:"\u8868\u5934\u5206\u7EC4",link:"/basic/grid-column-header-group.md"},{text:"\u5217\u540D\u52A9\u8BB0",link:"/basic/grid-column-helper.md"}]}],locales:{"/":{selectLanguageName:"English"}},navbar:[],logo:null,darkMode:!0,repo:null,selectLanguageText:"Languages",selectLanguageAriaLabel:"Select language",sidebarDepth:2,editLink:!0,editLinkText:"Edit this page",lastUpdated:!0,lastUpdatedText:"Last Updated",contributors:!0,contributorsText:"Contributors",notFound:["There's nothing here.","How did we get here?","That's a Four-Oh-Four.","Looks like we've got some broken links."],backToHome:"Take me home",openInNewWindow:"open in new window",toggleDarkMode:"toggle dark mode",toggleSidebar:"toggle sidebar"},Rg=Se(DE),UE=()=>Rg;Lu.webpackHot&&(__VUE_HMR_RUNTIME__.updateThemeData=e=>{Rg.value=e});const Og=Symbol(""),FE=()=>{const e=_t(Og);if(!e)throw new Error("useThemeLocaleData() is called without provider.");return e},BE=(e,t)=>{var r;return ct(ct({},e),(r=e.locales)==null?void 0:r[t])};var VE=_n({enhance({app:e}){const t=UE(),r=e._context.provides[$c],n=Ge(()=>BE(t.value,r.value));e.provide(Og,n),Object.defineProperties(e.config.globalProperties,{$theme:{get(){return t.value}},$themeLocale:{get(){return n.value}}})}}),kg=(e,t)=>{const r=e.__vccOpts||e;for(const[n,a]of t)r[n]=a;return r};const zE=it({__name:"Badge",props:{type:{type:String,required:!1,default:"tip"},text:{type:String,required:!1,default:""},vertical:{type:String,required:!1,default:void 0}},setup(e){return(t,r)=>(ts(),Qp("span",{class:xi(["badge",e.type]),style:Yo({verticalAlign:e.vertical})},[Bp(t.$slots,"default",{},()=>[Mc(p0(e.text),1)])],6))}});var GE=kg(zE,[["__file","Badge.vue"]]),HE=it({name:"CodeGroup",setup(e,{slots:t}){const r=Se(-1),n=Se([]),a=(d=r.value)=>{d<n.value.length-1?r.value=d+1:r.value=0,n.value[r.value].focus()},i=(d=r.value)=>{d>0?r.value=d-1:r.value=n.value.length-1,n.value[r.value].focus()},s=(d,h)=>{d.key===" "||d.key==="Enter"?(d.preventDefault(),r.value=h):d.key==="ArrowRight"?(d.preventDefault(),a(h)):d.key==="ArrowLeft"&&(d.preventDefault(),i(h))};return()=>{var h;const d=(((h=t.default)==null?void 0:h.call(t))||[]).filter(c=>c.type.name==="CodeGroupItem").map(c=>(c.props===null&&(c.props={}),c));return d.length===0?null:(r.value<0||r.value>d.length-1?(r.value=d.findIndex(c=>c.props.active===""||c.props.active===!0),r.value===-1&&(r.value=0)):d.forEach((c,o)=>{c.props.active=o===r.value}),Z("div",{class:"code-group"},[Z("div",{class:"code-group__nav"},Z("ul",{class:"code-group__ul"},d.map((c,o)=>{const l=o===r.value;return Z("li",{class:"code-group__li"},Z("button",{ref:u=>{u&&(n.value[o]=u)},class:{"code-group__nav-tab":!0,"code-group__nav-tab-active":l},ariaPressed:l,ariaExpanded:l,onClick:()=>r.value=o,onKeydown:u=>s(u,o)},c.props.title))}))),d]))}}});const WE=["aria-selected"],KE=it({name:"CodeGroupItem"}),YE=it(eo(ct({},KE),{props:{title:{type:String,required:!0},active:{type:Boolean,required:!1,default:!1}},setup(e){return(t,r)=>(ts(),Qp("div",{class:xi(["code-group-item",{"code-group-item__active":e.active}]),"aria-selected":e.active},[Bp(t.$slots,"default")],10,WE))}}));var qE=kg(YE,[["__file","CodeGroupItem.vue"]]);function Ig(e){return A0()?(C0(e),!0):!1}var Vd;const Pi=typeof window!="undefined",XE=e=>typeof e=="string",ol=()=>{};Pi&&((Vd=window==null?void 0:window.navigator)==null?void 0:Vd.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function jE(e,t){function r(...n){e(()=>t.apply(this,n),{fn:t,thisArg:this,args:n})}return r}const Mg=e=>e();function QE(e=Mg){const t=Se(!0);function r(){t.value=!1}function n(){t.value=!0}return{isActive:t,pause:r,resume:n,eventFilter:(...i)=>{t.value&&e(...i)}}}function ZE(e,t=!0){Sc()?Up(e):t?e():pt(e)}var zd=Object.getOwnPropertySymbols,JE=Object.prototype.hasOwnProperty,ew=Object.prototype.propertyIsEnumerable,tw=(e,t)=>{var r={};for(var n in e)JE.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&zd)for(var n of zd(e))t.indexOf(n)<0&&ew.call(e,n)&&(r[n]=e[n]);return r};function rw(e,t,r={}){const n=r,{eventFilter:a=Mg}=n,i=tw(n,["eventFilter"]);return rr(e,jE(a,t),i)}var nw=Object.defineProperty,aw=Object.defineProperties,iw=Object.getOwnPropertyDescriptors,Uo=Object.getOwnPropertySymbols,Pg=Object.prototype.hasOwnProperty,Sg=Object.prototype.propertyIsEnumerable,Gd=(e,t,r)=>t in e?nw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ow=(e,t)=>{for(var r in t||(t={}))Pg.call(t,r)&&Gd(e,r,t[r]);if(Uo)for(var r of Uo(t))Sg.call(t,r)&&Gd(e,r,t[r]);return e},sw=(e,t)=>aw(e,iw(t)),lw=(e,t)=>{var r={};for(var n in e)Pg.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Uo)for(var n of Uo(e))t.indexOf(n)<0&&Sg.call(e,n)&&(r[n]=e[n]);return r};function cw(e,t,r={}){const n=r,{eventFilter:a}=n,i=lw(n,["eventFilter"]),{eventFilter:s,pause:d,resume:h,isActive:c}=QE(a);return{stop:rw(e,t,sw(ow({},i),{eventFilter:s})),pause:d,resume:h,isActive:c}}function uw(e){var t;const r=Fn(e);return(t=r==null?void 0:r.$el)!=null?t:r}const Fo=Pi?window:void 0;Pi&&window.document;Pi&&window.navigator;Pi&&window.location;function dw(...e){let t,r,n,a;if(XE(e[0])?([r,n,a]=e,t=Fo):[t,r,n,a]=e,!t)return ol;let i=ol;const s=rr(()=>uw(t),h=>{i(),h&&(h.addEventListener(r,n,a),i=()=>{h.removeEventListener(r,n,a),i=ol})},{immediate:!0,flush:"post"}),d=()=>{s(),i()};return Ig(d),d}function fw(e,t={}){const{window:r=Fo}=t,n=Boolean(r&&"matchMedia"in r);let a;const i=Se(!1),s=()=>{!n||(a||(a=r.matchMedia(e)),i.value=a.matches)};return ZE(()=>{s(),a&&("addEventListener"in a?a.addEventListener("change",s):a.addListener(s),Ig(()=>{"removeEventListener"in a?a.removeEventListener("change",s):a.removeListener(s)}))}),i}const Kl=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Yl="__vueuse_ssr_handlers__";Kl[Yl]=Kl[Yl]||{};const hw=Kl[Yl];function pw(e,t){return hw[e]||t}function gw(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"||Array.isArray(e)?"object":Number.isNaN(e)?"any":"number"}const mw={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}};function vw(e,t,r,n={}){var a;const{flush:i="pre",deep:s=!0,listenToStorageChanges:d=!0,writeDefaults:h=!0,shallow:c,window:o=Fo,eventFilter:l,onError:u=A=>{console.error(A)}}=n,f=(c?Np:Se)(t);if(!r)try{r=pw("getDefaultStorage",()=>{var A;return(A=Fo)==null?void 0:A.localStorage})()}catch(A){u(A)}if(!r)return f;const m=Fn(t),g=gw(m),b=(a=n.serializer)!=null?a:mw[g],{pause:v,resume:w}=cw(f,()=>y(f.value),{flush:i,deep:s,eventFilter:l});return o&&d&&dw(o,"storage",T),T(),f;function y(A){try{A==null?r.removeItem(e):r.setItem(e,b.write(A))}catch(x){u(x)}}function _(A){if(!(A&&A.key!==e)){v();try{const x=A?A.newValue:r.getItem(e);return x==null?(h&&m!==null&&r.setItem(e,b.write(m)),m):typeof x!="string"?x:b.read(x)}catch(x){u(x)}finally{w()}}}function T(A){A&&A.key!==e||(f.value=_(A))}}function bw(e){return fw("(prefers-color-scheme: dark)",e)}var Hd;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(Hd||(Hd={}));const Lg=Symbol(""),e8=()=>{const e=_t(Lg);if(!e)throw new Error("useDarkMode() is called without provider.");return e},yw=()=>{const e=Fg(),t=bw(),r=vw("vuepress-color-scheme","auto"),n=Ge({get(){return e.value.darkMode?r.value==="auto"?t.value:r.value==="dark":!1},set(a){a===t.value?r.value="auto":r.value=a?"dark":"light"}});wt(Lg,n),Ew(n)},Ew=e=>{const t=(r=e.value)=>{const n=window==null?void 0:window.document.querySelector("html");n==null||n.classList.toggle("dark",r)};xr(()=>{rr(e,t,{immediate:!0})}),Ii(()=>t())},$g=(...e)=>{const r=Bc().resolve(...e),n=r.matched[r.matched.length-1];if(!(n!=null&&n.redirect))return r;const{redirect:a}=n,i=We(a)?a(r):a,s=ft(i)?{path:i}:i;return $g(ct({hash:r.hash,query:r.query,params:r.params},s))},ww=e=>{const t=$g(encodeURI(e));return{text:t.meta.title||e,link:t.name==="404"?e:t.fullPath}};let sl=null,ja=null;const _w={wait:()=>sl,pending:()=>{sl=new Promise(e=>ja=e)},resolve:()=>{ja==null||ja(),sl=null,ja=null}},Nw=()=>_w,Dg=Symbol("sidebarItems"),t8=()=>{const e=_t(Dg);if(!e)throw new Error("useSidebarItems() is called without provider.");return e},Aw=()=>{const e=Fg(),t=X1(),r=Ge(()=>Cw(t.value,e.value));wt(Dg,r)},Cw=(e,t)=>{var a,i,s,d;const r=(i=(a=e.sidebar)!=null?a:t.sidebar)!=null?i:"auto",n=(d=(s=e.sidebarDepth)!=null?s:t.sidebarDepth)!=null?d:2;return e.home||r===!1?[]:r==="auto"?Tw(n):ze(r)?Ug(r,n):ig(r)?Rw(r,n):[]},xw=(e,t)=>({text:e.title,link:`#${e.slug}`,children:Gc(e.children,t)}),Gc=(e,t)=>t>0?e.map(r=>xw(r,t-1)):[],Tw=e=>{const t=Mi();return[{text:t.value.title,children:Gc(t.value.headers,e)}]},Ug=(e,t)=>{const r=Vc(),n=Mi(),a=i=>{var d;let s;if(ft(i)?s=ww(i):s=i,s.children)return eo(ct({},s),{children:s.children.map(h=>a(h))});if(s.link===r.path){const h=((d=n.value.headers[0])==null?void 0:d.level)===1?n.value.headers[0].children:n.value.headers;return eo(ct({},s),{children:Gc(h,t)})}return s};return e.map(i=>a(i))},Rw=(e,t)=>{var i;const r=Vc(),n=og(e,r.path),a=(i=e[n])!=null?i:[];return Ug(a,t)},Fg=()=>FE();var Ow=_n({enhance({app:e,router:t}){e.component("Badge",GE),e.component("CodeGroup",HE),e.component("CodeGroupItem",qE),e.component("AutoLinkExternalIcon",()=>{const n=e.component("ExternalLinkIcon");return n?Z(n):null}),e.component("NavbarSearch",()=>{const n=e.component("Docsearch")||e.component("SearchBox");return n?Z(n):null});const r=t.options.scrollBehavior;t.options.scrollBehavior=async(...n)=>(await Nw().wait(),r(...n))},setup(){yw(),Aw()}});class kw{constructor(){le(this,"skeleton",{})}add(t,r){return this.skeleton[t]=r,this}forEach(t){if(this.skeleton)for(const r in this.skeleton)this.skeleton&&this.skeleton.hasOwnProperty&&t.call(null,this.skeleton[r],r,this.skeleton)}}const Iw=new kw;class Mw{constructor(){le(this,"version","3.7.4");le(this,"hooks",Iw)}}const os=new Mw,Ot=class{constructor(t){le(this,"value");if(!t)throw new TypeError("Invalid argument; `value` has no value.");this.value=Ot.EMPTY,t&&Ot.isGuid(t)&&(this.value=t)}static isGuid(t){const r=t.toString();return t&&(t instanceof Ot||Ot.validator.test(r))}static create(){return new Ot([Ot.gen(2),Ot.gen(1),Ot.gen(1),Ot.gen(1),Ot.gen(3)].join("-"))}static createEmpty(){return new Ot("emptyguid")}static parse(t){return new Ot(t)}static raw(){return[Ot.gen(2),Ot.gen(1),Ot.gen(1),Ot.gen(1),Ot.gen(3)].join("-")}static gen(t){let r="";for(let n=0;n<t;n++)r+=((1+Math.random())*65536|0).toString(16).substring(1);return r}equals(t){return Ot.isGuid(t)&&this.value===t.toString()}isEmpty(){return this.value===Ot.EMPTY}toString(){return this.value}};let At=Ot;le(At,"validator",new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i")),le(At,"EMPTY","00000000-0000-0000-0000-000000000000");var Wd=it({name:"VmaGridFoobar",props:{type:{type:String,default:"foo"}},setup(e,t){const r={uId:At.create().toString(),props:e,context:t},n=()=>Z("div",{class:["vma-grid-foobar",e.type]});return r.renderVN=n,wt("$vmaGridFoobar",r),r},render(){return this.renderVN()}});const Pw={install(e){e.component(Wd.name,Wd)}};var Kd=it({name:"VmaGridIcon",props:{type:{type:String,default:"default"},size:{type:String,default:"normal"},name:String,color:String,rotate:{type:Number,default:0},translateX:{type:Number,default:0},translateY:{type:Number,default:0},scaleX:{type:Number,default:1},scaleY:{type:Number,default:1}},setup(e,t){const r={uId:At.create().toString(),props:e,context:t},n=()=>{const{color:i,rotate:s,translateX:d,translateY:h,scaleX:c,scaleY:o}=e,l={};return i&&(l.color=i),l.transform=`rotate(${s}deg) translate(${d}px, ${h}px) scale(${c}, ${o})`,l},a=()=>Z("i",{class:["vma-grid-iconfont",`vma-grid-icon-${e.name}`,"vma-grid-icon",e.size,e.type],style:n()});return r.renderVN=a,wt("$vmaGridIcon",r),r},render(){return this.renderVN()}});const Sw={install(e){e.component(Kd.name,Kd)}};var Yd=it({name:"VmaGridLoading",props:{size:{type:String,default:"normal"},currentColor:{type:Boolean,default:!1},vertical:Boolean,type:{type:String,default:"default"},category:{type:String,default:"circle-fade"}},setup(e,t){const{slots:r}=t,n={uId:At.create().toString(),props:e,context:t},a=Ge(()=>e.type),i=Ge(()=>e.size),s=()=>{const c=r.default?r.default({}):()=>"";return Z("span",{class:["text",a.value,i.value],style:{display:e.vertical?"block":"inline-block"}},c)},d=()=>{if(e.category==="plane")return mt();if(e.category==="chase"){const c=[];return c.push(Z("div",{class:"chase-dot"})),c.push(Z("div",{class:"chase-dot"})),c.push(Z("div",{class:"chase-dot"})),c.push(Z("div",{class:"chase-dot"})),c.push(Z("div",{class:"chase-dot"})),c.push(Z("div",{class:"chase-dot"})),c}if(e.category==="bounce"){const c=[];return c.push(Z("div",{class:"bounce-dot"})),c.push(Z("div",{class:"bounce-dot"})),c}if(e.category==="wave"){const c=[];return c.push(Z("div",{class:"wave-rect"})),c.push(Z("div",{class:"wave-rect"})),c.push(Z("div",{class:"wave-rect"})),c.push(Z("div",{class:"wave-rect"})),c.push(Z("div",{class:"wave-rect"})),c}if(e.category==="pulse")return mt();if(e.category==="flow"){const c=[];return c.push(Z("div",{class:"flow-dot"})),c.push(Z("div",{class:"flow-dot"})),c.push(Z("div",{class:"flow-dot"})),c}if(e.category==="swing"){const c=[];return c.push(Z("div",{class:"swing-dot"})),c.push(Z("div",{class:"swing-dot"})),c}if(e.category==="circle"){const c=[];return c.push(Z("div",{class:"circle-dot"})),c.push(Z("div",{class:"circle-dot"})),c.push(Z("div",{class:"circle-dot"})),c.push(Z("div",{class:"circle-dot"})),c.push(Z("div",{class:"circle-dot"})),c.push(Z("div",{class:"circle-dot"})),c.push(Z("div",{class:"circle-dot"})),c.push(Z("div",{class:"circle-dot"})),c.push(Z("div",{class:"circle-dot"})),c.push(Z("div",{class:"circle-dot"})),c.push(Z("div",{class:"circle-dot"})),c.push(Z("div",{class:"circle-dot"})),c}if(e.category==="circle-fade"){const c=[];return c.push(Z("div",{class:"circle-fade-dot"})),c.push(Z("div",{class:"circle-fade-dot"})),c.push(Z("div",{class:"circle-fade-dot"})),c.push(Z("div",{class:"circle-fade-dot"})),c.push(Z("div",{class:"circle-fade-dot"})),c.push(Z("div",{class:"circle-fade-dot"})),c.push(Z("div",{class:"circle-fade-dot"})),c.push(Z("div",{class:"circle-fade-dot"})),c.push(Z("div",{class:"circle-fade-dot"})),c.push(Z("div",{class:"circle-fade-dot"})),c.push(Z("div",{class:"circle-fade-dot"})),c.push(Z("div",{class:"circle-fade-dot"})),c}if(e.category==="fold"){const c=[];return c.push(Z("div",{class:"fold-cube"})),c.push(Z("div",{class:"fold-cube"})),c.push(Z("div",{class:"fold-cube"})),c.push(Z("div",{class:"fold-cube"})),c}return mt()},h=()=>Z("div",{class:["vma-grid-loading",{vertical:e.vertical}]},[Z("div",{class:[{plane:e.category==="plane",chase:e.category==="chase",bounce:e.category==="bounce",wave:e.category==="wave",pulse:e.category==="pulse",flow:e.category==="flow",swing:e.category==="swing",circle:e.category==="circle","circle-fade":e.category==="circle-fade",fold:e.category==="fold",currentColor:e.currentColor},a.value,i.value]},d()),s()]);return n.renderVN=h,wt("$vmaGridLoading",n),n},render(){return this.renderVN()}});const Lw={install(e){e.component(Yd.name,Yd)}};var qd=it({name:"VmaGridButton",props:{text:String,icon:String,color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,disabled:Boolean,iconPrefix:String,loadingText:String,loadingCategory:String,type:{type:String,default:"default"},size:{type:String,default:"normal"},iconPosition:{type:String,default:"left"}},emits:["click"],setup(e,t){const{slots:r,emit:n}=t,a={uId:At.create().toString(),props:e,context:t},i=Ut("VmaGridLoading"),s=Ut("VmaGridIcon"),d=()=>{let m;return e.loading?m=e.loadingText:m=r.default?r.default({}):()=>e.text,m?Z("span",{class:["text"]},m):Z("span",{class:["text"]})},h=()=>r.loading?r.loading():Z(i,{size:e.size,type:e.type,category:e.loadingCategory,style:{display:"inline-block"},currentColor:!0}),c=()=>e.loading?h():e.icon?Z(s,{name:e.icon,size:e.size,type:e.type,color:"currentColor"}):mt(),o=()=>{const{color:m,plain:g}=e;if(m){const b={};return b.color=g?m:"white",g||(b.background=m),m.indexOf("gradient")!==-1?b.border=0:b.borderColor=m,b}return{}},l=m=>{!e.loading&&!e.disabled&&n("click",m)},u=Ge(()=>{const m=["vma-grid-button",e.size,e.type];return e.plain&&m.push("plain"),e.block&&m.push("block"),e.round&&m.push("round"),e.square&&m.push("square"),e.loading&&m.push("loading"),e.disabled&&m.push("disabled"),m}),f=()=>Z("button",{class:u.value,style:o(),disabled:e.disabled,onClick:l},[Z("div",{class:["content"]},[e.iconPosition==="left"&&c(),d(),e.iconPosition==="right"&&c()])]);return a.renderVN=f,wt("$vmaGridButton",a),a},render(){return this.renderVN()}});const $w={install(e){e.component(qd.name,qd)}};var Xd=it({name:"VmaGridRadio",props:{size:{type:String,default:"normal"},type:{type:String,default:"default"},modelValue:Boolean,label:{type:[String,Number],default:null},indeterminate:Boolean,title:[String,Number],content:[String,Number],disabled:Boolean},emits:["update:modelValue","change"],setup(e,t){const{slots:r,emit:n}=t,a={uId:At.create().toString(),props:e,context:t},i=Ut("VmaGridIcon"),s=_t("$vmaGridRadioGroup",null),d=Ge(()=>e.disabled||s&&s.props.disabled),h=Ge(()=>s?s.props.modelValue===e.label:e.modelValue),c=Ge(()=>s&&s.props.type?s.props.type:e.type),o=Ge(()=>s&&s.props.size?s.props.size:e.size),l=f=>{d.value||(s?s.handleChecked({label:e.label},f):(n("update:modelValue",e.label),n("change",{label:e.label},f)))},u=()=>{const f=d.value;return Z("label",{class:["vma-grid-radio",o.value],title:e.title},[Z("input",{class:"input",type:"radio",disabled:f,checked:h.value,onChange:l}),Z("span",{class:["icon",`icon--${c.value}`,{"icon--checked":h.value},{[`icon--checked--${c.value}`]:h.value},{"icon--disabled":f}]},[Z(i,{name:"check",size:o.value,translateY:-1})]),Z("span",{class:["label",`label--${c.value}`,{"label--checked":h.value},{[`label--checked--${c.value}`]:h.value},{"label--disabled":f}]},r.default?r.default({}):e.content)])};return a.renderVN=u,wt("$vmaGridRadio",a),a},render(){return this.renderVN()}}),jd=it({name:"VmaGridRadioGroup",props:{modelValue:{type:[String,Number,Boolean]},disabled:Boolean,size:{type:String},type:{type:String}},emits:["update:modelValue","change"],setup(e,t){const{slots:r,emit:n}=t,a={uId:At.create().toString(),props:e,context:t};return Object.assign(a,{handleChecked(s,d){const{label:h}=s;n("update:modelValue",h),n("change",s,d)}}),wt("$vmaGridRadioGroup",a),()=>Z("div",{class:"vma-radio-group"},r.default?r.default({}):[])}});const Dw={install(e){e.component(Xd.name,Xd),e.component(jd.name,jd)}};var Qd=it({name:"VmaGridCheckbox",props:{size:{type:String,default:"normal"},type:{type:String,default:"default"},modelValue:Boolean,label:{type:[String,Number],default:null},indeterminate:Boolean,title:[String,Number],content:[String,Number],disabled:Boolean},emits:["update:modelValue","change"],setup(e,t){const{slots:r,emit:n}=t,a={uId:At.create().toString(),props:e,context:t},i=Ut("VmaGridIcon"),s=_t("$vmaGridCheckboxGroup",null),d=Ge(()=>e.disabled||s&&s.props.disabled),h=Ge(()=>{var m;return s?(m=s.props.modelValue)==null?void 0:m.includes(e.label):e.modelValue}),c=Ge(()=>s&&s.props.type?s.props.type:e.type),o=Ge(()=>s&&s.props.size?s.props.size:e.size),l=["vma-grid-checkbox",o.value],u=m=>{if(!d.value){const{checked:b}=m.target;s?s.handleChecked({checked:b,label:e.label},m):(n("update:modelValue",b),n("change",{checked:b,label:e.label},m))}},f=()=>{const m=d.value;return Z("label",{class:l,title:e.title},[Z("input",{class:"input",type:"checkbox",disabled:m,checked:h.value,onChange:u}),Z("span",{class:["icon",`icon--${c.value}`,{"icon--checked":h.value},{[`icon--checked--${c.value}`]:h.value},{"icon--disabled":m}]},[Z(i,{name:"check",size:o.value,translateY:-1})]),Z("span",{class:["label",`label--${c.value}`,{"label--checked":h.value},{[`label--checked--${c.value}`]:h.value},{"label--disabled":m}]},r.default?r.default({}):e.content)])};return a.renderVN=f,wt("$vmaGridRadio",a),a},render(){return this.renderVN()}}),Zd=it({name:"VmaGridCheckboxGroup",props:{modelValue:{type:Array,default:()=>[]},disabled:Boolean,size:{type:String},type:{type:String}},emits:["update:modelValue","change"],setup(e,t){const{slots:r,emit:n}=t,a={uId:At.create().toString(),props:e,context:t};return Object.assign(a,{handleChecked(s,d){const{checked:h,label:c}=s,o=e.modelValue||[],l=o.indexOf(c);h?l===-1&&o.push(c):o.splice(l,1),n("update:modelValue",o),n("change",ct({checkedValues:o},s),d)}}),wt("$vmaGridCheckboxGroup",a),()=>Z("div",{class:"vma-checkbox-group"},r.default?r.default({}):[])}});const Uw={install(e){e.component(Qd.name,Qd),e.component(Zd.name,Zd)}};var Jd=it({name:"VmaGridTextarea",props:{type:{type:String,default:"default"},modelValue:[String,Number],immediate:{type:Boolean,default:!0},name:String,readonly:Boolean,disabled:Boolean,placeholder:String,maxlength:[String,Number],size:{type:String,default:"normal"},rows:{type:[String,Number],default:2},wrap:{type:Boolean,default:!0},autofocus:{type:Boolean,default:!1}},emits:["update:modelValue","input","change","focus","blur","keydown","keyup"],setup(e,t){const{emit:r}=t,n=Se(),a=Se(),i=Se(),s=Se(),d=Se(),h={refElem:n,refTextarea:d,refLinesDiv:a,refCountHelperDiv:i,refCountTargetHelperDiv:s},c=Cr({initiated:!1,isActivated:!1,inputValue:e.modelValue}),o={uId:At.create().toString(),props:e,context:t,reactiveData:c,getRefs:()=>h};rr(()=>e.modelValue,N=>{c.inputValue=N});const l=Ge(()=>{const{placeholder:N}=e;return N||""}),u=Ge(()=>{const{immediate:N}=e;return N});let f={};f={dispatchEvent(N,P,z){r(N,ct({$input:o,$event:z},P))},focus(){const N=d.value;return c.isActivated=!0,N.focus(),pt()},blur(){return d.value.blur(),c.isActivated=!1,pt()}},Object.assign(o,f);const m=(N,P)=>{c.inputValue=N,f.dispatchEvent("input",{value:N},P),r("update:modelValue",N),f.dispatchEvent("change",{value:N},P)},g=N=>{const{inputValue:P}=c;f.dispatchEvent(N.type,{value:P},N)},b=N=>{u.value?g(N):m(c.inputValue,N)},v=N=>{c.isActivated=!0,g(N)},w=N=>{N&&N.target},y=N=>{const{inputValue:P}=c;u.value||m(P,N),c.isActivated=!1,f.dispatchEvent("blur",{value:P},N)},_=(N,P)=>{const z=u.value;c.inputValue=N,z?m(N,P):f.dispatchEvent("input",{value:N},P)},T=N=>{const P=N.target,{value:z}=P;_(z,N)},A=N=>{g(N)},x=N=>{g(N)},C=()=>{const{inputValue:N,isActivated:P}=c,{disabled:z,readonly:K,rows:q,wrap:W,autofocus:ce}=e,V=l.value;return Z("div",{ref:n,class:["vma-grid-textarea",e.size,e.type,{"is--active":P,"is--disabled":z}]},[Z("textarea",{ref:d,class:["inner-textarea",{"inner-textarea--wrap":W,"inner-textarea--nowrap":!W}],value:N,placeholder:V,disabled:z,readonly:K,rows:q,autofocus:ce,onKeydown:A,onKeyup:x,onInput:T,onChange:b,onFocus:v,onBlur:y,onScroll:w,style:{resize:"both"}})])};return o.renderVN=C,o},render(){return this.renderVN()}});const Fw={install(e){e.component(Jd.name,Jd)}};var ef=it({name:"VmaGridCtxMenu",props:{value:String},emits:["change"],setup(e,t){const r=_t("$vmaCalcGrid",{}),n=Ut("VmaGridIcon"),a=Ut("VmaGridColorPicker"),{reactiveData:i}=r,{refGridCtxMenu:s}=r.getRefs(),{ctxMenuStore:d}=i,h={},c={uId:At.create().toString(),props:e,context:t,getRefs:()=>h},o=(u,f)=>u==="colorPicker"?Z(a,{readonly:!1,value:f.code==="cellFrontColor"?r.getCell(f.code,f.param.row,f.param.col)||"#000000":r.getCell(f.code,f.param.row,f.param.col),defaultColor:f.code==="cellFrontColor"?"#000000":null,onChange:(m,g)=>{r.updateCell(f.code,f.param.row,f.param.col,f.param.eRow,f.param.eCol,g)}}):mt(),l=()=>Z(Qb,{to:"body",disabled:!1},[Z("div",{ref:s,class:["vma-grid-context-menu",{"is--visible":d.visible}],style:d.style},d.list.map((u,f)=>Z("ul",{class:"group-wrapper",key:f},u.map((m,g)=>{const b=m.children&&m.children.length;return m.visible?Z("li",{class:[{"link--disabled":m.disabled,"link--active":m===d.selected}],key:`${f}_${g}`},[Z("a",{class:"link",onClick(v){r.ctxMenuLinkEvent(v,m)},onMouseover(v){r.ctxMenuMouseoverEvent(v,m)},onMouseout(v){r.ctxMenuMouseoutEvent(v,m)}},[Z("i",{class:["link-prefix",m.prefixIcon]},m.prefixIcon?Z(n,{name:m.prefixIcon,size:"mini",translateY:1}):mt()),Z("span",{class:"link-content"},m.name),Z("i",{class:["link-suffix",b?m.suffixIcon||"angle-right":m.suffixIcon]},[m.suffixComp?o(m.suffixComp,m):mt(),b?Z(n,{name:m.suffixIcon||"angle-right",size:"mini",translateY:1}):m.suffixIcon?Z(n,{name:m.suffixIcon,size:"mini",translateY:1}):mt()])]),b?Z("ul",{class:["sub-group-wrapper",{"is--show":m===d.selected}]},m.children.map((v,w)=>v.visible?Z("li",{class:[{"link--disabled":v.disabled,"link--active":v===d.selectChild}],key:`${f}_${g}_${w}`},Z("a",{class:"link",onClick(y){r.ctxMenuLinkEvent(y,v)},onMouseover(y){r.ctxMenuMouseoverEvent(y,m,v)},onMouseout(y){r.ctxMenuMouseoutEvent(y,m)}},[Z("i",{class:["link-prefix",v.prefixIcon]},v.prefixIcon?Z(n,{name:v.prefixIcon,size:"mini",translateY:1}):mt()),Z("span",{class:"link-content",style:{fontFamily:v.item}},v.name),Z("i",{class:["link-suffix",m.suffixIcon]})])):null)):null]):null}))))]);return c.renderVN=l,c},render(){return this.renderVN()}});const Bw=typeof window!="undefined",Ft=Bw&&window.navigator.userAgent.toLowerCase(),Vw=Ft&&/; msie|trident/i.test(Ft)&&!/ucbrowser/i.test(Ft),zw=Ft&&/edg/i.test(Ft),Gw=Ft&&/chrome|crios/i.test(Ft)&&!/opr|opera|chromium|edg|ucbrowser|googlebot/i.test(Ft),Hw=Ft&&/chromium/i.test(Ft),Ww=Ft&&/safari/i.test(Ft)&&!/chromium|edg|ucbrowser|chrome|crios|opr|opera|fxios|firefox/i.test(Ft),Kw=Ft&&/firefox|fxios/i.test(Ft)&&!/seamonkey/i.test(Ft),Yw=Ft&&/opr|opera/i.test(Ft),qw=typeof document=="undefined"?0:document?document.querySelector("html"):0,Xw=typeof document=="undefined"?0:document,jw=typeof window=="undefined"?0:window;function Bg(e,t,r){if(e){const n=e.parentNode;if(r.top+=e.offsetTop,r.left+=e.offsetLeft,n&&n!==qw&&n!==document.body&&(r.top-=n.scrollTop,r.left-=n.scrollLeft),!(t&&(e===t||e.offsetParent===t))&&e.offsetParent)return Bg(e.offsetParent,t,r)}return r}const ll={};function Qw(e){return ll[e]||(ll[e]=new RegExp(`(?:^|\\s)${e}(?!\\S)`,"g")),ll[e]}function tf(e,t){return e&&e.className&&e.className.match&&e.className.match(Qw(t))}function ql(){const e=document.documentElement,t=document.body;return{scrollTop:e.scrollTop||t.scrollTop,scrollLeft:e.scrollLeft||t.scrollLeft,visibleHeight:e.clientHeight||t.clientHeight,visibleWidth:e.clientWidth||t.clientWidth}}const Zt={isIE:Vw,isEdge:zw,isChrome:Gw,isChromium:Hw,isSafari:Ww,isFirefox:Kw,isOpera:Yw,getOffsetPos(e,t){return Bg(e,t,{left:0,top:0})},getDomNode:ql,hasClass:tf,getAbsolutePos(e){const t=e.getBoundingClientRect(),r=t.top,n=t.left,{scrollTop:a,scrollLeft:i,visibleHeight:s,visibleWidth:d}=ql();return{boundingTop:r,top:a+r,boundingLeft:n,left:i+n,visibleHeight:s,visibleWidth:d}},getEventTargetNode(e,t,r,n){let a,i=e.target;for(;i&&i.nodeType&&i!==document;){if(r&&tf(i,r)&&(!n||n(i)))return a=i,{flag:r?!!a:!0,container:t,targetElem:a};if(i===t)return{flag:r?!!a:!0,container:t,targetElem:a};i=i.parentNode}return{flag:!1}},isPx(e){return e&&/^\d+(px)?$/.test(e)},isScale(e){return e&&/^\d+%$/.test(e)}};function Xl(e){const t=e.getBoundingClientRect(),r=t.top,n=t.left,{scrollTop:a,scrollLeft:i,visibleHeight:s,visibleWidth:d}=ql();return{boundingTop:r,top:a+r,boundingLeft:n,left:i+n,visibleHeight:s,visibleWidth:d}}const Zw={setupGrid(e){const{uId:t,reactiveData:r}=e,{refGrid:n,refGridCtxMenu:a,refStylePlugin:i,refBorderPlugin:s,refAlignPlugin:d}=e.getRefs();let h={},c={};h={closeMenu(){return Object.assign(r.ctxMenuStore,{visible:!1,selected:null,selectChild:null,showChild:!1}),pt()}};const o=(l,u,f)=>{const m=[];if(u==="grid-corner"){let y=[];y.push({name:"\u63D2\u5165\u9996\u884C",code:"insertFirstRow",disabled:!1,visible:!0}),y.push({name:"\u63D2\u5165\u9996\u5217",code:"insertFirstColumn",disabled:!1,visible:!0}),m.push(y),y=[],y.push({name:"\u663E\u793A\u6240\u6709\u884C",code:"showAllRows",disabled:!1,visible:!0,param:f}),y.push({name:"\u663E\u793A\u6240\u6709\u5217",code:"showAllColumns",disabled:!1,visible:!0,param:f}),m.push(y)}if(u==="column-indicator"){let y=[];y.push({name:"\u5411\u524D\u63D2\u5165\u4E00\u5217",code:"insertColumnBefore",disabled:!1,visible:!0,param:f}),y.push({name:"\u5411\u540E\u63D2\u5165\u4E00\u5217",code:"insertColumnAfter",disabled:!1,visible:!0,param:f}),m.push(y),y=[],y.push({name:"\u5220\u9664\u5217",code:"deleteColumn",disabled:!1,visible:!0,param:f}),m.push(y),y=[],y.push({name:"\u9690\u85CF\u5217",code:"hideColumn",disabled:!1,visible:!0,param:f}),y.push({name:"\u663E\u793A\u6240\u6709\u5217",code:"showAllColumns",disabled:!1,visible:!0,param:f}),m.push(y)}if(u==="row-indicator"){let y=[];y.push({name:"\u5411\u4E0A\u63D2\u5165\u4E00\u884C",code:"insertRowBefore",disabled:!1,visible:!0,param:f}),y.push({name:"\u5411\u4E0B\u63D2\u5165\u4E00\u884C",code:"insertRowAfter",disabled:!1,visible:!0,param:f}),m.push(y),y=[],y.push({name:"\u5220\u9664\u884C",code:"deleteRow",disabled:!1,visible:!0,param:f}),m.push(y),y=[],y.push({name:"\u9690\u85CF\u884C",code:"hideRow",disabled:!1,visible:!0,param:f}),y.push({name:"\u663E\u793A\u6240\u6709\u884C",code:"showAllRows",disabled:!1,visible:!0,param:f}),m.push(y)}if(u==="cell"){let y=[],_=[];y=[],_=[],_.push({name:"\u5E38\u89C4",code:"cellFormat",disabled:!1,visible:!0,item:"general",param:f}),_.push({name:"\u65E5\u671F",code:"cellFormat",disabled:!1,visible:!0,item:"date",param:f}),_.push({name:"\u65F6\u95F4",code:"cellFormat",disabled:!1,visible:!0,item:"time",param:f}),_.push({name:"\u767E\u5206\u6BD4",code:"cellFormat",disabled:!1,visible:!0,item:"percent",param:f}),_.push({name:"\u5206\u6570",code:"cellFormat",disabled:!1,visible:!0,item:"fraction",param:f}),_.push({name:"\u79D1\u5B66\u8BA1\u6570",code:"cellFormat",disabled:!1,visible:!0,item:"scientific-notation",param:f}),_.push({name:"\u6570\u5B57",code:"cellFormat",disabled:!1,visible:!0,item:"number",param:f}),_.push({name:"\u6587\u672C",code:"cellFormat",disabled:!1,visible:!0,item:"string",param:f}),y.push({name:"\u683C\u5F0F",prefixIcon:"info-circle",code:"cellFormat",disabled:!1,visible:!0,children:_,param:f}),_=[],_.push({name:"\u5343\u5206\u4F4D",code:"cellFastFormat",disabled:!1,visible:!0,item:"thousandths",param:f}),_.push({name:"\u589E\u52A0\u5C0F\u6570\u4F4D",code:"cellFastFormat",disabled:!1,visible:!0,item:"decimal-places-add",param:f}),_.push({name:"\u51CF\u5C11\u5C0F\u6570\u4F4D",code:"cellFastFormat",disabled:!1,visible:!0,item:"decimal-places-reduce",param:f}),y.push({name:"\u683C\u5F0F\u8BBE\u7F6E",prefixIcon:"info",code:"cellFastFormat",disabled:!1,visible:!0,children:_,param:f}),m.push(y),y=[],_=[],d.value&&(Object.keys(d.value.vertical()).map(T=>(r.currentSheetData[Number(f.row)][Number(f.col)-1],_.push({name:d.value.vertical()[T],code:"cellAlignDetail",disabled:!1,visible:!0,item:T,param:f}),null)),Object.keys(d.value.horizontal()).map(T=>(r.currentSheetData[Number(f.row)][Number(f.col)-1],_.push({name:d.value.horizontal()[T],code:"cellAlignDetail",disabled:!1,visible:!0,item:T,param:f}),null)),y.push({name:"\u5BF9\u9F50\u65B9\u5F0F",code:"cellAlign",disabled:!1,visible:!0,children:_,param:f})),_=[],s.value&&(_.push({name:s.value.top(),code:"cellBorderDetail",disabled:!1,visible:!0,item:"top",param:f}),_.push({name:s.value.bottom(),code:"cellBorderDetail",disabled:!1,visible:!0,item:"bottom",param:f}),_.push({name:s.value.left(),code:"cellBorderDetail",disabled:!1,visible:!0,item:"left",param:f}),_.push({name:s.value.right(),code:"cellBorderDetail",disabled:!1,visible:!0,item:"right",param:f}),_.push({name:s.value.none(),code:"cellBorderDetail",disabled:!1,visible:!0,item:"none",param:f}),_.push({name:s.value.all(),code:"cellBorderDetail",disabled:!1,visible:!0,item:"all",param:f}),_.push({name:s.value.out(),code:"cellBorderDetail",disabled:!1,visible:!0,item:"out",param:f}),_.push({name:s.value.inner(),code:"cellBorderDetail",disabled:!1,visible:!0,item:"inner",param:f}),y.push({name:"\u8FB9\u6846",code:"cellBorder",disabled:!1,visible:!0,children:_,param:f})),_=[],i.value&&(i.value.fontFamily().map((T,A)=>(_.push({name:T,code:"cellFontFamilyDetail",disabled:!1,visible:!0,item:T,prefixIcon:r.currentSheetData[Number(f.row)][Number(f.col)-1].ff===T?"check":null,param:f}),null)),y.push({name:"\u5B57\u4F53",code:"cellFont",disabled:!1,visible:!0,children:_,param:f})),_=[],i.value&&(i.value.fontSize().map((T,A)=>(_.push({name:T,code:"cellFontSizeDetail",disabled:!1,visible:!0,item:T,prefixIcon:r.currentSheetData[Number(f.row)][Number(f.col)-1].fs===Number(T)?"check":null,param:f}),null)),y.push({name:"\u5B57\u53F7",code:"cellFontSize",disabled:!1,visible:!0,children:_,param:f})),_=[],i.value&&(Object.keys(i.value.fontStyle()).map(T=>{const A=r.currentSheetData[Number(f.row)][Number(f.col)-1];return _.push({name:i.value.fontStyle()[T],code:"cellFontStyleDetail",disabled:!1,visible:!0,item:T,prefixIcon:A[`${T}`]===!0?"check":null,param:f}),null}),y.push({name:"\u98CE\u683C",code:"cellFontStyle",disabled:!1,visible:!0,children:_,param:f})),y.push({name:"\u989C\u8272",code:"cellFrontColor",disabled:!1,visible:!0,suffixComp:"colorPicker",param:f}),y.push({name:"\u586B\u5145",code:"cellBackColor",disabled:!1,visible:!0,suffixComp:"colorPicker",param:f}),m.push(y)}l.preventDefault();const{scrollTop:g,scrollLeft:b}=Zt.getDomNode(),v=l.clientY+g,w=l.clientX+b;Object.assign(r.ctxMenuStore,{visible:!0,selected:null,list:m,selectChild:null,showChild:!1,style:{top:`${v}px`,left:`${w}px`}}),pt(()=>{const{scrollTop:y,scrollLeft:_,visibleHeight:T,visibleWidth:A}=Zt.getDomNode(),x=l.clientY+y,C=l.clientX+_,N=a.value,P=N.clientHeight,z=N.clientWidth,{boundingTop:K,boundingLeft:q}=Xl(N),W=K+P-T,ce=q+z-A;W>-10&&(r.ctxMenuStore.style.top=`${Math.max(y+2,x-P-2)}px`),ce>-10&&(r.ctxMenuStore.style.left=`${Math.max(_+2,C-z-2)}px`)})};return c={ctxMenuLinkEvent(l,u){u&&!u.disabled&&(u.code==="insertColumnBefore"?e.updateColumn("insertColumnBefore",u.param.row,u.param.col):u.code==="insertColumnAfter"?e.updateColumn("insertColumnAfter",u.param.row,u.param.col):u.code==="deleteColumn"?e.updateColumn("deleteColumn",u.param.row,u.param.col):u.code==="hideColumn"?e.updateColumn("hideColumn",u.param.row,u.param.col):u.code==="showAllColumns"?e.updateColumn("showAllColumns",u.param.row,u.param.col):u.code==="fixColumn"||u.code==="unfixColumn"||(u.code==="hideRow"?e.updateRow("hideRow",u.param.row,u.param.col):u.code==="showAllRows"?e.updateRow("showAllRows",u.param.row,u.param.col):u.code==="insertRowBefore"?e.updateRow("insertRowBefore",u.param.row,u.param.col):u.code==="insertRowAfter"?e.updateRow("insertRowAfter",u.param.row,u.param.col):u.code==="deleteRow"?e.updateRow("deleteRow",u.param.row,u.param.col):u.code==="insertFirstColumn"?e.updateColumn("insertFirstColumn",0,0):u.code==="insertFirstRow"?e.updateRow("insertFirstRow",0,0):u.code==="cellFontSizeDetail"?e.updateCell("updateCellFontSize",u.param.row,u.param.col,u.param.eRow,u.param.eCol,u.item):u.code==="cellFontFamilyDetail"?e.updateCell("updateCellFontFamily",u.param.row,u.param.col,u.param.eRow,u.param.eCol,u.item):u.code==="cellFontStyleDetail"?e.updateCell("updateCellFontStyle",u.param.row,u.param.col,u.param.eRow,u.param.eCol,u.item):u.code==="cellBorderDetail"?e.updateCell("updateCellBorder",u.param.row,u.param.col,u.param.eRow,u.param.eCol,u.item):u.code==="cellAlignDetail"?e.updateCell("updateCellAlign",u.param.row,u.param.col,u.param.eRow,u.param.eCol,u.item):u.code==="cellFormat"?e.updateCell("updateCellFormat",u.param.row,u.param.col,u.param.eRow,u.param.eCol,u.item):u.code==="cellFastFormat"&&e.updateCell("updateCellFastFormat",u.param.row,u.param.col,u.param.eRow,u.param.eCol,u.item))),h.closeMenu&&h.closeMenu()},ctxMenuMouseoutEvent(l,u){const{ctxMenuStore:f}=r;u.children||(f.selected=null),f.selectChild=null},ctxMenuMouseoverEvent(l,u,f){const m=l.currentTarget,{ctxMenuStore:g}=r;l.preventDefault(),l.stopPropagation(),g.selected=u,g.selectChild=f,f||(g.showChild=u&&u.children&&u.children.length>0,g.showChild&&pt(()=>{const b=m.nextElementSibling;if(b){const{boundingTop:v,boundingLeft:w,visibleHeight:y,visibleWidth:_}=Xl(m),T=v+m.offsetHeight,A=w+m.offsetWidth;let x="",C="";A+b.offsetWidth>_-10&&(x="auto",C=`${m.offsetWidth}px`);let N="",P="";T+b.offsetHeight>y-10&&(N="auto",P="0"),b.style.left=x,b.style.right=C,b.style.top=N,b.style.bottom=P}}))},handleContextmenuEvent:l=>{r.currentCellEditorActive=!1;const u=n.value,f=Zt.getEventTargetNode(l,u,"column-indicator",v=>{const w=v.parentNode.parentNode.parentNode.parentNode;return w!==document&&w.getAttribute("uid")===t}),m=Zt.getEventTargetNode(l,u,"row-indicator",v=>{const w=v.parentNode.parentNode.parentNode.parentNode.parentNode;return w!==document&&w.getAttribute("uid")===t}),g=Zt.getEventTargetNode(l,u,"grid-corner",v=>{const w=v.parentNode.parentNode.parentNode.parentNode;return w!==document&&w.getAttribute("uid")===t}),b=Zt.getEventTargetNode(l,u,"normal",v=>{const w=v.parentNode.parentNode.parentNode.parentNode;return w!==document&&w.getAttribute("uid")===t});if(g.flag&&o(l,"grid-corner",{row:g.targetElem.getAttribute("row"),col:g.targetElem.getAttribute("col")}),b.flag&&r.currentArea&&Object.keys(r.currentArea).length>1){const v=r.currentArea.start.c>r.currentArea.end.c?r.currentArea.end.c:r.currentArea.start.c,w=r.currentArea.end.c<r.currentArea.start.c?r.currentArea.start.c:r.currentArea.end.c,y=r.currentArea.start.r>r.currentArea.end.r?r.currentArea.end.r:r.currentArea.start.r,_=r.currentArea.end.r<r.currentArea.start.r?r.currentArea.start.r:r.currentArea.end.r;o(l,"cell",{row:y,col:v+1,eRow:_,eCol:w+1})}f.flag&&o(l,"column-indicator",{row:f.targetElem.getAttribute("row"),col:f.targetElem.getAttribute("col")}),m.flag&&o(l,"row-indicator",{row:m.targetElem.getAttribute("row"),col:m.targetElem.getAttribute("col")})}},ct(ct({},h),c)}},Jw={install(e){os.hooks.add("VmaGridCtxMenu",Zw),e.component(ef.name,ef)}};var rf=it({name:"VmaGridColorPicker",props:{readonly:{type:Boolean,default:!1},defaultColor:{type:String,default:"#000000"},value:String},emits:["change"],setup(e,t){const{slots:r,emit:n}=t,a=Ut("VmaGridButton"),i=Se(),s={refColorPickerPallet:i},d={uId:At.create().toString(),props:e,context:t,getRefs:()=>s},h=Se(""),c=Se(!1),o=["#000000","#ffffff","#eeece1","#1e497b","#4e81bb","#e2534d","#9aba60","#8165a0","#47acc5","#f9974c"],l=["#c21401","#ff1e02","#ffc12a","#ffff3a","#90cf5b","#00af57","#00afee","#0071be","#00215f","#72349d"],u=[["#7f7f7f","#f2f2f2"],["#0d0d0d","#808080"],["#1c1a10","#ddd8c3"],["#0e243d","#c6d9f0"],["#233f5e","#dae5f0"],["#632623","#f2dbdb"],["#4d602c","#eaf1de"],["#3f3150","#e6e0ec"],["#1e5867","#d9eef3"],["#99490f","#fee9da"]],f=G=>G.length===4?`#${G[1]}${G[1]}${G[2]}${G[2]}${G[3]}${G[3]}`:G,m=(G,j,ie)=>{const fe=(G<<16|j<<8|ie).toString(16);return`#${new Array(Math.abs(fe.length-7)).join("0")}${fe}`},g=G=>{const j=f(G),ie=[];for(let fe=1;fe<7;fe+=2)ie.push(parseInt(`0x${j.slice(fe,fe+2)}`,16));return ie},b=(G,j,ie)=>{const fe=g(G),ve=g(j),xe=(ve[0]-fe[0])/ie,Te=(ve[1]-fe[1])/ie,Me=(ve[2]-fe[2])/ie,J=[];for(let S=0;S<ie;S++)J.push(m(xe*S+fe[0],Te*S+fe[1],Me*S+fe[2]));return J},v=Ge(()=>{const G=[];for(const j of u)G.push(b(j[1],j[0],5));return G}),w=Ge(()=>e.value!==""?e.value:e.defaultColor),y=Ge(()=>h.value!==""?h.value:w.value),_=()=>{c.value=!1},T=G=>{e.readonly||(c.value=!0,pt(()=>{const j=G.currentTarget,ie=j.nextElementSibling;if(ie){const{boundingTop:fe,boundingLeft:ve,visibleHeight:xe,visibleWidth:Te}=Xl(j),Me=fe+j.offsetHeight,J=ve+j.offsetWidth;let S="",I="";J+ie.offsetWidth>Te-10&&(S="auto",I=`${j.offsetWidth}px`);let U="",me="";Me+ie.offsetHeight>xe-10&&(U="auto",me="0"),ie.style.left=S,ie.style.right=I,ie.style.top=U,ie.style.bottom=me}}))},A=["vma-grid-color-picker--color-button"];e.readonly&&A.push("vma-grid-color-picker--color-button--readonly");const x=(G,j)=>{n("change",G,j),c.value=!1},C=G=>{n("change",G,e.defaultColor),c.value=!1},N=G=>{n("change",G,y.value),c.value=!1},P=()=>Z("div",{class:["vma-grid-color-picker--color-pallet--default"]},[Z("div",{class:["vma-grid-color-picker--color-pallet--default-color-view"],style:`background-color: ${y.value}`,onClick(j){N(j)}}),Z("div",{class:["vma-grid-color-picker--color-pallet--default-default-color"]},[Z(a,{onMouseDown:C},()=>"\u9ED8\u8BA4\u989C\u8272")])]),z=(G,j)=>{h.value=j},K=()=>{h.value=""},q=()=>{const G=[],j=[];return o.forEach(ie=>{G.push(Z("li",{style:`background-color:${ie}`,onMouseOver(fe){z(fe,ie)},onMouseOut:K,onClick(fe){x(fe,ie)}}))}),v.value.forEach(ie=>{const fe=[];ie.forEach(ve=>{fe.push(Z("li",{style:`background-color:${ve}`,onMouseOver(xe){z(xe,ve)},onMouseOut:K,onClick(xe){x(xe,ve)}}))}),j.push(Z("li",{},Z("ul",{},fe)))}),Z("div",{},[Z("h3",{},"\u4E3B\u9898\u989C\u8272"),Z("ul",{class:["vma-grid-color-picker--color-pallet--theme"]},G),Z("ul",{class:["vma-grid-color-picker--color-pallet--gradient"]},j)])},W=()=>{const G=[];return l.forEach(j=>{G.push(Z("li",{style:`background-color:${j}`,onMouseOver(ie){z(ie,j)},onMouseOut:K,onClick(ie){x(ie,j)}}))}),Z("div",{},[Z("h3",{},"\u6807\u51C6\u989C\u8272"),Z("ul",{class:["vma-grid-color-picker--color-pallet--theme"]},G)])},ce=()=>Z("div",{ref:i,class:["vma-grid-color-picker--color-pallet",c.value?"vma-grid-color-picker--color-pallet--open":""]},[P(),q(),W()]),V=()=>Z("div",{class:["vma-grid-color-picker"],tabIndex:-1,onClick(G){G.stopPropagation()},onBlur:_},[Z("div",{class:A,style:`background-color:${w.value}`,onClick:T}),ce()]);return d.renderVN=V,wt("$vmaGridColorPicker",d),d},render(){return this.renderVN()}});const e_={install(e){e.component(rf.name,rf)}};function Rr(e){return typeof e=="number"||/^\d+(\.\d+)?$/.test(e)}var Ae=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function t_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jl={exports:{}};(function(e,t){const r="\u0E28\u0E39\u0E19\u0E22\u0E4C\u0E1A\u0E32\u0E17\u0E16\u0E49\u0E27\u0E19",n=["","\u0E2B\u0E19\u0E36\u0E48\u0E07","\u0E2A\u0E2D\u0E07","\u0E2A\u0E32\u0E21","\u0E2A\u0E35\u0E48","\u0E2B\u0E49\u0E32","\u0E2B\u0E01","\u0E40\u0E08\u0E47\u0E14","\u0E41\u0E1B\u0E14","\u0E40\u0E01\u0E49\u0E32"],a=["","\u0E2A\u0E34\u0E1A","\u0E23\u0E49\u0E2D\u0E22","\u0E1E\u0E31\u0E19","\u0E2B\u0E21\u0E37\u0E48\u0E19","\u0E41\u0E2A\u0E19","\u0E25\u0E49\u0E32\u0E19"];function i(c){let o="";const l=c.length,u=7;if(l>u){const f=l-u+1,m=c.slice(0,f),g=c.slice(f);return i(m)+"\u0E25\u0E49\u0E32\u0E19"+i(g)}else for(let f=0;f<l;f++){const m=c[f];m>0&&(o+=n[m]+a[l-f-1])}return o}function s(c){let o=c;return o=o.replace(//g,"\u0E2A\u0E34\u0E1A"),o=o.replace(//g,"\u0E22\u0E35\u0E48\u0E2A\u0E34\u0E1A"),o=o.replace(//g,"\u0E2A\u0E34\u0E1A\u0E40\u0E2D\u0E47\u0E14"),o}function d(c,o){let l="";return c===""&&o===""?l=r:c!==""&&o===""?l=c+"\u0E1A\u0E32\u0E17\u0E16\u0E49\u0E27\u0E19":c===""&&o!==""?l=o+"\u0E2A\u0E15\u0E32\u0E07\u0E04\u0E4C":l=c+"\u0E1A\u0E32\u0E17"+o+"\u0E2A\u0E15\u0E32\u0E07\u0E04\u0E4C",l}function h(c){if(!c||typeof c=="boolean"||isNaN(Number(c))||c<Number.MIN_SAFE_INTEGER||c>Number.MAX_SAFE_INTEGER)return r;const o=Math.abs(c),l=Math.floor(o).toString(),u=(o%1*100).toFixed(2).split(".")[0],f=Array.from(l).map(Number),m=Array.from(u).map(Number);let g=i(f),b=i(m);g=s(g),b=s(b);const v=d(g,b);return c>=0?v:"\u0E25\u0E1A"+v}e.exports!=null&&(e.exports={bahttext:h},t.default={bahttext:h})})(jl,jl.exports);class Vn{constructor(t,r){le(this,"_data");le(this,"_refs");if(t==null&&r==null)this._data=[],this._refs=[];else{if(t.length!==r.length)throw Error("Collection: data length should match references length.");this._data=t,this._refs=r}}get data(){return this._data}get refs(){return this._refs}get length(){return this._data.length}add(t,r){this._data.push(t),this._refs.push(r)}}const R={NUMBER:0,ARRAY:1,BOOLEAN:2,STRING:3,RANGE_REF:4,CELL_REF:5,COLLECTIONS:6,NUMBER_NO_BOOLEAN:10},Vg=[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,121645100408832e3,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8,15511210043330986e9,40329146112660565e10,10888869450418352e12,30488834461171387e13,8841761993739702e15,26525285981219107e16,8222838654177922e18,2631308369336935e20,8683317618811886e21,29523279903960416e22,10333147966386145e24,37199332678990125e25,13763753091226346e27,5230226174666011e29,20397882081197444e30,8159152832478977e32,3345252661316381e34,140500611775288e37,6041526306337383e37,2658271574788449e39,11962222086548019e40,5502622159812089e42,25862324151116818e43,12413915592536073e45,6082818640342675e47,30414093201713376e48,15511187532873822e50,8065817517094388e52,42748832840600255e53,2308436973392414e56,12696403353658276e57,7109985878048635e59,40526919504877214e60,23505613312828785e62,13868311854568984e64,832098711274139e67,5075802138772248e68,3146997326038794e70,198260831540444e73,12688693218588417e73,8247650592082472e75,5443449390774431e77,3647111091818868e79,24800355424368305e80,1711224524281413e83,11978571669969892e84,8504785885678623e86,61234458376886085e87,44701154615126844e89,3307885441519386e92,248091408113954e95,18854947016660504e95,14518309202828587e97,11324281178206297e99,8946182130782976e101,7156945704626381e103,5797126020747368e105,4753643337012842e107,3945523969720659e109,3314240134565353e111,281710411438055e114,24227095383672734e114,2107757298379528e117,18548264225739844e118,1650795516090846e121,14857159644817615e122,1352001527678403e125,12438414054641308e126,11567725070816416e128,1087366156656743e131,1032997848823906e133,9916779348709496e134,9619275968248212e136,9426890448883248e138,9332621544394415e140,9332621544394415e142],r_={};Object.keys(R).forEach(e=>{r_[R[e]]=e});const zn={isRangeRef:e=>e.ref&&e.ref.from,isCellRef:e=>e.ref&&!e.ref.from,columnNumberToName:e=>{let t=e,r="",n=0;for(;t>0;)n=(t-1)%26,r=String.fromCharCode("A".charCodeAt(0)+n)+r,t=Math.floor((t-n)/26);return r},columnNameToNumber:e=>{e=e.toUpperCase();const t=e.length;let r=0;for(let n=0;n<t;n++){const a=e.charCodeAt(n);isNaN(a)||(r+=(a-64)*26**(t-n-1))}return r},extend:(e,t)=>{if(t==null)return e;let r,n;if(zn.isCellRef(e))r=0,n=0;else if(zn.isRangeRef(e))r=e.ref.to.row-e.ref.from.row,n=e.ref.to.col-e.ref.from.col;else throw Error("Address.extend should not reach here.");return zn.isCellRef(t)?(r>0||n>0)&&(t={ref:{from:{col:t.ref.col,row:t.ref.row},to:{row:t.ref.row+r,col:t.ref.col+n}}}):(t.ref.to.row=t.ref.from.row+r,t.ref.to.col=t.ref.from.col+n),t}};class n_{constructor(){le(this,"_Types");le(this,"type2Number");le(this,"checkFunctionResult",t=>{if(typeof t==="number"){if(isNaN(t))return M.VALUE;if(!isFinite(t))return M.NUM}return t==null?M.NULL:t});le(this,"isRangeRef",t=>t.ref&&t.ref.from);le(this,"isCellRef",t=>t.ref&&!t.ref.from);le(this,"retrieveArg",(t,r)=>{if(r===null)return{value:0,isArray:!1,omitted:!0};const n=t.utils.extractRefValue(r);return{value:n.val,isArray:n.isArray,ref:r.ref}});this._Types=R,this.type2Number={number:R.NUMBER,boolean:R.BOOLEAN,string:R.STRING,object:-1}}get Types(){return this._Types}set Types(t){this._Types=t}flattenDeep(t){return t.reduce((r,n)=>Array.isArray(n)?r.concat(this.flattenDeep(n)):r.concat(n),[])}acceptNumber(t,r=!0,n=!0){if(t instanceof M)return t;let a;if(typeof t=="number")a=t;else if(typeof t=="boolean")if(n)a=Number(t);else throw M.VALUE;else if(typeof t=="string"){if(t.length===0||(a=Number(t),a!==a))throw M.VALUE}else if(Array.isArray(t))if(r)a=this.acceptNumber(t[0][0]);else if(t[0].length===1)a=this.acceptNumber(t[0][0]);else throw M.VALUE;else throw Error("Unknown type in FormulaHelpers.acceptNumber");return a}flattenParams(t,r,n,a,i=null,s=1){if(t.length<s)throw M.ARG_MISSING([r]);i==null&&(i=r===R.NUMBER?0:r==null?null:""),t.forEach(d=>{const{isCellRef:h,isRangeRef:c,isArray:o}=d,l=d.value instanceof Vn,u=!h&&!c&&!o&&!l,f={isLiteral:u,isCellRef:h,isRangeRef:c,isArray:o,isUnion:l};if(u)d.omitted?d=i:d=this.accept(d,r,i),a(d,f);else if(h)a(d.value,f);else if(l){if(!n)throw M.VALUE;d=d.value.data,d=this.flattenDeep(d),d.forEach(m=>{a(m,f)})}else(c||o)&&(d=this.flattenDeep(d.value),d.forEach(m=>{a(m,f)}))})}accept(t,r=null,n,a=!0,i=!1){if(Array.isArray(r)&&(r=r[0]),t==null&&n===void 0)throw M.ARG_MISSING([r]);if(t==null)return n;if(typeof t!="object"||Array.isArray(t))return t;const s=t.isArray;if(t.value!=null&&(t=t.value),r==null)return t;if(t instanceof M)throw t;if(r===R.ARRAY){if(Array.isArray(t))return a?this.flattenDeep(t):t;if(t instanceof Vn)throw M.VALUE;if(i)return a?[t]:[[t]];throw M.VALUE}else if(r===R.COLLECTIONS)return t;s&&(t=t[0][0]);const d=this.type(t);if(r===R.STRING)d===R.BOOLEAN?t=t?"TRUE":"FALSE":t=`${t}`;else if(r===R.BOOLEAN){if(d===R.STRING)throw M.VALUE;d===R.NUMBER&&(t=Boolean(t))}else if(r===R.NUMBER)t=this.acceptNumber(t,!1);else if(r===R.NUMBER_NO_BOOLEAN)t=this.acceptNumber(t,!1,!1);else throw M.VALUE;return t}type(t){let r=this.type2Number[typeof t];return r===-1&&(Array.isArray(t)?r=R.ARRAY:t.ref?t.ref.from?r=R.RANGE_REF:r=R.CELL_REF:t instanceof Vn&&(r=R.COLLECTIONS)),r}retrieveRanges(t,r,n){return n=zn.extend(r,n),r=this.retrieveArg(t,r),r=this.accept(r,R.ARRAY,void 0,!1,!0),n!==r?(n=this.retrieveArg(t,n),n=this.accept(n,R.ARRAY,void 0,!1,!0)):n=r,[r,n]}}const Et=new n_,Ir={isWildCard:e=>typeof e=="string"?/[*?]/.test(e):!1,toRegex:(e,t)=>RegExp(e.replace(/[.+^${}()|[\]\\]/g,"\\$&").replace(/([^~]??)[?]/g,"$1.").replace(/([^~]??)[*]/g,"$1.*").replace(/~([?*])/g,"$1"),t)},Ql={parse:e=>{const t=typeof e;if(t==="string"){const r=e.toUpperCase();if(r==="TRUE"||r==="FALSE")return{op:"=",value:r==="TRUE"};const n=e.match(/(<>|>=|<=|>|<|=)(.*)/);if(n){const a=n[1];let i;if(isNaN(n[2])){const s=n[2].toUpperCase();if(s==="TRUE"||s==="FALSE")i=s==="TRUE";else if(/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A|#REF!/.test(n[2]))i=new M(n[2]);else if(i=n[2],Ir.isWildCard(i))return{op:"wc",value:Ir.toRegex(i),match:a==="="}}else i=Number(n[2]);return{op:a,value:i}}return Ir.isWildCard(e)?{op:"wc",value:Ir.toRegex(e),match:!0}:{op:"=",value:e}}if(t==="boolean"||t==="number"||Array.isArray(e)||e instanceof M)return{op:"=",value:e};throw Error(`Criteria.parse: type ${typeof e} not support`)}},ua=class extends Error{constructor(r,n,a){super(n);le(this,"_error");le(this,"_details");if(n==null&&a==null&&ua.errorMap.has(r))return ua.errorMap.get(r);n==null&&a==null?(this._error=r,ua.errorMap.set(r,this)):this._error=r,this._details=a}get details(){return this._details}set details(r){this._details=r}get error(){return this._error}get name(){return this._error}equals(r){return r instanceof ua&&r._error===this._error}toString(){return this._error}};let M=ua;le(M,"errorMap",new Map),le(M,"DIV0"),le(M,"NA"),le(M,"NAME"),le(M,"NULL"),le(M,"NUM"),le(M,"REF"),le(M,"VALUE"),le(M,"NOT_IMPLEMENTED"),le(M,"TOO_MANY_ARGS"),le(M,"ARG_MISSING"),le(M,"ERROR");M.errorMap=new Map;M.DIV0=new M("#DIV/0!");M.NA=new M("#N/A");M.NAME=new M("#NAME?");M.NULL=new M("#NULL!");M.NUM=new M("#NUM!");M.REF=new M("#REF!");M.VALUE=new M("#VALUE!");M.NOT_IMPLEMENTED=e=>new M("#NAME?",`Function ${e} is not implemented.`);M.TOO_MANY_ARGS=e=>new M("#N/A",`Function ${e} has too many arguments.`);M.ARG_MISSING=e=>new M("#N/A",`Argument type ${e.map(t=>R[t]).join(", ")} is missing.`);M.ERROR=(e,t)=>new M("#ERROR!",e,t);var ma={},a_=function(t){t.version="0.11.2";function r(S){for(var I="",U=S.length-1;U>=0;)I+=S.charAt(U--);return I}function n(S,I){for(var U="";U.length<I;)U+=S;return U}function a(S,I){var U=""+S;return U.length>=I?U:n("0",I-U.length)+U}function i(S,I){var U=""+S;return U.length>=I?U:n(" ",I-U.length)+U}function s(S,I){var U=""+S;return U.length>=I?U:U+n(" ",I-U.length)}function d(S,I){var U=""+Math.round(S);return U.length>=I?U:n("0",I-U.length)+U}function h(S,I){var U=""+S;return U.length>=I?U:n("0",I-U.length)+U}var c=Math.pow(2,32);function o(S,I){if(S>c||S<-c)return d(S,I);var U=Math.round(S);return h(U,I)}function l(S,I){return I=I||0,S.length>=7+I&&(S.charCodeAt(I)|32)===103&&(S.charCodeAt(I+1)|32)===101&&(S.charCodeAt(I+2)|32)===110&&(S.charCodeAt(I+3)|32)===101&&(S.charCodeAt(I+4)|32)===114&&(S.charCodeAt(I+5)|32)===97&&(S.charCodeAt(I+6)|32)===108}var u=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],f=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function m(S){S[0]="General",S[1]="0",S[2]="0.00",S[3]="#,##0",S[4]="#,##0.00",S[9]="0%",S[10]="0.00%",S[11]="0.00E+00",S[12]="# ?/?",S[13]="# ??/??",S[14]="m/d/yy",S[15]="d-mmm-yy",S[16]="d-mmm",S[17]="mmm-yy",S[18]="h:mm AM/PM",S[19]="h:mm:ss AM/PM",S[20]="h:mm",S[21]="h:mm:ss",S[22]="m/d/yy h:mm",S[37]="#,##0 ;(#,##0)",S[38]="#,##0 ;[Red](#,##0)",S[39]="#,##0.00;(#,##0.00)",S[40]="#,##0.00;[Red](#,##0.00)",S[45]="mm:ss",S[46]="[h]:mm:ss",S[47]="mmss.0",S[48]="##0.0E+0",S[49]="@",S[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'}var g={};m(g);var b=[],v=0;for(v=5;v<=8;++v)b[v]=32+v;for(v=23;v<=26;++v)b[v]=0;for(v=27;v<=31;++v)b[v]=14;for(v=50;v<=58;++v)b[v]=14;for(v=59;v<=62;++v)b[v]=v-58;for(v=67;v<=68;++v)b[v]=v-58;for(v=72;v<=75;++v)b[v]=v-58;for(v=67;v<=68;++v)b[v]=v-57;for(v=76;v<=78;++v)b[v]=v-56;for(v=79;v<=81;++v)b[v]=v-34;var w=[];w[5]=w[63]='"$"#,##0_);\\("$"#,##0\\)',w[6]=w[64]='"$"#,##0_);[Red]\\("$"#,##0\\)',w[7]=w[65]='"$"#,##0.00_);\\("$"#,##0.00\\)',w[8]=w[66]='"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',w[41]='_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',w[42]='_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',w[43]='_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',w[44]='_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)';function y(S,I,U){for(var me=S<0?-1:1,Y=S*me,be=0,X=1,k=0,B=1,H=0,re=0,ne=Math.floor(Y);H<I&&(ne=Math.floor(Y),k=ne*X+be,re=ne*H+B,!(Y-ne<5e-8));)Y=1/(Y-ne),be=X,X=k,B=H,H=re;if(re>I&&(H>I?(re=B,k=be):(re=H,k=X)),!U)return[0,me*k,re];var p=Math.floor(me*k/re);return[p,me*k-p*re,re]}function _(S,I,U){if(S>2958465||S<0)return null;var me=S|0,Y=Math.floor(86400*(S-me)),be=0,X=[],k={D:me,T:Y,u:86400*(S-me)-Y,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(k.u)<1e-6&&(k.u=0),I&&I.date1904&&(me+=1462),k.u>.9999&&(k.u=0,++Y==86400&&(k.T=Y=0,++me,++k.D)),me===60)X=U?[1317,10,29]:[1900,2,29],be=3;else if(me===0)X=U?[1317,8,29]:[1900,1,0],be=6;else{me>60&&--me;var B=new Date(1900,0,1);B.setDate(B.getDate()+me-1),X=[B.getFullYear(),B.getMonth()+1,B.getDate()],be=B.getDay(),me<60&&(be=(be+6)%7),U&&(be=K(B,X))}return k.y=X[0],k.m=X[1],k.d=X[2],k.S=Y%60,Y=Math.floor(Y/60),k.M=Y%60,Y=Math.floor(Y/60),k.H=Y,k.q=be,k}t.parse_date_code=_;var T=new Date(1899,11,31,0,0,0),A=T.getTime(),x=new Date(1900,2,1,0,0,0);function C(S,I){var U=S.getTime();return I?U-=1461*24*60*60*1e3:S>=x&&(U+=24*60*60*1e3),(U-(A+(S.getTimezoneOffset()-T.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function N(S){return S.toString(10)}t._general_int=N;var P=function(){var I=/(?:\.0*|(\.\d*[1-9])0+)$/;function U(H){return H.indexOf(".")==-1?H:H.replace(I,"$1")}var me=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,Y=/(E[+-])(\d)$/;function be(H){return H.indexOf("E")==-1?H:H.replace(me,"$1E").replace(Y,"$10$2")}function X(H){var re=H<0?12:11,ne=U(H.toFixed(12));return ne.length<=re||(ne=H.toPrecision(10),ne.length<=re)?ne:H.toExponential(5)}function k(H){var re=U(H.toFixed(11));return re.length>(H<0?12:11)||re==="0"||re==="-0"?H.toPrecision(6):re}function B(H){var re=Math.floor(Math.log(Math.abs(H))*Math.LOG10E),ne;return re>=-4&&re<=-1?ne=H.toPrecision(10+re):Math.abs(re)<=9?ne=X(H):re===10?ne=H.toFixed(10).substr(0,12):ne=k(H),U(be(ne.toUpperCase()))}return B}();t._general_num=P;function z(S,I){switch(typeof S){case"string":return S;case"boolean":return S?"TRUE":"FALSE";case"number":return(S|0)===S?S.toString(10):P(S);case"undefined":return"";case"object":if(S==null)return"";if(S instanceof Date)return Me(14,C(S,I&&I.date1904),I)}throw new Error("unsupported value in General format: "+S)}t._general=z;function K(S,I){I[0]-=581;var U=S.getDay();return S<60&&(U=(U+6)%7),U}function q(S,I,U,me){var Y="",be=0,X=0,k=U.y,B,H=0;switch(S){case 98:k=U.y+543;case 121:switch(I.length){case 1:case 2:B=k%100,H=2;break;default:B=k%1e4,H=4;break}break;case 109:switch(I.length){case 1:case 2:B=U.m,H=I.length;break;case 3:return f[U.m-1][1];case 5:return f[U.m-1][0];default:return f[U.m-1][2]}break;case 100:switch(I.length){case 1:case 2:B=U.d,H=I.length;break;case 3:return u[U.q][0];default:return u[U.q][1]}break;case 104:switch(I.length){case 1:case 2:B=1+(U.H+11)%12,H=I.length;break;default:throw"bad hour format: "+I}break;case 72:switch(I.length){case 1:case 2:B=U.H,H=I.length;break;default:throw"bad hour format: "+I}break;case 77:switch(I.length){case 1:case 2:B=U.M,H=I.length;break;default:throw"bad minute format: "+I}break;case 115:if(I!="s"&&I!="ss"&&I!=".0"&&I!=".00"&&I!=".000")throw"bad second format: "+I;return U.u===0&&(I=="s"||I=="ss")?a(U.S,I.length):(me>=2?X=me===3?1e3:100:X=me===1?10:1,be=Math.round(X*(U.S+U.u)),be>=60*X&&(be=0),I==="s"?be===0?"0":""+be/X:(Y=a(be,2+me),I==="ss"?Y.substr(0,2):"."+Y.substr(2,I.length-1)));case 90:switch(I){case"[h]":case"[hh]":B=U.D*24+U.H;break;case"[m]":case"[mm]":B=(U.D*24+U.H)*60+U.M;break;case"[s]":case"[ss]":B=((U.D*24+U.H)*60+U.M)*60+Math.round(U.S+U.u);break;default:throw"bad abstime format: "+I}H=I.length===3?1:2;break;case 101:B=k,H=1;break}var re=H>0?a(B,H):"";return re}function W(S){var I=3;if(S.length<=I)return S;for(var U=S.length%I,me=S.substr(0,U);U!=S.length;U+=I)me+=(me.length>0?",":"")+S.substr(U,I);return me}var ce=function(){var I=/%/g;function U(de,L,D){var ae=L.replace(I,""),Q=L.length-ae.length;return ce(de,ae,D*Math.pow(10,2*Q))+n("%",Q)}function me(de,L,D){for(var ae=L.length-1;L.charCodeAt(ae-1)===44;)--ae;return ce(de,L.substr(0,ae),D/Math.pow(10,3*(L.length-ae)))}function Y(de,L){var D,ae=de.indexOf("E")-de.indexOf(".")-1;if(de.match(/^#+0.0E\+0$/)){if(L==0)return"0.0E+0";if(L<0)return"-"+Y(de,-L);var Q=de.indexOf(".");Q===-1&&(Q=de.indexOf("E"));var ee=Math.floor(Math.log(L)*Math.LOG10E)%Q;if(ee<0&&(ee+=Q),D=(L/Math.pow(10,ee)).toPrecision(ae+1+(Q+ee)%Q),D.indexOf("e")===-1){var we=Math.floor(Math.log(L)*Math.LOG10E);for(D.indexOf(".")===-1?D=D.charAt(0)+"."+D.substr(1)+"E+"+(we-D.length+ee):D+="E+"+(we-ee);D.substr(0,2)==="0.";)D=D.charAt(0)+D.substr(2,Q)+"."+D.substr(2+Q),D=D.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");D=D.replace(/\+-/,"-")}D=D.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(Le,Be,$e,De){return Be+$e+De.substr(0,(Q+ee)%Q)+"."+De.substr(ee)+"E"})}else D=L.toExponential(ae);return de.match(/E\+00$/)&&D.match(/e[+-]\d$/)&&(D=D.substr(0,D.length-1)+"0"+D.charAt(D.length-1)),de.match(/E\-/)&&D.match(/e\+/)&&(D=D.replace(/e\+/,"e")),D.replace("e","E")}var be=/# (\?+)( ?)\/( ?)(\d+)/;function X(de,L,D){var ae=parseInt(de[4],10),Q=Math.round(L*ae),ee=Math.floor(Q/ae),we=Q-ee*ae,Le=ae;return D+(ee===0?"":""+ee)+" "+(we===0?n(" ",de[1].length+1+de[4].length):i(we,de[1].length)+de[2]+"/"+de[3]+a(Le,de[4].length))}function k(de,L,D){return D+(L===0?"":""+L)+n(" ",de[1].length+2+de[4].length)}var B=/^#*0*\.([0#]+)/,H=/\).*[0#]/,re=/\(###\) ###\\?-####/;function ne(de){for(var L="",D,ae=0;ae!=de.length;++ae)switch(D=de.charCodeAt(ae)){case 35:break;case 63:L+=" ";break;case 48:L+="0";break;default:L+=String.fromCharCode(D)}return L}function p(de,L){var D=Math.pow(10,L);return""+Math.round(de*D)/D}function ye(de,L){var D=de-Math.floor(de),ae=Math.pow(10,L);return L<(""+Math.round(D*ae)).length?0:Math.round(D*ae)}function $(de,L){return L<(""+Math.round((de-Math.floor(de))*Math.pow(10,L))).length?1:0}function pe(de){return de<2147483647&&de>-2147483648?""+(de>=0?de|0:de-1|0):""+Math.floor(de)}function ue(de,L,D){if(de.charCodeAt(0)===40&&!L.match(H)){var ae=L.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return D>=0?ue("n",ae,D):"("+ue("n",ae,-D)+")"}if(L.charCodeAt(L.length-1)===44)return me(de,L,D);if(L.indexOf("%")!==-1)return U(de,L,D);if(L.indexOf("E")!==-1)return Y(L,D);if(L.charCodeAt(0)===36)return"$"+ue(de,L.substr(L.charAt(1)==" "?2:1),D);var Q,ee,we,Le,Be=Math.abs(D),$e=D<0?"-":"";if(L.match(/^00+$/))return $e+o(Be,L.length);if(L.match(/^[#?]+$/))return Q=o(D,0),Q==="0"&&(Q=""),Q.length>L.length?Q:ne(L.substr(0,L.length-Q.length))+Q;if(ee=L.match(be))return X(ee,Be,$e);if(L.match(/^#+0+$/))return $e+o(Be,L.length-L.indexOf("0"));if(ee=L.match(B))return Q=p(D,ee[1].length).replace(/^([^\.]+)$/,"$1."+ne(ee[1])).replace(/\.$/,"."+ne(ee[1])).replace(/\.(\d*)$/,function(Ee,oe){return"."+oe+n("0",ne(ee[1]).length-oe.length)}),L.indexOf("0.")!==-1?Q:Q.replace(/^0\./,".");if(L=L.replace(/^#+([0.])/,"$1"),ee=L.match(/^(0*)\.(#*)$/))return $e+p(Be,ee[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,ee[1].length?"0.":".");if(ee=L.match(/^#{1,3},##0(\.?)$/))return $e+W(o(Be,0));if(ee=L.match(/^#,##0\.([#0]*0)$/))return D<0?"-"+ue(de,L,-D):W(""+(Math.floor(D)+$(D,ee[1].length)))+"."+a(ye(D,ee[1].length),ee[1].length);if(ee=L.match(/^#,#*,#0/))return ue(de,L.replace(/^#,#*,/,""),D);if(ee=L.match(/^([0#]+)(\\?-([0#]+))+$/))return Q=r(ue(de,L.replace(/[\\-]/g,""),D)),we=0,r(r(L.replace(/\\/g,"")).replace(/[0#]/g,function(Ee){return we<Q.length?Q.charAt(we++):Ee==="0"?"0":""}));if(L.match(re))return Q=ue(de,"##########",D),"("+Q.substr(0,3)+") "+Q.substr(3,3)+"-"+Q.substr(6);var De="";if(ee=L.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return we=Math.min(ee[4].length,7),Le=y(Be,Math.pow(10,we)-1,!1),Q=""+$e,De=ce("n",ee[1],Le[1]),De.charAt(De.length-1)==" "&&(De=De.substr(0,De.length-1)+"0"),Q+=De+ee[2]+"/"+ee[3],De=s(Le[2],we),De.length<ee[4].length&&(De=ne(ee[4].substr(ee[4].length-De.length))+De),Q+=De,Q;if(ee=L.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return we=Math.min(Math.max(ee[1].length,ee[4].length),7),Le=y(Be,Math.pow(10,we)-1,!0),$e+(Le[0]||(Le[1]?"":"0"))+" "+(Le[1]?i(Le[1],we)+ee[2]+"/"+ee[3]+s(Le[2],we):n(" ",2*we+1+ee[2].length+ee[3].length));if(ee=L.match(/^[#0?]+$/))return Q=o(D,0),L.length<=Q.length?Q:ne(L.substr(0,L.length-Q.length))+Q;if(ee=L.match(/^([#0?]+)\.([#0]+)$/)){Q=""+D.toFixed(Math.min(ee[2].length,10)).replace(/([^0])0+$/,"$1"),we=Q.indexOf(".");var xt=L.indexOf(".")-we,Vt=L.length-Q.length-xt;return ne(L.substr(0,xt)+Q+L.substr(L.length-Vt))}if(ee=L.match(/^00,000\.([#0]*0)$/))return we=ye(D,ee[1].length),D<0?"-"+ue(de,L,-D):W(pe(D)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(Ee){return"00,"+(Ee.length<3?a(0,3-Ee.length):"")+Ee})+"."+a(we,ee[1].length);switch(L){case"###,##0.00":return ue(de,"#,##0.00",D);case"###,###":case"##,###":case"#,###":var ar=W(o(Be,0));return ar!=="0"?$e+ar:"";case"###,###.00":return ue(de,"###,##0.00",D).replace(/^0\./,".");case"#,###.00":return ue(de,"#,##0.00",D).replace(/^0\./,".")}throw new Error("unsupported format |"+L+"|")}function Oe(de,L,D){for(var ae=L.length-1;L.charCodeAt(ae-1)===44;)--ae;return ce(de,L.substr(0,ae),D/Math.pow(10,3*(L.length-ae)))}function Ne(de,L,D){var ae=L.replace(I,""),Q=L.length-ae.length;return ce(de,ae,D*Math.pow(10,2*Q))+n("%",Q)}function ke(de,L){var D,ae=de.indexOf("E")-de.indexOf(".")-1;if(de.match(/^#+0.0E\+0$/)){if(L==0)return"0.0E+0";if(L<0)return"-"+ke(de,-L);var Q=de.indexOf(".");Q===-1&&(Q=de.indexOf("E"));var ee=Math.floor(Math.log(L)*Math.LOG10E)%Q;if(ee<0&&(ee+=Q),D=(L/Math.pow(10,ee)).toPrecision(ae+1+(Q+ee)%Q),!D.match(/[Ee]/)){var we=Math.floor(Math.log(L)*Math.LOG10E);D.indexOf(".")===-1?D=D.charAt(0)+"."+D.substr(1)+"E+"+(we-D.length+ee):D+="E+"+(we-ee),D=D.replace(/\+-/,"-")}D=D.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(Le,Be,$e,De){return Be+$e+De.substr(0,(Q+ee)%Q)+"."+De.substr(ee)+"E"})}else D=L.toExponential(ae);return de.match(/E\+00$/)&&D.match(/e[+-]\d$/)&&(D=D.substr(0,D.length-1)+"0"+D.charAt(D.length-1)),de.match(/E\-/)&&D.match(/e\+/)&&(D=D.replace(/e\+/,"e")),D.replace("e","E")}function _e(de,L,D){if(de.charCodeAt(0)===40&&!L.match(H)){var ae=L.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return D>=0?_e("n",ae,D):"("+_e("n",ae,-D)+")"}if(L.charCodeAt(L.length-1)===44)return Oe(de,L,D);if(L.indexOf("%")!==-1)return Ne(de,L,D);if(L.indexOf("E")!==-1)return ke(L,D);if(L.charCodeAt(0)===36)return"$"+_e(de,L.substr(L.charAt(1)==" "?2:1),D);var Q,ee,we,Le,Be=Math.abs(D),$e=D<0?"-":"";if(L.match(/^00+$/))return $e+a(Be,L.length);if(L.match(/^[#?]+$/))return Q=""+D,D===0&&(Q=""),Q.length>L.length?Q:ne(L.substr(0,L.length-Q.length))+Q;if(ee=L.match(be))return k(ee,Be,$e);if(L.match(/^#+0+$/))return $e+a(Be,L.length-L.indexOf("0"));if(ee=L.match(B))return Q=(""+D).replace(/^([^\.]+)$/,"$1."+ne(ee[1])).replace(/\.$/,"."+ne(ee[1])),Q=Q.replace(/\.(\d*)$/,function(Ee,oe){return"."+oe+n("0",ne(ee[1]).length-oe.length)}),L.indexOf("0.")!==-1?Q:Q.replace(/^0\./,".");if(L=L.replace(/^#+([0.])/,"$1"),ee=L.match(/^(0*)\.(#*)$/))return $e+(""+Be).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,ee[1].length?"0.":".");if(ee=L.match(/^#{1,3},##0(\.?)$/))return $e+W(""+Be);if(ee=L.match(/^#,##0\.([#0]*0)$/))return D<0?"-"+_e(de,L,-D):W(""+D)+"."+n("0",ee[1].length);if(ee=L.match(/^#,#*,#0/))return _e(de,L.replace(/^#,#*,/,""),D);if(ee=L.match(/^([0#]+)(\\?-([0#]+))+$/))return Q=r(_e(de,L.replace(/[\\-]/g,""),D)),we=0,r(r(L.replace(/\\/g,"")).replace(/[0#]/g,function(Ee){return we<Q.length?Q.charAt(we++):Ee==="0"?"0":""}));if(L.match(re))return Q=_e(de,"##########",D),"("+Q.substr(0,3)+") "+Q.substr(3,3)+"-"+Q.substr(6);var De="";if(ee=L.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return we=Math.min(ee[4].length,7),Le=y(Be,Math.pow(10,we)-1,!1),Q=""+$e,De=ce("n",ee[1],Le[1]),De.charAt(De.length-1)==" "&&(De=De.substr(0,De.length-1)+"0"),Q+=De+ee[2]+"/"+ee[3],De=s(Le[2],we),De.length<ee[4].length&&(De=ne(ee[4].substr(ee[4].length-De.length))+De),Q+=De,Q;if(ee=L.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return we=Math.min(Math.max(ee[1].length,ee[4].length),7),Le=y(Be,Math.pow(10,we)-1,!0),$e+(Le[0]||(Le[1]?"":"0"))+" "+(Le[1]?i(Le[1],we)+ee[2]+"/"+ee[3]+s(Le[2],we):n(" ",2*we+1+ee[2].length+ee[3].length));if(ee=L.match(/^[#0?]+$/))return Q=""+D,L.length<=Q.length?Q:ne(L.substr(0,L.length-Q.length))+Q;if(ee=L.match(/^([#0]+)\.([#0]+)$/)){Q=""+D.toFixed(Math.min(ee[2].length,10)).replace(/([^0])0+$/,"$1"),we=Q.indexOf(".");var xt=L.indexOf(".")-we,Vt=L.length-Q.length-xt;return ne(L.substr(0,xt)+Q+L.substr(L.length-Vt))}if(ee=L.match(/^00,000\.([#0]*0)$/))return D<0?"-"+_e(de,L,-D):W(""+D).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(Ee){return"00,"+(Ee.length<3?a(0,3-Ee.length):"")+Ee})+"."+a(0,ee[1].length);switch(L){case"###,###":case"##,###":case"#,###":var ar=W(""+Be);return ar!=="0"?$e+ar:"";default:if(L.match(/\.[0#?]*$/))return _e(de,L.slice(0,L.lastIndexOf(".")),D)+ne(L.slice(L.lastIndexOf(".")))}throw new Error("unsupported format |"+L+"|")}return function(L,D,ae){return(ae|0)===ae?_e(L,D,ae):ue(L,D,ae)}}();function V(S){for(var I=[],U=!1,me=0,Y=0;me<S.length;++me)switch(S.charCodeAt(me)){case 34:U=!U;break;case 95:case 42:case 92:++me;break;case 59:I[I.length]=S.substr(Y,me-Y),Y=me+1}if(I[I.length]=S.substr(Y),U===!0)throw new Error("Format |"+S+"| unterminated string ");return I}t._split=V;var G=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function j(S){for(var I=0,U="",me="";I<S.length;)switch(U=S.charAt(I)){case"G":l(S,I)&&(I+=6),I++;break;case'"':for(;S.charCodeAt(++I)!==34&&I<S.length;);++I;break;case"\\":I+=2;break;case"_":I+=2;break;case"@":++I;break;case"B":case"b":if(S.charAt(I+1)==="1"||S.charAt(I+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(S.substr(I,3).toUpperCase()==="A/P"||S.substr(I,5).toUpperCase()==="AM/PM"||S.substr(I,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++I;break;case"[":for(me=U;S.charAt(I++)!=="]"&&I<S.length;)me+=S.charAt(I);if(me.match(G))return!0;break;case".":case"0":case"#":for(;I<S.length&&("0#?.,E+-%".indexOf(U=S.charAt(++I))>-1||U=="\\"&&S.charAt(I+1)=="-"&&"0#".indexOf(S.charAt(I+2))>-1););break;case"?":for(;S.charAt(++I)===U;);break;case"*":++I,(S.charAt(I)==" "||S.charAt(I)=="*")&&++I;break;case"(":case")":++I;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;I<S.length&&"0123456789".indexOf(S.charAt(++I))>-1;);break;case" ":++I;break;default:++I;break}return!1}t.is_date=j;function ie(S,I,U,me){for(var Y=[],be="",X=0,k="",B="t",H,re,ne,p="H";X<S.length;)switch(k=S.charAt(X)){case"G":if(!l(S,X))throw new Error("unrecognized character "+k+" in "+S);Y[Y.length]={t:"G",v:"General"},X+=7;break;case'"':for(be="";(ne=S.charCodeAt(++X))!==34&&X<S.length;)be+=String.fromCharCode(ne);Y[Y.length]={t:"t",v:be},++X;break;case"\\":var ye=S.charAt(++X),$=ye==="("||ye===")"?ye:"t";Y[Y.length]={t:$,v:ye},++X;break;case"_":Y[Y.length]={t:"t",v:" "},X+=2;break;case"@":Y[Y.length]={t:"T",v:I},++X;break;case"B":case"b":if(S.charAt(X+1)==="1"||S.charAt(X+1)==="2"){if(H==null&&(H=_(I,U,S.charAt(X+1)==="2"),H==null))return"";Y[Y.length]={t:"X",v:S.substr(X,2)},B=k,X+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":k=k.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(I<0||H==null&&(H=_(I,U),H==null))return"";for(be=k;++X<S.length&&S.charAt(X).toLowerCase()===k;)be+=k;k==="m"&&B.toLowerCase()==="h"&&(k="M"),k==="h"&&(k=p),Y[Y.length]={t:k,v:be},B=k;break;case"A":case"a":case"\u4E0A":var pe={t:k,v:k};if(H==null&&(H=_(I,U)),S.substr(X,3).toUpperCase()==="A/P"?(H!=null&&(pe.v=H.H>=12?"P":"A"),pe.t="T",p="h",X+=3):S.substr(X,5).toUpperCase()==="AM/PM"?(H!=null&&(pe.v=H.H>=12?"PM":"AM"),pe.t="T",X+=5,p="h"):S.substr(X,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(H!=null&&(pe.v=H.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),pe.t="T",X+=5,p="h"):(pe.t="t",++X),H==null&&pe.t==="T")return"";Y[Y.length]=pe,B=k;break;case"[":for(be=k;S.charAt(X++)!=="]"&&X<S.length;)be+=S.charAt(X);if(be.slice(-1)!=="]")throw'unterminated "[" block: |'+be+"|";if(be.match(G)){if(H==null&&(H=_(I,U),H==null))return"";Y[Y.length]={t:"Z",v:be.toLowerCase()},B=be.charAt(1)}else be.indexOf("$")>-1&&(be=(be.match(/\$([^-\[\]]*)/)||[])[1]||"$",j(S)||(Y[Y.length]={t:"t",v:be}));break;case".":if(H!=null){for(be=k;++X<S.length&&(k=S.charAt(X))==="0";)be+=k;Y[Y.length]={t:"s",v:be};break}case"0":case"#":for(be=k;++X<S.length&&"0#?.,E+-%".indexOf(k=S.charAt(X))>-1;)be+=k;Y[Y.length]={t:"n",v:be};break;case"?":for(be=k;S.charAt(++X)===k;)be+=k;Y[Y.length]={t:k,v:be},B=k;break;case"*":++X,(S.charAt(X)==" "||S.charAt(X)=="*")&&++X;break;case"(":case")":Y[Y.length]={t:me===1?"t":k,v:k},++X;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(be=k;X<S.length&&"0123456789".indexOf(S.charAt(++X))>-1;)be+=S.charAt(X);Y[Y.length]={t:"D",v:be};break;case" ":Y[Y.length]={t:k,v:k},++X;break;case"$":Y[Y.length]={t:"t",v:"$"},++X;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(k)===-1)throw new Error("unrecognized character "+k+" in "+S);Y[Y.length]={t:"t",v:k},++X;break}var ue=0,Oe=0,Ne;for(X=Y.length-1,B="t";X>=0;--X)switch(Y[X].t){case"h":case"H":Y[X].t=p,B="h",ue<1&&(ue=1);break;case"s":(Ne=Y[X].v.match(/\.0+$/))&&(Oe=Math.max(Oe,Ne[0].length-1)),ue<3&&(ue=3);case"d":case"y":case"M":case"e":B=Y[X].t;break;case"m":B==="s"&&(Y[X].t="M",ue<2&&(ue=2));break;case"X":break;case"Z":ue<1&&Y[X].v.match(/[Hh]/)&&(ue=1),ue<2&&Y[X].v.match(/[Mm]/)&&(ue=2),ue<3&&Y[X].v.match(/[Ss]/)&&(ue=3)}switch(ue){case 0:break;case 1:H.u>=.5&&(H.u=0,++H.S),H.S>=60&&(H.S=0,++H.M),H.M>=60&&(H.M=0,++H.H);break;case 2:H.u>=.5&&(H.u=0,++H.S),H.S>=60&&(H.S=0,++H.M);break}var ke="",_e;for(X=0;X<Y.length;++X)switch(Y[X].t){case"t":case"T":case" ":case"D":break;case"X":Y[X].v="",Y[X].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":Y[X].v=q(Y[X].t.charCodeAt(0),Y[X].v,H,Oe),Y[X].t="t";break;case"n":case"?":for(_e=X+1;Y[_e]!=null&&((k=Y[_e].t)==="?"||k==="D"||(k===" "||k==="t")&&Y[_e+1]!=null&&(Y[_e+1].t==="?"||Y[_e+1].t==="t"&&Y[_e+1].v==="/")||Y[X].t==="("&&(k===" "||k==="n"||k===")")||k==="t"&&(Y[_e].v==="/"||Y[_e].v===" "&&Y[_e+1]!=null&&Y[_e+1].t=="?"));)Y[X].v+=Y[_e].v,Y[_e]={v:"",t:";"},++_e;ke+=Y[X].v,X=_e-1;break;case"G":Y[X].t="t",Y[X].v=z(I,U);break}var de="",L,D;if(ke.length>0){ke.charCodeAt(0)==40?(L=I<0&&ke.charCodeAt(0)===45?-I:I,D=ce("n",ke,L)):(L=I<0&&me>1?-I:I,D=ce("n",ke,L),L<0&&Y[0]&&Y[0].t=="t"&&(D=D.substr(1),Y[0].v="-"+Y[0].v)),_e=D.length-1;var ae=Y.length;for(X=0;X<Y.length;++X)if(Y[X]!=null&&Y[X].t!="t"&&Y[X].v.indexOf(".")>-1){ae=X;break}var Q=Y.length;if(ae===Y.length&&D.indexOf("E")===-1){for(X=Y.length-1;X>=0;--X)Y[X]==null||"n?".indexOf(Y[X].t)===-1||(_e>=Y[X].v.length-1?(_e-=Y[X].v.length,Y[X].v=D.substr(_e+1,Y[X].v.length)):_e<0?Y[X].v="":(Y[X].v=D.substr(0,_e+1),_e=-1),Y[X].t="t",Q=X);_e>=0&&Q<Y.length&&(Y[Q].v=D.substr(0,_e+1)+Y[Q].v)}else if(ae!==Y.length&&D.indexOf("E")===-1){for(_e=D.indexOf(".")-1,X=ae;X>=0;--X)if(!(Y[X]==null||"n?".indexOf(Y[X].t)===-1)){for(re=Y[X].v.indexOf(".")>-1&&X===ae?Y[X].v.indexOf(".")-1:Y[X].v.length-1,de=Y[X].v.substr(re+1);re>=0;--re)_e>=0&&(Y[X].v.charAt(re)==="0"||Y[X].v.charAt(re)==="#")&&(de=D.charAt(_e--)+de);Y[X].v=de,Y[X].t="t",Q=X}for(_e>=0&&Q<Y.length&&(Y[Q].v=D.substr(0,_e+1)+Y[Q].v),_e=D.indexOf(".")+1,X=ae;X<Y.length;++X)if(!(Y[X]==null||"n?(".indexOf(Y[X].t)===-1&&X!==ae)){for(re=Y[X].v.indexOf(".")>-1&&X===ae?Y[X].v.indexOf(".")+1:0,de=Y[X].v.substr(0,re);re<Y[X].v.length;++re)_e<D.length&&(de+=D.charAt(_e++));Y[X].v=de,Y[X].t="t",Q=X}}}for(X=0;X<Y.length;++X)Y[X]!=null&&"n?".indexOf(Y[X].t)>-1&&(L=me>1&&I<0&&X>0&&Y[X-1].v==="-"?-I:I,Y[X].v=ce(Y[X].t,Y[X].v,L),Y[X].t="t");var ee="";for(X=0;X!==Y.length;++X)Y[X]!=null&&(ee+=Y[X].v);return ee}t._eval=ie;var fe=/\[[=<>]/,ve=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function xe(S,I){if(I==null)return!1;var U=parseFloat(I[2]);switch(I[1]){case"=":if(S==U)return!0;break;case">":if(S>U)return!0;break;case"<":if(S<U)return!0;break;case"<>":if(S!=U)return!0;break;case">=":if(S>=U)return!0;break;case"<=":if(S<=U)return!0;break}return!1}function Te(S,I){var U=V(S),me=U.length,Y=U[me-1].indexOf("@");if(me<4&&Y>-1&&--me,U.length>4)throw new Error("cannot find right format for |"+U.join("|")+"|");if(typeof I!="number")return[4,U.length===4||Y>-1?U[U.length-1]:"@"];switch(U.length){case 1:U=Y>-1?["General","General","General",U[0]]:[U[0],U[0],U[0],"@"];break;case 2:U=Y>-1?[U[0],U[0],U[0],U[1]]:[U[0],U[1],U[0],"@"];break;case 3:U=Y>-1?[U[0],U[1],U[0],U[2]]:[U[0],U[1],U[2],"@"];break}var be=I>0?U[0]:I<0?U[1]:U[2];if(U[0].indexOf("[")===-1&&U[1].indexOf("[")===-1)return[me,be];if(U[0].match(fe)!=null||U[1].match(fe)!=null){var X=U[0].match(ve),k=U[1].match(ve);return xe(I,X)?[me,U[0]]:xe(I,k)?[me,U[1]]:[me,U[X!=null&&k!=null?2:1]]}return[me,be]}function Me(S,I,U){U==null&&(U={});var me="";switch(typeof S){case"string":S=="m/d/yy"&&U.dateNF?me=U.dateNF:me=S;break;case"number":S==14&&U.dateNF?me=U.dateNF:me=(U.table!=null?U.table:g)[S],me==null&&(me=U.table&&U.table[b[S]]||g[b[S]]),me==null&&(me=w[S]||"General");break}if(l(me,0))return z(I,U);I instanceof Date&&(I=C(I,U.date1904));var Y=Te(me,I);if(l(Y[1]))return z(I,U);if(I===!0)I="TRUE";else if(I===!1)I="FALSE";else if(I===""||I==null)return"";return ie(Y[1],I,U,Y[0])}function J(S,I){if(typeof I!="number"){I=+I||-1;for(var U=0;U<392;++U){if(g[U]==null){I<0&&(I=U);continue}if(g[U]==S){I=U;break}}I<0&&(I=391)}return g[I]=S,I}t.load=J,t._table=g,t.get_table=function(){return g},t.load_table=function(I){for(var U=0;U!=392;++U)I[U]!==void 0&&J(I[U],U)},t.init_table=m,t.format=Me};a_(ma);const He=Et,nf={latin:{halfRE:/[!-~]/g,fullRE:/[-]/g,delta:65248},hangul1:{halfRE:/[-]/g,fullRE:/[-]/g,delta:-60921},hangul2:{halfRE:/[-]/g,fullRE:/[-]/g,delta:-61025},kana:{delta:0,half:"\uFF61\uFF62\uFF63\uFF64\uFF65\uFF66\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\uFF71\uFF72\uFF73\uFF74\uFF75\uFF76\uFF77\uFF78\uFF79\uFF7A\uFF7B\uFF7C\uFF7D\uFF7E\uFF7F\uFF80\uFF81\uFF82\uFF83\uFF84\uFF85\uFF86\uFF87\uFF88\uFF89\uFF8A\uFF8B\uFF8C\uFF8D\uFF8E\uFF8F\uFF90\uFF91\uFF92\uFF93\uFF94\uFF95\uFF96\uFF97\uFF98\uFF99\uFF9A\uFF9B\uFF9C\uFF9D\uFF9E\uFF9F",full:"\u3002\u300C\u300D\u3001\u30FB\u30F2\u30A1\u30A3\u30A5\u30A7\u30A9\u30E3\u30E5\u30E7\u30C3\u30FC\u30A2\u30A4\u30A6\u30A8\u30AA\u30AB\u30AD\u30AF\u30B1\u30B3\u30B5\u30B7\u30B9\u30BB\u30BD\u30BF\u30C1\u30C4\u30C6\u30C8\u30CA\u30CB\u30CC\u30CD\u30CE\u30CF\u30D2\u30D5\u30D8\u30DB\u30DE\u30DF\u30E0\u30E1\u30E2\u30E4\u30E6\u30E8\u30E9\u30EA\u30EB\u30EC\u30ED\u30EF\u30F3\u309B\u309C"},extras:{delta:0,half:"\xA2\xA3\xAC\xAF\xA6\xA5\u20A9 |\u2190\u2191\u2192\u2193\u25A0\xB0",full:"\uFFE0\uFFE1\uFFE2\uFFE3\uFFE4\uFFE5\uFFE6\u3000\uFFE8\uFFE9\uFFEA\uFFEB\uFFEC\uFFED\uFFEE"}},i_=e=>t=>e.delta?String.fromCharCode(t.charCodeAt(0)+e.delta):[...e.full][[...e.half].indexOf(t)],o_=e=>t=>e.delta?String.fromCharCode(t.charCodeAt(0)-e.delta):[...e.half][[...e.full].indexOf(t)],zg=(e,t)=>e[`${t}RE`]||new RegExp(`[${e[t]}]`,"g"),Gg=Object.keys(nf).map(e=>nf[e]),s_=e=>Gg.reduce((t,r)=>t.replace(zg(r,"half"),i_(r)),e),l_=e=>Gg.reduce((t,r)=>t.replace(zg(r,"full"),o_(r)),e),Pt={ASC:e=>(e=He.accept(e,R.STRING),l_(e)),BAHTTEXT:e=>{e=He.accept(e,R.NUMBER);try{return jl.exports.bahttext(e)}catch(t){throw Error(`Error in https://github.com/jojoee/bahttext 
${t.toString()}`)}},CHAR:e=>{if(e=He.accept(e,R.NUMBER),e>255||e<1)throw M.VALUE;return String.fromCharCode(e)},CLEAN:e=>(e=He.accept(e,R.STRING),e.replace(/[\x00-\x1F]/g,"")),CODE:e=>{if(e=He.accept(e,R.STRING),e.length===0)throw M.VALUE;return e.charCodeAt(0)},CONCAT:(...e)=>{let t="";return He.flattenParams(e,R.STRING,!1,r=>{r=He.accept(r,R.STRING),t+=r}),t},CONCATENATE:(...e)=>{let t="";if(e.length===0)throw Error("CONCATENATE need at least one argument.");return e.forEach(r=>{r=He.accept(r,R.STRING),t+=r}),t},DBCS:e=>(e=He.accept(e,R.STRING),s_(e)),DOLLAR:(e,t)=>{e=He.accept(e,R.NUMBER),t=He.accept(t,R.NUMBER,2);const r=Array(t).fill("0").join("");return ma.format(`$#,##0.${r}_);($#,##0.${r})`,e).trim()},EXACT:(e,t)=>(e=He.accept(e,[R.STRING]),t=He.accept(t,[R.STRING]),e===t),FIND:(e,t,r)=>{if(e=He.accept(e,R.STRING),t=He.accept(t,R.STRING),r=He.accept(r,R.NUMBER,1),r<1||r>t.length)throw M.VALUE;const n=t.indexOf(e,r-1);if(n===-1)throw M.VALUE;return n+1},FINDB:(e,t,r)=>Pt.FIND(e,t,r),FIXED:(e,t,r)=>{e=He.accept(e,R.NUMBER),t=He.accept(t,R.NUMBER,2),r=He.accept(r,R.BOOLEAN,!1);const n=Array(t).fill("0").join(""),a=r?"":"#,";return ma.format(`${a}##0.${n}_);(${a}##0.${n})`,e).trim()},LEFT:(e,t)=>{if(e=He.accept(e,R.STRING),t=He.accept(t,R.NUMBER,1),t<0)throw M.VALUE;return t>e.length?e:e.slice(0,t)},LEFTB:(e,t)=>Pt.LEFT(e,t),LEN:e=>(e=He.accept(e,R.STRING),e.length),LENB:e=>Pt.LEN(e),LOWER:e=>(e=He.accept(e,R.STRING),e.toLowerCase()),MID:(e,t,r)=>{if(e=He.accept(e,R.STRING),t=He.accept(t,R.NUMBER),r=He.accept(r,R.NUMBER),t>e.length)return"";if(t<1||r<1)throw M.VALUE;return e.slice(t-1,t+r-1)},MIDB:(e,t,r)=>Pt.MID(e,t,r),NUMBERVALUE:(e,t,r)=>{if(e=He.accept(e,R.STRING),t=He.accept(t,R.STRING,"."),r=He.accept(r,R.STRING,","),e.length===0)return 0;if(t.length===0||r.length===0||(t=t[0],r=r[0],t===r||e.indexOf(t)<e.lastIndexOf(r)))throw M.VALUE;const n=e.replace(r,"").replace(t,".").replace(/[^\-0-9.%()]/g,"").match(/([(-]*)([0-9]*[.]*[0-9]+)([)]?)([%]*)/);if(!n)throw M.VALUE;const a=n[1].length,i=n[3].length,s=n[4].length;let d=Number(n[2]);if(a>1||a&&!i||!a&&i||isNaN(d))throw M.VALUE;return d/=100**s,a?-d:d},PHONETIC:()=>{},PROPER:e=>(e=He.accept(e,[R.STRING]),e=e.toLowerCase(),e=e.charAt(0).toUpperCase()+e.slice(1),e.replace(/(?:[^a-zA-Z])([a-zA-Z])/g,t=>t.toUpperCase())),REPLACE:(e,t,r,n)=>{e=He.accept(e,[R.STRING]),t=He.accept(t,[R.NUMBER]),r=He.accept(r,[R.NUMBER]),n=He.accept(n,[R.STRING]);const a=e.split("");return a.splice(t-1,r,n),a.join("")},REPLACEB:(e,t,r,n)=>Pt.REPLACE(e,t,r,n),REPT:(e,t)=>{e=He.accept(e,R.STRING),t=He.accept(t,R.NUMBER);let r="";for(let n=0;n<t;n++)r+=e;return r},RIGHT:(e,t)=>{if(e=He.accept(e,R.STRING),t=He.accept(t,R.NUMBER,1),t<0)throw M.VALUE;const r=e.length;return t>r?e:e.slice(r-t)},RIGHTB:(e,t)=>Pt.RIGHT(e,t),SEARCH:(e,t,r)=>{if(e=He.accept(e,R.STRING),t=He.accept(t,R.STRING),r=He.accept(r,R.NUMBER,1),r<1||r>t.length)throw M.VALUE;const n=Ir.isWildCard(e)?Ir.toRegex(e,"i"):e,a=t.slice(r-1).search(n);if(a===-1)throw M.VALUE;return a+r},SEARCHB:(e,t,r)=>Pt.SEARCH(e,t,r),SUBSTITUTE:(...e)=>{throw M.NOT_IMPLEMENTED("SUBSTITUTE")},T:e=>(e=He.accept(e),typeof e=="string"?e:""),TEXT:(e,t)=>{e=He.accept(e,R.NUMBER),t=He.accept(t,R.STRING);try{return ma.format(t,e)}catch(r){throw console.error(r),M.VALUE}},TEXTJOIN:(...e)=>{},TRIM:e=>(e=He.accept(e,[R.STRING]),e.replace(/^\s+|\s+$/g,"")),UNICHAR:e=>{if(e=He.accept(e,[R.NUMBER]),e<=0)throw M.VALUE;return String.fromCharCode(e)},UNICODE:e=>Pt.CODE(e)},Rt=Et,fo=1e3*60*60*24,Zl=new Date(Date.UTC(1900,0,1)),c_=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],u_=[void 0,[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],void 0,void 0,void 0,void 0,void 0,void 0,void 0,[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],af=[void 0,[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]],d_=/^\s*(\d\d?)\s*(:\s*\d\d?)?\s*(:\s*\d\d?)?\s*(pm|am)?\s*$/i,f_=/^\s*((\d\d?)\s*([-/])\s*(\d\d?))([\d:.apm\s]*)$/i,h_=/^\s*((\d\d?)\s*([-/])\s*(jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*))([\d:.apm\s]*)$/i,p_=/^\s*((jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*)\s*([-/])\s*(\d\d?))([\d:.apm\s]*)$/i;function g_(e){const t=e.match(f_),r=e.match(h_),n=e.match(p_);return t?e=t[1]+t[3]+new Date().getFullYear()+t[5]:r?e=r[1]+r[3]+new Date().getFullYear()+r[5]:n&&(e=n[1]+n[3]+new Date().getFullYear()+n[5]),new Date(Date.parse(`${e} UTC`))}function m_(e){const t=e.match(d_);if(!t)return null;const r=t[2]?t[2]:":00",n=t[3]?t[3]:":00",a=t[4]?` ${t[4]}`:"",i=new Date(Date.parse(`1/1/1900 ${t[1]+r+n+a} UTC`));let s=new Date;return s=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds())),new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds(),i.getUTCMilliseconds()))}function Rn(e){const t=e>-22038912e5?2:1;return Math.floor((e-Zl.getTime())/864e5)+t}function v_(e){if(e<0)throw M.VALUE;return e<=60?new Date(Zl.getTime()+(e-1)*864e5):new Date(Zl.getTime()+(e-2)*864e5)}function Hg(e){if(e instanceof Date)return{date:e};e=Rt.accept(e);let t=!0,r;return isNaN(e)?(r=m_(e),r?t=!1:r=g_(e)):(e=Number(e),r=v_(e)),{date:r,isDateGiven:t}}function st(e){return Hg(e).date}function cl(e,t){return e.getUTCFullYear()===t.getUTCFullYear()&&e.getUTCMonth()===t.getUTCMonth()&&e.getUTCDate()===t.getUTCDate()}function b_(e){return e===1900?!0:new Date(e,1,29).getMonth()===1}const gn={DATE:(e,t,r)=>{if(e=Rt.accept(e,R.NUMBER),t=Rt.accept(t,R.NUMBER),r=Rt.accept(r,R.NUMBER),e<0||e>=1e4)throw M.NUM;return e<1900&&(e+=1900),Rn(Date.UTC(e,t-1,r))},DATEDIF:(e,t,r)=>{if(e=st(e),t=st(t),r=Rt.accept(r,R.STRING).toLowerCase(),e>t)throw M.NUM;const n=t.getUTCFullYear()-e.getUTCFullYear(),a=t.getUTCMonth()-e.getUTCMonth(),i=t.getUTCDate()-e.getUTCDate();let s;switch(r){case"y":return s=a<0||a===0&&i<0?-1:0,s+n;case"m":return s=i<0?-1:0,n*12+a+s;case"d":return Math.floor(t-e)/fo;case"md":return e.setUTCFullYear(t.getUTCFullYear()),i<0?e.setUTCMonth(t.getUTCMonth()-1):e.setUTCMonth(t.getUTCMonth()),Math.floor(t-e)/fo;case"ym":return s=i<0?-1:0,(s+n*12+a)%12;case"yd":return a<0||a===0&&i<0?e.setUTCFullYear(t.getUTCFullYear()-1):e.setUTCFullYear(t.getUTCFullYear()),Math.floor(t-e)/fo}},DATEVALUE:e=>{e=Rt.accept(e,R.STRING);const{date:t,isDateGiven:r}=Hg(e);if(!r)return 0;const n=Rn(t);if(n<0||n>2958465)throw M.VALUE;return n},DAY:e=>st(e).getUTCDate(),DAYS:(e,t)=>{e=st(e),t=st(t);let r=0;return t<-22038912e5&&e>-22038912e5&&(r=1),Math.floor(e-t)/fo+r},DAYS360:(e,t,r)=>{e=st(e),t=st(t),r=Rt.accept(r,R.BOOLEAN,!1),e.getUTCDate()===31&&e.setUTCDate(30),!r&&e.getUTCDate()<30&&t.getUTCDate()>30?t.setUTCMonth(t.getUTCMonth()+1,1):t.getUTCDate()===31&&t.setUTCDate(30);const n=t.getUTCFullYear()-e.getUTCFullYear(),a=t.getUTCMonth()-e.getUTCMonth(),i=t.getUTCDate()-e.getUTCDate();return a*30+i+n*12*30},EDATE:(e,t)=>(e=st(e),t=Rt.accept(t,R.NUMBER),e.setUTCMonth(e.getUTCMonth()+t),Rn(e)),EOMONTH:(e,t)=>(e=st(e),t=Rt.accept(t,R.NUMBER),e.setUTCMonth(e.getUTCMonth()+t+1,0),Rn(e)),HOUR:e=>st(e).getUTCHours(),ISOWEEKNUM:e=>{const t=st(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),n=r.getUTCDay();r.setUTCDate(r.getUTCDate()+4-n);const a=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r.getTime()-a.getTime())/864e5+1)/7)},MINUTE:e=>st(e).getUTCMinutes(),MONTH:e=>st(e).getUTCMonth()+1,NETWORKDAYS:(e,t,r)=>{e=st(e),t=st(t);let n=1;if(e>t){n=-1;const s=e;e=t,t=s}const a=[];r!=null&&Rt.flattenParams([r],R.NUMBER,!1,s=>{a.push(st(s))});let i=0;for(;e<=t;){if(e.getUTCDay()!==0&&e.getUTCDay()!==6){let s=!1;for(let d=0;d<a.length;d++)if(cl(e,a[d])){s=!0;break}s||i++}e.setUTCDate(e.getUTCDate()+1)}return n*i},"NETWORKDAYS.INTL":(e,t,r,n)=>{e=st(e),t=st(t);let a=1;if(e>t){a=-1;const d=e;e=t,t=d}if(r=Rt.accept(r,null,1),r==="1111111")return 0;if(typeof r=="string"&&Number(r).toString()!==r){if(r.length!==7)throw M.VALUE;r=r.charAt(6)+r.slice(0,6);const d=[];for(let h=0;h<r.length;h++)r.charAt(h)==="1"&&d.push(h);r=d}else{if(typeof r!="number")throw M.VALUE;r=af[r]}const i=[];n!=null&&Rt.flattenParams([n],R.NUMBER,!1,d=>{i.push(st(d))});let s=0;for(;e<=t;){let d=!1;for(let h=0;h<r.length;h++)if(r[h]===e.getUTCDay()){d=!0;break}if(!d){let h=!1;for(let c=0;c<i.length;c++)if(cl(e,i[c])){h=!0;break}h||s++}e.setUTCDate(e.getUTCDate()+1)}return a*s},NOW:()=>{const e=new Date;return Rn(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))+(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},SECOND:e=>st(e).getUTCSeconds(),TIME:(e,t,r)=>{if(e=Rt.accept(e,R.NUMBER),t=Rt.accept(t,R.NUMBER),r=Rt.accept(r,R.NUMBER),e<0||e>32767||t<0||t>32767||r<0||r>32767)throw M.NUM;return(3600*e+60*t+r)/86400},TIMEVALUE:e=>(e=st(e),(3600*e.getUTCHours()+60*e.getUTCMinutes()+e.getUTCSeconds())/86400),TODAY:()=>{const e=new Date;return Rn(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))},WEEKDAY:(e,t)=>{const r=st(e);t=Rt.accept(t,R.NUMBER,1);const n=r.getUTCDay(),a=u_[t];if(!a)throw M.NUM;return a[n]},WEEKNUM:(e,t)=>{const r=st(e);if(t=Rt.accept(t,R.NUMBER,1),t===21)return gn.ISOWEEKNUM(e);const n=c_[t],a=new Date(Date.UTC(r.getUTCFullYear(),0,1)),i=a.getUTCDay()<n?1:0;return Math.ceil(((r-a.getTime())/864e5+1)/7)+i},WORKDAY:(e,t,r)=>gn["WORKDAY.INTL"](e,t,1,r),"WORKDAY.INTL":(e,t,r,n)=>{if(e=st(e),t=Rt.accept(t,R.NUMBER),r=Rt.accept(r,null,1),r==="1111111")throw M.VALUE;if(typeof r=="string"&&Number(r).toString()!==r){if(r.length!==7)throw M.VALUE;r=r.charAt(6)+r.slice(0,6);const s=[];for(let d=0;d<r.length;d++)r.charAt(d)==="1"&&s.push(d);r=s}else{if(typeof r!="number")throw M.VALUE;if(r=af[r],r==null)throw M.NUM}const a=[];n!=null&&Rt.flattenParams([n],R.NUMBER,!1,s=>{a.push(st(s))}),e.setUTCDate(e.getUTCDate()+1);let i=0;for(;i<t;){let s=!1;for(let d=0;d<r.length;d++)if(r[d]===e.getUTCDay()){s=!0;break}if(!s){let d=!1;for(let h=0;h<a.length;h++)if(cl(e,a[h])){d=!0;break}d||i++}e.setUTCDate(e.getUTCDate()+1)}return Rn(e)-1},YEAR:e=>st(e).getUTCFullYear(),YEARFRAC:(e,t,r)=>{if(e=st(e),t=st(t),e>t){const c=e;e=t,t=c}if(r=Rt.accept(r,R.NUMBER,0),r=Math.trunc(r),r<0||r>4)throw M.VALUE;let n=e.getUTCDate();const a=e.getUTCMonth()+1,i=e.getUTCFullYear();let s=t.getUTCDate();const d=t.getUTCMonth()+1,h=t.getUTCFullYear();switch(r){case 0:return n===31&&s===31?(n=30,s=30):n===31?n=30:n===30&&s===31&&(s=30),Math.abs(s+d*30+h*360-(n+a*30+i*360))/360;case 1:if(h-i<2){const u=b_(i)&&i!==1900?366:365;return gn.DAYS(t,e)/u}const c=h-i+1,l=(new Date(h+1,0,1).getTime()-new Date(i,0,1).getTime())/1e3/60/60/24/c;return gn.DAYS(t,e)/l;case 2:return Math.abs(gn.DAYS(t,e)/360);case 3:return Math.abs(gn.DAYS(t,e)/365);case 4:return Math.abs(s+d*30+h*360-(n+a*30+i*360))/360}throw M.VALUE}},y_={unaryOp:(e,t,r)=>{let n=1;if(e.forEach(a=>{if(a!=="+")if(a==="-")n=-n;else throw new Error(`Unrecognized prefix: ${a}`)}),t==null&&(t=0),n===1)return t;try{t=Et.acceptNumber(t,r)}catch(a){if(a instanceof M)Array.isArray(t)&&(t=t[0][0]);else throw a}return typeof t=="number"&&isNaN(t)?M.VALUE:-t}},E_={percentOp:(e,t,r)=>{try{e=Et.acceptNumber(e,r)}catch(n){if(n instanceof M)return n;throw n}if(t==="%")return e/100;throw new Error(`Unrecognized postfix: ${t}`)}},dn={boolean:3,string:2,number:1},va={compareOp:(e,t,r,n,a)=>{e==null&&(e=0),r==null&&(r=0),n&&(e=e[0][0]),a&&(r=r[0][0]);const i=typeof e,s=typeof r;if(i===s)switch(t){case"=":return e===r;case">":return e>r;case"<":return e<r;case"<>":return e!==r;case"<=":return e<=r;case">=":return e>=r}else switch(t){case"=":return!1;case">":return dn[i]>dn[s];case"<":return dn[i]<dn[s];case"<>":return!0;case"<=":return dn[i]<=dn[s];case">=":return dn[i]>=dn[s]}throw Error("Infix.compareOp: Should not reach here.")},concatOp:(e,t,r,n,a)=>{e==null&&(e=""),r==null&&(r=""),n&&(e=e[0][0]),a&&(r=r[0][0]);const i=typeof e,s=typeof r;return i==="boolean"&&(e=e?"TRUE":"FALSE"),s==="boolean"&&(r=r?"TRUE":"FALSE"),`${e}${r}`},mathOp:(e,t,r,n,a)=>{e==null&&(e=0),r==null&&(r=0);try{e=Et.acceptNumber(e,n),r=Et.acceptNumber(r,a)}catch(i){if(i instanceof M)return i;throw i}switch(t){case"+":return e+r;case"-":return e-r;case"*":return e*r;case"/":return r===0?M.DIV0:e/r;case"^":return e**r}throw Error("Infix.mathOp: Should not reach here.")}},ul={compareOp:["<",">","=","<>","<=",">="],concatOp:["&"],mathOp:["+","-","*","/","^"]},Re=Et,dl=[],fl=[];function Ao(e){return e<=100?Vg[e]:dl[e]>0?dl[e]:dl[e]=Ao(e-1)*e}function Wg(e){return e===1||e===0?1:e===2?2:fl[e]>0?fl[e]:fl[e]=Wg(e-2)*e}const Lt={ABS:e=>(e=Re.accept(e,R.NUMBER),Math.abs(e)),AGGREGATE:(e,t,r,...n)=>{},ARABIC:e=>{if(e=Re.accept(e,R.STRING).toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))throw new M("#VALUE!","Invalid roman numeral in ARABIC evaluation.");let t=0;const r={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,n=>{t+=r[n]}),t},BASE:(e,t,r)=>{if(e=Re.accept(e,R.NUMBER),e<0||e>=2**53||(t=Re.accept(t,R.NUMBER),t<2||t>36)||(r=Re.accept(r,R.NUMBER,0),r<0))throw M.NUM;const n=e.toString(t).toUpperCase();return new Array(Math.max(r+1-n.length,0)).join("0")+n},CEILING:(e,t)=>{if(e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER),t===0)return 0;if(e/t%1===0)return e;const r=Math.abs(t),n=Math.floor(Math.abs(e)/r);return e<0?t<0?-r*(n+1):-r*n:(n+1)*r},"CEILING.MATH":(e,t,r)=>{if(e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER,e>0?1:-1),r=Re.accept(r,R.NUMBER,0),e>=0)return Lt.CEILING(e,t);const n=r?t:0;return Lt.CEILING(e,t)-n},"CEILING.PRECISE":(e,t)=>(e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER,1),Lt.CEILING(e,Math.abs(t))),COMBIN:(e,t)=>{if(e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER),e<0||t<0||e<t)throw M.NUM;const r=Lt.FACT(e),n=Lt.FACT(t);return r/n/Lt.FACT(e-t)},COMBINA:(e,t)=>{if(e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER),(e===0||e===1)&&t===0)return 1;if(e<0||t<0)throw M.NUM;return Lt.COMBIN(e+t-1,e-1)},DECIMAL:(e,t)=>{if(e=Re.accept(e,R.STRING),t=Re.accept(t,R.NUMBER),t=Math.trunc(t),t<2||t>36)throw M.NUM;const r=parseInt(e,t);if(isNaN(r))throw M.NUM;return r},DEGREES:e=>(e=Re.accept(e,R.NUMBER),e*(180/Math.PI)),EVEN:e=>Lt.CEILING(e,-2),EXP:e=>(e=Re.accept(e,R.NUMBER),Math.exp(e)),FACT:e=>{if(e=Re.accept(e,R.NUMBER),e=Math.trunc(e),e>170||e<0)throw M.NUM;return e<=100?Vg[e]:Ao(e)},FACTDOUBLE:e=>{if(e=Re.accept(e,R.NUMBER),e=Math.trunc(e),e<-1)throw M.NUM;return e===-1?1:Wg(e)},FLOOR:(e,t)=>{if(e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER),t===0)return 0;if(e>0&&t<0)throw M.NUM;if(e/t%1===0)return e;const r=Math.abs(t),n=Math.floor(Math.abs(e)/r);return e<0?t<0?-r*n:-r*(n+1):n*r},"FLOOR.MATH":(e,t,r)=>(e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER,e>0?1:-1),r=Re.accept(r,R.NUMBER,0),r===0||e>=0?Lt.FLOOR(e,Math.abs(t)):Lt.FLOOR(e,t)+t),"FLOOR.PRECISE":(e,t)=>(e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER,1),Lt.FLOOR(e,Math.abs(t))),GCD:(...e)=>{const t=[];Re.flattenParams(e,null,!1,s=>{if(s=typeof s=="boolean"?NaN:Number(s),isNaN(s))throw M.VALUE;if(s<0||s>9007199254740990)throw M.NUM;t.push(Math.trunc(s))},0);let r,n;const a=e.length;let i=Math.abs(t[0]);for(r=1;r<a;r++){for(n=Math.abs(t[r]);i&&n;)i>n?i%=n:n%=i;i+=n}return i},INT:e=>(e=Re.accept(e,R.NUMBER),Math.floor(e)),"ISO.CEILING":(e,t)=>Lt["CEILING.PRECISE"](e,t),LCM:(...e)=>{const t=[];Re.flattenParams(e,null,!1,a=>{if(a=typeof a=="boolean"?NaN:Number(a),isNaN(a))throw M.VALUE;if(a<0||a>9007199254740990)throw M.NUM;t.push(Math.trunc(a))},1);const r=t.length;let n=Math.abs(t[0]);for(let a=1;a<r;a++){let i=Math.abs(t[a]);const s=n;for(;n&&i;)n>i?n%=i:i%=n;n=Math.abs(s*t[a])/(n+i)}return n},LN:e=>(e=Re.accept(e,R.NUMBER),Math.log(e)),LOG:(e,t)=>(e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER,10),Math.log(e)/Math.log(t)),LOG10:e=>(e=Re.accept(e,R.NUMBER),Math.log10(e)),MDETERM:e=>{if(e=Re.accept(e,R.ARRAY,void 0,!1,!0),e[0].length!==e.length)throw M.VALUE;const t=e.length,r=e[0].length;let n=0,a,i;if(t===1)return e[0][0];if(t===2)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(let s=0;s<r;s++){a=e[0][s],i=e[0][s];for(let d=1;d<t;d++)i*=e[d][((s+d)%r+r)%r],a*=e[d][((s-d)%r+r)%r];n+=i-a}return n},MINVERSE:e=>{},MMULT:(e,t)=>{e=Re.accept(e,R.ARRAY,void 0,!1,!0),t=Re.accept(t,R.ARRAY,void 0,!1,!0);const r=e.length,n=e[0].length,a=t.length,i=t[0].length,s=new Array(r);if(n!==a)throw M.VALUE;for(let d=0;d<r;d++){s[d]=new Array(i);for(let h=0;h<i;h++){s[d][h]=0;for(let c=0;c<n;c++){const o=e[d][c],l=t[c][h];if(typeof o!="number"||typeof l!="number")throw M.VALUE;s[d][h]+=e[d][c]*t[c][h]}}}return s},MOD:(e,t)=>{if(e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER),t===0)throw M.DIV0;return e-t*Lt.INT(e/t)},MROUND:(e,t)=>{if(e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER),t===0)return 0;if(e>0&&t<0||e<0&&t>0)throw M.NUM;return e/t%1===0?e:Math.round(e/t)*t},MULTINOMIAL:(...e)=>{let t=0,r=1;return Re.flattenParams(e,R.NUMBER,!1,n=>{if(n<0)throw M.NUM;t+=n,r*=Ao(n)}),Ao(t)/r},MUNIT:e=>{e=Re.accept(e,R.NUMBER);const t=[];for(let r=0;r<e;r++){const n=[];for(let a=0;a<e;a++)r===a?n.push(1):n.push(0);t.push(n)}return t},ODD:e=>{if(e=Re.accept(e,R.NUMBER),e===0)return 1;let t=Math.ceil(Math.abs(e));return t=t&1?t:t+1,e>0?t:-t},PI:()=>Math.PI,POWER:(e,t)=>(e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER),e**t),PRODUCT:(...e)=>{let t=1;return Re.flattenParams(e,null,!0,(r,n)=>{const a=Number(r);n.isLiteral&&!isNaN(a)?t*=a:typeof r=="number"&&(t*=r)},1),t},QUOTIENT:(e,t)=>(e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER),Math.trunc(e/t)),RADIANS:e=>(e=Re.accept(e,R.NUMBER),e/180*Math.PI),RAND:()=>Math.random(),RANDBETWEEN:(e,t)=>(e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER),Math.floor(Math.random()*(t-e+1)+e)),ROMAN:(e,t)=>{if(e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER,0),t!==0)throw Error("ROMAN: only allows form=0 (classic form).");const r=String(e).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let a="",i=3;for(;i--;)a=(n[+r.pop()+i*10]||"")+a;return new Array(+r.join("")+1).join("M")+a},ROUND:(e,t)=>{e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER);const r=10**Math.abs(t),n=e>0?1:-1;return t>0?n*Math.round(Math.abs(e)*r)/r:t===0?n*Math.round(Math.abs(e)):n*Math.round(Math.abs(e)/r)*r},ROUNDDOWN:(e,t)=>{e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER);const r=10**Math.abs(t),n=e>0?1:-1;if(t>0){const i=1/r*.5;return n*Math.round((Math.abs(e)-i)*r)/r}if(t===0)return n*Math.round(Math.abs(e)-.5);const a=r*.5;return n*Math.round((Math.abs(e)-a)/r)*r},ROUNDUP:(e,t)=>{e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER);const r=10**Math.abs(t),n=e>0?1:-1;if(t>0){const i=1/r*.5;return n*Math.round((Math.abs(e)+i)*r)/r}if(t===0)return n*Math.round(Math.abs(e)+.5);const a=r*.5;return n*Math.round((Math.abs(e)+a)/r)*r},SERIESSUM:(e,t,r,n)=>{e=Re.accept(e,R.NUMBER),t=Re.accept(t,R.NUMBER),r=Re.accept(r,R.NUMBER);let a=0,i;return Re.flattenParams([n],R.NUMBER,!1,s=>{if(typeof s!="number")throw M.VALUE;a===0?i=s*e**t:i+=s*e**(t+a*r),a++}),i},SIGN:e=>(e=Re.accept(e,R.NUMBER),e>0?1:e===0?0:-1),SQRT:e=>{if(e=Re.accept(e,R.NUMBER),e<0)throw M.NUM;return Math.sqrt(e)},SQRTPI:e=>{if(e=Re.accept(e,R.NUMBER),e<0)throw M.NUM;return Math.sqrt(e*Math.PI)},SUBTOTAL:()=>{},SUM:(...e)=>{let t=0;return Re.flattenParams(e,R.NUMBER,!0,(r,n)=>{n.isLiteral||typeof r=="number"?t+=r:Rr(r)&&(t+=Number(r))}),t},SUMIF:(e,t,r,n)=>{const a=Re.retrieveRanges(e,t,n);t=a[0],n=a[1],r=Re.retrieveArg(e,r);const i=r.isArray;r=Ql.parse(Re.accept(r));let s=0;return t.forEach((d,h)=>{d.forEach((c,o)=>{const l=n[h][o];typeof l=="number"&&(r.op==="wc"?r.match===r.value.test(c)&&(s+=l):va.compareOp(c,r.op,r.value,Array.isArray(c),i)&&(s+=l))})}),s},SUMIFS:()=>{},SUMPRODUCT:(e,...t)=>{e=Re.accept(e,R.ARRAY,void 0,!1,!0),t.forEach(n=>{if(n=Re.accept(n,R.ARRAY,void 0,!1,!0),e[0].length!==n[0].length||e.length!==n.length)throw M.VALUE;for(let a=0;a<e.length;a++)for(let i=0;i<e[0].length;i++)typeof e[a][i]!="number"&&(e[a][i]=0),typeof n[a][i]!="number"&&(n[a][i]=0),e[a][i]*=n[a][i]});let r=0;return e.forEach(n=>{n.forEach(a=>{r+=a})}),r},SUMSQ:(...e)=>{let t=0;return Re.flattenParams(e,R.NUMBER,!0,(r,n)=>{(n.isLiteral||typeof r=="number")&&(t+=r**2)}),t},SUMX2MY2:(e,t)=>{const r=[],n=[];let a=0;if(Re.flattenParams([e],null,!1,(i,s)=>{r.push(i)}),Re.flattenParams([t],null,!1,(i,s)=>{n.push(i)}),r.length!==n.length)throw M.NA;for(let i=0;i<r.length;i++)typeof r[i]=="number"&&typeof n[i]=="number"&&(a+=r[i]**2-n[i]**2);return a},SUMX2PY2:(e,t)=>{const r=[],n=[];let a=0;if(Re.flattenParams([e],null,!1,(i,s)=>{r.push(i)}),Re.flattenParams([t],null,!1,(i,s)=>{n.push(i)}),r.length!==n.length)throw M.NA;for(let i=0;i<r.length;i++)typeof r[i]=="number"&&typeof n[i]=="number"&&(a+=r[i]**2+n[i]**2);return a},SUMXMY2:(e,t)=>{const r=[],n=[];let a=0;if(Re.flattenParams([e],null,!1,(i,s)=>{r.push(i)}),Re.flattenParams([t],null,!1,(i,s)=>{n.push(i)}),r.length!==n.length)throw M.NA;for(let i=0;i<r.length;i++)typeof r[i]=="number"&&typeof n[i]=="number"&&(a+=(r[i]-n[i])**2);return a},TRUNC:e=>(e=Re.accept(e,R.NUMBER),Math.trunc(e))},Ct=Et,ra=2**27-1,of={ACOS:e=>{if(e=Ct.accept(e,R.NUMBER),e>1||e<-1)throw M.NUM;return Math.acos(e)},ACOSH:e=>{if(e=Ct.accept(e,R.NUMBER),e<1)throw M.NUM;return Math.acosh(e)},ACOT:e=>(e=Ct.accept(e,R.NUMBER),Math.PI/2-Math.atan(e)),ACOTH:e=>{if(e=Ct.accept(e,R.NUMBER),Math.abs(e)<=1)throw M.NUM;return Math.atanh(1/e)},ASIN:e=>{if(e=Ct.accept(e,R.NUMBER),e>1||e<-1)throw M.NUM;return Math.asin(e)},ASINH:e=>(e=Ct.accept(e,R.NUMBER),Math.asinh(e)),ATAN:e=>(e=Ct.accept(e,R.NUMBER),Math.atan(e)),ATAN2:(e,t)=>{if(e=Ct.accept(e,R.NUMBER),t=Ct.accept(t,R.NUMBER),t===0&&e===0)throw M.DIV0;return Math.atan2(t,e)},ATANH:e=>{if(e=Ct.accept(e,R.NUMBER),Math.abs(e)>1)throw M.NUM;return Math.atanh(e)},COS:e=>{if(e=Ct.accept(e,R.NUMBER),Math.abs(e)>ra)throw M.NUM;return Math.cos(e)},COSH:e=>(e=Ct.accept(e,R.NUMBER),Math.cosh(e)),COT:e=>{if(e=Ct.accept(e,R.NUMBER),Math.abs(e)>ra)throw M.NUM;if(e===0)throw M.DIV0;return 1/Math.tan(e)},COTH:e=>{if(e=Ct.accept(e,R.NUMBER),e===0)throw M.DIV0;return 1/Math.tanh(e)},CSC:e=>{if(e=Ct.accept(e,R.NUMBER),Math.abs(e)>ra)throw M.NUM;return 1/Math.sin(e)},CSCH:e=>{if(e=Ct.accept(e,R.NUMBER),e===0)throw M.DIV0;return 1/Math.sinh(e)},SEC:e=>{if(e=Ct.accept(e,R.NUMBER),Math.abs(e)>ra)throw M.NUM;return 1/Math.cos(e)},SECH:e=>(e=Ct.accept(e,R.NUMBER),1/Math.cosh(e)),SIN:e=>{if(e=Ct.accept(e,R.NUMBER),Math.abs(e)>ra)throw M.NUM;return Math.sin(e)},SINH:e=>(e=Ct.accept(e,R.NUMBER),Math.sinh(e)),TAN:e=>{if(e=Ct.accept(e,R.NUMBER),Math.abs(e)>ra)throw M.NUM;return Math.tan(e)},TANH:e=>(e=Ct.accept(e,R.NUMBER),Math.tanh(e))},br=Et;function hl(e){let t=0,r=0;return br.flattenParams(e,null,!0,n=>{const a=typeof n;a==="string"?n==="TRUE"?n=!0:n==="FALSE"&&(n=!1):a==="number"&&(n=Boolean(n)),typeof n=="boolean"&&(n===!0?t++:r++)}),[t,r]}const sf={AND:(...e)=>{const[t,r]=hl(e);return t===0&&r===0?M.VALUE:t>0&&r===0},FALSE:()=>!1,IF:(e,t,r,n)=>(t=br.accept(t,R.BOOLEAN),r=br.accept(r),n=br.accept(n,null,!1),t?r:n),IFERROR:(e,t)=>e.value instanceof M?br.accept(t):br.accept(e),IFNA(e,t){if(arguments.length>2)throw M.TOO_MANY_ARGS("IFNA");return M.NA.equals(e.value)?br.accept(t):br.accept(e)},IFS:(...e)=>{if(e.length%2!==0)return new M("#N/A","IFS expects all arguments after position 0 to be in pairs.");for(let t=0;t<e.length/2;t++){const r=br.accept(e[t*2],R.BOOLEAN),n=br.accept(e[t*2+1]);if(r)return n}return M.NA},NOT:e=>(e=br.accept(e,R.BOOLEAN),!e),OR:(...e)=>{const[t,r]=hl(e);return t===0&&r===0?M.VALUE:t>0},SWITCH:(...e)=>{},TRUE:()=>!0,XOR:(...e)=>{const[t,r]=hl(e);return t===0&&r===0?M.VALUE:t%2===1}};var ii={};(function(e){(function(t){t(typeof DO_NOT_EXPORT_BESSEL=="undefined"?e:{})})(function(t){t.version="1.0.2";var r=Math;function n(o,l){for(var u=0,f=0;u<o.length;++u)f=l*f+o[u];return f}function a(o,l,u,f,m){if(l===0)return u;if(l===1)return f;for(var g=2/o,b=f,v=1;v<l;++v)b=f*v*g+m*u,u=f,f=b;return b}function i(o,l,u,f,m){return function(b,v){if(f){if(b===0)return f==1?-1/0:1/0;if(b<0)return NaN}if(v===0)return o(b);if(v===1)return l(b);if(v<0)return NaN;v|=0;var w=o(b),y=l(b);return a(b,v,w,y,m)}}var s=function(){var o=.636619772,l=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),u=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),f=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),m=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function g(T){var A=0,x=0,C=0,N=T*T;if(T<8)x=n(l,N),C=n(u,N),A=x/C;else{var P=T-.785398164;N=64/N,x=n(f,N),C=n(m,N),A=r.sqrt(o/T)*(r.cos(P)*x-r.sin(P)*C*8/T)}return A}var b=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),v=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),w=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),y=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function _(T){var A=0,x=0,C=0,N=T*T,P=r.abs(T)-2.356194491;return Math.abs(T)<8?(x=T*n(b,N),C=n(v,N),A=x/C):(N=64/N,x=n(w,N),C=n(y,N),A=r.sqrt(o/r.abs(T))*(r.cos(P)*x-r.sin(P)*C*8/r.abs(T)),T<0&&(A=-A)),A}return function T(A,x){if(x=Math.round(x),!isFinite(A))return isNaN(A)?A:0;if(x<0)return(x%2?-1:1)*T(A,-x);if(A<0)return(x%2?-1:1)*T(-A,x);if(x===0)return g(A);if(x===1)return _(A);if(A===0)return 0;var C=0;if(A>x)C=a(A,x,g(A),_(A),-1);else{for(var N=2*r.floor((x+r.floor(r.sqrt(40*x)))/2),P=!1,z=0,K=0,q=1,W=0,ce=2/A,V=N;V>0;V--)W=V*ce*q-z,z=q,q=W,r.abs(q)>1e10&&(q*=1e-10,z*=1e-10,C*=1e-10,K*=1e-10),P&&(K+=q),P=!P,V==x&&(C=z);K=2*K-q,C/=K}return C}}(),d=function(){var o=.636619772,l=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),u=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),f=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),m=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function g(T){var A=0,x=0,C=0,N=T*T,P=T-.785398164;return T<8?(x=n(l,N),C=n(u,N),A=x/C+o*s(T,0)*r.log(T)):(N=64/N,x=n(f,N),C=n(m,N),A=r.sqrt(o/T)*(r.sin(P)*x+r.cos(P)*C*8/T)),A}var b=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),v=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),w=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),y=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function _(T){var A=0,x=0,C=0,N=T*T,P=T-2.356194491;return T<8?(x=T*n(b,N),C=n(v,N),A=x/C+o*(s(T,1)*r.log(T)-1/T)):(N=64/N,x=n(w,N),C=n(y,N),A=r.sqrt(o/T)*(r.sin(P)*x+r.cos(P)*C*8/T)),A}return i(g,_,"BESSELY",1,-1)}(),h=function(){var o=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),l=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function u(b){return b<=3.75?n(o,b*b/(3.75*3.75)):r.exp(r.abs(b))/r.sqrt(r.abs(b))*n(l,3.75/r.abs(b))}var f=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),m=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function g(b){return b<3.75?b*n(f,b*b/(3.75*3.75)):(b<0?-1:1)*r.exp(r.abs(b))/r.sqrt(r.abs(b))*n(m,3.75/r.abs(b))}return function b(v,w){if(w=Math.round(w),w===0)return u(v);if(w===1)return g(v);if(w<0)return NaN;if(r.abs(v)===0)return 0;if(v==1/0)return 1/0;var y=0,_,T=2/r.abs(v),A=0,x=1,C=0,N=2*r.round((w+r.round(r.sqrt(40*w)))/2);for(_=N;_>0;_--)C=_*T*x+A,A=x,x=C,r.abs(x)>1e10&&(x*=1e-10,A*=1e-10,y*=1e-10),_==w&&(y=A);return y*=b(v,0)/x,v<0&&w%2?-y:y}}(),c=function(){var o=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),l=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function u(b){return b<=2?-r.log(b/2)*h(b,0)+n(o,b*b/4):r.exp(-b)/r.sqrt(b)*n(l,2/b)}var f=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),m=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function g(b){return b<=2?r.log(b/2)*h(b,1)+1/b*n(f,b*b/4):r.exp(-b)/r.sqrt(b)*n(m,2/b)}return i(u,g,"BESSELK",2,1)}();t.besselj=s,t.bessely=d,t.besseli=h,t.besselk=c})})(ii);var Kg={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Ae,function(){var r=function(n,a){var i=Array.prototype.concat,s=Array.prototype.slice,d=Object.prototype.toString;function h(w,y){var _=w>y?w:y;return n.pow(10,17-~~(n.log(_>0?_:-_)*n.LOG10E))}var c=Array.isArray||function(y){return d.call(y)==="[object Array]"};function o(w){return d.call(w)==="[object Function]"}function l(w){return typeof w=="number"?w-w===0:!1}function u(w){return i.apply([],w)}function f(){return new f._init(arguments)}f.fn=f.prototype,f._init=function(y){if(c(y[0]))if(c(y[0][0])){o(y[1])&&(y[0]=f.map(y[0],y[1]));for(var _=0;_<y[0].length;_++)this[_]=y[0][_];this.length=y[0].length}else this[0]=o(y[1])?f.map(y[0],y[1]):y[0],this.length=1;else if(l(y[0]))this[0]=f.seq.apply(null,y),this.length=1;else{if(y[0]instanceof f)return f(y[0].toArray());this[0]=[],this.length=1}return this},f._init.prototype=f.prototype,f._init.constructor=f,f.utils={calcRdx:h,isArray:c,isFunction:o,isNumber:l,toVector:u},f._random_fn=n.random,f.setRandom=function(y){if(typeof y!="function")throw new TypeError("fn is not a function");f._random_fn=y},f.extend=function(y){var _,T;if(arguments.length===1){for(T in y)f[T]=y[T];return this}for(_=1;_<arguments.length;_++)for(T in arguments[_])y[T]=arguments[_][T];return y},f.rows=function(y){return y.length||1},f.cols=function(y){return y[0].length||1},f.dimensions=function(y){return{rows:f.rows(y),cols:f.cols(y)}},f.row=function(y,_){return c(_)?_.map(function(T){return f.row(y,T)}):y[_]},f.rowa=function(y,_){return f.row(y,_)},f.col=function(y,_){if(c(_)){var T=f.arange(y.length).map(function(){return new Array(_.length)});return _.forEach(function(C,N){f.arange(y.length).forEach(function(P){T[P][N]=y[P][C]})}),T}for(var A=new Array(y.length),x=0;x<y.length;x++)A[x]=[y[x][_]];return A},f.cola=function(y,_){return f.col(y,_).map(function(T){return T[0]})},f.diag=function(y){for(var _=f.rows(y),T=new Array(_),A=0;A<_;A++)T[A]=[y[A][A]];return T},f.antidiag=function(y){for(var _=f.rows(y)-1,T=new Array(_),A=0;_>=0;_--,A++)T[A]=[y[A][_]];return T},f.transpose=function(y){var _=[],T,A,x,C,N;for(c(y[0])||(y=[y]),A=y.length,x=y[0].length,N=0;N<x;N++){for(T=new Array(A),C=0;C<A;C++)T[C]=y[C][N];_.push(T)}return _.length===1?_[0]:_},f.map=function(y,_,T){var A,x,C,N,P;for(c(y[0])||(y=[y]),x=y.length,C=y[0].length,N=T?y:new Array(x),A=0;A<x;A++)for(N[A]||(N[A]=new Array(C)),P=0;P<C;P++)N[A][P]=_(y[A][P],A,P);return N.length===1?N[0]:N},f.cumreduce=function(y,_,T){var A,x,C,N,P;for(c(y[0])||(y=[y]),x=y.length,C=y[0].length,N=T?y:new Array(x),A=0;A<x;A++)for(N[A]||(N[A]=new Array(C)),C>0&&(N[A][0]=y[A][0]),P=1;P<C;P++)N[A][P]=_(N[A][P-1],y[A][P]);return N.length===1?N[0]:N},f.alter=function(y,_){return f.map(y,_,!0)},f.create=function(y,_,T){var A=new Array(y),x,C;for(o(_)&&(T=_,_=y),x=0;x<y;x++)for(A[x]=new Array(_),C=0;C<_;C++)A[x][C]=T(x,C);return A};function m(){return 0}f.zeros=function(y,_){return l(_)||(_=y),f.create(y,_,m)};function g(){return 1}f.ones=function(y,_){return l(_)||(_=y),f.create(y,_,g)},f.rand=function(y,_){return l(_)||(_=y),f.create(y,_,f._random_fn)};function b(w,y){return w===y?1:0}f.identity=function(y,_){return l(_)||(_=y),f.create(y,_,b)},f.symmetric=function(y){var _=y.length,T,A;if(y.length!==y[0].length)return!1;for(T=0;T<_;T++)for(A=0;A<_;A++)if(y[A][T]!==y[T][A])return!1;return!0},f.clear=function(y){return f.alter(y,m)},f.seq=function(y,_,T,A){o(A)||(A=!1);var x=[],C=h(y,_),N=(_*C-y*C)/((T-1)*C),P=y,z;for(z=0;P<=_&&z<T;z++,P=(y*C+N*C*z)/C)x.push(A?A(P,z):P);return x},f.arange=function(y,_,T){var A=[],x;if(T=T||1,_===a&&(_=y,y=0),y===_||T===0)return[];if(y<_&&T<0)return[];if(y>_&&T>0)return[];if(T>0)for(x=y;x<_;x+=T)A.push(x);else for(x=y;x>_;x+=T)A.push(x);return A},f.slice=function(){function w(_,T,A,x){var C,N=[],P=_.length;if(T===a&&A===a&&x===a)return f.copy(_);if(T=T||0,A=A||_.length,T=T>=0?T:P+T,A=A>=0?A:P+A,x=x||1,T===A||x===0)return[];if(T<A&&x<0)return[];if(T>A&&x>0)return[];if(x>0)for(C=T;C<A;C+=x)N.push(_[C]);else for(C=T;C>A;C+=x)N.push(_[C]);return N}function y(_,T){var A,x;if(T=T||{},l(T.row)){if(l(T.col))return _[T.row][T.col];var C=f.rowa(_,T.row);return A=T.col||{},w(C,A.start,A.end,A.step)}if(l(T.col)){var N=f.cola(_,T.col);return x=T.row||{},w(N,x.start,x.end,x.step)}x=T.row||{},A=T.col||{};var P=w(_,x.start,x.end,x.step);return P.map(function(z){return w(z,A.start,A.end,A.step)})}return y}(),f.sliceAssign=function(y,_,T){var A,x;if(l(_.row)){if(l(_.col))return y[_.row][_.col]=T;_.col=_.col||{},_.col.start=_.col.start||0,_.col.end=_.col.end||y[0].length,_.col.step=_.col.step||1,A=f.arange(_.col.start,n.min(y.length,_.col.end),_.col.step);var C=_.row;return A.forEach(function(P,z){y[C][P]=T[z]}),y}if(l(_.col)){_.row=_.row||{},_.row.start=_.row.start||0,_.row.end=_.row.end||y.length,_.row.step=_.row.step||1,x=f.arange(_.row.start,n.min(y[0].length,_.row.end),_.row.step);var N=_.col;return x.forEach(function(P,z){y[P][N]=T[z]}),y}return T[0].length===a&&(T=[T]),_.row.start=_.row.start||0,_.row.end=_.row.end||y.length,_.row.step=_.row.step||1,_.col.start=_.col.start||0,_.col.end=_.col.end||y[0].length,_.col.step=_.col.step||1,x=f.arange(_.row.start,n.min(y.length,_.row.end),_.row.step),A=f.arange(_.col.start,n.min(y[0].length,_.col.end),_.col.step),x.forEach(function(P,z){A.forEach(function(K,q){y[P][K]=T[z][q]})}),y},f.diagonal=function(y){var _=f.zeros(y.length,y.length);return y.forEach(function(T,A){_[A][A]=T}),_},f.copy=function(y){return y.map(function(_){return l(_)?_:_.map(function(T){return T})})};var v=f.prototype;return v.length=0,v.push=Array.prototype.push,v.sort=Array.prototype.sort,v.splice=Array.prototype.splice,v.slice=Array.prototype.slice,v.toArray=function(){return this.length>1?s.call(this):s.call(this)[0]},v.map=function(y,_){return f(f.map(this,y,_))},v.cumreduce=function(y,_){return f(f.cumreduce(this,y,_))},v.alter=function(y){return f.alter(this,y),this},function(w){for(var y=0;y<w.length;y++)(function(_){v[_]=function(T){var A=this,x;return T?(setTimeout(function(){T.call(A,v[_].call(A))}),this):(x=f[_](this),c(x)?f(x):x)}})(w[y])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(w){for(var y=0;y<w.length;y++)(function(_){v[_]=function(T,A){var x=this;return A?(setTimeout(function(){A.call(x,v[_].call(x,T))}),this):f(f[_](this,T))}})(w[y])}("row col".split(" ")),function(w){for(var y=0;y<w.length;y++)(function(_){v[_]=function(){return f(f[_].apply(null,arguments))}})(w[y])}("create zeros ones rand identity".split(" ")),f}(Math);return function(n,a){var i=n.utils.isFunction;function s(c,o){return c-o}function d(c,o,l){return a.max(o,a.min(c,l))}n.sum=function(o){for(var l=0,u=o.length;--u>=0;)l+=o[u];return l},n.sumsqrd=function(o){for(var l=0,u=o.length;--u>=0;)l+=o[u]*o[u];return l},n.sumsqerr=function(o){for(var l=n.mean(o),u=0,f=o.length,m;--f>=0;)m=o[f]-l,u+=m*m;return u},n.sumrow=function(o){for(var l=0,u=o.length;--u>=0;)l+=o[u];return l},n.product=function(o){for(var l=1,u=o.length;--u>=0;)l*=o[u];return l},n.min=function(o){for(var l=o[0],u=0;++u<o.length;)o[u]<l&&(l=o[u]);return l},n.max=function(o){for(var l=o[0],u=0;++u<o.length;)o[u]>l&&(l=o[u]);return l},n.unique=function(o){for(var l={},u=[],f=0;f<o.length;f++)l[o[f]]||(l[o[f]]=!0,u.push(o[f]));return u},n.mean=function(o){return n.sum(o)/o.length},n.meansqerr=function(o){return n.sumsqerr(o)/o.length},n.geomean=function(o){return a.pow(n.product(o),1/o.length)},n.median=function(o){var l=o.length,u=o.slice().sort(s);return l&1?u[l/2|0]:(u[l/2-1]+u[l/2])/2},n.cumsum=function(o){return n.cumreduce(o,function(l,u){return l+u})},n.cumprod=function(o){return n.cumreduce(o,function(l,u){return l*u})},n.diff=function(o){var l=[],u=o.length,f;for(f=1;f<u;f++)l.push(o[f]-o[f-1]);return l},n.rank=function(c){var o,l=[],u={};for(o=0;o<c.length;o++){var f=c[o];u[f]?u[f]++:(u[f]=1,l.push(f))}var m=l.sort(s),g={},b=1;for(o=0;o<m.length;o++){var f=m[o],v=u[f],w=b,y=b+v-1,_=(w+y)/2;g[f]=_,b+=v}return c.map(function(T){return g[T]})},n.mode=function(o){var l=o.length,u=o.slice().sort(s),f=1,m=0,g=0,b=[],v;for(v=0;v<l;v++)u[v]===u[v+1]?f++:(f>m?(b=[u[v]],m=f,g=0):f===m&&(b.push(u[v]),g++),f=1);return g===0?b[0]:b},n.range=function(o){return n.max(o)-n.min(o)},n.variance=function(o,l){return n.sumsqerr(o)/(o.length-(l?1:0))},n.pooledvariance=function(o){var l=o.reduce(function(f,m){return f+n.sumsqerr(m)},0),u=o.reduce(function(f,m){return f+m.length},0);return l/(u-o.length)},n.deviation=function(c){for(var o=n.mean(c),l=c.length,u=new Array(l),f=0;f<l;f++)u[f]=c[f]-o;return u},n.stdev=function(o,l){return a.sqrt(n.variance(o,l))},n.pooledstdev=function(o){return a.sqrt(n.pooledvariance(o))},n.meandev=function(o){for(var l=n.mean(o),u=[],f=o.length-1;f>=0;f--)u.push(a.abs(o[f]-l));return n.mean(u)},n.meddev=function(o){for(var l=n.median(o),u=[],f=o.length-1;f>=0;f--)u.push(a.abs(o[f]-l));return n.median(u)},n.coeffvar=function(o){return n.stdev(o)/n.mean(o)},n.quartiles=function(o){var l=o.length,u=o.slice().sort(s);return[u[a.round(l/4)-1],u[a.round(l/2)-1],u[a.round(l*3/4)-1]]},n.quantiles=function(o,l,u,f){var m=o.slice().sort(s),g=[l.length],b=o.length,v,w,y,_,T,A;for(typeof u=="undefined"&&(u=3/8),typeof f=="undefined"&&(f=3/8),v=0;v<l.length;v++)w=l[v],y=u+w*(1-u-f),_=b*w+y,T=a.floor(d(_,1,b-1)),A=d(_-T,0,1),g[v]=(1-A)*m[T-1]+A*m[T];return g},n.percentile=function(o,l,u){var f=o.slice().sort(s),m=l*(f.length+(u?1:-1))+(u?0:1),g=parseInt(m),b=m-g;return g+1<f.length?f[g-1]+b*(f[g]-f[g-1]):f[g-1]},n.percentileOfScore=function(o,l,u){var f=0,m=o.length,g=!1,b,v;for(u==="strict"&&(g=!0),v=0;v<m;v++)b=o[v],(g&&b<l||!g&&b<=l)&&f++;return f/m},n.histogram=function(o,l){l=l||4;var u=n.min(o),f=(n.max(o)-u)/l,m=o.length,g=[],b;for(b=0;b<l;b++)g[b]=0;for(b=0;b<m;b++)g[a.min(a.floor((o[b]-u)/f),l-1)]+=1;return g},n.covariance=function(o,l){var u=n.mean(o),f=n.mean(l),m=o.length,g=new Array(m),b;for(b=0;b<m;b++)g[b]=(o[b]-u)*(l[b]-f);return n.sum(g)/(m-1)},n.corrcoeff=function(o,l){return n.covariance(o,l)/n.stdev(o,1)/n.stdev(l,1)},n.spearmancoeff=function(c,o){return c=n.rank(c),o=n.rank(o),n.corrcoeff(c,o)},n.stanMoment=function(o,l){for(var u=n.mean(o),f=n.stdev(o),m=o.length,g=0,b=0;b<m;b++)g+=a.pow((o[b]-u)/f,l);return g/o.length},n.skewness=function(o){return n.stanMoment(o,3)},n.kurtosis=function(o){return n.stanMoment(o,4)-3};var h=n.prototype;(function(c){for(var o=0;o<c.length;o++)(function(l){h[l]=function(u,f){var m=[],g=0,b=this;if(i(u)&&(f=u,u=!1),f)return setTimeout(function(){f.call(b,h[l].call(b,u))}),this;if(this.length>1){for(b=u===!0?this:this.transpose();g<b.length;g++)m[g]=n[l](b[g]);return m}return n[l](this[0],u)}})(c[o])})("cumsum cumprod".split(" ")),function(c){for(var o=0;o<c.length;o++)(function(l){h[l]=function(u,f){var m=[],g=0,b=this;if(i(u)&&(f=u,u=!1),f)return setTimeout(function(){f.call(b,h[l].call(b,u))}),this;if(this.length>1){for(l!=="sumrow"&&(b=u===!0?this:this.transpose());g<b.length;g++)m[g]=n[l](b[g]);return u===!0?n[l](n.utils.toVector(m)):m}return n[l](this[0],u)}})(c[o])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(c){for(var o=0;o<c.length;o++)(function(l){h[l]=function(){var u=[],f=0,m=this,g=Array.prototype.slice.call(arguments),b;if(i(g[g.length-1])){b=g[g.length-1];var v=g.slice(0,g.length-1);return setTimeout(function(){b.call(m,h[l].apply(m,v))}),this}else{b=void 0;var w=function(_){return n[l].apply(m,[_].concat(g))}}if(this.length>1){for(m=m.transpose();f<m.length;f++)u[f]=w(m[f]);return u}return w(this[0])}})(c[o])}("quantiles percentileOfScore".split(" "))}(r,Math),function(n,a){n.gammaln=function(s){var d=0,h=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],c=1.000000000190015,o,l,u;for(u=(l=o=s)+5.5,u-=(o+.5)*a.log(u);d<6;d++)c+=h[d]/++l;return a.log(2.5066282746310007*c/o)-u},n.loggam=function(s){var d,h,c,o,l,u,f,m=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(d=s,f=0,s==1||s==2)return 0;for(s<=7&&(f=a.floor(7-s),d=s+f),h=1/(d*d),c=2*a.PI,l=m[9],u=8;u>=0;u--)l*=h,l+=m[u];if(o=l/d+.5*a.log(c)+(d-.5)*a.log(d)-d,s<=7)for(u=1;u<=f;u++)o-=a.log(d-1),d-=1;return o},n.gammafn=function(s){var d=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],h=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],c=!1,o=0,l=0,u=0,f=s,m,g,b,v;if(s>171.6243769536076)return 1/0;if(f<=0)if(v=f%1+36e-17,v)c=(f&1?-1:1)*a.PI/a.sin(a.PI*v),f=1-f;else return 1/0;for(b=f,f<1?g=f++:g=(f-=o=(f|0)-1)-1,m=0;m<8;++m)u=(u+d[m])*g,l=l*g+h[m];if(v=u/l+1,b<f)v/=b;else if(b>f)for(m=0;m<o;++m)v*=f,f++;return c&&(v=c/v),v},n.gammap=function(s,d){return n.lowRegGamma(s,d)*n.gammafn(s)},n.lowRegGamma=function(s,d){var h=n.gammaln(s),c=s,o=1/s,l=o,u=d+1-s,f=1/1e-30,m=1/u,g=m,b=1,v=-~(a.log(s>=1?s:1/s)*8.5+s*.4+17),w;if(d<0||s<=0)return NaN;if(d<s+1){for(;b<=v;b++)o+=l*=d/++c;return o*a.exp(-d+s*a.log(d)-h)}for(;b<=v;b++)w=-b*(b-s),u+=2,m=w*m+u,f=u+w/f,m=1/m,g*=m*f;return 1-g*a.exp(-d+s*a.log(d)-h)},n.factorialln=function(s){return s<0?NaN:n.gammaln(s+1)},n.factorial=function(s){return s<0?NaN:n.gammafn(s+1)},n.combination=function(s,d){return s>170||d>170?a.exp(n.combinationln(s,d)):n.factorial(s)/n.factorial(d)/n.factorial(s-d)},n.combinationln=function(s,d){return n.factorialln(s)-n.factorialln(d)-n.factorialln(s-d)},n.permutation=function(s,d){return n.factorial(s)/n.factorial(s-d)},n.betafn=function(s,d){if(!(s<=0||d<=0))return s+d>170?a.exp(n.betaln(s,d)):n.gammafn(s)*n.gammafn(d)/n.gammafn(s+d)},n.betaln=function(s,d){return n.gammaln(s)+n.gammaln(d)-n.gammaln(s+d)},n.betacf=function(s,d,h){var c=1e-30,o=1,l=d+h,u=d+1,f=d-1,m=1,g=1-l*s/u,b,v,w,y;for(a.abs(g)<c&&(g=c),g=1/g,y=g;o<=100&&(b=2*o,v=o*(h-o)*s/((f+b)*(d+b)),g=1+v*g,a.abs(g)<c&&(g=c),m=1+v/m,a.abs(m)<c&&(m=c),g=1/g,y*=g*m,v=-(d+o)*(l+o)*s/((d+b)*(u+b)),g=1+v*g,a.abs(g)<c&&(g=c),m=1+v/m,a.abs(m)<c&&(m=c),g=1/g,w=g*m,y*=w,!(a.abs(w-1)<3e-7));o++);return y},n.gammapinv=function(s,d){var h=0,c=d-1,o=1e-8,l=n.gammaln(d),u,f,m,g,b,v,w;if(s>=1)return a.max(100,d+100*a.sqrt(d));if(s<=0)return 0;for(d>1?(v=a.log(c),w=a.exp(c*(v-1)-l),b=s<.5?s:1-s,m=a.sqrt(-2*a.log(b)),u=(2.30753+m*.27061)/(1+m*(.99229+m*.04481))-m,s<.5&&(u=-u),u=a.max(.001,d*a.pow(1-1/(9*d)-u/(3*a.sqrt(d)),3))):(m=1-d*(.253+d*.12),s<m?u=a.pow(s/m,1/d):u=1-a.log(1-(s-m)/(1-m)));h<12;h++){if(u<=0)return 0;if(f=n.lowRegGamma(d,u)-s,d>1?m=w*a.exp(-(u-c)+c*(a.log(u)-v)):m=a.exp(-u+c*a.log(u)-l),g=f/m,u-=m=g/(1-.5*a.min(1,g*((d-1)/u-1))),u<=0&&(u=.5*(u+m)),a.abs(m)<o*u)break}return u},n.erf=function(s){var d=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],h=d.length-1,c=!1,o=0,l=0,u,f,m,g;for(s<0&&(s=-s,c=!0),u=2/(2+s),f=4*u-2;h>0;h--)m=o,o=f*o-l+d[h],l=m;return g=u*a.exp(-s*s+.5*(d[0]+f*o)-l),c?g-1:1-g},n.erfc=function(s){return 1-n.erf(s)},n.erfcinv=function(s){var d=0,h,c,o,l;if(s>=2)return-100;if(s<=0)return 100;for(l=s<1?s:2-s,o=a.sqrt(-2*a.log(l/2)),h=-.70711*((2.30753+o*.27061)/(1+o*(.99229+o*.04481))-o);d<2;d++)c=n.erfc(h)-l,h+=c/(1.1283791670955126*a.exp(-h*h)-h*c);return s<1?h:-h},n.ibetainv=function(s,d,h){var c=1e-8,o=d-1,l=h-1,u=0,f,m,g,b,v,w,y,_,T,A,x;if(s<=0)return 0;if(s>=1)return 1;for(d>=1&&h>=1?(g=s<.5?s:1-s,b=a.sqrt(-2*a.log(g)),y=(2.30753+b*.27061)/(1+b*(.99229+b*.04481))-b,s<.5&&(y=-y),_=(y*y-3)/6,T=2/(1/(2*d-1)+1/(2*h-1)),A=y*a.sqrt(_+T)/T-(1/(2*h-1)-1/(2*d-1))*(_+5/6-2/(3*T)),y=d/(d+h*a.exp(2*A))):(f=a.log(d/(d+h)),m=a.log(h/(d+h)),b=a.exp(d*f)/d,v=a.exp(h*m)/h,A=b+v,s<b/A?y=a.pow(d*A*s,1/d):y=1-a.pow(h*A*(1-s),1/h)),x=-n.gammaln(d)-n.gammaln(h)+n.gammaln(d+h);u<10;u++){if(y===0||y===1)return y;if(w=n.ibeta(y,d,h)-s,b=a.exp(o*a.log(y)+l*a.log(1-y)+x),v=w/b,y-=b=v/(1-.5*a.min(1,v*(o/y-l/(1-y)))),y<=0&&(y=.5*(y+b)),y>=1&&(y=.5*(y+b+1)),a.abs(b)<c*y&&u>0)break}return y},n.ibeta=function(s,d,h){var c=s===0||s===1?0:a.exp(n.gammaln(d+h)-n.gammaln(d)-n.gammaln(h)+d*a.log(s)+h*a.log(1-s));return s<0||s>1?!1:s<(d+1)/(d+h+2)?c*n.betacf(s,d,h)/d:1-c*n.betacf(1-s,h,d)/h},n.randn=function(s,d){var h,c,o,l,u;if(d||(d=s),s)return n.create(s,d,function(){return n.randn()});do h=n._random_fn(),c=1.7156*(n._random_fn()-.5),o=h-.449871,l=a.abs(c)+.386595,u=o*o+l*(.196*l-.25472*o);while(u>.27597&&(u>.27846||c*c>-4*a.log(h)*h*h));return c/h},n.randg=function(s,d,h){var c=s,o,l,u,f,m,g;if(h||(h=d),s||(s=1),d)return g=n.zeros(d,h),g.alter(function(){return n.randg(s)}),g;s<1&&(s+=1),o=s-1/3,l=1/a.sqrt(9*o);do{do m=n.randn(),f=1+l*m;while(f<=0);f=f*f*f,u=n._random_fn()}while(u>1-.331*a.pow(m,4)&&a.log(u)>.5*m*m+o*(1-f+a.log(f)));if(s==c)return o*f;do u=n._random_fn();while(u===0);return a.pow(u,1/c)*o*f},function(i){for(var s=0;s<i.length;s++)(function(d){n.fn[d]=function(){return n(n.map(this,function(h){return n[d](h)}))}})(i[s])}("gammaln gammafn factorial factorialln".split(" ")),function(i){for(var s=0;s<i.length;s++)(function(d){n.fn[d]=function(){return n(n[d].apply(null,arguments))}})(i[s])}("randn".split(" "))}(r,Math),function(n,a){(function(c){for(var o=0;o<c.length;o++)(function(l){n[l]=function u(f,m,g){return this instanceof u?(this._a=f,this._b=m,this._c=g,this):new u(f,m,g)},n.fn[l]=function(u,f,m){var g=n[l](u,f,m);return g.data=this,g},n[l].prototype.sample=function(u){var f=this._a,m=this._b,g=this._c;return u?n.alter(u,function(){return n[l].sample(f,m,g)}):n[l].sample(f,m,g)},function(u){for(var f=0;f<u.length;f++)(function(m){n[l].prototype[m]=function(g){var b=this._a,v=this._b,w=this._c;return!g&&g!==0&&(g=this.data),typeof g!="number"?n.fn.map.call(g,function(y){return n[l][m](y,b,v,w)}):n[l][m](g,b,v,w)}})(u[f])}("pdf cdf inv".split(" ")),function(u){for(var f=0;f<u.length;f++)(function(m){n[l].prototype[m]=function(){return n[l][m](this._a,this._b,this._c)}})(u[f])}("mean median mode variance".split(" "))})(c[o])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),n.extend(n.beta,{pdf:function(o,l,u){return o>1||o<0?0:l==1&&u==1?1:l<512&&u<512?a.pow(o,l-1)*a.pow(1-o,u-1)/n.betafn(l,u):a.exp((l-1)*a.log(o)+(u-1)*a.log(1-o)-n.betaln(l,u))},cdf:function(o,l,u){return o>1||o<0?(o>1)*1:n.ibeta(o,l,u)},inv:function(o,l,u){return n.ibetainv(o,l,u)},mean:function(o,l){return o/(o+l)},median:function(o,l){return n.ibetainv(.5,o,l)},mode:function(o,l){return(o-1)/(o+l-2)},sample:function(o,l){var u=n.randg(o);return u/(u+n.randg(l))},variance:function(o,l){return o*l/(a.pow(o+l,2)*(o+l+1))}}),n.extend(n.centralF,{pdf:function(o,l,u){var f,m,g;return o<0?0:l<=2?o===0&&l<2?1/0:o===0&&l===2?1:1/n.betafn(l/2,u/2)*a.pow(l/u,l/2)*a.pow(o,l/2-1)*a.pow(1+l/u*o,-(l+u)/2):(f=l*o/(u+o*l),m=u/(u+o*l),g=l*m/2,g*n.binomial.pdf((l-2)/2,(l+u-2)/2,f))},cdf:function(o,l,u){return o<0?0:n.ibeta(l*o/(l*o+u),l/2,u/2)},inv:function(o,l,u){return u/(l*(1/n.ibetainv(o,l/2,u/2)-1))},mean:function(o,l){return l>2?l/(l-2):void 0},mode:function(o,l){return o>2?l*(o-2)/(o*(l+2)):void 0},sample:function(o,l){var u=n.randg(o/2)*2,f=n.randg(l/2)*2;return u/o/(f/l)},variance:function(o,l){if(!(l<=4))return 2*l*l*(o+l-2)/(o*(l-2)*(l-2)*(l-4))}}),n.extend(n.cauchy,{pdf:function(o,l,u){return u<0?0:u/(a.pow(o-l,2)+a.pow(u,2))/a.PI},cdf:function(o,l,u){return a.atan((o-l)/u)/a.PI+.5},inv:function(c,o,l){return o+l*a.tan(a.PI*(c-.5))},median:function(o){return o},mode:function(o){return o},sample:function(o,l){return n.randn()*a.sqrt(1/(2*n.randg(.5)))*l+o}}),n.extend(n.chisquare,{pdf:function(o,l){return o<0?0:o===0&&l===2?.5:a.exp((l/2-1)*a.log(o)-o/2-l/2*a.log(2)-n.gammaln(l/2))},cdf:function(o,l){return o<0?0:n.lowRegGamma(l/2,o/2)},inv:function(c,o){return 2*n.gammapinv(c,.5*o)},mean:function(c){return c},median:function(o){return o*a.pow(1-2/(9*o),3)},mode:function(o){return o-2>0?o-2:0},sample:function(o){return n.randg(o/2)*2},variance:function(o){return 2*o}}),n.extend(n.exponential,{pdf:function(o,l){return o<0?0:l*a.exp(-l*o)},cdf:function(o,l){return o<0?0:1-a.exp(-l*o)},inv:function(c,o){return-a.log(1-c)/o},mean:function(c){return 1/c},median:function(c){return 1/c*a.log(2)},mode:function(){return 0},sample:function(o){return-1/o*a.log(n._random_fn())},variance:function(c){return a.pow(c,-2)}}),n.extend(n.gamma,{pdf:function(o,l,u){return o<0?0:o===0&&l===1?1/u:a.exp((l-1)*a.log(o)-o/u-n.gammaln(l)-l*a.log(u))},cdf:function(o,l,u){return o<0?0:n.lowRegGamma(l,o/u)},inv:function(c,o,l){return n.gammapinv(c,o)*l},mean:function(c,o){return c*o},mode:function(o,l){if(o>1)return(o-1)*l},sample:function(o,l){return n.randg(o)*l},variance:function(o,l){return o*l*l}}),n.extend(n.invgamma,{pdf:function(o,l,u){return o<=0?0:a.exp(-(l+1)*a.log(o)-u/o-n.gammaln(l)+l*a.log(u))},cdf:function(o,l,u){return o<=0?0:1-n.lowRegGamma(l,u/o)},inv:function(c,o,l){return l/n.gammapinv(1-c,o)},mean:function(c,o){return c>1?o/(c-1):void 0},mode:function(o,l){return l/(o+1)},sample:function(o,l){return l/n.randg(o)},variance:function(o,l){if(!(o<=2))return l*l/((o-1)*(o-1)*(o-2))}}),n.extend(n.kumaraswamy,{pdf:function(o,l,u){return o===0&&l===1?u:o===1&&u===1?l:a.exp(a.log(l)+a.log(u)+(l-1)*a.log(o)+(u-1)*a.log(1-a.pow(o,l)))},cdf:function(o,l,u){return o<0?0:o>1?1:1-a.pow(1-a.pow(o,l),u)},inv:function(o,l,u){return a.pow(1-a.pow(1-o,1/u),1/l)},mean:function(c,o){return o*n.gammafn(1+1/c)*n.gammafn(o)/n.gammafn(1+1/c+o)},median:function(o,l){return a.pow(1-a.pow(2,-1/l),1/o)},mode:function(o,l){if(o>=1&&l>=1&&o!==1&&l!==1)return a.pow((o-1)/(o*l-1),1/o)},variance:function(){throw new Error("variance not yet implemented")}}),n.extend(n.lognormal,{pdf:function(o,l,u){return o<=0?0:a.exp(-a.log(o)-.5*a.log(2*a.PI)-a.log(u)-a.pow(a.log(o)-l,2)/(2*u*u))},cdf:function(o,l,u){return o<0?0:.5+.5*n.erf((a.log(o)-l)/a.sqrt(2*u*u))},inv:function(c,o,l){return a.exp(-1.4142135623730951*l*n.erfcinv(2*c)+o)},mean:function(o,l){return a.exp(o+l*l/2)},median:function(o){return a.exp(o)},mode:function(o,l){return a.exp(o-l*l)},sample:function(o,l){return a.exp(n.randn()*l+o)},variance:function(o,l){return(a.exp(l*l)-1)*a.exp(2*o+l*l)}}),n.extend(n.noncentralt,{pdf:function(o,l,u){var f=1e-14;return a.abs(u)<f?n.studentt.pdf(o,l):a.abs(o)<f?a.exp(n.gammaln((l+1)/2)-u*u/2-.5*a.log(a.PI*l)-n.gammaln(l/2)):l/o*(n.noncentralt.cdf(o*a.sqrt(1+2/l),l+2,u)-n.noncentralt.cdf(o,l,u))},cdf:function(o,l,u){var f=1e-14,m=200;if(a.abs(u)<f)return n.studentt.cdf(o,l);var g=!1;o<0&&(g=!0,u=-u);for(var b=n.normal.cdf(-u,0,1),v=f+1,w=v,y=o*o/(o*o+l),_=0,T=a.exp(-u*u/2),A=a.exp(-u*u/2-.5*a.log(2)-n.gammaln(3/2))*u;_<m||w>f||v>f;)w=v,_>0&&(T*=u*u/(2*_),A*=u*u/(2*(_+1/2))),v=T*n.beta.cdf(y,_+.5,l/2)+A*n.beta.cdf(y,_+1,l/2),b+=.5*v,_++;return g?1-b:b}}),n.extend(n.normal,{pdf:function(o,l,u){return a.exp(-.5*a.log(2*a.PI)-a.log(u)-a.pow(o-l,2)/(2*u*u))},cdf:function(o,l,u){return .5*(1+n.erf((o-l)/a.sqrt(2*u*u)))},inv:function(c,o,l){return-1.4142135623730951*l*n.erfcinv(2*c)+o},mean:function(c){return c},median:function(o){return o},mode:function(c){return c},sample:function(o,l){return n.randn()*l+o},variance:function(c,o){return o*o}}),n.extend(n.pareto,{pdf:function(o,l,u){return o<l?0:u*a.pow(l,u)/a.pow(o,u+1)},cdf:function(o,l,u){return o<l?0:1-a.pow(l/o,u)},inv:function(o,l,u){return l/a.pow(1-o,1/u)},mean:function(o,l){if(!(l<=1))return l*a.pow(o,l)/(l-1)},median:function(o,l){return o*(l*a.SQRT2)},mode:function(o){return o},variance:function(c,o){if(!(o<=2))return c*c*o/(a.pow(o-1,2)*(o-2))}}),n.extend(n.studentt,{pdf:function(o,l){return l=l>1e100?1e100:l,1/(a.sqrt(l)*n.betafn(.5,l/2))*a.pow(1+o*o/l,-((l+1)/2))},cdf:function(o,l){var u=l/2;return n.ibeta((o+a.sqrt(o*o+l))/(2*a.sqrt(o*o+l)),u,u)},inv:function(c,o){var l=n.ibetainv(2*a.min(c,1-c),.5*o,.5);return l=a.sqrt(o*(1-l)/l),c>.5?l:-l},mean:function(o){return o>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(o){return n.randn()*a.sqrt(o/(2*n.randg(o/2)))},variance:function(o){return o>2?o/(o-2):o>1?1/0:void 0}}),n.extend(n.weibull,{pdf:function(o,l,u){return o<0||l<0||u<0?0:u/l*a.pow(o/l,u-1)*a.exp(-a.pow(o/l,u))},cdf:function(o,l,u){return o<0?0:1-a.exp(-a.pow(o/l,u))},inv:function(c,o,l){return o*a.pow(-a.log(1-c),1/l)},mean:function(c,o){return c*n.gammafn(1+1/o)},median:function(o,l){return o*a.pow(a.log(2),1/l)},mode:function(o,l){return l<=1?0:o*a.pow((l-1)/l,1/l)},sample:function(o,l){return o*a.pow(-a.log(n._random_fn()),1/l)},variance:function(o,l){return o*o*n.gammafn(1+2/l)-a.pow(n.weibull.mean(o,l),2)}}),n.extend(n.uniform,{pdf:function(o,l,u){return o<l||o>u?0:1/(u-l)},cdf:function(o,l,u){return o<l?0:o<u?(o-l)/(u-l):1},inv:function(c,o,l){return o+c*(l-o)},mean:function(o,l){return .5*(o+l)},median:function(o,l){return n.mean(o,l)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,l){return o/2+l/2+(l/2-o/2)*(2*n._random_fn()-1)},variance:function(o,l){return a.pow(l-o,2)/12}});function i(c,o,l,u){for(var f=0,m=1,g=1,b=1,v=0,w=0,y;a.abs((g-w)/g)>u;)w=g,y=-(o+v)*(o+l+v)*c/(o+2*v)/(o+2*v+1),f=g+y*f,m=b+y*m,v=v+1,y=v*(l-v)*c/(o+2*v-1)/(o+2*v),g=f+y*g,b=m+y*b,f=f/b,m=m/b,g=g/b,b=1;return g/o}n.extend(n.binomial,{pdf:function(o,l,u){return u===0||u===1?l*u===o?1:0:n.combination(l,o)*a.pow(u,o)*a.pow(1-u,l-o)},cdf:function(o,l,u){var f,m=1e-10;if(o<0)return 0;if(o>=l)return 1;if(u<0||u>1||l<=0)return NaN;o=a.floor(o);var g=u,b=o+1,v=l-o,w=b+v,y=a.exp(n.gammaln(w)-n.gammaln(v)-n.gammaln(b)+b*a.log(g)+v*a.log(1-g));return g<(b+1)/(w+2)?f=y*i(g,b,v,m):f=1-y*i(1-g,v,b,m),a.round((1-f)*(1/m))/(1/m)}}),n.extend(n.negbin,{pdf:function(o,l,u){return o!==o>>>0?!1:o<0?0:n.combination(o+l-1,l-1)*a.pow(1-u,o)*a.pow(u,l)},cdf:function(o,l,u){var f=0,m=0;if(o<0)return 0;for(;m<=o;m++)f+=n.negbin.pdf(m,l,u);return f}}),n.extend(n.hypgeom,{pdf:function(o,l,u,f){if(o!==o|0)return!1;if(o<0||o<u-(l-f))return 0;if(o>f||o>u)return 0;if(u*2>l)return f*2>l?n.hypgeom.pdf(l-u-f+o,l,l-u,l-f):n.hypgeom.pdf(f-o,l,l-u,f);if(f*2>l)return n.hypgeom.pdf(u-o,l,u,l-f);if(u<f)return n.hypgeom.pdf(o,l,f,u);for(var m=1,g=0,b=0;b<o;b++){for(;m>1&&g<f;)m*=1-u/(l-g),g++;m*=(f-b)*(u-b)/((b+1)*(l-u-f+b+1))}for(;g<f;g++)m*=1-u/(l-g);return a.min(1,a.max(0,m))},cdf:function(o,l,u,f){if(o<0||o<u-(l-f))return 0;if(o>=f||o>=u)return 1;if(u*2>l)return f*2>l?n.hypgeom.cdf(l-u-f+o,l,l-u,l-f):1-n.hypgeom.cdf(f-o-1,l,l-u,f);if(f*2>l)return 1-n.hypgeom.cdf(u-o-1,l,u,l-f);if(u<f)return n.hypgeom.cdf(o,l,f,u);for(var m=1,g=1,b=0,v=0;v<o;v++){for(;m>1&&b<f;){var w=1-u/(l-b);g*=w,m*=w,b++}g*=(f-v)*(u-v)/((v+1)*(l-u-f+v+1)),m+=g}for(;b<f;b++)m*=1-u/(l-b);return a.min(1,a.max(0,m))}}),n.extend(n.poisson,{pdf:function(o,l){return l<0||o%1!==0||o<0?0:a.pow(l,o)*a.exp(-l)/n.factorial(o)},cdf:function(o,l){var u=[],f=0;if(o<0)return 0;for(;f<=o;f++)u.push(n.poisson.pdf(f,l));return n.sum(u)},mean:function(c){return c},variance:function(c){return c},sampleSmall:function(o){var l=1,u=0,f=a.exp(-o);do u++,l*=n._random_fn();while(l>f);return u-1},sampleLarge:function(o){var l=o,u,f,m,g,b,v,w,y,_,T;for(g=a.sqrt(l),b=a.log(l),w=.931+2.53*g,v=-.059+.02483*w,y=1.1239+1.1328/(w-3.4),_=.9277-3.6224/(w-2);;){if(f=a.random()-.5,m=a.random(),T=.5-a.abs(f),u=a.floor((2*v/T+w)*f+l+.43),T>=.07&&m<=_)return u;if(!(u<0||T<.013&&m>T)&&a.log(m)+a.log(y)-a.log(v/(T*T)+w)<=-l+u*b-n.loggam(u+1))return u}},sample:function(o){return o<10?this.sampleSmall(o):this.sampleLarge(o)}}),n.extend(n.triangular,{pdf:function(o,l,u,f){return u<=l||f<l||f>u?NaN:o<l||o>u?0:o<f?2*(o-l)/((u-l)*(f-l)):o===f?2/(u-l):2*(u-o)/((u-l)*(u-f))},cdf:function(o,l,u,f){return u<=l||f<l||f>u?NaN:o<=l?0:o>=u?1:o<=f?a.pow(o-l,2)/((u-l)*(f-l)):1-a.pow(u-o,2)/((u-l)*(u-f))},inv:function(o,l,u,f){return u<=l||f<l||f>u?NaN:o<=(f-l)/(u-l)?l+(u-l)*a.sqrt(o*((f-l)/(u-l))):l+(u-l)*(1-a.sqrt((1-o)*(1-(f-l)/(u-l))))},mean:function(o,l,u){return(o+l+u)/3},median:function(o,l,u){if(u<=(o+l)/2)return l-a.sqrt((l-o)*(l-u))/a.sqrt(2);if(u>(o+l)/2)return o+a.sqrt((l-o)*(u-o))/a.sqrt(2)},mode:function(o,l,u){return u},sample:function(o,l,u){var f=n._random_fn();return f<(u-o)/(l-o)?o+a.sqrt(f*(l-o)*(u-o)):l-a.sqrt((1-f)*(l-o)*(l-u))},variance:function(o,l,u){return(o*o+l*l+u*u-o*l-o*u-l*u)/18}}),n.extend(n.arcsine,{pdf:function(o,l,u){return u<=l?NaN:o<=l||o>=u?0:2/a.PI*a.pow(a.pow(u-l,2)-a.pow(2*o-l-u,2),-.5)},cdf:function(o,l,u){return o<l?0:o<u?2/a.PI*a.asin(a.sqrt((o-l)/(u-l))):1},inv:function(c,o,l){return o+(.5-.5*a.cos(a.PI*c))*(l-o)},mean:function(o,l){return l<=o?NaN:(o+l)/2},median:function(o,l){return l<=o?NaN:(o+l)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,l){return(o+l)/2+(l-o)/2*a.sin(2*a.PI*n.uniform.sample(0,1))},variance:function(o,l){return l<=o?NaN:a.pow(l-o,2)/8}});function s(c){return c/a.abs(c)}n.extend(n.laplace,{pdf:function(o,l,u){return u<=0?0:a.exp(-a.abs(o-l)/u)/(2*u)},cdf:function(o,l,u){return u<=0?0:o<l?.5*a.exp((o-l)/u):1-.5*a.exp(-(o-l)/u)},mean:function(c){return c},median:function(c){return c},mode:function(c){return c},variance:function(c,o){return 2*o*o},sample:function(o,l){var u=n._random_fn()-.5;return o-l*s(u)*a.log(1-2*a.abs(u))}});function d(c,o,l){var u=12,f=6,m=-30,g=-50,b=60,v=8,w=3,y=2,_=3,T=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],A=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],x=c*.5;if(x>=v)return 1;var C=2*n.normal.cdf(x,0,1,1,0)-1;C>=a.exp(g/l)?C=a.pow(C,l):C=0;var N;c>w?N=y:N=_;for(var P=x,z=(v-x)/N,K=P+z,q=0,W=l-1,ce=1;ce<=N;ce++){for(var V=0,G=.5*(K+P),j=.5*(K-P),ie=1;ie<=u;ie++){var fe,ve;f<ie?(fe=u-ie+1,ve=T[fe-1]):(fe=ie,ve=-T[fe-1]);var xe=j*ve,Te=G+xe,Me=Te*Te;if(Me>b)break;var J=2*n.normal.cdf(Te,0,1,1,0),S=2*n.normal.cdf(Te,c,1,1,0),I=J*.5-S*.5;I>=a.exp(m/W)&&(I=A[fe-1]*a.exp(-(.5*Me))*a.pow(I,W),V+=I)}V*=2*j*l/a.sqrt(2*a.PI),q+=V,P=K,K+=z}return C+=q,C<=a.exp(m/o)?0:(C=a.pow(C,o),C>=1?1:C)}function h(c,o,l){var u=.322232421088,f=.099348462606,m=-1,g=.588581570495,b=-.342242088547,v=.531103462366,w=-.204231210125,y=.10353775285,_=-453642210148e-16,T=.0038560700634,A=.8832,x=.2368,C=1.214,N=1.208,P=1.4142,z=120,K=.5-.5*c,q=a.sqrt(a.log(1/(K*K))),W=q+((((q*_+w)*q+b)*q+m)*q+u)/((((q*T+y)*q+v)*q+g)*q+f);l<z&&(W+=(W*W*W+W)/l/4);var ce=A-x*W;return l<z&&(ce+=-C/l+N*W/l),W*(ce*a.log(o-1)+P)}n.extend(n.tukey,{cdf:function(o,l,u){var f=1,m=l,g=16,b=8,v=-30,w=1e-14,y=100,_=800,T=5e3,A=25e3,x=1,C=.5,N=.25,P=.125,z=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],K=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(o<=0)return 0;if(u<2||f<1||m<2)return NaN;if(!Number.isFinite(o))return 1;if(u>A)return d(o,f,m);var q=u*.5,W=q*a.log(u)-u*a.log(2)-n.gammaln(q),ce=q-1,V=u*.25,G;u<=y?G=x:u<=_?G=C:u<=T?G=N:G=P,W+=a.log(G);for(var j=0,ie=1;ie<=50;ie++){for(var fe=0,ve=(2*ie-1)*G,xe=1;xe<=g;xe++){var Te,Me;b<xe?(Te=xe-b-1,Me=W+ce*a.log(ve+z[Te]*G)-(z[Te]*G+ve)*V):(Te=xe-1,Me=W+ce*a.log(ve-z[Te]*G)+(z[Te]*G-ve)*V);var J;if(Me>=v){b<xe?J=o*a.sqrt((z[Te]*G+ve)*.5):J=o*a.sqrt((-(z[Te]*G)+ve)*.5);var S=d(J,f,m),I=S*K[Te]*a.exp(Me);fe+=I}}if(ie*G>=1&&fe<=w)break;j+=fe}if(fe>w)throw new Error("tukey.cdf failed to converge");return j>1&&(j=1),j},inv:function(c,o,l){var u=1,f=o,m=1e-4,g=50;if(l<2||u<1||f<2)return NaN;if(c<0||c>1)return NaN;if(c===0)return 0;if(c===1)return 1/0;var b=h(c,f,l),v=n.tukey.cdf(b,o,l)-c,w;v>0?w=a.max(0,b-1):w=b+1;for(var y=n.tukey.cdf(w,o,l)-c,_,T=1;T<g;T++){_=w-y*(w-b)/(y-v),v=y,b=w,_<0&&(_=0,y=-c),y=n.tukey.cdf(_,o,l)-c,w=_;var A=a.abs(w-b);if(A<m)return _}throw new Error("tukey.inv failed to converge")}})}(r,Math),function(n,a){var i=Array.prototype.push,s=n.utils.isArray;function d(h){return s(h)||h instanceof n}n.extend({add:function(c,o){return d(o)?(d(o[0])||(o=[o]),n.map(c,function(l,u,f){return l+o[u][f]})):n.map(c,function(l){return l+o})},subtract:function(c,o){return d(o)?(d(o[0])||(o=[o]),n.map(c,function(l,u,f){return l-o[u][f]||0})):n.map(c,function(l){return l-o})},divide:function(c,o){return d(o)?(d(o[0])||(o=[o]),n.multiply(c,n.inv(o))):n.map(c,function(l){return l/o})},multiply:function(c,o){var l,u,f,m,g,b,v,w;if(c.length===void 0&&o.length===void 0)return c*o;if(g=c.length,b=c[0].length,v=n.zeros(g,f=d(o)?o[0].length:b),w=0,d(o)){for(;w<f;w++)for(l=0;l<g;l++){for(m=0,u=0;u<b;u++)m+=c[l][u]*o[u][w];v[l][w]=m}return g===1&&w===1?v[0][0]:v}return n.map(c,function(y){return y*o})},outer:function(c,o){return n.multiply(c.map(function(l){return[l]}),[o])},dot:function(c,o){d(c[0])||(c=[c]),d(o[0])||(o=[o]);for(var l=c[0].length===1&&c.length!==1?n.transpose(c):c,u=o[0].length===1&&o.length!==1?n.transpose(o):o,f=[],m=0,g=l.length,b=l[0].length,v,w;m<g;m++){for(f[m]=[],v=0,w=0;w<b;w++)v+=l[m][w]*u[m][w];f[m]=v}return f.length===1?f[0]:f},pow:function(c,o){return n.map(c,function(l){return a.pow(l,o)})},exp:function(c){return n.map(c,function(o){return a.exp(o)})},log:function(c){return n.map(c,function(o){return a.log(o)})},abs:function(c){return n.map(c,function(o){return a.abs(o)})},norm:function(c,o){var l=0,u=0;for(isNaN(o)&&(o=2),d(c[0])&&(c=c[0]);u<c.length;u++)l+=a.pow(a.abs(c[u]),o);return a.pow(l,1/o)},angle:function(c,o){return a.acos(n.dot(c,o)/(n.norm(c)*n.norm(o)))},aug:function(c,o){var l=[],u;for(u=0;u<c.length;u++)l.push(c[u].slice());for(u=0;u<l.length;u++)i.apply(l[u],o[u]);return l},inv:function(c){for(var o=c.length,l=c[0].length,u=n.identity(o,l),f=n.gauss_jordan(c,u),m=[],g=0,b;g<o;g++)for(m[g]=[],b=l;b<f[0].length;b++)m[g][b-l]=f[g][b];return m},det:function(c){var o=c.length,l=o*2,u=new Array(l),f=o-1,m=l-1,g=f-o+1,b=m,v=0,w=0,y;if(o===2)return c[0][0]*c[1][1]-c[0][1]*c[1][0];for(;v<l;v++)u[v]=1;for(v=0;v<o;v++){for(y=0;y<o;y++)u[g<0?g+o:g]*=c[v][y],u[b<o?b+o:b]*=c[v][y],g++,b--;g=--f-o+1,b=--m}for(v=0;v<o;v++)w+=u[v];for(;v<l;v++)w-=u[v];return w},gauss_elimination:function(c,o){var l=0,u=0,f=c.length,m=c[0].length,g=1,b=0,v=[],w,y,_,T;for(c=n.aug(c,o),w=c[0].length,l=0;l<f;l++){for(y=c[l][l],u=l,T=l+1;T<m;T++)y<a.abs(c[T][l])&&(y=c[T][l],u=T);if(u!=l)for(T=0;T<w;T++)_=c[l][T],c[l][T]=c[u][T],c[u][T]=_;for(u=l+1;u<f;u++)for(g=c[u][l]/c[l][l],T=l;T<w;T++)c[u][T]=c[u][T]-g*c[l][T]}for(l=f-1;l>=0;l--){for(b=0,u=l+1;u<=f-1;u++)b=b+v[u]*c[l][u];v[l]=(c[l][w-1]-b)/c[l][l]}return v},gauss_jordan:function(c,o){var l=n.aug(c,o),u=l.length,f=l[0].length,m=0,g,b,v;for(b=0;b<u;b++){var w=b;for(v=b+1;v<u;v++)a.abs(l[v][b])>a.abs(l[w][b])&&(w=v);var y=l[b];for(l[b]=l[w],l[w]=y,v=b+1;v<u;v++)for(m=l[v][b]/l[b][b],g=b;g<f;g++)l[v][g]-=l[b][g]*m}for(b=u-1;b>=0;b--){for(m=l[b][b],v=0;v<b;v++)for(g=f-1;g>b-1;g--)l[v][g]-=l[b][g]*l[v][b]/m;for(l[b][b]/=m,g=u;g<f;g++)l[b][g]/=m}return l},triaUpSolve:function(c,o){var l=c[0].length,u=n.zeros(1,l)[0],f,m=!1;return o[0].length!=null&&(o=o.map(function(g){return g[0]}),m=!0),n.arange(l-1,-1,-1).forEach(function(g){f=n.arange(g+1,l).map(function(b){return u[b]*c[g][b]}),u[g]=(o[g]-n.sum(f))/c[g][g]}),m?u.map(function(g){return[g]}):u},triaLowSolve:function(c,o){var l=c[0].length,u=n.zeros(1,l)[0],f,m=!1;return o[0].length!=null&&(o=o.map(function(g){return g[0]}),m=!0),n.arange(l).forEach(function(g){f=n.arange(g).map(function(b){return c[g][b]*u[b]}),u[g]=(o[g]-n.sum(f))/c[g][g]}),m?u.map(function(g){return[g]}):u},lu:function(c){var o=c.length,l=n.identity(o),u=n.zeros(c.length,c[0].length),f;return n.arange(o).forEach(function(m){u[0][m]=c[0][m]}),n.arange(1,o).forEach(function(m){n.arange(m).forEach(function(g){f=n.arange(g).map(function(b){return l[m][b]*u[b][g]}),l[m][g]=(c[m][g]-n.sum(f))/u[g][g]}),n.arange(m,o).forEach(function(g){f=n.arange(m).map(function(b){return l[m][b]*u[b][g]}),u[m][g]=c[f.length][g]-n.sum(f)})}),[l,u]},cholesky:function(c){var o=c.length,l=n.zeros(c.length,c[0].length),u;return n.arange(o).forEach(function(f){u=n.arange(f).map(function(m){return a.pow(l[f][m],2)}),l[f][f]=a.sqrt(c[f][f]-n.sum(u)),n.arange(f+1,o).forEach(function(m){u=n.arange(f).map(function(g){return l[f][g]*l[m][g]}),l[m][f]=(c[f][m]-n.sum(u))/l[f][f]})}),l},gauss_jacobi:function(c,o,l,u){for(var f=0,m=0,g=c.length,b=[],v=[],w=[],y,_,T,A;f<g;f++)for(b[f]=[],v[f]=[],w[f]=[],m=0;m<g;m++)f>m?(b[f][m]=c[f][m],v[f][m]=w[f][m]=0):f<m?(v[f][m]=c[f][m],b[f][m]=w[f][m]=0):(w[f][m]=c[f][m],b[f][m]=v[f][m]=0);for(T=n.multiply(n.multiply(n.inv(w),n.add(b,v)),-1),_=n.multiply(n.inv(w),o),y=l,A=n.add(n.multiply(T,l),_),f=2;a.abs(n.norm(n.subtract(A,y)))>u;)y=A,A=n.add(n.multiply(T,y),_),f++;return A},gauss_seidel:function(c,o,l,u){for(var f=0,m=c.length,g=[],b=[],v=[],w,y,_,T,A;f<m;f++)for(g[f]=[],b[f]=[],v[f]=[],w=0;w<m;w++)f>w?(g[f][w]=c[f][w],b[f][w]=v[f][w]=0):f<w?(b[f][w]=c[f][w],g[f][w]=v[f][w]=0):(v[f][w]=c[f][w],g[f][w]=b[f][w]=0);for(T=n.multiply(n.multiply(n.inv(n.add(v,g)),b),-1),_=n.multiply(n.inv(n.add(v,g)),o),y=l,A=n.add(n.multiply(T,l),_),f=2;a.abs(n.norm(n.subtract(A,y)))>u;)y=A,A=n.add(n.multiply(T,y),_),f=f+1;return A},SOR:function(c,o,l,u,f){for(var m=0,g=c.length,b=[],v=[],w=[],y,_,T,A,x;m<g;m++)for(b[m]=[],v[m]=[],w[m]=[],y=0;y<g;y++)m>y?(b[m][y]=c[m][y],v[m][y]=w[m][y]=0):m<y?(v[m][y]=c[m][y],b[m][y]=w[m][y]=0):(w[m][y]=c[m][y],b[m][y]=v[m][y]=0);for(A=n.multiply(n.inv(n.add(w,n.multiply(b,f))),n.subtract(n.multiply(w,1-f),n.multiply(v,f))),T=n.multiply(n.multiply(n.inv(n.add(w,n.multiply(b,f))),o),f),_=l,x=n.add(n.multiply(A,l),T),m=2;a.abs(n.norm(n.subtract(x,_)))>u;)_=x,x=n.add(n.multiply(A,_),T),m++;return x},householder:function(c){for(var o=c.length,l=c[0].length,u=0,f=[],m=[],g,b,v,w,y;u<o-1;u++){for(g=0,w=u+1;w<l;w++)g+=c[w][u]*c[w][u];for(y=c[u+1][u]>0?-1:1,g=y*a.sqrt(g),b=a.sqrt((g*g-c[u+1][u]*g)/2),f=n.zeros(o,1),f[u+1][0]=(c[u+1][u]-g)/(2*b),v=u+2;v<o;v++)f[v][0]=c[v][u]/(2*b);m=n.subtract(n.identity(o,l),n.multiply(n.multiply(f,n.transpose(f)),2)),c=n.multiply(m,n.multiply(c,m))}return c},QR:function(){var h=n.sum,c=n.arange;function o(l){var u=l.length,f=l[0].length,m=n.zeros(f,f);l=n.copy(l);var g,b,v;for(b=0;b<f;b++){for(m[b][b]=a.sqrt(h(c(u).map(function(w){return l[w][b]*l[w][b]}))),g=0;g<u;g++)l[g][b]=l[g][b]/m[b][b];for(v=b+1;v<f;v++)for(m[b][v]=h(c(u).map(function(w){return l[w][b]*l[w][v]})),g=0;g<u;g++)l[g][v]=l[g][v]-l[g][b]*m[b][v]}return[l,m]}return o}(),lstsq:function(){function h(o){o=n.copy(o);var l=o.length,u=n.identity(l);return n.arange(l-1,-1,-1).forEach(function(f){n.sliceAssign(u,{row:f},n.divide(n.slice(u,{row:f}),o[f][f])),n.sliceAssign(o,{row:f},n.divide(n.slice(o,{row:f}),o[f][f])),n.arange(f).forEach(function(m){var g=n.multiply(o[m][f],-1),b=n.slice(o,{row:m}),v=n.multiply(n.slice(o,{row:f}),g);n.sliceAssign(o,{row:m},n.add(b,v));var w=n.slice(u,{row:m}),y=n.multiply(n.slice(u,{row:f}),g);n.sliceAssign(u,{row:m},n.add(w,y))})}),u}function c(o,l){var u=!1;l[0].length===void 0&&(l=l.map(function(A){return[A]}),u=!0);var f=n.QR(o),m=f[0],g=f[1],b=o[0].length,v=n.slice(m,{col:{end:b}}),w=n.slice(g,{row:{end:b}}),y=h(w),_=n.transpose(v);_[0].length===void 0&&(_=[_]);var T=n.multiply(n.multiply(y,_),l);return T.length===void 0&&(T=[[T]]),u?T.map(function(A){return A[0]}):T}return c}(),jacobi:function(c){for(var o=1,l=c.length,u=n.identity(l,l),f=[],m,g,b,v,w,y,_,T;o===1;){for(y=c[0][1],v=0,w=1,g=0;g<l;g++)for(b=0;b<l;b++)g!=b&&y<a.abs(c[g][b])&&(y=a.abs(c[g][b]),v=g,w=b);for(c[v][v]===c[w][w]?_=c[v][w]>0?a.PI/4:-a.PI/4:_=a.atan(2*c[v][w]/(c[v][v]-c[w][w]))/2,T=n.identity(l,l),T[v][v]=a.cos(_),T[v][w]=-a.sin(_),T[w][v]=a.sin(_),T[w][w]=a.cos(_),u=n.multiply(u,T),m=n.multiply(n.multiply(n.inv(T),c),T),c=m,o=0,g=1;g<l;g++)for(b=1;b<l;b++)g!=b&&a.abs(c[g][b])>.001&&(o=1)}for(g=0;g<l;g++)f.push(c[g][g]);return[u,f]},rungekutta:function(c,o,l,u,f,m){var g,b,v,w,y;if(m===2)for(;u<=l;)g=o*c(u,f),b=o*c(u+o,f+g),v=f+(g+b)/2,f=v,u=u+o;if(m===4)for(;u<=l;)g=o*c(u,f),b=o*c(u+o/2,f+g/2),w=o*c(u+o/2,f+b/2),y=o*c(u+o,f+w),v=f+(g+2*b+2*w+y)/6,f=v,u=u+o;return f},romberg:function(c,o,l,u){for(var f=0,m=(l-o)/2,g=[],b=[],v=[],w,y,_,T,A;f<u/2;){for(A=c(o),_=o,T=0;_<=l;_=_+m,T++)g[T]=_;for(w=g.length,_=1;_<w-1;_++)A+=(_%2!==0?4:2)*c(g[_]);A=m/3*(A+c(l)),v[f]=A,m/=2,f++}for(y=v.length,w=1;y!==1;){for(_=0;_<y-1;_++)b[_]=(a.pow(4,w)*v[_+1]-v[_])/(a.pow(4,w)-1);y=b.length,v=b,b=[],w++}return v},richardson:function(c,o,l,u){function f(x,C){for(var N=0,P=x.length,z;N<P;N++)x[N]===C&&(z=N);return z}for(var m=a.abs(l-c[f(c,l)+1]),g=0,b=[],v=[],w,y,_,T,A;u>=m;)w=f(c,l+u),y=f(c,l),b[g]=(o[w]-2*o[y]+o[2*y-w])/(u*u),u/=2,g++;for(T=b.length,_=1;T!=1;){for(A=0;A<T-1;A++)v[A]=(a.pow(4,_)*b[A+1]-b[A])/(a.pow(4,_)-1);T=v.length,b=v,v=[],_++}return b},simpson:function(c,o,l,u){for(var f=(l-o)/u,m=c(o),g=[],b=o,v=0,w=1,y;b<=l;b=b+f,v++)g[v]=b;for(y=g.length;w<y-1;w++)m+=(w%2!==0?4:2)*c(g[w]);return f/3*(m+c(l))},hermite:function(c,o,l,u){for(var f=c.length,m=0,g=0,b=[],v=[],w=[],y=[],_;g<f;g++){for(b[g]=1,_=0;_<f;_++)g!=_&&(b[g]*=(u-c[_])/(c[g]-c[_]));for(v[g]=0,_=0;_<f;_++)g!=_&&(v[g]+=1/(c[g]-c[_]));w[g]=(1-2*(u-c[g])*v[g])*(b[g]*b[g]),y[g]=(u-c[g])*(b[g]*b[g]),m+=w[g]*o[g]+y[g]*l[g]}return m},lagrange:function(c,o,l){for(var u=0,f=0,m,g,b=c.length;f<b;f++){for(g=o[f],m=0;m<b;m++)f!=m&&(g*=(l-c[m])/(c[f]-c[m]));u+=g}return u},cubic_spline:function(c,o,l){for(var u=c.length,f=0,m,g=[],b=[],v=[],w=[],y=[],_=[],T=[];f<u-1;f++)y[f]=c[f+1]-c[f];for(v[0]=0,f=1;f<u-1;f++)v[f]=3/y[f]*(o[f+1]-o[f])-3/y[f-1]*(o[f]-o[f-1]);for(f=1;f<u-1;f++)g[f]=[],b[f]=[],g[f][f-1]=y[f-1],g[f][f]=2*(y[f-1]+y[f]),g[f][f+1]=y[f],b[f][0]=v[f];for(w=n.multiply(n.inv(g),b),m=0;m<u-1;m++)_[m]=(o[m+1]-o[m])/y[m]-y[m]*(w[m+1][0]+2*w[m][0])/3,T[m]=(w[m+1][0]-w[m][0])/(3*y[m]);for(m=0;m<u&&!(c[m]>l);m++);return m-=1,o[m]+(l-c[m])*_[m]+n.sq(l-c[m])*w[m]+(l-c[m])*n.sq(l-c[m])*T[m]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(c){var o=c.length,l=c[0].length,u=0,f,m,g=[],b=[],v=[],w=[],y=[],_=[],T=[],A=[],x=[],C=[];for(u=0;u<o;u++)g[u]=n.sum(c[u])/l;for(u=0;u<l;u++)for(T[u]=[],f=0;f<o;f++)T[u][f]=c[f][u]-g[f];for(T=n.transpose(T),u=0;u<o;u++)for(A[u]=[],f=0;f<o;f++)A[u][f]=n.dot([T[u]],[T[f]])/(l-1);for(v=n.jacobi(A),x=v[0],b=v[1],C=n.transpose(x),u=0;u<b.length;u++)for(f=u;f<b.length;f++)b[u]<b[f]&&(m=b[u],b[u]=b[f],b[f]=m,w=C[u],C[u]=C[f],C[f]=w);for(_=n.transpose(T),u=0;u<o;u++)for(y[u]=[],f=0;f<_.length;f++)y[u][f]=n.dot([C[u]],[_[f]]);return[c,b,C,y]}}),function(h){for(var c=0;c<h.length;c++)(function(o){n.fn[o]=function(l,u){var f=this;return u?(setTimeout(function(){u.call(f,n.fn[o].call(f,l))},15),this):typeof n[o](this,l)=="number"?n[o](this,l):n(n[o](this,l))}})(h[c])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(r,Math),function(n,a){var i=[].slice,s=n.utils.isNumber,d=n.utils.isArray;n.extend({zscore:function(){var o=i.call(arguments);return s(o[1])?(o[0]-o[1])/o[2]:(o[0]-n.mean(o[1]))/n.stdev(o[1],o[2])},ztest:function(){var o=i.call(arguments),l;return d(o[1])?(l=n.zscore(o[0],o[1],o[3]),o[2]===1?n.normal.cdf(-a.abs(l),0,1):n.normal.cdf(-a.abs(l),0,1)*2):o.length>2?(l=n.zscore(o[0],o[1],o[2]),o[3]===1?n.normal.cdf(-a.abs(l),0,1):n.normal.cdf(-a.abs(l),0,1)*2):(l=o[0],o[1]===1?n.normal.cdf(-a.abs(l),0,1):n.normal.cdf(-a.abs(l),0,1)*2)}}),n.extend(n.fn,{zscore:function(o,l){return(o-this.mean())/this.stdev(l)},ztest:function(o,l,u){var f=a.abs(this.zscore(o,u));return l===1?n.normal.cdf(-f,0,1):n.normal.cdf(-f,0,1)*2}}),n.extend({tscore:function(){var o=i.call(arguments);return o.length===4?(o[0]-o[1])/(o[2]/a.sqrt(o[3])):(o[0]-n.mean(o[1]))/(n.stdev(o[1],!0)/a.sqrt(o[1].length))},ttest:function(){var o=i.call(arguments),l;return o.length===5?(l=a.abs(n.tscore(o[0],o[1],o[2],o[3])),o[4]===1?n.studentt.cdf(-l,o[3]-1):n.studentt.cdf(-l,o[3]-1)*2):s(o[1])?(l=a.abs(o[0]),o[2]==1?n.studentt.cdf(-l,o[1]-1):n.studentt.cdf(-l,o[1]-1)*2):(l=a.abs(n.tscore(o[0],o[1])),o[2]==1?n.studentt.cdf(-l,o[1].length-1):n.studentt.cdf(-l,o[1].length-1)*2)}}),n.extend(n.fn,{tscore:function(o){return(o-this.mean())/(this.stdev(!0)/a.sqrt(this.cols()))},ttest:function(o,l){return l===1?1-n.studentt.cdf(a.abs(this.tscore(o)),this.cols()-1):n.studentt.cdf(-a.abs(this.tscore(o)),this.cols()-1)*2}}),n.extend({anovafscore:function(){var o=i.call(arguments),l,u,f,m,g,b,v,w;if(o.length===1){for(g=new Array(o[0].length),v=0;v<o[0].length;v++)g[v]=o[0][v];o=g}for(u=new Array,v=0;v<o.length;v++)u=u.concat(o[v]);for(f=n.mean(u),l=0,v=0;v<o.length;v++)l=l+o[v].length*a.pow(n.mean(o[v])-f,2);for(l/=o.length-1,b=0,v=0;v<o.length;v++)for(m=n.mean(o[v]),w=0;w<o[v].length;w++)b+=a.pow(o[v][w]-m,2);return b/=u.length-o.length,l/b},anovaftest:function(){var o=i.call(arguments),l,u,f,m;if(s(o[0]))return 1-n.centralF.cdf(o[0],o[1],o[2]);var g=n.anovafscore(o);for(l=o.length-1,f=0,m=0;m<o.length;m++)f=f+o[m].length;return u=f-l-1,1-n.centralF.cdf(g,l,u)},ftest:function(o,l,u){return 1-n.centralF.cdf(o,l,u)}}),n.extend(n.fn,{anovafscore:function(){return n.anovafscore(this.toArray())},anovaftes:function(){var o=0,l;for(l=0;l<this.length;l++)o=o+this[l].length;return n.ftest(this.anovafscore(),this.length-1,o-this.length)}}),n.extend({qscore:function(){var o=i.call(arguments),l,u,f,m,g;return s(o[0])?(l=o[0],u=o[1],f=o[2],m=o[3],g=o[4]):(l=n.mean(o[0]),u=n.mean(o[1]),f=o[0].length,m=o[1].length,g=o[2]),a.abs(l-u)/(g*a.sqrt((1/f+1/m)/2))},qtest:function(){var o=i.call(arguments),l;o.length===3?(l=o[0],o=o.slice(1)):o.length===7?(l=n.qscore(o[0],o[1],o[2],o[3],o[4]),o=o.slice(5)):(l=n.qscore(o[0],o[1],o[2]),o=o.slice(3));var u=o[0],f=o[1];return 1-n.tukey.cdf(l,f,u-f)},tukeyhsd:function(o){for(var l=n.pooledstdev(o),u=o.map(function(w){return n.mean(w)}),f=o.reduce(function(w,y){return w+y.length},0),m=[],g=0;g<o.length;++g)for(var b=g+1;b<o.length;++b){var v=n.qtest(u[g],u[b],o[g].length,o[b].length,l,f,o.length);m.push([[g,b],v])}return m}}),n.extend({normalci:function(){var o=i.call(arguments),l=new Array(2),u;return o.length===4?u=a.abs(n.normal.inv(o[1]/2,0,1)*o[2]/a.sqrt(o[3])):u=a.abs(n.normal.inv(o[1]/2,0,1)*n.stdev(o[2])/a.sqrt(o[2].length)),l[0]=o[0]-u,l[1]=o[0]+u,l},tci:function(){var o=i.call(arguments),l=new Array(2),u;return o.length===4?u=a.abs(n.studentt.inv(o[1]/2,o[3]-1)*o[2]/a.sqrt(o[3])):u=a.abs(n.studentt.inv(o[1]/2,o[2].length-1)*n.stdev(o[2],!0)/a.sqrt(o[2].length)),l[0]=o[0]-u,l[1]=o[0]+u,l},significant:function(o,l){return o<l}}),n.extend(n.fn,{normalci:function(o,l){return n.normalci(o,l,this.toArray())},tci:function(o,l){return n.tci(o,l,this.toArray())}});function h(c,o,l,u){if(c>1||l>1||c<=0||l<=0)throw new Error("Proportions should be greater than 0 and less than 1");var f=(c*o+l*u)/(o+u),m=a.sqrt(f*(1-f)*(1/o+1/u));return(c-l)/m}n.extend(n.fn,{oneSidedDifferenceOfProportions:function(o,l,u,f){var m=h(o,l,u,f);return n.ztest(m,1)},twoSidedDifferenceOfProportions:function(o,l,u,f){var m=h(o,l,u,f);return n.ztest(m,2)}})}(r,Math),r.models=function(){function n(h){var c=h[0].length,o=r.arange(c).map(function(l){var u=r.arange(c).filter(function(f){return f!==l});return a(r.col(h,l).map(function(f){return f[0]}),r.col(h,u))});return o}function a(h,c){var o=h.length,l=c[0].length-1,u=o-l-1,f=r.lstsq(c,h),m=r.multiply(c,f.map(function(T){return[T]})).map(function(T){return T[0]}),g=r.subtract(h,m),b=r.mean(h),v=r.sum(m.map(function(T){return Math.pow(T-b,2)})),w=r.sum(h.map(function(T,A){return Math.pow(T-m[A],2)})),y=v+w,_=v/y;return{exog:c,endog:h,nobs:o,df_model:l,df_resid:u,coef:f,predict:m,resid:g,ybar:b,SST:y,SSE:v,SSR:w,R2:_}}function i(h){var c=n(h.exog),o=Math.sqrt(h.SSR/h.df_resid),l=c.map(function(b){var v=b.SST,w=b.R2;return o/Math.sqrt(v*(1-w))}),u=h.coef.map(function(b,v){return(b-0)/l[v]}),f=u.map(function(b){var v=r.studentt.cdf(b,h.df_resid);return(v>.5?1-v:v)*2}),m=r.studentt.inv(.975,h.df_resid),g=h.coef.map(function(b,v){var w=m*l[v];return[b-w,b+w]});return{se:l,t:u,p:f,sigmaHat:o,interval95:g}}function s(h){var c=h.R2/h.df_model/((1-h.R2)/h.df_resid),o=function(u,f,m){return r.beta.cdf(u/(m/f+u),f/2,m/2)},l=1-o(c,h.df_model,h.df_resid);return{F_statistic:c,pvalue:l}}function d(h,c){var o=a(h,c),l=i(o),u=s(o),f=1-(1-o.R2)*((o.nobs-1)/o.df_resid);return o.t=l,o.f=u,o.adjust_R2=f,o}return{ols:d}}(),r.extend({buildxmatrix:function(){for(var a=new Array(arguments.length),i=0;i<arguments.length;i++){var s=[1];a[i]=s.concat(arguments[i])}return r(a)},builddxmatrix:function(){for(var a=new Array(arguments[0].length),i=0;i<arguments[0].length;i++){var s=[1];a[i]=s.concat(arguments[0][i])}return r(a)},buildjxmatrix:function(a){for(var i=new Array(a.length),s=0;s<a.length;s++)i[s]=a[s];return r.builddxmatrix(i)},buildymatrix:function(a){return r(a).transpose()},buildjymatrix:function(a){return a.transpose()},matrixmult:function(a,i){var s,d,h,c,o;if(a.cols()==i.rows()){if(i.rows()>1){for(c=[],s=0;s<a.rows();s++)for(c[s]=[],d=0;d<i.cols();d++){for(o=0,h=0;h<a.cols();h++)o+=a.toArray()[s][h]*i.toArray()[h][d];c[s][d]=o}return r(c)}for(c=[],s=0;s<a.rows();s++)for(c[s]=[],d=0;d<i.cols();d++){for(o=0,h=0;h<a.cols();h++)o+=a.toArray()[s][h]*i.toArray()[d];c[s][d]=o}return r(c)}},regress:function(a,i){var s=r.xtranspxinv(a),d=a.transpose(),h=r.matrixmult(r(s),d);return r.matrixmult(h,i)},regresst:function(a,i,s){var d=r.regress(a,i),h={};h.anova={};var c=r.jMatYBar(a,d);h.yBar=c;var o=i.mean();h.anova.residuals=r.residuals(i,c),h.anova.ssr=r.ssr(c,o),h.anova.msr=h.anova.ssr/(a[0].length-1),h.anova.sse=r.sse(i,c),h.anova.mse=h.anova.sse/(i.length-(a[0].length-1)-1),h.anova.sst=r.sst(i,o),h.anova.mst=h.anova.sst/(i.length-1),h.anova.r2=1-h.anova.sse/h.anova.sst,h.anova.r2<0&&(h.anova.r2=0),h.anova.fratio=h.anova.msr/h.anova.mse,h.anova.pvalue=r.anovaftest(h.anova.fratio,a[0].length-1,i.length-(a[0].length-1)-1),h.anova.rmse=Math.sqrt(h.anova.mse),h.anova.r2adj=1-h.anova.mse/h.anova.mst,h.anova.r2adj<0&&(h.anova.r2adj=0),h.stats=new Array(a[0].length);for(var l=r.xtranspxinv(a),u,f,m,g=0;g<d.length;g++)u=Math.sqrt(h.anova.mse*Math.abs(l[g][g])),f=Math.abs(d[g]/u),m=r.ttest(f,i.length-a[0].length-1,s),h.stats[g]=[d[g],u,f,m];return h.regress=d,h},xtranspx:function(a){return r.matrixmult(a.transpose(),a)},xtranspxinv:function(a){var i=r.matrixmult(a.transpose(),a),s=r.inv(i);return s},jMatYBar:function(a,i){var s=r.matrixmult(a,i);return new r(s)},residuals:function(a,i){return r.matrixsubtract(a,i)},ssr:function(a,i){for(var s=0,d=0;d<a.length;d++)s+=Math.pow(a[d]-i,2);return s},sse:function(a,i){for(var s=0,d=0;d<a.length;d++)s+=Math.pow(a[d]-i[d],2);return s},sst:function(a,i){for(var s=0,d=0;d<a.length;d++)s+=Math.pow(a[d]-i,2);return s},matrixsubtract:function(a,i){for(var s=new Array(a.length),d=0;d<a.length;d++){s[d]=new Array(a[d].length);for(var h=0;h<a[d].length;h++)s[d][h]=a[d][h]-i[d][h]}return r(s)}}),r.jStat=r,r})})(Kg);var Ue=Kg.exports;const Fe=Et,w_=536870911,__=-536870912,pl=511,ho=-512,N_=/^\s?[+-]?\s?[0-9]+[.]?[0-9]*([eE][+-][0-9]+)?\s?$/,A_=/^\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+-][0-9]+)?)?)\s?[ij]\s?$/,C_=/^\s?([+-]?\s?[0-9]+[.]?[0-9]*([eE][+-][0-9]+)?)\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+-][0-9]+)?)?)\s?[ij]\s?$/;function bt(e){e=Fe.accept(e);let t=0,r=0,n="i";if(typeof e=="number")return{real:e,im:r,unit:n};if(typeof e=="boolean")throw M.VALUE;let a=e.match(N_);if(a)return t=Number(a[0]),{real:t,im:r,unit:n};if(a=e.match(A_),a)return r=Number(/^\s?[+-]?\s?$/.test(a[1])?`${a[1]}1`:a[1]),n=a[0].slice(-1),{real:t,im:r,unit:n};if(a=e.match(C_),a)return t=Number(a[1]),r=Number(/^\s?[+-]?\s?$/.test(a[3])?`${a[3]}1`:a[3]),n=a[0].slice(-1),{real:t,im:r,unit:n};throw M.NUM}const Ke={BESSELI:(e,t)=>{if(e=Fe.accept(e,R.NUMBER_NO_BOOLEAN),t=Fe.accept(t,R.NUMBER_NO_BOOLEAN),t=Math.trunc(t),t<0)throw M.NUM;return ii.besseli(e,t)},BESSELJ:(e,t)=>{if(e=Fe.accept(e,R.NUMBER_NO_BOOLEAN),t=Fe.accept(t,R.NUMBER_NO_BOOLEAN),t=Math.trunc(t),t<0)throw M.NUM;return ii.besselj(e,t)},BESSELK:(e,t)=>{if(e=Fe.accept(e,R.NUMBER_NO_BOOLEAN),t=Fe.accept(t,R.NUMBER_NO_BOOLEAN),t=Math.trunc(t),t<0)throw M.NUM;return ii.besselk(e,t)},BESSELY:(e,t)=>{if(e=Fe.accept(e,R.NUMBER_NO_BOOLEAN),t=Fe.accept(t,R.NUMBER_NO_BOOLEAN),t=Math.trunc(t),t<0)throw M.NUM;return ii.bessely(e,t)},BIN2DEC:e=>{e=Fe.accept(e,R.NUMBER_NO_BOOLEAN);const t=e.toString();if(t.length>10)throw M.NUM;return t.length===10&&t.substring(0,1)==="1"?parseInt(t.substring(1),2)+ho:parseInt(t,2)},BIN2HEX:(e,t)=>{e=Fe.accept(e,R.NUMBER_NO_BOOLEAN),t=Fe.accept(t,R.NUMBER_NO_BOOLEAN,null);const r=e.toString();if(r.length>10)throw M.NUM;if(r.length===10&&r.substring(0,1)==="1")return(parseInt(r.substring(1),2)+0xfffffffe00).toString(16).toUpperCase();const n=parseInt(e,2).toString(16);if(t==null)return n.toUpperCase();if(t<0)throw M.NUM;if(t=Math.trunc(t),t>=n.length)return(Pt.REPT("0",t-n.length)+n).toUpperCase();throw M.NUM},BIN2OCT:(e,t)=>{e=Fe.accept(e,R.NUMBER_NO_BOOLEAN),t=Fe.accept(t,R.NUMBER,null);const r=e.toString();if(r.length>10)throw M.NUM;if(r.length===10&&r.substr(0,1)==="1")return(parseInt(r.substr(1),2)+1073741312).toString(8);const n=parseInt(e,2).toString(8);if(t==null)return n.toUpperCase();if(t<0)throw M.NUM;if(t=Math.trunc(t),t>=n.length)return Pt.REPT("0",t-n.length)+n;throw M.NUM},BITAND:(e,t)=>{if(e=Fe.accept(e,R.NUMBER),t=Fe.accept(t,R.NUMBER),e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff)throw M.NUM;return e&t},BITLSHIFT:(e,t)=>{if(e=Fe.accept(e,R.NUMBER),t=Fe.accept(t,R.NUMBER),t=Math.trunc(t),Math.abs(t)>53||e<0||Math.floor(e)!==e||e>0xffffffffffff)throw M.NUM;const r=t>=0?e*2**t:Math.trunc(e/2**-t);if(r>0xffffffffffff)throw M.NUM;return r},BITOR:(e,t)=>{if(e=Fe.accept(e,R.NUMBER),t=Fe.accept(t,R.NUMBER),e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff)throw M.NUM;return e|t},BITRSHIFT:(e,t)=>(e=Fe.accept(e,R.NUMBER),t=Fe.accept(t,R.NUMBER),Ke.BITLSHIFT(e,-t)),BITXOR:(e,t)=>{if(e=Fe.accept(e,R.NUMBER),t=Fe.accept(t,R.NUMBER),e<0||e>0xffffffffffff||Math.floor(e)!==e||t<0||t>0xffffffffffff||Math.floor(t)!==t)throw M.NUM;return e^t},COMPLEX:(e,t,r)=>{if(e=Fe.accept(e,R.NUMBER_NO_BOOLEAN),t=Fe.accept(t,R.NUMBER_NO_BOOLEAN),r=Fe.accept(r,R.STRING,"i"),r!=="i"&&r!=="j")throw M.VALUE;if(e===0&&t===0)return 0;if(e===0)return t===1?r:t===-1?`-${r}`:t.toString()+r;if(t===0)return e.toString();const n=t>0?"+":"";return t===1?e.toString()+n+r:t===-1?`${e.toString()+n}-${r}`:e.toString()+n+t.toString()+r},DEC2BIN:(e,t)=>{if(e=Fe.accept(e,R.NUMBER),t=Fe.accept(t,R.NUMBER,null),e<ho||e>pl)throw M.NUM;if(e<0)return`1${Pt.REPT("0",9-(512+e).toString(2).length)}${(512+e).toString(2)}`;const r=parseInt(e,10).toString(2);if(t==null)return r;if(t=Math.trunc(t),t<=0||t<r.length)throw M.NUM;return Pt.REPT("0",t-r.length)+r},DEC2HEX:(e,t)=>{if(e=Fe.accept(e,R.NUMBER),t=Fe.accept(t,R.NUMBER,null),e<-549755813888||e>549755813888)throw M.NUM;if(e<0)return(1099511627776+e).toString(16).toUpperCase();const r=parseInt(e,10).toString(16);if(t==null)return r.toUpperCase();if(t=Math.trunc(t),t<=0||t<r.length)throw M.NUM;return Pt.REPT("0",t-r.length)+r.toUpperCase()},DEC2OCT:(e,t)=>{if(e=Fe.accept(e,R.NUMBER),t=Fe.accept(t,R.NUMBER,null),e<-536870912||e>536870912)throw M.NUM;if(e<0)return(e+1073741824).toString(8);const r=parseInt(e,10).toString(8);if(t==null)return r.toUpperCase();if(t=Math.trunc(t),t<=0||t<r.length)throw M.NUM;return Pt.REPT("0",t-r.length)+r},DELTA:(e,t)=>(e=Fe.accept(e,R.NUMBER_NO_BOOLEAN),t=Fe.accept(t,R.NUMBER_NO_BOOLEAN,0),e===t?1:0),ERF:(e,t)=>(e=Fe.accept(e,R.NUMBER_NO_BOOLEAN),t=Fe.accept(t,R.NUMBER_NO_BOOLEAN,0),Ue.erf(e)),ERFC:e=>(e=Fe.accept(e,R.NUMBER_NO_BOOLEAN),Ue.erfc(e)),GESTEP:(e,t)=>(e=Fe.accept(e,R.NUMBER_NO_BOOLEAN),t=Fe.accept(t,R.NUMBER_NO_BOOLEAN,0),e>=t?1:0),HEX2BIN:(e,t)=>{if(e=Fe.accept(e,R.STRING),t=Fe.accept(t,R.NUMBER,null),e.length>10||!/^[0-9a-fA-F]*$/.test(e))throw M.NUM;const r=e.length===10&&e.substr(0,1).toLowerCase()==="f",n=r?parseInt(e,16)-1099511627776:parseInt(e,16);if(n<ho||n>pl)throw M.NUM;if(r)return`1${Pt.REPT("0",9-(n+512).toString(2).length)}${(n+512).toString(2)}`;const a=n.toString(2);if(t==null)return a;if(t=Math.trunc(t),t<=0||t<a.length)throw M.NUM;return Pt.REPT("0",t-a.length)+a},HEX2DEC:e=>{if(e=Fe.accept(e,R.STRING),e.length>10||!/^[0-9a-fA-F]*$/.test(e))throw M.NUM;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},HEX2OCT:(e,t)=>{if(e=Fe.accept(e,R.STRING),e.length>10||!/^[0-9a-fA-F]*$/.test(e))throw M.NUM;const r=Ke.HEX2DEC(e);if(r>w_||r<__)throw M.NUM;return Ke.DEC2OCT(r,t)},IMABS:e=>{const{real:t,im:r}=bt(e);return Math.sqrt(t**2+r**2)},IMAGINARY:e=>bt(e).im,IMARGUMENT:e=>{const{real:t,im:r}=bt(e);if(t===0&&r===0)throw M.DIV0;return t===0&&r>0?Math.PI/2:t===0&&r<0?-Math.PI/2:t<0&&r===0?Math.PI:t>0&&r===0?0:t>0?Math.atan(r/t):t<0&&r>0?Math.atan(r/t)+Math.PI:Math.atan(r/t)-Math.PI},IMCONJUGATE:e=>{const{real:t,im:r,unit:n}=bt(e);return r!==0?Ke.COMPLEX(t,-r,n):`${t}`},IMCOS:e=>{const{real:t,im:r,unit:n}=bt(e),a=Math.cos(t)*(Math.exp(r)+Math.exp(-r))/2,i=-Math.sin(t)*(Math.exp(r)-Math.exp(-r))/2;return Ke.COMPLEX(a,i,n)},IMCOSH:e=>{const{real:t,im:r,unit:n}=bt(e),a=Math.cos(r)*(Math.exp(t)+Math.exp(-t))/2,i=-Math.sin(r)*(Math.exp(t)-Math.exp(-t))/2;return Ke.COMPLEX(a,-i,n)},IMCOT:e=>{e=Fe.accept(e);const t=Ke.IMCOS(e),r=Ke.IMSIN(e);return Ke.IMDIV(t,r)},IMCSC:e=>(e=Fe.accept(e),Ke.IMDIV("1",Ke.IMSIN(e))),IMCSCH:e=>(e=Fe.accept(e),Ke.IMDIV("1",Ke.IMSINH(e))),IMDIV:(e,t)=>{const r=bt(e),n=r.real,a=r.im,i=r.unit,s=bt(t),d=s.real,h=s.im,c=s.unit;if(d===0&&h===0||i!==c)throw M.NUM;const o=i,l=d**2+h**2;return Ke.COMPLEX((n*d+a*h)/l,(a*d-n*h)/l,o)},IMEXP:e=>{const{real:t,im:r,unit:n}=bt(e),a=Math.exp(t);return Ke.COMPLEX(a*Math.cos(r),a*Math.sin(r),n)},IMLN:e=>{const{real:t,im:r,unit:n}=bt(e);return Ke.COMPLEX(Math.log(Math.sqrt(t**2+r**2)),Math.atan(r/t),n)},IMLOG10:e=>{const{real:t,im:r,unit:n}=bt(e),a=Math.log(Math.sqrt(t**2+r**2))/Math.log(10),i=Math.atan(r/t)/Math.log(10);return Ke.COMPLEX(a,i,n)},IMLOG2:e=>{const{real:t,im:r,unit:n}=bt(e),a=Math.log(Math.sqrt(t**2+r**2))/Math.log(2),i=Math.atan(r/t)/Math.log(2);return Ke.COMPLEX(a,i,n)},IMPOWER:(e,t)=>{const{unit:r}=bt(e);t=Fe.accept(t,R.NUMBER_NO_BOOLEAN);const n=Ke.IMABS(e)**t,a=Ke.IMARGUMENT(e),i=n*Math.cos(t*a),s=n*Math.sin(t*a);return Ke.COMPLEX(i,s,r)},IMPRODUCT:(...e)=>{let t,r=0;return Fe.flattenParams(e,null,!1,n=>{if(r===0)t=Fe.accept(n),bt(t);else{const a=bt(t),i=a.real,s=a.im,d=a.unit,h=bt(n),c=h.real,o=h.im,l=h.unit;if(d!==l)throw M.VALUE;t=Ke.COMPLEX(i*c-s*o,i*o+s*c)}r++},1),t},IMREAL:e=>bt(e).real,IMSEC:e=>Ke.IMDIV("1",Ke.IMCOS(e)),IMSECH:e=>Ke.IMDIV("1",Ke.IMCOSH(e)),IMSIN:e=>{const{real:t,im:r,unit:n}=bt(e),a=Math.sin(t)*(Math.exp(r)+Math.exp(-r))/2,i=Math.cos(t)*(Math.exp(r)-Math.exp(-r))/2;return Ke.COMPLEX(a,i,n)},IMSINH:e=>{const{real:t,im:r,unit:n}=bt(e),a=Math.cos(r)*(Math.exp(t)-Math.exp(-t))/2,i=Math.sin(r)*(Math.exp(t)+Math.exp(-t))/2;return Ke.COMPLEX(a,i,n)},IMSQRT:e=>{const{unit:t}=bt(e),r=Math.sqrt(Ke.IMABS(e)),n=Ke.IMARGUMENT(e);return Ke.COMPLEX(r*Math.cos(n/2),r*Math.sin(n/2),t)},IMSUB:(e,t)=>{const r=bt(e),n=r.real,a=r.im,i=r.unit,s=bt(t),d=s.real,h=s.im,c=s.unit;if(i!==c)throw M.VALUE;return Ke.COMPLEX(n-d,a-h,i)},IMSUM:(...e)=>{let t=0,r=0,n;return Fe.flattenParams(e,null,!1,a=>{const{real:i,im:s,unit:d}=bt(a);if(n||(n=d),n!==d)throw M.VALUE;t+=i,r+=s}),Ke.COMPLEX(t,r,n)},IMTAN:e=>(bt(e),Ke.IMDIV(Ke.IMSIN(e),Ke.IMCOS(e))),OCT2BIN:(e,t)=>{if(e=Fe.accept(e,R.STRING),t=Fe.accept(t,R.NUMBER,null),e.length>10||t>10||t!==null&&t<0)throw M.NUM;t=Math.trunc(t);const r=e.length===10&&e.substring(0,1)==="7",n=Ke.OCT2DEC(e);if(n<ho||n>pl)return M.NUM;if(r)return`1${Pt.REPT("0",9-(512+n).toString(2).length)}${(512+n).toString(2)}`;const a=n.toString(2);if(t===0)return a;if(t<a.length)throw M.NUM;return Pt.REPT("0",t-a.length)+a},OCT2DEC:e=>{if(e=Fe.accept(e,R.STRING),e.length>10)throw M.NUM;for(const r of e)if(r<"0"||r>"7")throw M.NUM;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},OCT2HEX:(e,t)=>{if(e=Fe.accept(e,R.STRING),t=Fe.accept(t,R.NUMBER_NO_BOOLEAN,null),e.length>10)throw M.NUM;for(const a of e)if(a<"0"||a>"7")throw M.NUM;if(t=Math.trunc(t),t<0||t>10)throw M.NUM;const r=Ke.OCT2DEC(e),n=Ke.DEC2HEX(r);if(t===0)return n;if(t<n.length)throw M.NUM;return Pt.REPT("0",t-n.length)+n}},nt=Et,lf={ADDRESS:(e,t,r,n,a)=>{if(e=nt.accept(e,R.NUMBER),t=nt.accept(t,R.NUMBER),r=nt.accept(r,R.NUMBER,1),n=nt.accept(n,R.BOOLEAN,!0),a=nt.accept(a,R.STRING,""),e<1||t<1||r<1||r>4)throw M.VALUE;let i="";return a.length>0&&(/[^A-Za-z_.\d\u007F-\uFFFF]/.test(a)?i+=`'${a}'!`:i+=`${a}!`),n?(i+=r===1||r===3?"$":"",i+=zn.columnNumberToName(t),i+=r===1||r===2?"$":"",i+=e):(i+="R",i+=r===4||r===3?`[${e}]`:e,i+="C",i+=r===4||r===2?`[${t}]`:t),i},AREAS:e=>(e=nt.accept(e),e instanceof Vn?e.length:1),CHOOSE:(e,...t)=>{},COLUMN:(e,t)=>{if(t==null){if(e.position.col!=null)return e.position.col;throw Error("FormulaParser.parse is called without position parameter.")}else{if(typeof t!="object"||Array.isArray(t))throw M.VALUE;if(nt.isCellRef(t))return t.ref.col;if(nt.isRangeRef(t))return t.ref.from.col;throw Error("ReferenceFunctions.COLUMN should not reach here.")}},COLUMNS:(e,t)=>{if(t==null)throw Error("COLUMNS requires one argument");if(typeof t!="object"||Array.isArray(t))throw M.VALUE;if(nt.isCellRef(t))return 1;if(nt.isRangeRef(t))return Math.abs(t.ref.from.col-t.ref.to.col)+1;throw Error("ReferenceFunctions.COLUMNS should not reach here.")},HLOOKUP:(e,t,r,n)=>{e=nt.accept(e);try{t=nt.accept(t,R.ARRAY,void 0,!1)}catch(s){throw s instanceof M?M.NA:s}if(r=nt.accept(r,R.NUMBER),n=nt.accept(n,R.BOOLEAN,!0),r<1)throw M.VALUE;if(t[r-1]===void 0)throw M.REF;const a=typeof e;if(n){let s=a===typeof t[0][0]?t[0][0]:null;for(let d=1;d<t[0].length;d++){const h=t[0][d];if(typeof h===a){if(s>e&&h>e)throw M.NA;if(h===e)return t[r-1][d];if(s!=null&&h>e&&s<=e)return t[r-1][d-1];s=h}}if(s==null)throw M.NA;return t[0].length===1?t[r-1][0]:s}let i=-1;if(Ir.isWildCard(e)?i=t[0].findIndex(s=>Ir.toRegex(e,"i").test(s)):i=t[0].findIndex(s=>s===e),i===-1)throw M.NA;return t[r-1][i]},INDEX:(e,t,r,n,a)=>{r=e.utils.extractRefValue(r),r={value:r.val,isArray:r.isArray},r=nt.accept(r,R.NUMBER),r=Math.trunc(r),n==null?n=1:(n=e.utils.extractRefValue(n),n={value:n.val,isArray:n.isArray},n=nt.accept(n,R.NUMBER,1),n=Math.trunc(n)),a==null?a=1:(a=e.utils.extractRefValue(a),a={value:a.val,isArray:a.isArray},a=nt.accept(a,R.NUMBER,1),a=Math.trunc(a));let i=t;if(t instanceof Vn)i=t.refs[a-1];else if(a>1)throw M.REF;if(r===0&&n===0)return i;if(r===0){if(nt.isRangeRef(i)){if(i.ref.to.col-i.ref.from.col<n-1)throw M.REF;return i.ref.from.col+=n-1,i.ref.to.col=i.ref.from.col,i}if(Array.isArray(i)){const s=[];return i.forEach(d=>s.push([d[n-1]])),s}}if(n===0){if(nt.isRangeRef(i)){if(i.ref.to.row-i.ref.from.row<r-1)throw M.REF;return i.ref.from.row+=r-1,i.ref.to.row=i.ref.from.row,i}if(Array.isArray(i))return i[n-1]}if(r!==0&&n!==0){if(nt.isRangeRef(i)){if(i=i.ref,i.to.row-i.from.row<r-1||i.to.col-i.from.col<n-1)throw M.REF;return{ref:{row:i.from.row+r-1,col:i.from.col+n-1}}}if(nt.isCellRef(i)){if(i=i.ref,r>1||n>1)throw M.REF;return{ref:{row:i.row+r-1,col:i.col+n-1}}}if(Array.isArray(i)){if(i.length<r||i[0].length<n)throw M.REF;return i[r-1][n-1]}}},MATCH:()=>{},ROW:(e,t)=>{if(t==null){if(e.position.row!=null)return e.position.row;throw Error("FormulaParser.parse is called without position parameter.")}else{if(typeof t!="object"||Array.isArray(t))throw M.VALUE;if(nt.isCellRef(t))return t.ref.row;if(nt.isRangeRef(t))return t.ref.from.row;throw Error("ReferenceFunctions.ROW should not reach here.")}},ROWS:(e,t)=>{if(t==null)throw Error("ROWS requires one argument");if(typeof t!="object"||Array.isArray(t))throw M.VALUE;if(nt.isCellRef(t))return 1;if(nt.isRangeRef(t))return Math.abs(t.ref.from.row-t.ref.to.row)+1;throw Error("ReferenceFunctions.ROWS should not reach here.")},TRANSPOSE:e=>{e=nt.accept(e,R.ARRAY,void 0,!1);const t=[];for(let r=0;r<e[0].length;r++){t[r]=[];for(let n=0;n<e.length;n++)t[r][n]=e[n][r]}return t},VLOOKUP:(e,t,r,n)=>{e=nt.accept(e);try{t=nt.accept(t,R.ARRAY,void 0,!1)}catch(s){throw s instanceof M?M.NA:s}if(r=nt.accept(r,R.NUMBER),n=nt.accept(n,R.BOOLEAN,!0),r<1)throw M.VALUE;if(t[0][r-1]===void 0)throw M.REF;const a=typeof e;if(n){let s=a===typeof t[0][0]?t[0][0]:null;for(let d=1;d<t.length;d++){const h=t[d],c=t[d][0];if(typeof c===a){if(s>e&&c>e)throw M.NA;if(c===e)return h[r-1];if(s!=null&&c>e&&s<=e)return t[d-1][r-1];s=c}}if(s==null)throw M.NA;return t.length===1?t[0][r-1]:s}let i=-1;if(Ir.isWildCard(e)?i=t.findIndex(s=>Ir.toRegex(e,"i").test(s[0])):i=t.findIndex(s=>s[0]===e),i===-1)throw M.NA;return t[i][r-1]}},zt=Et,x_={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7},cf={CELL:(e,t)=>{},"ERROR.TYPE":e=>{if(e=zt.accept(e),e instanceof M)return x_[e.toString()];throw M.NA},INFO:()=>{},ISBLANK:e=>e.ref?e.value==null||e.value==="":!1,ISERR:e=>(e=zt.accept(e),e instanceof M&&e.toString()!=="#N/A"),ISERROR:e=>(e=zt.accept(e),e instanceof M),ISEVEN:e=>(e=zt.accept(e,R.NUMBER),e=Math.trunc(e),e%2===0),ISLOGICAL:e=>(e=zt.accept(e),typeof e=="boolean"),ISNA:e=>(e=zt.accept(e),e instanceof M&&e.toString()==="#N/A"),ISNONTEXT:e=>(e=zt.accept(e),typeof e!="string"),ISNUMBER:e=>(e=zt.accept(e),typeof e=="number"),ISREF:e=>!e.ref||zt.isCellRef(e)&&(e.ref.row>1048576||e.ref.col>16384)||zt.isRangeRef(e)&&(e.ref.from.row>1048576||e.ref.from.col>16384||e.ref.to.row>1048576||e.ref.to.col>16384)?!1:(e=zt.accept(e),!(e instanceof M&&e.toString()==="#REF!")),ISTEXT:e=>(e=zt.accept(e),typeof e=="string"),N:e=>{e=zt.accept(e);const t=typeof e;if(t==="number")return e;if(t==="boolean")return Number(e);if(e instanceof M)throw e;return 0},NA:()=>{throw M.NA},TYPE:e=>{if(e.ref){if(zt.isRangeRef(e))return 16;if(zt.isCellRef(e)&&(e=zt.accept(e),typeof e=="string"&&e.length===0))return 1}e=zt.accept(e);const t=typeof e;if(t==="number")return 1;if(t==="string")return 2;if(t==="boolean")return 4;if(e instanceof M)return 16;if(Array.isArray(e))return 64;throw M.VALUE}},he=Et,T_=2.5066282746310002,Yg={"BETA.DIST":(e,t,r,n,a,i)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),n=he.accept(n,R.BOOLEAN),a=he.accept(a,R.NUMBER,0),i=he.accept(i,R.NUMBER,1),t<=0||r<=0||e<a||e>i||a===i)throw M.NUM;return e=(e-a)/(i-a),n?Ue.beta.cdf(e,t,r):Ue.beta.pdf(e,t,r)/(i-a)},"BETA.INV":(e,t,r,n,a)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),n=he.accept(n,R.NUMBER,0),a=he.accept(a,R.NUMBER,1),t<=0||r<=0||e<=0||e>1)throw M.NUM;return Ue.beta.inv(e,t,r)*(a-n)+n},"BINOM.DIST":(e,t,r,n)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),n=he.accept(n,R.BOOLEAN),t<0||r<0||r>1||e<0||e>t)throw M.NUM;return n?Ue.binomial.cdf(e,t,r):Ue.binomial.pdf(e,t,r)},"BINOM.DIST.RANGE":(e,t,r,n)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),n=he.accept(n,R.NUMBER,r),e<0||t<0||t>1||r<0||r>e||n<r||n>e)throw M.NUM;let a=0;for(let i=r;i<=n;i++)a+=Lt.COMBIN(e,i)*t**i*(1-t)**(e-i);return a},"BINOM.INV":(e,t,r)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),e<0||t<0||t>1||r<0||r>1)throw M.NUM;let n=0;for(;n<=e;){if(Ue.binomial.cdf(n,e,t)>=r)return n;n++}throw M.NUM},"CHISQ.DIST":(e,t,r)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),t=Math.trunc(t),e<0||t<1||t>10**10)throw M.NUM;return r?Ue.chisquare.cdf(e,t):Ue.chisquare.pdf(e,t)},"CHISQ.DIST.RT":(e,t)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),t=Math.trunc(t),e<0||t<1||t>10**10)throw M.NUM;return 1-Ue.chisquare.cdf(e,t)},"CHISQ.INV":(e,t)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),t=Math.trunc(t),e<0||e>1||t<1||t>10**10)throw M.NUM;return Ue.chisquare.inv(e,t)},"CHISQ.INV.RT":(e,t)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),t=Math.trunc(t),e<0||e>1||t<1||t>10**10)throw M.NUM;return Ue.chisquare.inv(1-e,t)},"CHISQ.TEST":(e,t)=>{const r=he.accept(e,R.ARRAY,void 0,!1,!1),n=he.accept(t,R.ARRAY,void 0,!1,!1);if(r.length!==n.length||r[0].length!==n[0].length||r.length===1&&r[0].length===1)throw M.NA;const a=r.length,i=r[0].length;let s=(a-1)*(i-1);a===1?s=i-1:s=a-1;let d=0;for(let u=0;u<a;u++)for(let f=0;f<i;f++)if(!(typeof r[u][f]!="number"||typeof n[u][f]!="number")){if(n[u][f]===0)throw M.DIV0;d+=(r[u][f]-n[u][f])**2/n[u][f]}let h=Math.exp(-.5*d);s%2===1&&(h*=Math.sqrt(2*d/Math.PI));let c=s;for(;c>=2;)h=h*d/c,c-=2;let o=h,l=s;for(;o>1e-15*h;)l+=2,o=o*d/l,h+=o;return 1-h},"CONFIDENCE.NORM":(e,t,r)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),r=Math.trunc(r),e<=0||e>=1||t<=0||r<1)throw M.NUM;return Ue.normalci(1,e,t,r)[1]-1},"CONFIDENCE.T":(e,t,r)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),r=Math.trunc(r),e<=0||e>=1||t<=0||r<1)throw M.NUM;if(r===1)throw M.DIV0;return Ue.tci(1,e,t,r)[1]-1},CORREL:(e,t)=>{if(e=he.accept(e,R.ARRAY,void 0,!0,!0),t=he.accept(t,R.ARRAY,void 0,!0,!0),e.length!==t.length)throw M.NA;const r=[],n=[];for(let a=0;a<e.length;a++)typeof e[a]!="number"||typeof t[a]!="number"||(r.push(e[a]),n.push(t[a]));if(r.length<=1)throw M.DIV0;return Ue.corrcoeff(r,n)},"COVARIANCE.P":(e,t)=>{if(e=he.accept(e,R.ARRAY,void 0,!0,!0),t=he.accept(t,R.ARRAY,void 0,!0,!0),e.length!==t.length)throw M.NA;const r=[],n=[];for(let d=0;d<e.length;d++)typeof e[d]!="number"||typeof t[d]!="number"||(r.push(e[d]),n.push(t[d]));const a=Ue.mean(r),i=Ue.mean(n);let s=0;for(let d=0;d<r.length;d++)s+=(r[d]-a)*(n[d]-i);return s/r.length},"COVARIANCE.S":(e,t)=>{if(e=he.accept(e,R.ARRAY,void 0,!0,!0),t=he.accept(t,R.ARRAY,void 0,!0,!0),e.length!==t.length)throw M.NA;const r=[],n=[];for(let a=0;a<e.length;a++)typeof e[a]!="number"||typeof t[a]!="number"||(r.push(e[a]),n.push(t[a]));if(r.length<=1)throw M.DIV0;return Ue.covariance(r,n)},DEVSQ:(...e)=>{let t=0;const r=[];he.flattenParams(e,R.NUMBER,!0,(a,i)=>{typeof a=="number"&&(t+=a,r.push(a))});const n=t/r.length;t=0;for(let a=0;a<r.length;a++)t+=(r[a]-n)**2;return t},"EXPON.DIST":(e,t,r)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.BOOLEAN),e<0||t<=0)throw M.NUM;return r?Ue.exponential.cdf(e,t):Ue.exponential.pdf(e,t)},"F.DIST":(e,t,r,n)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),n=he.accept(n,R.BOOLEAN),e<0||t<1||r<1)throw M.NUM;return t=Math.trunc(t),r=Math.trunc(r),n?Ue.centralF.cdf(e,t,r):Ue.centralF.pdf(e,t,r)},"F.DIST.RT":(e,t,r)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),e<0||t<1||r<1)throw M.NUM;return t=Math.trunc(t),r=Math.trunc(r),1-Ue.centralF.cdf(e,t,r)},"F.INV":(e,t,r)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),e<0||e>1||t<1||r<1)throw M.NUM;return t=Math.trunc(t),r=Math.trunc(r),Ue.centralF.inv(e,t,r)},"F.INV.RT":(e,t,r)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),e<0||e>1||t<1||t>=10**10||r<1||r>=10**10)throw M.NUM;return t=Math.trunc(t),r=Math.trunc(r),Ue.centralF.inv(1-e,t,r)},"F.TEST":(e,t)=>{e=he.accept(e,R.ARRAY,void 0,!0,!0),t=he.accept(t,R.ARRAY,void 0,!0,!0);const r=[],n=[];let a=0,i=0;for(let h=0;h<Math.max(e.length,t.length);h++)typeof e[h]=="number"&&(r.push(e[h]),a+=e[h]),typeof t[h]=="number"&&(n.push(t[h]),i+=t[h]);if(r.length<=1||n.length<=1)throw M.DIV0;a/=r.length,i/=n.length;let s=0,d=0;for(let h=0;h<r.length;h++)s+=(a-r[h])**2;s/=r.length-1;for(let h=0;h<n.length;h++)d+=(i-n[h])**2;return d/=n.length-1,Ue.centralF.cdf(s/d,r.length-1,n.length-1)*2},FISHER:e=>{if(e=he.accept(e,R.NUMBER),e<=-1||e>=1)throw M.NUM;return Math.log((1+e)/(1-e))/2},FISHERINV:e=>{e=he.accept(e,R.NUMBER);const t=Math.exp(2*e);return(t-1)/(t+1)},FORECAST:(e,t,r)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.ARRAY,void 0,!0,!0),r=he.accept(r,R.ARRAY,void 0,!0,!0),r.length!==t.length)throw M.NA;const n=[],a=[];let i=!0;for(let u=0;u<t.length;u++)typeof t[u]!="number"||typeof r[u]!="number"||(n.push(t[u]),a.push(r[u]),r[u]!==r[0]&&(i=!1));if(i)throw M.DIV0;const s=Ue.mean(n),d=Ue.mean(a);let h=0,c=0;for(let u=0;u<n.length;u++)h+=(a[u]-d)*(n[u]-s),c+=(a[u]-d)**2;const o=h/c;return s-o*d+o*e},"FORECAST.ETS":()=>{},"FORECAST.ETS.CONFINT":()=>{},"FORECAST.ETS.SEASONALITY":()=>{},"FORECAST.ETS.STAT":()=>{},"FORECAST.LINEAR":(e,t,r)=>Yg.FORECAST(e,t,r),FREQUENCY:(e,t)=>{e=he.accept(e,R.ARRAY,void 0,!0,!0),t=he.accept(t,R.ARRAY,void 0,!0,!0);const r=[];for(let a=0;a<t.length;a++)typeof t[a]=="number"&&r.push(t[a]);r.sort(),r.push(1/0);const n=[];for(let a=0;a<r.length;a++){n[a]=[],n[a][0]=0;for(let i=0;i<e.length;i++){if(typeof e[i]!="number")continue;e[i]<=r[a]&&(n[a][0]++,e[i]=null)}}return n},GAMMA:e=>{if(e=he.accept(e,R.NUMBER),e===0||e<0&&e===Math.trunc(e))throw M.NUM;return Ue.gammafn(e)},"GAMMA.DIST":(e,t,r,n)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),n=he.accept(n,R.BOOLEAN),e<0||t<=0||r<=0)throw M.NUM;return n?Ue.gamma.cdf(e,t,r,!0):Ue.gamma.pdf(e,t,r,!1)},"GAMMA.INV":(e,t,r)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),e<0||e>1||t<=0||r<=0)throw M.NUM;return Ue.gamma.inv(e,t,r)},GAMMALN:e=>{if(e=he.accept(e,R.NUMBER),e<=0)throw M.NUM;return Ue.gammaln(e)},"GAMMALN.PRECISE":e=>{if(e=he.accept(e,R.NUMBER),e<=0)throw M.NUM;return Ue.gammaln(e)},GAUSS:e=>(e=he.accept(e,R.NUMBER),Ue.normal.cdf(e,0,1)-.5),GEOMEAN:(...e)=>{const t=[];return he.flattenParams(e,R.NUMBER,!0,(r,n)=>{typeof r=="number"&&t.push(r)}),Ue.geomean(t)},GROWTH:(e,t,r,n)=>{e=he.accept(e,R.ARRAY,void 0,!0,!0);for(let f=0;f<e.length;f++)if(typeof e[f]!="number")throw M.VALUE;t=he.accept(t,R.ARRAY,null,!0,!0);const a=t==null;if(t==null){t=[];for(let f=1;f<=e.length;f++)t.push(f)}else{if(t.length!==e.length)throw M.REF;for(let f=0;f<t.length;f++)if(typeof t[f]!="number")throw M.VALUE}if(r=he.accept(r,R.ARRAY,null,!1,!0),r==null&&a){r=[];for(let f=1;f<=e.length;f++)r.push(f);r=[r]}else r==null&&(r=Array.isArray(t[0])?t:[t]);n=he.accept(n,R.BOOLEAN,!0);const i=e.length;let s=0,d=0,h=0,c=0;for(let f=0;f<i;f++){const m=t[f],g=Math.log(e[f]);s+=m,d+=g,h+=m*g,c+=m*m}s/=i,d/=i,h/=i,c/=i;let o,l;n?(o=(h-s*d)/(c-s*s),l=d-o*s):(o=h/c,l=0);const u=[];for(let f=0;f<r.length;f++){u[f]=[];for(let m=0;m<r[0].length;m++){if(typeof r[f][m]!="number")throw M.VALUE;u[f][m]=Math.exp(l+o*r[f][m])}}return u},HARMEAN:(...e)=>{let t=0,r=0;return he.flattenParams(e,R.NUMBER,!0,(n,a)=>{typeof n=="number"&&(r+=1/n,t++)}),t/r},"HYPGEOM.DIST":(e,t,r,n,a)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),n=he.accept(n,R.NUMBER),a=he.accept(a,R.BOOLEAN),e=Math.trunc(e),t=Math.trunc(t),r=Math.trunc(r),n=Math.trunc(n),n<=0||e<0||t<=0||r<=0||t>n||r>n||t<e||r<e||e<t-n+r)throw M.NUM;function i(d,h,c,o){return Lt.COMBIN(c,d)*Lt.COMBIN(o-c,h-d)/Lt.COMBIN(o,h)}function s(d,h,c,o){let l=0;for(let u=0;u<=d;u++)l+=i(u,h,c,o);return l}return a?s(e,t,r,n):i(e,t,r,n)},INTERCEPT:(e,t)=>{if(e=he.accept(e,R.ARRAY,void 0,!0,!0),t=he.accept(t,R.ARRAY,void 0,!0,!0),t.length!==e.length)throw M.NA;const r=[],n=[];for(let c=0;c<e.length;c++)typeof e[c]!="number"||typeof t[c]!="number"||(r.push(e[c]),n.push(t[c]));if(r.length<=1)throw M.DIV0;const a=Ue.mean(r),i=Ue.mean(n);let s=0,d=0;for(let c=0;c<r.length;c++)s+=(n[c]-i)*(r[c]-a),d+=(n[c]-i)**2;const h=s/d;return a-h*i},KURT:(...e)=>{let t=0;const r=[];he.flattenParams(e,R.NUMBER,!0,(i,s)=>{typeof i=="number"&&(t+=i,r.push(i))});const n=r.length;t/=n;let a=0;for(let i=0;i<n;i++)a+=(r[i]-t)**4;return a/=Ue.stdev(r,!0)**4,n*(n+1)/((n-1)*(n-2)*(n-3))*a-3*(n-1)*(n-1)/((n-2)*(n-3))},LINEST:()=>{},LOGEST:()=>{},"LOGNORM.DIST":(e,t,r,n)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),n=he.accept(n,R.BOOLEAN),e<=0||r<=0)throw M.NUM;return n?Ue.lognormal.cdf(e,t,r):Ue.lognormal.pdf(e,t,r)},"LOGNORM.INV":(e,t,r)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),e<=0||e>=1||r<=0)throw M.NUM;return Ue.lognormal.inv(e,t,r)},"MODE.MULT":()=>{},"MODE.SNGL":()=>{},"NEGBINOM.DIST":(e,t,r,n)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),n=he.accept(n,R.BOOLEAN),e=Math.trunc(e),t=Math.trunc(t),r<0||r>1||e<0||t<1)throw M.NUM;return n?Ue.negbin.cdf(e,t,r):Ue.negbin.pdf(e,t,r)},"NORM.DIST":(e,t,r,n)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),n=he.accept(n,R.BOOLEAN),r<=0)throw M.NUM;return n?Ue.normal.cdf(e,t,r):Ue.normal.pdf(e,t,r)},"NORM.INV":(e,t,r)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),e<=0||e>=1||r<=0)throw M.NUM;return Ue.normal.inv(e,t,r)},"NORM.S.DIST":(e,t)=>(e=he.accept(e,R.NUMBER),t=he.accept(t,R.BOOLEAN),t?Ue.normal.cdf(e,0,1):Ue.normal.pdf(e,0,1)),"NORM.S.INV":e=>{if(e=he.accept(e,R.NUMBER),e<=0||e>=1)throw M.NUM;return Ue.normal.inv(e,0,1)},PEARSON:()=>{},"PERCENTILE.EXC":()=>{},"PERCENTILE.INC":()=>{},"PERCENTRANK.EXC":()=>{},"PERCENTRANK.INC":()=>{},PERMUTATIONA:()=>{},PHI:e=>(e=he.accept(e,R.NUMBER),Math.exp(-.5*e*e)/T_),"POISSON.DIST":(e,t,r)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.BOOLEAN),e<0||t<0)throw M.NUM;return e=Math.trunc(e),r?Ue.poisson.cdf(e,t):Ue.poisson.pdf(e,t)},PROB:()=>{},"QUARTILE.EXC":()=>{},"QUARTILE.INC":()=>{},"RANK.AVG":()=>{},"RANK.EQ":()=>{},RSQ:()=>{},SKEW:()=>{},"SKEW.P":()=>{},SLOPE:()=>{},STANDARDIZE:(e,t,r)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),r<=0)throw M.NUM;return(e-t)/r},"STDEV.P":()=>{},"STDEV.S":()=>{},STDEVA:()=>{},STDEVPA:()=>{},STEYX:()=>{},"T.DIST":(e,t,r)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.BOOLEAN),t<1)throw M.NUM;return r?Ue.studentt.cdf(e,t):Ue.studentt.pdf(e,t)},"T.DIST.2T":(e,t)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),t<1||e<0)throw M.NUM;return(1-Ue.studentt.cdf(e,t))*2},"T.DIST.RT":(e,t)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),t<1)throw M.NUM;return 1-Ue.studentt.cdf(e,t)},"T.INV":(e,t)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),e<=0||e>1||t<1)throw M.NUM;return t=t%1===0?t:Math.trunc(t),Ue.studentt.inv(e,t)},"T.INV.2T":(e,t)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),e<=0||e>1||t<1)throw M.NUM;return t=t%1===0?t:Math.trunc(t),Math.abs(Ue.studentt.inv(e/2,t))},"T.TEST":()=>{},TREND:()=>{},TRIMMEAN:()=>{},"VAR.P":()=>{},"VAR.S":()=>{},VARA:()=>{},VARPA:()=>{},"WEIBULL.DIST":(e,t,r,n)=>{if(e=he.accept(e,R.NUMBER),t=he.accept(t,R.NUMBER),r=he.accept(r,R.NUMBER),n=he.accept(n,R.BOOLEAN),e<0||t<=0||r<=0)throw M.NUM;return n?1-Math.exp(-((e/r)**t)):e**(t-1)*Math.exp(-((e/r)**t))*t/r**t},"Z.TEST":()=>{}},Yr=Et,Jl={AVEDEV:(...e)=>{let t=0;const r=[];Yr.flattenParams(e,R.NUMBER,!0,(a,i)=>{typeof a=="number"&&(t+=a,r.push(a))});const n=t/r.length;t=0;for(let a=0;a<r.length;a++)t+=Math.abs(r[a]-n);return t/r.length},AVERAGE:(...e)=>{let t=0,r=0;return Yr.flattenParams(e,R.NUMBER,!0,(n,a)=>{typeof n=="number"&&(t+=n,r++)}),t/r},AVERAGEA:(...e)=>{let t=0,r=0;return Yr.flattenParams(e,R.NUMBER,!0,(n,a)=>{const i=typeof n;i==="number"?(t+=n,r++):i==="string"&&r++}),t/r},AVERAGEIF:(e,t,r,n)=>{const a=Yr.retrieveRanges(e,t,n);t=a[0],n=a[1],r=Yr.retrieveArg(e,r);const i=r.isArray;r=Ql.parse(Yr.accept(r));let s=0,d=0;if(t.forEach((h,c)=>{h.forEach((o,l)=>{const u=n[c][l];typeof u=="number"&&(r.op==="wc"?r.match===r.value.test(o)&&(s+=u,d++):va.compareOp(o,r.op,r.value,Array.isArray(o),i)&&(s+=u,d++))})}),d===0)throw M.DIV0;return s/d},AVERAGEIFS:()=>{},COUNT:(...e)=>{let t=0;return Yr.flattenParams(e,null,!0,(r,n)=>{(n.isLiteral&&!isNaN(r)||typeof r=="number")&&t++}),t},COUNTIF:(e,t)=>{e=Yr.accept(e,R.ARRAY,void 0,!1,!0);const r=t.isArray;t=Yr.accept(t);let n=0;return t=Ql.parse(t),e.forEach(a=>{a.forEach(i=>{t.op==="wc"?t.match===t.value.test(i)&&n++:va.compareOp(i,t.op,t.value,Array.isArray(i),r)&&n++})}),n},LARGE:()=>{},MAX:()=>{},MAXA:()=>{},MAXIFS:()=>{},MEDIAN:()=>{},MIN:()=>{},MINA:()=>{},MINIFS:()=>{},PERMUT:()=>{},PERMUTATIONA:()=>{},SMALL:()=>{}};Object.assign(Jl,Yg);const R_=Et,O_={ENCODEURL:e=>encodeURIComponent(R_.accept(e,R.STRING)),FILTERXML:()=>{},WEBSERVICE:(e,t)=>{throw M.ERROR("WEBSERVICE is not supported in sync mode.")}};var qg={},Si={};Object.defineProperty(Si,"__esModule",{value:!0});Si.VERSION=void 0;Si.VERSION="10.1.2";var ur={},k_=Object.prototype;function I_(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||k_;return e===r}var Li=I_;function M_(e,t){return function(r){return e(t(r))}}var Xg=M_,P_=Xg,S_=P_(Object.keys,Object),L_=S_,$_=Li,D_=L_,U_=Object.prototype,F_=U_.hasOwnProperty;function B_(e){if(!$_(e))return D_(e);var t=[];for(var r in Object(e))F_.call(e,r)&&r!="constructor"&&t.push(r);return t}var jg=B_,V_=typeof Ae=="object"&&Ae&&Ae.Object===Object&&Ae,Qg=V_,z_=Qg,G_=typeof self=="object"&&self&&self.Object===Object&&self,H_=z_||G_||Function("return this")(),$r=H_,W_=$r,K_=W_.Symbol,Sa=K_,uf=Sa,Zg=Object.prototype,Y_=Zg.hasOwnProperty,q_=Zg.toString,Qa=uf?uf.toStringTag:void 0;function X_(e){var t=Y_.call(e,Qa),r=e[Qa];try{e[Qa]=void 0;var n=!0}catch{}var a=q_.call(e);return n&&(t?e[Qa]=r:delete e[Qa]),a}var j_=X_,Q_=Object.prototype,Z_=Q_.toString;function J_(e){return Z_.call(e)}var eN=J_,df=Sa,tN=j_,rN=eN,nN="[object Null]",aN="[object Undefined]",ff=df?df.toStringTag:void 0;function iN(e){return e==null?e===void 0?aN:nN:ff&&ff in Object(e)?tN(e):rN(e)}var Kn=iN;function oN(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Dr=oN,sN=Kn,lN=Dr,cN="[object AsyncFunction]",uN="[object Function]",dN="[object GeneratorFunction]",fN="[object Proxy]";function hN(e){if(!lN(e))return!1;var t=sN(e);return t==uN||t==dN||t==cN||t==fN}var $i=hN,pN=$r,gN=pN["__core-js_shared__"],mN=gN,gl=mN,hf=function(){var e=/[^.]+$/.exec(gl&&gl.keys&&gl.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function vN(e){return!!hf&&hf in e}var bN=vN,yN=Function.prototype,EN=yN.toString;function wN(e){if(e!=null){try{return EN.call(e)}catch{}try{return e+""}catch{}}return""}var Jg=wN,_N=$i,NN=bN,AN=Dr,CN=Jg,xN=/[\\^$.*+?()[\]{}|]/g,TN=/^\[object .+?Constructor\]$/,RN=Function.prototype,ON=Object.prototype,kN=RN.toString,IN=ON.hasOwnProperty,MN=RegExp("^"+kN.call(IN).replace(xN,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function PN(e){if(!AN(e)||NN(e))return!1;var t=_N(e)?MN:TN;return t.test(CN(e))}var SN=PN;function LN(e,t){return e==null?void 0:e[t]}var $N=LN,DN=SN,UN=$N;function FN(e,t){var r=UN(e,t);return DN(r)?r:void 0}var Yn=FN,BN=Yn,VN=$r,zN=BN(VN,"DataView"),GN=zN,HN=Yn,WN=$r,KN=HN(WN,"Map"),Hc=KN,YN=Yn,qN=$r,XN=YN(qN,"Promise"),jN=XN,QN=Yn,ZN=$r,JN=QN(ZN,"Set"),em=JN,eA=Yn,tA=$r,rA=eA(tA,"WeakMap"),nA=rA,ec=GN,tc=Hc,rc=jN,nc=em,ac=nA,tm=Kn,La=Jg,pf="[object Map]",aA="[object Object]",gf="[object Promise]",mf="[object Set]",vf="[object WeakMap]",bf="[object DataView]",iA=La(ec),oA=La(tc),sA=La(rc),lA=La(nc),cA=La(ac),Sn=tm;(ec&&Sn(new ec(new ArrayBuffer(1)))!=bf||tc&&Sn(new tc)!=pf||rc&&Sn(rc.resolve())!=gf||nc&&Sn(new nc)!=mf||ac&&Sn(new ac)!=vf)&&(Sn=function(e){var t=tm(e),r=t==aA?e.constructor:void 0,n=r?La(r):"";if(n)switch(n){case iA:return bf;case oA:return pf;case sA:return gf;case lA:return mf;case cA:return vf}return t});var Di=Sn;function uA(e){return e!=null&&typeof e=="object"}var Ur=uA,dA=Kn,fA=Ur,hA="[object Arguments]";function pA(e){return fA(e)&&dA(e)==hA}var gA=pA,yf=gA,mA=Ur,rm=Object.prototype,vA=rm.hasOwnProperty,bA=rm.propertyIsEnumerable,yA=yf(function(){return arguments}())?yf:function(e){return mA(e)&&vA.call(e,"callee")&&!bA.call(e,"callee")},ss=yA,EA=Array.isArray,lt=EA,wA=9007199254740991;function _A(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=wA}var Wc=_A,NA=$i,AA=Wc;function CA(e){return e!=null&&AA(e.length)&&!NA(e)}var Fr=CA,Aa={exports:{}};function xA(){return!1}var TA=xA;(function(e,t){var r=$r,n=TA,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===a,d=s?r.Buffer:void 0,h=d?d.isBuffer:void 0,c=h||n;e.exports=c})(Aa,Aa.exports);var RA=Kn,OA=Wc,kA=Ur,IA="[object Arguments]",MA="[object Array]",PA="[object Boolean]",SA="[object Date]",LA="[object Error]",$A="[object Function]",DA="[object Map]",UA="[object Number]",FA="[object Object]",BA="[object RegExp]",VA="[object Set]",zA="[object String]",GA="[object WeakMap]",HA="[object ArrayBuffer]",WA="[object DataView]",KA="[object Float32Array]",YA="[object Float64Array]",qA="[object Int8Array]",XA="[object Int16Array]",jA="[object Int32Array]",QA="[object Uint8Array]",ZA="[object Uint8ClampedArray]",JA="[object Uint16Array]",eC="[object Uint32Array]",gt={};gt[KA]=gt[YA]=gt[qA]=gt[XA]=gt[jA]=gt[QA]=gt[ZA]=gt[JA]=gt[eC]=!0;gt[IA]=gt[MA]=gt[HA]=gt[PA]=gt[WA]=gt[SA]=gt[LA]=gt[$A]=gt[DA]=gt[UA]=gt[FA]=gt[BA]=gt[VA]=gt[zA]=gt[GA]=!1;function tC(e){return kA(e)&&OA(e.length)&&!!gt[RA(e)]}var rC=tC;function nC(e){return function(t){return e(t)}}var Ui=nC,Ca={exports:{}};(function(e,t){var r=Qg,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,s=i&&r.process,d=function(){try{var h=a&&a.require&&a.require("util").types;return h||s&&s.binding&&s.binding("util")}catch{}}();e.exports=d})(Ca,Ca.exports);var aC=rC,iC=Ui,Ef=Ca.exports,wf=Ef&&Ef.isTypedArray,oC=wf?iC(wf):aC,Kc=oC,sC=jg,lC=Di,cC=ss,uC=lt,dC=Fr,fC=Aa.exports,hC=Li,pC=Kc,gC="[object Map]",mC="[object Set]",vC=Object.prototype,bC=vC.hasOwnProperty;function yC(e){if(e==null)return!0;if(dC(e)&&(uC(e)||typeof e=="string"||typeof e.splice=="function"||fC(e)||pC(e)||cC(e)))return!e.length;var t=lC(e);if(t==gC||t==mC)return!e.size;if(hC(e))return!sC(e).length;for(var r in e)if(bC.call(e,r))return!1;return!0}var Br=yC;function EC(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var Fi=EC;function wC(){this.__data__=[],this.size=0}var _C=wC;function NC(e,t){return e===t||e!==e&&t!==t}var Bi=NC,AC=Bi;function CC(e,t){for(var r=e.length;r--;)if(AC(e[r][0],t))return r;return-1}var ls=CC,xC=ls,TC=Array.prototype,RC=TC.splice;function OC(e){var t=this.__data__,r=xC(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():RC.call(t,r,1),--this.size,!0}var kC=OC,IC=ls;function MC(e){var t=this.__data__,r=IC(t,e);return r<0?void 0:t[r][1]}var PC=MC,SC=ls;function LC(e){return SC(this.__data__,e)>-1}var $C=LC,DC=ls;function UC(e,t){var r=this.__data__,n=DC(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var FC=UC,BC=_C,VC=kC,zC=PC,GC=$C,HC=FC;function $a(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}$a.prototype.clear=BC;$a.prototype.delete=VC;$a.prototype.get=zC;$a.prototype.has=GC;$a.prototype.set=HC;var cs=$a,WC=cs;function KC(){this.__data__=new WC,this.size=0}var YC=KC;function qC(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var XC=qC;function jC(e){return this.__data__.get(e)}var QC=jC;function ZC(e){return this.__data__.has(e)}var JC=ZC,ex=Yn,tx=ex(Object,"create"),us=tx,_f=us;function rx(){this.__data__=_f?_f(null):{},this.size=0}var nx=rx;function ax(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var ix=ax,ox=us,sx="__lodash_hash_undefined__",lx=Object.prototype,cx=lx.hasOwnProperty;function ux(e){var t=this.__data__;if(ox){var r=t[e];return r===sx?void 0:r}return cx.call(t,e)?t[e]:void 0}var dx=ux,fx=us,hx=Object.prototype,px=hx.hasOwnProperty;function gx(e){var t=this.__data__;return fx?t[e]!==void 0:px.call(t,e)}var mx=gx,vx=us,bx="__lodash_hash_undefined__";function yx(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=vx&&t===void 0?bx:t,this}var Ex=yx,wx=nx,_x=ix,Nx=dx,Ax=mx,Cx=Ex;function Da(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Da.prototype.clear=wx;Da.prototype.delete=_x;Da.prototype.get=Nx;Da.prototype.has=Ax;Da.prototype.set=Cx;var xx=Da,Nf=xx,Tx=cs,Rx=Hc;function Ox(){this.size=0,this.__data__={hash:new Nf,map:new(Rx||Tx),string:new Nf}}var kx=Ox;function Ix(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var Mx=Ix,Px=Mx;function Sx(e,t){var r=e.__data__;return Px(t)?r[typeof t=="string"?"string":"hash"]:r.map}var ds=Sx,Lx=ds;function $x(e){var t=Lx(this,e).delete(e);return this.size-=t?1:0,t}var Dx=$x,Ux=ds;function Fx(e){return Ux(this,e).get(e)}var Bx=Fx,Vx=ds;function zx(e){return Vx(this,e).has(e)}var Gx=zx,Hx=ds;function Wx(e,t){var r=Hx(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var Kx=Wx,Yx=kx,qx=Dx,Xx=Bx,jx=Gx,Qx=Kx;function Ua(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ua.prototype.clear=Yx;Ua.prototype.delete=qx;Ua.prototype.get=Xx;Ua.prototype.has=jx;Ua.prototype.set=Qx;var Yc=Ua,Zx=cs,Jx=Hc,eT=Yc,tT=200;function rT(e,t){var r=this.__data__;if(r instanceof Zx){var n=r.__data__;if(!Jx||n.length<tT-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new eT(n)}return r.set(e,t),this.size=r.size,this}var nT=rT,aT=cs,iT=YC,oT=XC,sT=QC,lT=JC,cT=nT;function Fa(e){var t=this.__data__=new aT(e);this.size=t.size}Fa.prototype.clear=iT;Fa.prototype.delete=oT;Fa.prototype.get=sT;Fa.prototype.has=lT;Fa.prototype.set=cT;var qc=Fa,uT="__lodash_hash_undefined__";function dT(e){return this.__data__.set(e,uT),this}var fT=dT;function hT(e){return this.__data__.has(e)}var pT=hT,gT=Yc,mT=fT,vT=pT;function Bo(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new gT;++t<r;)this.add(e[t])}Bo.prototype.add=Bo.prototype.push=mT;Bo.prototype.has=vT;var Xc=Bo;function bT(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var nm=bT;function yT(e,t){return e.has(t)}var jc=yT,ET=Xc,wT=nm,_T=jc,NT=1,AT=2;function CT(e,t,r,n,a,i){var s=r&NT,d=e.length,h=t.length;if(d!=h&&!(s&&h>d))return!1;var c=i.get(e),o=i.get(t);if(c&&o)return c==t&&o==e;var l=-1,u=!0,f=r&AT?new ET:void 0;for(i.set(e,t),i.set(t,e);++l<d;){var m=e[l],g=t[l];if(n)var b=s?n(g,m,l,t,e,i):n(m,g,l,e,t,i);if(b!==void 0){if(b)continue;u=!1;break}if(f){if(!wT(t,function(v,w){if(!_T(f,w)&&(m===v||a(m,v,r,n,i)))return f.push(w)})){u=!1;break}}else if(!(m===g||a(m,g,r,n,i))){u=!1;break}}return i.delete(e),i.delete(t),u}var am=CT,xT=$r,TT=xT.Uint8Array,im=TT;function RT(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var OT=RT;function kT(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var Qc=kT,Af=Sa,Cf=im,IT=Bi,MT=am,PT=OT,ST=Qc,LT=1,$T=2,DT="[object Boolean]",UT="[object Date]",FT="[object Error]",BT="[object Map]",VT="[object Number]",zT="[object RegExp]",GT="[object Set]",HT="[object String]",WT="[object Symbol]",KT="[object ArrayBuffer]",YT="[object DataView]",xf=Af?Af.prototype:void 0,ml=xf?xf.valueOf:void 0;function qT(e,t,r,n,a,i,s){switch(r){case YT:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case KT:return!(e.byteLength!=t.byteLength||!i(new Cf(e),new Cf(t)));case DT:case UT:case VT:return IT(+e,+t);case FT:return e.name==t.name&&e.message==t.message;case zT:case HT:return e==t+"";case BT:var d=PT;case GT:var h=n&LT;if(d||(d=ST),e.size!=t.size&&!h)return!1;var c=s.get(e);if(c)return c==t;n|=$T,s.set(e,t);var o=MT(d(e),d(t),n,a,i,s);return s.delete(e),o;case WT:if(ml)return ml.call(e)==ml.call(t)}return!1}var XT=qT;function jT(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var Zc=jT,QT=Zc,ZT=lt;function JT(e,t,r){var n=t(e);return ZT(e)?n:QT(n,r(e))}var om=JT;function eR(e,t){for(var r=-1,n=e==null?0:e.length,a=0,i=[];++r<n;){var s=e[r];t(s,r,e)&&(i[a++]=s)}return i}var Jc=eR;function tR(){return[]}var sm=tR,rR=Jc,nR=sm,aR=Object.prototype,iR=aR.propertyIsEnumerable,Tf=Object.getOwnPropertySymbols,oR=Tf?function(e){return e==null?[]:(e=Object(e),rR(Tf(e),function(t){return iR.call(e,t)}))}:nR,eu=oR;function sR(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var lR=sR,cR=9007199254740991,uR=/^(?:0|[1-9]\d*)$/;function dR(e,t){var r=typeof e;return t=t==null?cR:t,!!t&&(r=="number"||r!="symbol"&&uR.test(e))&&e>-1&&e%1==0&&e<t}var fs=dR,fR=lR,hR=ss,pR=lt,gR=Aa.exports,mR=fs,vR=Kc,bR=Object.prototype,yR=bR.hasOwnProperty;function ER(e,t){var r=pR(e),n=!r&&hR(e),a=!r&&!n&&gR(e),i=!r&&!n&&!a&&vR(e),s=r||n||a||i,d=s?fR(e.length,String):[],h=d.length;for(var c in e)(t||yR.call(e,c))&&!(s&&(c=="length"||a&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||mR(c,h)))&&d.push(c);return d}var lm=ER,wR=lm,_R=jg,NR=Fr;function AR(e){return NR(e)?wR(e):_R(e)}var mr=AR,CR=om,xR=eu,TR=mr;function RR(e){return CR(e,TR,xR)}var cm=RR,Rf=cm,OR=1,kR=Object.prototype,IR=kR.hasOwnProperty;function MR(e,t,r,n,a,i){var s=r&OR,d=Rf(e),h=d.length,c=Rf(t),o=c.length;if(h!=o&&!s)return!1;for(var l=h;l--;){var u=d[l];if(!(s?u in t:IR.call(t,u)))return!1}var f=i.get(e),m=i.get(t);if(f&&m)return f==t&&m==e;var g=!0;i.set(e,t),i.set(t,e);for(var b=s;++l<h;){u=d[l];var v=e[u],w=t[u];if(n)var y=s?n(w,v,u,t,e,i):n(v,w,u,e,t,i);if(!(y===void 0?v===w||a(v,w,r,n,i):y)){g=!1;break}b||(b=u=="constructor")}if(g&&!b){var _=e.constructor,T=t.constructor;_!=T&&"constructor"in e&&"constructor"in t&&!(typeof _=="function"&&_ instanceof _&&typeof T=="function"&&T instanceof T)&&(g=!1)}return i.delete(e),i.delete(t),g}var PR=MR,vl=qc,SR=am,LR=XT,$R=PR,Of=Di,kf=lt,If=Aa.exports,DR=Kc,UR=1,Mf="[object Arguments]",Pf="[object Array]",po="[object Object]",FR=Object.prototype,Sf=FR.hasOwnProperty;function BR(e,t,r,n,a,i){var s=kf(e),d=kf(t),h=s?Pf:Of(e),c=d?Pf:Of(t);h=h==Mf?po:h,c=c==Mf?po:c;var o=h==po,l=c==po,u=h==c;if(u&&If(e)){if(!If(t))return!1;s=!0,o=!1}if(u&&!o)return i||(i=new vl),s||DR(e)?SR(e,t,r,n,a,i):LR(e,t,h,r,n,a,i);if(!(r&UR)){var f=o&&Sf.call(e,"__wrapped__"),m=l&&Sf.call(t,"__wrapped__");if(f||m){var g=f?e.value():e,b=m?t.value():t;return i||(i=new vl),a(g,b,r,n,i)}}return u?(i||(i=new vl),$R(e,t,r,n,a,i)):!1}var VR=BR,zR=VR,Lf=Ur;function um(e,t,r,n,a){return e===t?!0:e==null||t==null||!Lf(e)&&!Lf(t)?e!==e&&t!==t:zR(e,t,r,n,um,a)}var dm=um,GR=qc,HR=dm,WR=1,KR=2;function YR(e,t,r,n){var a=r.length,i=a,s=!n;if(e==null)return!i;for(e=Object(e);a--;){var d=r[a];if(s&&d[2]?d[1]!==e[d[0]]:!(d[0]in e))return!1}for(;++a<i;){d=r[a];var h=d[0],c=e[h],o=d[1];if(s&&d[2]){if(c===void 0&&!(h in e))return!1}else{var l=new GR;if(n)var u=n(c,o,h,e,t,l);if(!(u===void 0?HR(o,c,WR|KR,n,l):u))return!1}}return!0}var qR=YR,XR=Dr;function jR(e){return e===e&&!XR(e)}var fm=jR,QR=fm,ZR=mr;function JR(e){for(var t=ZR(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,QR(a)]}return t}var eO=JR;function tO(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var hm=tO,rO=qR,nO=eO,aO=hm;function iO(e){var t=nO(e);return t.length==1&&t[0][2]?aO(t[0][0],t[0][1]):function(r){return r===e||rO(r,e,t)}}var oO=iO,sO=Kn,lO=Ur,cO="[object Symbol]";function uO(e){return typeof e=="symbol"||lO(e)&&sO(e)==cO}var hs=uO,dO=lt,fO=hs,hO=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,pO=/^\w*$/;function gO(e,t){if(dO(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||fO(e)?!0:pO.test(e)||!hO.test(e)||t!=null&&e in Object(t)}var tu=gO,pm=Yc,mO="Expected a function";function ru(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(mO);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var s=e.apply(this,n);return r.cache=i.set(a,s)||i,s};return r.cache=new(ru.Cache||pm),r}ru.Cache=pm;var vO=ru,bO=vO,yO=500;function EO(e){var t=bO(e,function(n){return r.size===yO&&r.clear(),n}),r=t.cache;return t}var wO=EO,_O=wO,NO=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,AO=/\\(\\)?/g,CO=_O(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(NO,function(r,n,a,i){t.push(a?i.replace(AO,"$1"):n||r)}),t}),xO=CO,$f=Sa,TO=Fi,RO=lt,OO=hs,kO=1/0,Df=$f?$f.prototype:void 0,Uf=Df?Df.toString:void 0;function gm(e){if(typeof e=="string")return e;if(RO(e))return TO(e,gm)+"";if(OO(e))return Uf?Uf.call(e):"";var t=e+"";return t=="0"&&1/e==-kO?"-0":t}var IO=gm,MO=IO;function PO(e){return e==null?"":MO(e)}var mm=PO,SO=lt,LO=tu,$O=xO,DO=mm;function UO(e,t){return SO(e)?e:LO(e,t)?[e]:$O(DO(e))}var ps=UO,FO=hs,BO=1/0;function VO(e){if(typeof e=="string"||FO(e))return e;var t=e+"";return t=="0"&&1/e==-BO?"-0":t}var Vi=VO,zO=ps,GO=Vi;function HO(e,t){t=zO(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[GO(t[r++])];return r&&r==n?e:void 0}var nu=HO,WO=nu;function KO(e,t,r){var n=e==null?void 0:WO(e,t);return n===void 0?r:n}var YO=KO;function qO(e,t){return e!=null&&t in Object(e)}var XO=qO,jO=ps,QO=ss,ZO=lt,JO=fs,e2=Wc,t2=Vi;function r2(e,t,r){t=jO(t,e);for(var n=-1,a=t.length,i=!1;++n<a;){var s=t2(t[n]);if(!(i=e!=null&&r(e,s)))break;e=e[s]}return i||++n!=a?i:(a=e==null?0:e.length,!!a&&e2(a)&&JO(s,a)&&(ZO(e)||QO(e)))}var vm=r2,n2=XO,a2=vm;function i2(e,t){return e!=null&&a2(e,t,n2)}var o2=i2,s2=dm,l2=YO,c2=o2,u2=tu,d2=fm,f2=hm,h2=Vi,p2=1,g2=2;function m2(e,t){return u2(e)&&d2(t)?f2(h2(e),t):function(r){var n=l2(r,e);return n===void 0&&n===t?c2(r,e):s2(t,n,p2|g2)}}var v2=m2;function b2(e){return e}var zi=b2;function y2(e){return function(t){return t==null?void 0:t[e]}}var E2=y2,w2=nu;function _2(e){return function(t){return w2(t,e)}}var N2=_2,A2=E2,C2=N2,x2=tu,T2=Vi;function R2(e){return x2(e)?A2(T2(e)):C2(e)}var O2=R2,k2=oO,I2=v2,M2=zi,P2=lt,S2=O2;function L2(e){return typeof e=="function"?e:e==null?M2:typeof e=="object"?P2(e)?I2(e[0],e[1]):k2(e):S2(e)}var Vr=L2;function $2(e){return function(t,r,n){for(var a=-1,i=Object(t),s=n(t),d=s.length;d--;){var h=s[e?d:++a];if(r(i[h],h,i)===!1)break}return t}}var D2=$2,U2=D2,F2=U2(),B2=F2,V2=B2,z2=mr;function G2(e,t){return e&&V2(e,t,z2)}var H2=G2,W2=Fr;function K2(e,t){return function(r,n){if(r==null)return r;if(!W2(r))return e(r,n);for(var a=r.length,i=t?a:-1,s=Object(r);(t?i--:++i<a)&&n(s[i],i,s)!==!1;);return r}}var Y2=K2,q2=H2,X2=Y2,j2=X2(q2),qn=j2,Q2=qn,Z2=Fr;function J2(e,t){var r=-1,n=Z2(e)?Array(e.length):[];return Q2(e,function(a,i,s){n[++r]=t(a,i,s)}),n}var ek=J2,tk=Fi,rk=Vr,nk=ek,ak=lt;function ik(e,t){var r=ak(e)?tk:nk;return r(e,rk(t))}var nr=ik;function ok(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var bm=ok,sk=zi;function lk(e){return typeof e=="function"?e:sk}var ck=lk,uk=bm,dk=qn,fk=ck,hk=lt;function pk(e,t){var r=hk(e)?uk:dk;return r(e,fk(t))}var Yt=pk,gk=Fi;function mk(e,t){return gk(t,function(r){return e[r]})}var vk=mk,bk=vk,yk=mr;function Ek(e){return e==null?[]:bk(e,yk(e))}var tn=Ek,wk=Object.prototype,_k=wk.hasOwnProperty;function Nk(e,t){return e!=null&&_k.call(e,t)}var Ak=Nk,Ck=Ak,xk=vm;function Tk(e,t){return e!=null&&xk(e,t,Ck)}var vr=Tk,Rk=Yn,Ok=function(){try{var e=Rk(Object,"defineProperty");return e({},"",{}),e}catch{}}(),ym=Ok,Ff=ym;function kk(e,t,r){t=="__proto__"&&Ff?Ff(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var au=kk,Ik=au,Mk=Bi,Pk=Object.prototype,Sk=Pk.hasOwnProperty;function Lk(e,t,r){var n=e[t];(!(Sk.call(e,t)&&Mk(n,r))||r===void 0&&!(t in e))&&Ik(e,t,r)}var gs=Lk,$k=gs,Dk=au;function Uk(e,t,r,n){var a=!r;r||(r={});for(var i=-1,s=t.length;++i<s;){var d=t[i],h=n?n(r[d],e[d],d,r,e):void 0;h===void 0&&(h=e[d]),a?Dk(r,d,h):$k(r,d,h)}return r}var Gi=Uk,Fk=Gi,Bk=mr;function Vk(e,t){return e&&Fk(t,Bk(t),e)}var zk=Vk;function Gk(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var Hk=Gk,Wk=Dr,Kk=Li,Yk=Hk,qk=Object.prototype,Xk=qk.hasOwnProperty;function jk(e){if(!Wk(e))return Yk(e);var t=Kk(e),r=[];for(var n in e)n=="constructor"&&(t||!Xk.call(e,n))||r.push(n);return r}var Qk=jk,Zk=lm,Jk=Qk,eI=Fr;function tI(e){return eI(e)?Zk(e,!0):Jk(e)}var ms=tI,rI=Gi,nI=ms;function aI(e,t){return e&&rI(t,nI(t),e)}var iI=aI,ic={exports:{}};(function(e,t){var r=$r,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,s=i?r.Buffer:void 0,d=s?s.allocUnsafe:void 0;function h(c,o){if(o)return c.slice();var l=c.length,u=d?d(l):new c.constructor(l);return c.copy(u),u}e.exports=h})(ic,ic.exports);function oI(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var sI=oI,lI=Gi,cI=eu;function uI(e,t){return lI(e,cI(e),t)}var dI=uI,fI=Xg,hI=fI(Object.getPrototypeOf,Object),Em=hI,pI=Zc,gI=Em,mI=eu,vI=sm,bI=Object.getOwnPropertySymbols,yI=bI?function(e){for(var t=[];e;)pI(t,mI(e)),e=gI(e);return t}:vI,wm=yI,EI=Gi,wI=wm;function _I(e,t){return EI(e,wI(e),t)}var NI=_I,AI=om,CI=wm,xI=ms;function TI(e){return AI(e,xI,CI)}var _m=TI,RI=Object.prototype,OI=RI.hasOwnProperty;function kI(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&OI.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var II=kI,Bf=im;function MI(e){var t=new e.constructor(e.byteLength);return new Bf(t).set(new Bf(e)),t}var iu=MI,PI=iu;function SI(e,t){var r=t?PI(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var LI=SI,$I=/\w*$/;function DI(e){var t=new e.constructor(e.source,$I.exec(e));return t.lastIndex=e.lastIndex,t}var UI=DI,Vf=Sa,zf=Vf?Vf.prototype:void 0,Gf=zf?zf.valueOf:void 0;function FI(e){return Gf?Object(Gf.call(e)):{}}var BI=FI,VI=iu;function zI(e,t){var r=t?VI(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var GI=zI,HI=iu,WI=LI,KI=UI,YI=BI,qI=GI,XI="[object Boolean]",jI="[object Date]",QI="[object Map]",ZI="[object Number]",JI="[object RegExp]",eM="[object Set]",tM="[object String]",rM="[object Symbol]",nM="[object ArrayBuffer]",aM="[object DataView]",iM="[object Float32Array]",oM="[object Float64Array]",sM="[object Int8Array]",lM="[object Int16Array]",cM="[object Int32Array]",uM="[object Uint8Array]",dM="[object Uint8ClampedArray]",fM="[object Uint16Array]",hM="[object Uint32Array]";function pM(e,t,r){var n=e.constructor;switch(t){case nM:return HI(e);case XI:case jI:return new n(+e);case aM:return WI(e,r);case iM:case oM:case sM:case lM:case cM:case uM:case dM:case fM:case hM:return qI(e,r);case QI:return new n;case ZI:case tM:return new n(e);case JI:return KI(e);case eM:return new n;case rM:return YI(e)}}var gM=pM,mM=Dr,Hf=Object.create,vM=function(){function e(){}return function(t){if(!mM(t))return{};if(Hf)return Hf(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),bM=vM,yM=bM,EM=Em,wM=Li;function _M(e){return typeof e.constructor=="function"&&!wM(e)?yM(EM(e)):{}}var NM=_M,AM=Di,CM=Ur,xM="[object Map]";function TM(e){return CM(e)&&AM(e)==xM}var RM=TM,OM=RM,kM=Ui,Wf=Ca.exports,Kf=Wf&&Wf.isMap,IM=Kf?kM(Kf):OM,MM=IM,PM=Di,SM=Ur,LM="[object Set]";function $M(e){return SM(e)&&PM(e)==LM}var DM=$M,UM=DM,FM=Ui,Yf=Ca.exports,qf=Yf&&Yf.isSet,BM=qf?FM(qf):UM,VM=BM,zM=qc,GM=bm,HM=gs,WM=zk,KM=iI,YM=ic.exports,qM=sI,XM=dI,jM=NI,QM=cm,ZM=_m,JM=Di,eP=II,tP=gM,rP=NM,nP=lt,aP=Aa.exports,iP=MM,oP=Dr,sP=VM,lP=mr,cP=ms,uP=1,dP=2,fP=4,Nm="[object Arguments]",hP="[object Array]",pP="[object Boolean]",gP="[object Date]",mP="[object Error]",Am="[object Function]",vP="[object GeneratorFunction]",bP="[object Map]",yP="[object Number]",Cm="[object Object]",EP="[object RegExp]",wP="[object Set]",_P="[object String]",NP="[object Symbol]",AP="[object WeakMap]",CP="[object ArrayBuffer]",xP="[object DataView]",TP="[object Float32Array]",RP="[object Float64Array]",OP="[object Int8Array]",kP="[object Int16Array]",IP="[object Int32Array]",MP="[object Uint8Array]",PP="[object Uint8ClampedArray]",SP="[object Uint16Array]",LP="[object Uint32Array]",ht={};ht[Nm]=ht[hP]=ht[CP]=ht[xP]=ht[pP]=ht[gP]=ht[TP]=ht[RP]=ht[OP]=ht[kP]=ht[IP]=ht[bP]=ht[yP]=ht[Cm]=ht[EP]=ht[wP]=ht[_P]=ht[NP]=ht[MP]=ht[PP]=ht[SP]=ht[LP]=!0;ht[mP]=ht[Am]=ht[AP]=!1;function Co(e,t,r,n,a,i){var s,d=t&uP,h=t&dP,c=t&fP;if(r&&(s=a?r(e,n,a,i):r(e)),s!==void 0)return s;if(!oP(e))return e;var o=nP(e);if(o){if(s=eP(e),!d)return qM(e,s)}else{var l=JM(e),u=l==Am||l==vP;if(aP(e))return YM(e,d);if(l==Cm||l==Nm||u&&!a){if(s=h||u?{}:rP(e),!d)return h?jM(e,KM(s,e)):XM(e,WM(s,e))}else{if(!ht[l])return a?e:{};s=tP(e,l,d)}}i||(i=new zM);var f=i.get(e);if(f)return f;i.set(e,s),sP(e)?e.forEach(function(b){s.add(Co(b,t,r,b,e,i))}):iP(e)&&e.forEach(function(b,v){s.set(v,Co(b,t,r,v,e,i))});var m=c?h?ZM:QM:h?cP:lP,g=o?void 0:m(e);return GM(g||e,function(b,v){g&&(v=b,b=e[v]),HM(s,v,Co(b,t,r,v,e,i))}),s}var $P=Co,DP=$P,UP=4;function FP(e){return DP(e,UP)}var Nn=FP,Ba={},xa={};Object.defineProperty(xa,"__esModule",{value:!0});xa.PRINT_WARNING=xa.PRINT_ERROR=void 0;function BP(e){console&&console.error&&console.error("Error: ".concat(e))}xa.PRINT_ERROR=BP;function VP(e){console&&console.warn&&console.warn("Warning: ".concat(e))}xa.PRINT_WARNING=VP;var vs={};Object.defineProperty(vs,"__esModule",{value:!0});vs.timer=void 0;function zP(e){var t=new Date().getTime(),r=e(),n=new Date().getTime(),a=n-t;return{time:a,value:r}}vs.timer=zP;var bs={};Object.defineProperty(bs,"__esModule",{value:!0});bs.toFastProperties=void 0;function GP(e){function t(){}t.prototype=e;var r=new t;function n(){return typeof r.bar}return n(),n(),e}bs.toFastProperties=GP;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.toFastProperties=e.timer=e.PRINT_ERROR=e.PRINT_WARNING=void 0;var t=xa;Object.defineProperty(e,"PRINT_WARNING",{enumerable:!0,get:function(){return t.PRINT_WARNING}}),Object.defineProperty(e,"PRINT_ERROR",{enumerable:!0,get:function(){return t.PRINT_ERROR}});var r=vs;Object.defineProperty(e,"timer",{enumerable:!0,get:function(){return r.timer}});var n=bs;Object.defineProperty(e,"toFastProperties",{enumerable:!0,get:function(){return n.toFastProperties}})})(Ba);var Mr={},Va={};function HP(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}var ou=HP,WP=/\s/;function KP(e){for(var t=e.length;t--&&WP.test(e.charAt(t)););return t}var YP=KP,qP=YP,XP=/^\s+/;function jP(e){return e&&e.slice(0,qP(e)+1).replace(XP,"")}var QP=jP,ZP=QP,Xf=Dr,JP=hs,jf=0/0,eS=/^[-+]0x[0-9a-f]+$/i,tS=/^0b[01]+$/i,rS=/^0o[0-7]+$/i,nS=parseInt;function aS(e){if(typeof e=="number")return e;if(JP(e))return jf;if(Xf(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Xf(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=ZP(e);var r=tS.test(e);return r||rS.test(e)?nS(e.slice(2),r?2:8):eS.test(e)?jf:+e}var iS=aS,oS=iS,Qf=1/0,sS=17976931348623157e292;function lS(e){if(!e)return e===0?e:0;if(e=oS(e),e===Qf||e===-Qf){var t=e<0?-1:1;return t*sS}return e===e?e:0}var cS=lS,uS=cS;function dS(e){var t=uS(e),r=t%1;return t===t?r?t-r:t:0}var Hi=dS,fS=ou,hS=Hi;function pS(e,t,r){var n=e==null?0:e.length;return n?(t=r||t===void 0?1:hS(t),fS(e,t<0?0:t,n)):[]}var su=pS,It={},at={},gS=Kn,mS=lt,vS=Ur,bS="[object String]";function yS(e){return typeof e=="string"||!mS(e)&&vS(e)&&gS(e)==bS}var ys=yS,ES=Kn,wS=Ur,_S="[object RegExp]";function NS(e){return wS(e)&&ES(e)==_S}var AS=NS,CS=AS,xS=Ui,Zf=Ca.exports,Jf=Zf&&Zf.isRegExp,TS=Jf?xS(Jf):CS,xm=TS,RS=gs,OS=ps,kS=fs,eh=Dr,IS=Vi;function MS(e,t,r,n){if(!eh(e))return e;t=OS(t,e);for(var a=-1,i=t.length,s=i-1,d=e;d!=null&&++a<i;){var h=IS(t[a]),c=r;if(h==="__proto__"||h==="constructor"||h==="prototype")return e;if(a!=s){var o=d[h];c=n?n(o,h,d):void 0,c===void 0&&(c=eh(o)?o:kS(t[a+1])?[]:{})}RS(d,h,c),d=d[h]}return e}var PS=MS,SS=nu,LS=PS,$S=ps;function DS(e,t,r){for(var n=-1,a=t.length,i={};++n<a;){var s=t[n],d=SS(e,s);r(d,s)&&LS(i,$S(s,e),d)}return i}var US=DS,FS=Fi,BS=Vr,VS=US,zS=_m;function GS(e,t){if(e==null)return{};var r=FS(zS(e),function(n){return[n]});return t=BS(t),VS(e,r,function(n,a){return t(n,a[0])})}var Tm=GS;function HS(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var WS=HS,KS=WS,th=Math.max;function YS(e,t,r){return t=th(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=th(n.length-t,0),s=Array(i);++a<i;)s[a]=n[t+a];a=-1;for(var d=Array(t+1);++a<t;)d[a]=n[a];return d[t]=r(s),KS(e,this,d)}}var qS=YS;function XS(e){return function(){return e}}var jS=XS,QS=jS,rh=ym,ZS=zi,JS=rh?function(e,t){return rh(e,"toString",{configurable:!0,enumerable:!1,value:QS(t),writable:!0})}:ZS,eL=JS,tL=800,rL=16,nL=Date.now;function aL(e){var t=0,r=0;return function(){var n=nL(),a=rL-(n-r);if(r=n,a>0){if(++t>=tL)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var iL=aL,oL=eL,sL=iL,lL=sL(oL),cL=lL,uL=zi,dL=qS,fL=cL;function hL(e,t){return fL(dL(e,t,uL),e+"")}var lu=hL,pL=Bi,gL=Fr,mL=fs,vL=Dr;function bL(e,t,r){if(!vL(r))return!1;var n=typeof t;return(n=="number"?gL(r)&&mL(t,r.length):n=="string"&&t in r)?pL(r[t],e):!1}var Es=bL,yL=lu,EL=Es;function wL(e){return yL(function(t,r){var n=-1,a=r.length,i=a>1?r[a-1]:void 0,s=a>2?r[2]:void 0;for(i=e.length>3&&typeof i=="function"?(a--,i):void 0,s&&EL(r[0],r[1],s)&&(i=a<3?void 0:i,a=1),t=Object(t);++n<a;){var d=r[n];d&&e(t,d,n,i)}return t})}var _L=wL,NL=gs,AL=Gi,CL=_L,xL=Fr,TL=Li,RL=mr,OL=Object.prototype,kL=OL.hasOwnProperty,IL=CL(function(e,t){if(TL(t)||xL(t)){AL(t,RL(t),e);return}for(var r in t)kL.call(t,r)&&NL(e,r,t[r])}),ws=IL,rn=Ae&&Ae.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),za=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(at,"__esModule",{value:!0});at.serializeProduction=at.serializeGrammar=at.Terminal=at.Alternation=at.RepetitionWithSeparator=at.Repetition=at.RepetitionMandatoryWithSeparator=at.RepetitionMandatory=at.Option=at.Alternative=at.Rule=at.NonTerminal=at.AbstractProduction=void 0;var Rm=za(nr),ML=za(Yt),oc=za(ys),PL=za(xm),zr=za(Tm),Gr=za(ws);function SL(e){return LL(e)?e.LABEL:e.name}function LL(e){return(0,oc.default)(e.LABEL)&&e.LABEL!==""}var Hr=function(){function e(t){this._definition=t}return Object.defineProperty(e.prototype,"definition",{get:function(){return this._definition},set:function(t){this._definition=t},enumerable:!1,configurable:!0}),e.prototype.accept=function(t){t.visit(this),(0,ML.default)(this.definition,function(r){r.accept(t)})},e}();at.AbstractProduction=Hr;var Om=function(e){rn(t,e);function t(r){var n=e.call(this,[])||this;return n.idx=1,(0,Gr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return Object.defineProperty(t.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(r){},enumerable:!1,configurable:!0}),t.prototype.accept=function(r){r.visit(this)},t}(Hr);at.NonTerminal=Om;var km=function(e){rn(t,e);function t(r){var n=e.call(this,r.definition)||this;return n.orgText="",(0,Gr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return t}(Hr);at.Rule=km;var Im=function(e){rn(t,e);function t(r){var n=e.call(this,r.definition)||this;return n.ignoreAmbiguities=!1,(0,Gr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return t}(Hr);at.Alternative=Im;var Mm=function(e){rn(t,e);function t(r){var n=e.call(this,r.definition)||this;return n.idx=1,(0,Gr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return t}(Hr);at.Option=Mm;var Pm=function(e){rn(t,e);function t(r){var n=e.call(this,r.definition)||this;return n.idx=1,(0,Gr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return t}(Hr);at.RepetitionMandatory=Pm;var Sm=function(e){rn(t,e);function t(r){var n=e.call(this,r.definition)||this;return n.idx=1,(0,Gr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return t}(Hr);at.RepetitionMandatoryWithSeparator=Sm;var Lm=function(e){rn(t,e);function t(r){var n=e.call(this,r.definition)||this;return n.idx=1,(0,Gr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return t}(Hr);at.Repetition=Lm;var $m=function(e){rn(t,e);function t(r){var n=e.call(this,r.definition)||this;return n.idx=1,(0,Gr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return t}(Hr);at.RepetitionWithSeparator=$m;var Dm=function(e){rn(t,e);function t(r){var n=e.call(this,r.definition)||this;return n.idx=1,n.ignoreAmbiguities=!1,n.hasPredicates=!1,(0,Gr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return Object.defineProperty(t.prototype,"definition",{get:function(){return this._definition},set:function(r){this._definition=r},enumerable:!1,configurable:!0}),t}(Hr);at.Alternation=Dm;var xo=function(){function e(t){this.idx=1,(0,Gr.default)(this,(0,zr.default)(t,function(r){return r!==void 0}))}return e.prototype.accept=function(t){t.visit(this)},e}();at.Terminal=xo;function $L(e){return(0,Rm.default)(e,pi)}at.serializeGrammar=$L;function pi(e){function t(i){return(0,Rm.default)(i,pi)}if(e instanceof Om){var r={type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};return(0,oc.default)(e.label)&&(r.label=e.label),r}else{if(e instanceof Im)return{type:"Alternative",definition:t(e.definition)};if(e instanceof Mm)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof Pm)return{type:"RepetitionMandatory",idx:e.idx,definition:t(e.definition)};if(e instanceof Sm)return{type:"RepetitionMandatoryWithSeparator",idx:e.idx,separator:pi(new xo({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof $m)return{type:"RepetitionWithSeparator",idx:e.idx,separator:pi(new xo({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof Lm)return{type:"Repetition",idx:e.idx,definition:t(e.definition)};if(e instanceof Dm)return{type:"Alternation",idx:e.idx,definition:t(e.definition)};if(e instanceof xo){var n={type:"Terminal",name:e.terminalType.name,label:SL(e.terminalType),idx:e.idx};(0,oc.default)(e.label)&&(n.terminalLabel=e.label);var a=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(n.pattern=(0,PL.default)(a)?a.source:a),n}else{if(e instanceof km)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}}}at.serializeProduction=pi;var _s={};Object.defineProperty(_s,"__esModule",{value:!0});_s.GAstVisitor=void 0;var Tr=at,DL=function(){function e(){}return e.prototype.visit=function(t){var r=t;switch(r.constructor){case Tr.NonTerminal:return this.visitNonTerminal(r);case Tr.Alternative:return this.visitAlternative(r);case Tr.Option:return this.visitOption(r);case Tr.RepetitionMandatory:return this.visitRepetitionMandatory(r);case Tr.RepetitionMandatoryWithSeparator:return this.visitRepetitionMandatoryWithSeparator(r);case Tr.RepetitionWithSeparator:return this.visitRepetitionWithSeparator(r);case Tr.Repetition:return this.visitRepetition(r);case Tr.Alternation:return this.visitAlternation(r);case Tr.Terminal:return this.visitTerminal(r);case Tr.Rule:return this.visitRule(r);default:throw Error("non exhaustive match")}},e.prototype.visitNonTerminal=function(t){},e.prototype.visitAlternative=function(t){},e.prototype.visitOption=function(t){},e.prototype.visitRepetition=function(t){},e.prototype.visitRepetitionMandatory=function(t){},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){},e.prototype.visitRepetitionWithSeparator=function(t){},e.prototype.visitAlternation=function(t){},e.prototype.visitTerminal=function(t){},e.prototype.visitRule=function(t){},e}();_s.GAstVisitor=DL;var Pr={},UL=qn;function FL(e,t){var r;return UL(e,function(n,a,i){return r=t(n,a,i),!r}),!!r}var BL=FL,VL=nm,zL=Vr,GL=BL,HL=lt,WL=Es;function KL(e,t,r){var n=HL(e)?VL:GL;return r&&WL(e,t,r)&&(t=void 0),n(e,zL(t))}var cu=KL;function YL(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var qL=YL,XL=qn;function jL(e,t){var r=!0;return XL(e,function(n,a,i){return r=!!t(n,a,i),r}),r}var QL=jL,ZL=qL,JL=QL,e6=Vr,t6=lt,r6=Es;function n6(e,t,r){var n=t6(e)?ZL:JL;return r&&r6(e,t,r)&&(t=void 0),n(e,e6(t))}var Ns=n6;function a6(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var Um=a6;function i6(e){return e!==e}var o6=i6;function s6(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var l6=s6,c6=Um,u6=o6,d6=l6;function f6(e,t,r){return t===t?d6(e,t,r):c6(e,u6,r)}var uu=f6,h6=uu,p6=Fr,g6=ys,m6=Hi,v6=tn,b6=Math.max;function y6(e,t,r,n){e=p6(e)?e:v6(e),r=r&&!n?m6(r):0;var a=e.length;return r<0&&(r=b6(a+r,0)),g6(e)?r<=a&&e.indexOf(t,r)>-1:!!a&&h6(e,t,r)>-1}var nn=y6,du=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Pr,"__esModule",{value:!0});Pr.getProductionDslName=Pr.isBranchingProd=Pr.isOptionalProd=Pr.isSequenceProd=void 0;var E6=du(cu),w6=du(Ns),_6=du(nn),yt=at;function N6(e){return e instanceof yt.Alternative||e instanceof yt.Option||e instanceof yt.Repetition||e instanceof yt.RepetitionMandatory||e instanceof yt.RepetitionMandatoryWithSeparator||e instanceof yt.RepetitionWithSeparator||e instanceof yt.Terminal||e instanceof yt.Rule}Pr.isSequenceProd=N6;function sc(e,t){t===void 0&&(t=[]);var r=e instanceof yt.Option||e instanceof yt.Repetition||e instanceof yt.RepetitionWithSeparator;return r?!0:e instanceof yt.Alternation?(0,E6.default)(e.definition,function(n){return sc(n,t)}):e instanceof yt.NonTerminal&&(0,_6.default)(t,e)?!1:e instanceof yt.AbstractProduction?(e instanceof yt.NonTerminal&&t.push(e),(0,w6.default)(e.definition,function(n){return sc(n,t)})):!1}Pr.isOptionalProd=sc;function A6(e){return e instanceof yt.Alternation}Pr.isBranchingProd=A6;function C6(e){if(e instanceof yt.NonTerminal)return"SUBRULE";if(e instanceof yt.Option)return"OPTION";if(e instanceof yt.Alternation)return"OR";if(e instanceof yt.RepetitionMandatory)return"AT_LEAST_ONE";if(e instanceof yt.RepetitionMandatoryWithSeparator)return"AT_LEAST_ONE_SEP";if(e instanceof yt.RepetitionWithSeparator)return"MANY_SEP";if(e instanceof yt.Repetition)return"MANY";if(e instanceof yt.Terminal)return"CONSUME";throw Error("non exhaustive match")}Pr.getProductionDslName=C6;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isSequenceProd=e.isBranchingProd=e.isOptionalProd=e.getProductionDslName=e.GAstVisitor=e.serializeProduction=e.serializeGrammar=e.Alternative=e.Alternation=e.RepetitionWithSeparator=e.RepetitionMandatoryWithSeparator=e.RepetitionMandatory=e.Repetition=e.Option=e.NonTerminal=e.Terminal=e.Rule=void 0;var t=at;Object.defineProperty(e,"Rule",{enumerable:!0,get:function(){return t.Rule}}),Object.defineProperty(e,"Terminal",{enumerable:!0,get:function(){return t.Terminal}}),Object.defineProperty(e,"NonTerminal",{enumerable:!0,get:function(){return t.NonTerminal}}),Object.defineProperty(e,"Option",{enumerable:!0,get:function(){return t.Option}}),Object.defineProperty(e,"Repetition",{enumerable:!0,get:function(){return t.Repetition}}),Object.defineProperty(e,"RepetitionMandatory",{enumerable:!0,get:function(){return t.RepetitionMandatory}}),Object.defineProperty(e,"RepetitionMandatoryWithSeparator",{enumerable:!0,get:function(){return t.RepetitionMandatoryWithSeparator}}),Object.defineProperty(e,"RepetitionWithSeparator",{enumerable:!0,get:function(){return t.RepetitionWithSeparator}}),Object.defineProperty(e,"Alternation",{enumerable:!0,get:function(){return t.Alternation}}),Object.defineProperty(e,"Alternative",{enumerable:!0,get:function(){return t.Alternative}}),Object.defineProperty(e,"serializeGrammar",{enumerable:!0,get:function(){return t.serializeGrammar}}),Object.defineProperty(e,"serializeProduction",{enumerable:!0,get:function(){return t.serializeProduction}});var r=_s;Object.defineProperty(e,"GAstVisitor",{enumerable:!0,get:function(){return r.GAstVisitor}});var n=Pr;Object.defineProperty(e,"getProductionDslName",{enumerable:!0,get:function(){return n.getProductionDslName}}),Object.defineProperty(e,"isOptionalProd",{enumerable:!0,get:function(){return n.isOptionalProd}}),Object.defineProperty(e,"isBranchingProd",{enumerable:!0,get:function(){return n.isBranchingProd}}),Object.defineProperty(e,"isSequenceProd",{enumerable:!0,get:function(){return n.isSequenceProd}})})(It);var Fm=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Va,"__esModule",{value:!0});Va.RestWalker=void 0;var x6=Fm(su),nh=Fm(Yt),er=It,T6=function(){function e(){}return e.prototype.walk=function(t,r){var n=this;r===void 0&&(r=[]),(0,nh.default)(t.definition,function(a,i){var s=(0,x6.default)(t.definition,i+1);if(a instanceof er.NonTerminal)n.walkProdRef(a,s,r);else if(a instanceof er.Terminal)n.walkTerminal(a,s,r);else if(a instanceof er.Alternative)n.walkFlat(a,s,r);else if(a instanceof er.Option)n.walkOption(a,s,r);else if(a instanceof er.RepetitionMandatory)n.walkAtLeastOne(a,s,r);else if(a instanceof er.RepetitionMandatoryWithSeparator)n.walkAtLeastOneSep(a,s,r);else if(a instanceof er.RepetitionWithSeparator)n.walkManySep(a,s,r);else if(a instanceof er.Repetition)n.walkMany(a,s,r);else if(a instanceof er.Alternation)n.walkOr(a,s,r);else throw Error("non exhaustive match")})},e.prototype.walkTerminal=function(t,r,n){},e.prototype.walkProdRef=function(t,r,n){},e.prototype.walkFlat=function(t,r,n){var a=r.concat(n);this.walk(t,a)},e.prototype.walkOption=function(t,r,n){var a=r.concat(n);this.walk(t,a)},e.prototype.walkAtLeastOne=function(t,r,n){var a=[new er.Option({definition:t.definition})].concat(r,n);this.walk(t,a)},e.prototype.walkAtLeastOneSep=function(t,r,n){var a=ah(t,r,n);this.walk(t,a)},e.prototype.walkMany=function(t,r,n){var a=[new er.Option({definition:t.definition})].concat(r,n);this.walk(t,a)},e.prototype.walkManySep=function(t,r,n){var a=ah(t,r,n);this.walk(t,a)},e.prototype.walkOr=function(t,r,n){var a=this,i=r.concat(n);(0,nh.default)(t.definition,function(s){var d=new er.Alternative({definition:[s]});a.walk(d,i)})},e}();Va.RestWalker=T6;function ah(e,t,r){var n=[new er.Option({definition:[new er.Terminal({terminalType:e.separator})].concat(e.definition)})],a=n.concat(t,r);return a}var Nr={},ih=Sa,R6=ss,O6=lt,oh=ih?ih.isConcatSpreadable:void 0;function k6(e){return O6(e)||R6(e)||!!(oh&&e&&e[oh])}var I6=k6,M6=Zc,P6=I6;function Bm(e,t,r,n,a){var i=-1,s=e.length;for(r||(r=P6),a||(a=[]);++i<s;){var d=e[i];t>0&&r(d)?t>1?Bm(d,t-1,r,n,a):M6(a,d):n||(a[a.length]=d)}return a}var fu=Bm,S6=fu;function L6(e){var t=e==null?0:e.length;return t?S6(e,1):[]}var an=L6,$6=uu;function D6(e,t){var r=e==null?0:e.length;return!!r&&$6(e,t,0)>-1}var Vm=D6;function U6(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var zm=U6;function F6(){}var hu=F6,bl=em,B6=hu,V6=Qc,z6=1/0,G6=bl&&1/V6(new bl([,-0]))[1]==z6?function(e){return new bl(e)}:B6,H6=G6,W6=Xc,K6=Vm,Y6=zm,q6=jc,X6=H6,j6=Qc,Q6=200;function Z6(e,t,r){var n=-1,a=K6,i=e.length,s=!0,d=[],h=d;if(r)s=!1,a=Y6;else if(i>=Q6){var c=t?null:X6(e);if(c)return j6(c);s=!1,a=q6,h=new W6}else h=t?[]:d;e:for(;++n<i;){var o=e[n],l=t?t(o):o;if(o=r||o!==0?o:0,s&&l===l){for(var u=h.length;u--;)if(h[u]===l)continue e;t&&h.push(l),d.push(o)}else a(h,l,r)||(h!==d&&h.push(l),d.push(o))}return d}var J6=Z6,e3=J6;function t3(e){return e&&e.length?e3(e):[]}var pu=t3,gu=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Nr,"__esModule",{value:!0});Nr.firstForTerminal=Nr.firstForBranching=Nr.firstForSequence=Nr.first=void 0;var r3=gu(an),Gm=gu(pu),n3=gu(nr),sh=It,lc=It;function As(e){if(e instanceof sh.NonTerminal)return As(e.referencedRule);if(e instanceof sh.Terminal)return Km(e);if((0,lc.isSequenceProd)(e))return Hm(e);if((0,lc.isBranchingProd)(e))return Wm(e);throw Error("non exhaustive match")}Nr.first=As;function Hm(e){for(var t=[],r=e.definition,n=0,a=r.length>n,i,s=!0;a&&s;)i=r[n],s=(0,lc.isOptionalProd)(i),t=t.concat(As(i)),n=n+1,a=r.length>n;return(0,Gm.default)(t)}Nr.firstForSequence=Hm;function Wm(e){var t=(0,n3.default)(e.definition,function(r){return As(r)});return(0,Gm.default)((0,r3.default)(t))}Nr.firstForBranching=Wm;function Km(e){return[e.terminalType]}Nr.firstForTerminal=Km;var Wi={};Object.defineProperty(Wi,"__esModule",{value:!0});Wi.IN=void 0;Wi.IN="_~IN~_";var a3=Ae&&Ae.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ym=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Mr,"__esModule",{value:!0});Mr.buildInProdFollowPrefix=Mr.buildBetweenProdsFollowPrefix=Mr.computeAllProdsFollows=Mr.ResyncFollowsWalker=void 0;var i3=Va,o3=Nr,s3=Ym(Yt),l3=Ym(ws),qm=Wi,c3=It,Xm=function(e){a3(t,e);function t(r){var n=e.call(this)||this;return n.topProd=r,n.follows={},n}return t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(r,n,a){},t.prototype.walkProdRef=function(r,n,a){var i=jm(r.referencedRule,r.idx)+this.topProd.name,s=n.concat(a),d=new c3.Alternative({definition:s}),h=(0,o3.first)(d);this.follows[i]=h},t}(i3.RestWalker);Mr.ResyncFollowsWalker=Xm;function u3(e){var t={};return(0,s3.default)(e,function(r){var n=new Xm(r).startWalking();(0,l3.default)(t,n)}),t}Mr.computeAllProdsFollows=u3;function jm(e,t){return e.name+t+qm.IN}Mr.buildBetweenProdsFollowPrefix=jm;function d3(e){var t=e.terminalType.name;return t+e.idx+qm.IN}Mr.buildInProdFollowPrefix=d3;var Xn={};function f3(e){return e===void 0}var Ga=f3,Ki={},mu={},Cs={exports:{}};(function(e){(function(t,r){e.exports?e.exports=r():t.regexpToAst=r()})(typeof self!="undefined"?self:Ae,function(){function t(){}t.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},t.prototype.restoreState=function(g){this.idx=g.idx,this.input=g.input,this.groupIdx=g.groupIdx},t.prototype.pattern=function(g){this.idx=0,this.input=g,this.groupIdx=0,this.consumeChar("/");var b=this.disjunction();this.consumeChar("/");for(var v={type:"Flags",loc:{begin:this.idx,end:g.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":d(v,"global");break;case"i":d(v,"ignoreCase");break;case"m":d(v,"multiLine");break;case"u":d(v,"unicode");break;case"y":d(v,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:v,value:b,loc:this.loc(0)}},t.prototype.disjunction=function(){var g=[],b=this.idx;for(g.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),g.push(this.alternative());return{type:"Disjunction",value:g,loc:this.loc(b)}},t.prototype.alternative=function(){for(var g=[],b=this.idx;this.isTerm();)g.push(this.term());return{type:"Alternative",value:g,loc:this.loc(b)}},t.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},t.prototype.assertion=function(){var g=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(g)};case"$":return{type:"EndAnchor",loc:this.loc(g)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(g)};case"B":return{type:"NonWordBoundary",loc:this.loc(g)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var b;switch(this.popChar()){case"=":b="Lookahead";break;case"!":b="NegativeLookahead";break}h(b);var v=this.disjunction();return this.consumeChar(")"),{type:b,value:v,loc:this.loc(g)}}c()},t.prototype.quantifier=function(g){var b,v=this.idx;switch(this.popChar()){case"*":b={atLeast:0,atMost:1/0};break;case"+":b={atLeast:1,atMost:1/0};break;case"?":b={atLeast:0,atMost:1};break;case"{":var w=this.integerIncludingZero();switch(this.popChar()){case"}":b={atLeast:w,atMost:w};break;case",":var y;this.isDigit()?(y=this.integerIncludingZero(),b={atLeast:w,atMost:y}):b={atLeast:w,atMost:1/0},this.consumeChar("}");break}if(g===!0&&b===void 0)return;h(b);break}if(!(g===!0&&b===void 0))return h(b),this.peekChar(0)==="?"?(this.consumeChar("?"),b.greedy=!1):b.greedy=!0,b.type="Quantifier",b.loc=this.loc(v),b},t.prototype.atom=function(){var g,b=this.idx;switch(this.peekChar()){case".":g=this.dotAll();break;case"\\":g=this.atomEscape();break;case"[":g=this.characterClass();break;case"(":g=this.group();break}return g===void 0&&this.isPatternCharacter()&&(g=this.patternCharacter()),h(g),g.loc=this.loc(b),this.isQuantifier()&&(g.quantifier=this.quantifier()),g},t.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[i(`
`),i("\r"),i("\u2028"),i("\u2029")]}},t.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.decimalEscapeAtom=function(){var g=this.positiveInteger();return{type:"GroupBackReference",value:g}},t.prototype.characterClassEscape=function(){var g,b=!1;switch(this.popChar()){case"d":g=l;break;case"D":g=l,b=!0;break;case"s":g=f;break;case"S":g=f,b=!0;break;case"w":g=u;break;case"W":g=u,b=!0;break}return h(g),{type:"Set",value:g,complement:b}},t.prototype.controlEscapeAtom=function(){var g;switch(this.popChar()){case"f":g=i("\f");break;case"n":g=i(`
`);break;case"r":g=i("\r");break;case"t":g=i("	");break;case"v":g=i("\v");break}return h(g),{type:"Character",value:g}},t.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var g=this.popChar();if(/[a-zA-Z]/.test(g)===!1)throw Error("Invalid ");var b=g.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:b}},t.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:i("\0")}},t.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},t.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},t.prototype.identityEscapeAtom=function(){var g=this.popChar();return{type:"Character",value:i(g)}},t.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var g=this.popChar();return{type:"Character",value:i(g)}}},t.prototype.characterClass=function(){var g=[],b=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),b=!0);this.isClassAtom();){var v=this.classAtom(),w=v.type==="Character";if(w&&this.isRangeDash()){this.consumeChar("-");var y=this.classAtom(),_=y.type==="Character";if(_){if(y.value<v.value)throw Error("Range out of order in character class");g.push({from:v.value,to:y.value})}else s(v.value,g),g.push(i("-")),s(y.value,g)}else s(v.value,g)}return this.consumeChar("]"),{type:"Set",complement:b,value:g}},t.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},t.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:i("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.group=function(){var g=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),g=!1;break;default:this.groupIdx++;break}var b=this.disjunction();this.consumeChar(")");var v={type:"Group",capturing:g,value:b};return g&&(v.idx=this.groupIdx),v},t.prototype.positiveInteger=function(){var g=this.popChar();if(a.test(g)===!1)throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)g+=this.popChar();return parseInt(g,10)},t.prototype.integerIncludingZero=function(){var g=this.popChar();if(n.test(g)===!1)throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)g+=this.popChar();return parseInt(g,10)},t.prototype.patternCharacter=function(){var g=this.popChar();switch(g){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:i(g)}}},t.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},t.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},t.prototype.isDigit=function(){return n.test(this.peekChar(0))},t.prototype.isClassAtom=function(g){switch(g===void 0&&(g=0),this.peekChar(g)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},t.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},t.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},t.prototype.isQuantifier=function(){var g=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(g)}},t.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.parseHexDigits=function(g){for(var b="",v=0;v<g;v++){var w=this.popChar();if(r.test(w)===!1)throw Error("Expecting a HexDecimal digits");b+=w}var y=parseInt(b,16);return{type:"Character",value:y}},t.prototype.peekChar=function(g){return g===void 0&&(g=0),this.input[this.idx+g]},t.prototype.popChar=function(){var g=this.peekChar(0);return this.consumeChar(),g},t.prototype.consumeChar=function(g){if(g!==void 0&&this.input[this.idx]!==g)throw Error("Expected: '"+g+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++},t.prototype.loc=function(g){return{begin:g,end:this.idx}};var r=/[0-9a-fA-F]/,n=/[0-9]/,a=/[1-9]/;function i(g){return g.charCodeAt(0)}function s(g,b){g.length!==void 0?g.forEach(function(v){b.push(v)}):b.push(g)}function d(g,b){if(g[b]===!0)throw"duplicate flag "+b;g[b]=!0}function h(g){if(g===void 0)throw Error("Internal Error - Should never get here!")}function c(){throw Error("Internal Error - Should never get here!")}var o,l=[];for(o=i("0");o<=i("9");o++)l.push(o);var u=[i("_")].concat(l);for(o=i("a");o<=i("z");o++)u.push(o);for(o=i("A");o<=i("Z");o++)u.push(o);var f=[i(" "),i("\f"),i(`
`),i("\r"),i("	"),i("\v"),i("	"),i("\xA0"),i("\u1680"),i("\u2000"),i("\u2001"),i("\u2002"),i("\u2003"),i("\u2004"),i("\u2005"),i("\u2006"),i("\u2007"),i("\u2008"),i("\u2009"),i("\u200A"),i("\u2028"),i("\u2029"),i("\u202F"),i("\u205F"),i("\u3000"),i("\uFEFF")];function m(){}return m.prototype.visitChildren=function(g){for(var b in g){var v=g[b];g.hasOwnProperty(b)&&(v.type!==void 0?this.visit(v):Array.isArray(v)&&v.forEach(function(w){this.visit(w)},this))}},m.prototype.visit=function(g){switch(g.type){case"Pattern":this.visitPattern(g);break;case"Flags":this.visitFlags(g);break;case"Disjunction":this.visitDisjunction(g);break;case"Alternative":this.visitAlternative(g);break;case"StartAnchor":this.visitStartAnchor(g);break;case"EndAnchor":this.visitEndAnchor(g);break;case"WordBoundary":this.visitWordBoundary(g);break;case"NonWordBoundary":this.visitNonWordBoundary(g);break;case"Lookahead":this.visitLookahead(g);break;case"NegativeLookahead":this.visitNegativeLookahead(g);break;case"Character":this.visitCharacter(g);break;case"Set":this.visitSet(g);break;case"Group":this.visitGroup(g);break;case"GroupBackReference":this.visitGroupBackReference(g);break;case"Quantifier":this.visitQuantifier(g);break}this.visitChildren(g)},m.prototype.visitPattern=function(g){},m.prototype.visitFlags=function(g){},m.prototype.visitDisjunction=function(g){},m.prototype.visitAlternative=function(g){},m.prototype.visitStartAnchor=function(g){},m.prototype.visitEndAnchor=function(g){},m.prototype.visitWordBoundary=function(g){},m.prototype.visitNonWordBoundary=function(g){},m.prototype.visitLookahead=function(g){},m.prototype.visitNegativeLookahead=function(g){},m.prototype.visitCharacter=function(g){},m.prototype.visitSet=function(g){},m.prototype.visitGroup=function(g){},m.prototype.visitGroupBackReference=function(g){},m.prototype.visitQuantifier=function(g){},{RegExpParser:t,BaseRegExpVisitor:m,VERSION:"0.5.0"}})})(Cs);function h3(e){return e&&e.length?e[0]:void 0}var p3=h3,Yi=p3;function g3(e){for(var t=-1,r=e==null?0:e.length,n=0,a=[];++t<r;){var i=e[t];i&&(a[n++]=i)}return a}var xs=g3,m3=qn;function v3(e,t){var r=[];return m3(e,function(n,a,i){t(n,a,i)&&r.push(n)}),r}var Qm=v3,b3="Expected a function";function y3(e){if(typeof e!="function")throw new TypeError(b3);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}var E3=y3,w3=Jc,_3=Qm,N3=Vr,A3=lt,C3=E3;function x3(e,t){var r=A3(e)?w3:_3;return r(e,C3(N3(t)))}var vu=x3,T3=Xc,R3=Vm,O3=zm,k3=Fi,I3=Ui,M3=jc,P3=200;function S3(e,t,r,n){var a=-1,i=R3,s=!0,d=e.length,h=[],c=t.length;if(!d)return h;r&&(t=k3(t,I3(r))),n?(i=O3,s=!1):t.length>=P3&&(i=M3,s=!1,t=new T3(t));e:for(;++a<d;){var o=e[a],l=r==null?o:r(o);if(o=n||o!==0?o:0,s&&l===l){for(var u=c;u--;)if(t[u]===l)continue e;h.push(o)}else i(t,l,n)||h.push(o)}return h}var L3=S3,$3=Fr,D3=Ur;function U3(e){return D3(e)&&$3(e)}var F3=U3,B3=L3,V3=fu,z3=lu,lh=F3,G3=z3(function(e,t){return lh(e)?B3(e,V3(t,1,lh,!0)):[]}),bu=G3,H3=uu,W3=Hi,K3=Math.max;function Y3(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:W3(r);return a<0&&(a=K3(n+a,0)),H3(e,t,a)}var q3=Y3,X3=Vr,j3=Fr,Q3=mr;function Z3(e){return function(t,r,n){var a=Object(t);if(!j3(t)){var i=X3(r);t=Q3(t),r=function(d){return i(a[d],d,a)}}var s=e(t,r,n);return s>-1?a[i?t[s]:s]:void 0}}var J3=Z3,e$=Um,t$=Vr,r$=Hi,n$=Math.max;function a$(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:r$(r);return a<0&&(a=n$(n+a,0)),e$(e,t$(t),a)}var i$=a$,o$=J3,s$=i$,l$=o$(s$),yu=l$,c$=Jc,u$=Qm,d$=Vr,f$=lt;function h$(e,t){var r=f$(e)?c$:u$;return r(e,d$(t))}var Eu=h$,p$=lu,g$=Bi,m$=Es,v$=ms,Zm=Object.prototype,b$=Zm.hasOwnProperty,y$=p$(function(e,t){e=Object(e);var r=-1,n=t.length,a=n>2?t[2]:void 0;for(a&&m$(t[0],t[1],a)&&(n=1);++r<n;)for(var i=t[r],s=v$(i),d=-1,h=s.length;++d<h;){var c=s[d],o=e[c];(o===void 0||g$(o,Zm[c])&&!b$.call(e,c))&&(e[c]=i[c])}return e}),Jm=y$;function E$(e,t,r,n){var a=-1,i=e==null?0:e.length;for(n&&i&&(r=e[++a]);++a<i;)r=t(r,e[a],a,e);return r}var w$=E$;function _$(e,t,r,n,a){return a(e,function(i,s,d){r=n?(n=!1,i):t(r,i,s,d)}),r}var N$=_$,A$=w$,C$=qn,x$=Vr,T$=N$,R$=lt;function O$(e,t,r){var n=R$(e)?A$:T$,a=arguments.length<3;return n(e,x$(t),r,a,C$)}var jn=O$,ev={},wn={};Object.defineProperty(wn,"__esModule",{value:!0});wn.clearRegExpParserCache=wn.getRegExpAst=void 0;var k$=Cs.exports,To={},I$=new k$.RegExpParser;function M$(e){var t=e.toString();if(To.hasOwnProperty(t))return To[t];var r=I$.pattern(t);return To[t]=r,r}wn.getRegExpAst=M$;function P$(){To={}}wn.clearRegExpParserCache=P$;(function(e){var t=Ae&&Ae.__extends||function(){var A=function(x,C){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,P){N.__proto__=P}||function(N,P){for(var z in P)Object.prototype.hasOwnProperty.call(P,z)&&(N[z]=P[z])},A(x,C)};return function(x,C){if(typeof C!="function"&&C!==null)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");A(x,C);function N(){this.constructor=x}x.prototype=C===null?Object.create(C):(N.prototype=C.prototype,new N)}}(),r=Ae&&Ae.__importDefault||function(A){return A&&A.__esModule?A:{default:A}};Object.defineProperty(e,"__esModule",{value:!0}),e.canMatchCharCode=e.firstCharOptimizedIndices=e.getOptimizedStartCodesIndices=e.failedOptimizationPrefixMsg=void 0;var n=Cs.exports,a=r(lt),i=r(Ns),s=r(Yt),d=r(yu),h=r(tn),c=r(nn),o=Ba,l=wn,u=mu,f="Complement Sets are not supported for first char optimization";e.failedOptimizationPrefixMsg=`Unable to use "first char" lexer optimizations:
`;function m(A,x){x===void 0&&(x=!1);try{var C=(0,l.getRegExpAst)(A),N=g(C.value,{},C.flags.ignoreCase);return N}catch(z){if(z.message===f)x&&(0,o.PRINT_WARNING)("".concat(e.failedOptimizationPrefixMsg)+"	Unable to optimize: < ".concat(A.toString(),` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var P="";x&&(P=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),(0,o.PRINT_ERROR)("".concat(e.failedOptimizationPrefixMsg,`
`)+"	Failed parsing: < ".concat(A.toString(),` >
`)+"	Using the regexp-to-ast library version: ".concat(n.VERSION,`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+P)}}return[]}e.getOptimizedStartCodesIndices=m;function g(A,x,C){switch(A.type){case"Disjunction":for(var N=0;N<A.value.length;N++)g(A.value[N],x,C);break;case"Alternative":for(var P=A.value,N=0;N<P.length;N++){var z=P[N];switch(z.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var K=z;switch(K.type){case"Character":b(K.value,x,C);break;case"Set":if(K.complement===!0)throw Error(f);(0,s.default)(K.value,function(ce){if(typeof ce=="number")b(ce,x,C);else{var V=ce;if(C===!0)for(var G=V.from;G<=V.to;G++)b(G,x,C);else{for(var G=V.from;G<=V.to&&G<u.minOptimizationVal;G++)b(G,x,C);if(V.to>=u.minOptimizationVal)for(var j=V.from>=u.minOptimizationVal?V.from:u.minOptimizationVal,ie=V.to,fe=(0,u.charCodeToOptimizedIndex)(j),ve=(0,u.charCodeToOptimizedIndex)(ie),xe=fe;xe<=ve;xe++)x[xe]=xe}}});break;case"Group":g(K.value,x,C);break;default:throw Error("Non Exhaustive Match")}var q=K.quantifier!==void 0&&K.quantifier.atLeast===0;if(K.type==="Group"&&y(K)===!1||K.type!=="Group"&&q===!1)break}break;default:throw Error("non exhaustive match!")}return(0,h.default)(x)}e.firstCharOptimizedIndices=g;function b(A,x,C){var N=(0,u.charCodeToOptimizedIndex)(A);x[N]=N,C===!0&&v(A,x)}function v(A,x){var C=String.fromCharCode(A),N=C.toUpperCase();if(N!==C){var P=(0,u.charCodeToOptimizedIndex)(N.charCodeAt(0));x[P]=P}else{var z=C.toLowerCase();if(z!==C){var P=(0,u.charCodeToOptimizedIndex)(z.charCodeAt(0));x[P]=P}}}function w(A,x){return(0,d.default)(A.value,function(C){if(typeof C=="number")return(0,c.default)(x,C);var N=C;return(0,d.default)(x,function(P){return N.from<=P&&P<=N.to})!==void 0})}function y(A){var x=A.quantifier;return x&&x.atLeast===0?!0:A.value?(0,a.default)(A.value)?(0,i.default)(A.value,y):y(A.value):!1}var _=function(A){t(x,A);function x(C){var N=A.call(this)||this;return N.targetCharCodes=C,N.found=!1,N}return x.prototype.visitChildren=function(C){if(this.found!==!0){switch(C.type){case"Lookahead":this.visitLookahead(C);return;case"NegativeLookahead":this.visitNegativeLookahead(C);return}A.prototype.visitChildren.call(this,C)}},x.prototype.visitCharacter=function(C){(0,c.default)(this.targetCharCodes,C.value)&&(this.found=!0)},x.prototype.visitSet=function(C){C.complement?w(C,this.targetCharCodes)===void 0&&(this.found=!0):w(C,this.targetCharCodes)!==void 0&&(this.found=!0)},x}(n.BaseRegExpVisitor);function T(A,x){if(x instanceof RegExp){var C=(0,l.getRegExpAst)(x),N=new _(A);return N.visit(C),N.found}else return(0,d.default)(x,function(P){return(0,c.default)(A,P.charCodeAt(0))})!==void 0}e.canMatchCharCode=T})(ev);(function(e){var t=Ae&&Ae.__extends||function(){var L=function(D,ae){return L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Q,ee){Q.__proto__=ee}||function(Q,ee){for(var we in ee)Object.prototype.hasOwnProperty.call(ee,we)&&(Q[we]=ee[we])},L(D,ae)};return function(D,ae){if(typeof ae!="function"&&ae!==null)throw new TypeError("Class extends value "+String(ae)+" is not a constructor or null");L(D,ae);function Q(){this.constructor=D}D.prototype=ae===null?Object.create(ae):(Q.prototype=ae.prototype,new Q)}}(),r=Ae&&Ae.__importDefault||function(L){return L&&L.__esModule?L:{default:L}};Object.defineProperty(e,"__esModule",{value:!0}),e.charCodeToOptimizedIndex=e.minOptimizationVal=e.buildLineBreakIssueMessage=e.LineTerminatorOptimizedTester=e.isShortPattern=e.isCustomPattern=e.cloneEmptyGroups=e.performWarningRuntimeChecks=e.performRuntimeChecks=e.addStickyFlag=e.addStartOfInput=e.findUnreachablePatterns=e.findModesThatDoNotExist=e.findInvalidGroupType=e.findDuplicatePatterns=e.findUnsupportedFlags=e.findStartOfInputAnchor=e.findEmptyMatchRegExps=e.findEndOfInputAnchor=e.findInvalidPatterns=e.findMissingPatterns=e.validatePatterns=e.analyzeTokenTypes=e.enableSticky=e.disableSticky=e.SUPPORT_STICKY=e.MODES=e.DEFAULT_MODE=void 0;var n=Cs.exports,a=Ki,i=r(Yi),s=r(Br),d=r(xs),h=r(lt),c=r(tn),o=r(an),l=r(vu),u=r(bu),f=r(q3),m=r(nr),g=r(Yt),b=r(ys),v=r($i),w=r(Ga),y=r(yu),_=r(vr),T=r(mr),A=r(xm),x=r(Eu),C=r(Jm),N=r(jn),P=r(nn),z=Ba,K=ev,q=wn,W="PATTERN";e.DEFAULT_MODE="defaultMode",e.MODES="modes",e.SUPPORT_STICKY=typeof new RegExp("(?:)").sticky=="boolean";function ce(){e.SUPPORT_STICKY=!1}e.disableSticky=ce;function V(){e.SUPPORT_STICKY=!0}e.enableSticky=V;function G(L,D){D=(0,C.default)(D,{useSticky:e.SUPPORT_STICKY,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(F,E){return E()}});var ae=D.tracer;ae("initCharCodeToOptimizedIndexMap",function(){de()});var Q;ae("Reject Lexer.NA",function(){Q=(0,l.default)(L,function(F){return F[W]===a.Lexer.NA})});var ee=!1,we;ae("Transform Patterns",function(){ee=!1,we=(0,m.default)(Q,function(F){var E=F[W];if((0,A.default)(E)){var O=E.source;return O.length===1&&O!=="^"&&O!=="$"&&O!=="."&&!E.ignoreCase?O:O.length===2&&O[0]==="\\"&&!(0,P.default)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],O[1])?O[1]:D.useSticky?H(E):B(E)}else{if((0,v.default)(E))return ee=!0,{exec:E};if(typeof E=="object")return ee=!0,E;if(typeof E=="string"){if(E.length===1)return E;var Ce=E.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),Ve=new RegExp(Ce);return D.useSticky?H(Ve):B(Ve)}else throw Error("non exhaustive match")}})});var Le,Be,$e,De,xt;ae("misc mapping",function(){Le=(0,m.default)(Q,function(F){return F.tokenTypeIdx}),Be=(0,m.default)(Q,function(F){var E=F.GROUP;if(E!==a.Lexer.SKIPPED){if((0,b.default)(E))return E;if((0,w.default)(E))return!1;throw Error("non exhaustive match")}}),$e=(0,m.default)(Q,function(F){var E=F.LONGER_ALT;if(E){var O=(0,h.default)(E)?(0,m.default)(E,function(Ce){return(0,f.default)(Q,Ce)}):[(0,f.default)(Q,E)];return O}}),De=(0,m.default)(Q,function(F){return F.PUSH_MODE}),xt=(0,m.default)(Q,function(F){return(0,_.default)(F,"POP_MODE")})});var Vt;ae("Line Terminator Handling",function(){var F=Oe(D.lineTerminatorCharacters);Vt=(0,m.default)(Q,function(E){return!1}),D.positionTracking!=="onlyOffset"&&(Vt=(0,m.default)(Q,function(E){return(0,_.default)(E,"LINE_BREAKS")?!!E.LINE_BREAKS:pe(E,F)===!1&&(0,K.canMatchCharCode)(F,E.PATTERN)}))});var ar,Ee,oe,ge;ae("Misc Mapping #2",function(){ar=(0,m.default)(Q,ye),Ee=(0,m.default)(we,$),oe=(0,N.default)(Q,function(F,E){var O=E.GROUP;return(0,b.default)(O)&&O!==a.Lexer.SKIPPED&&(F[O]=[]),F},{}),ge=(0,m.default)(we,function(F,E){return{pattern:we[E],longerAlt:$e[E],canLineTerminator:Vt[E],isCustom:ar[E],short:Ee[E],group:Be[E],push:De[E],pop:xt[E],tokenTypeIdx:Le[E],tokenType:Q[E]}})});var te=!0,se=[];return D.safeMode||ae("First Char Optimization",function(){se=(0,N.default)(Q,function(F,E,O){if(typeof E.PATTERN=="string"){var Ce=E.PATTERN.charCodeAt(0),Ve=_e(Ce);Ne(F,Ve,ge[O])}else if((0,h.default)(E.START_CHARS_HINT)){var et;(0,g.default)(E.START_CHARS_HINT,function(Ie){var Pe=typeof Ie=="string"?Ie.charCodeAt(0):Ie,je=_e(Pe);et!==je&&(et=je,Ne(F,je,ge[O]))})}else if((0,A.default)(E.PATTERN))if(E.PATTERN.unicode)te=!1,D.ensureOptimizations&&(0,z.PRINT_ERROR)("".concat(K.failedOptimizationPrefixMsg)+"	Unable to analyze < ".concat(E.PATTERN.toString(),` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var tt=(0,K.getOptimizedStartCodesIndices)(E.PATTERN,D.ensureOptimizations);(0,s.default)(tt)&&(te=!1),(0,g.default)(tt,function(Ie){Ne(F,Ie,ge[O])})}else D.ensureOptimizations&&(0,z.PRINT_ERROR)("".concat(K.failedOptimizationPrefixMsg)+"	TokenType: <".concat(E.name,`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),te=!1;return F},[])}),{emptyGroups:oe,patternIdxToConfig:ge,charCodeToPatternIdxToConfig:se,hasCustom:ee,canBeOptimized:te}}e.analyzeTokenTypes=G;function j(L,D){var ae=[],Q=fe(L);ae=ae.concat(Q.errors);var ee=ve(Q.valid),we=ee.valid;return ae=ae.concat(ee.errors),ae=ae.concat(ie(we)),ae=ae.concat(me(we)),ae=ae.concat(Y(we,D)),ae=ae.concat(be(we)),ae}e.validatePatterns=j;function ie(L){var D=[],ae=(0,x.default)(L,function(Q){return(0,A.default)(Q[W])});return D=D.concat(Te(ae)),D=D.concat(S(ae)),D=D.concat(I(ae)),D=D.concat(U(ae)),D=D.concat(Me(ae)),D}function fe(L){var D=(0,x.default)(L,function(ee){return!(0,_.default)(ee,W)}),ae=(0,m.default)(D,function(ee){return{message:"Token Type: ->"+ee.name+"<- missing static 'PATTERN' property",type:a.LexerDefinitionErrorType.MISSING_PATTERN,tokenTypes:[ee]}}),Q=(0,u.default)(L,D);return{errors:ae,valid:Q}}e.findMissingPatterns=fe;function ve(L){var D=(0,x.default)(L,function(ee){var we=ee[W];return!(0,A.default)(we)&&!(0,v.default)(we)&&!(0,_.default)(we,"exec")&&!(0,b.default)(we)}),ae=(0,m.default)(D,function(ee){return{message:"Token Type: ->"+ee.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:a.LexerDefinitionErrorType.INVALID_PATTERN,tokenTypes:[ee]}}),Q=(0,u.default)(L,D);return{errors:ae,valid:Q}}e.findInvalidPatterns=ve;var xe=/[^\\][$]/;function Te(L){var D=function(ee){t(we,ee);function we(){var Le=ee!==null&&ee.apply(this,arguments)||this;return Le.found=!1,Le}return we.prototype.visitEndAnchor=function(Le){this.found=!0},we}(n.BaseRegExpVisitor),ae=(0,x.default)(L,function(ee){var we=ee.PATTERN;try{var Le=(0,q.getRegExpAst)(we),Be=new D;return Be.visit(Le),Be.found}catch{return xe.test(we.source)}}),Q=(0,m.default)(ae,function(ee){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+ee.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:a.LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenTypes:[ee]}});return Q}e.findEndOfInputAnchor=Te;function Me(L){var D=(0,x.default)(L,function(Q){var ee=Q.PATTERN;return ee.test("")}),ae=(0,m.default)(D,function(Q){return{message:"Token Type: ->"+Q.name+"<- static 'PATTERN' must not match an empty string",type:a.LexerDefinitionErrorType.EMPTY_MATCH_PATTERN,tokenTypes:[Q]}});return ae}e.findEmptyMatchRegExps=Me;var J=/[^\\[][\^]|^\^/;function S(L){var D=function(ee){t(we,ee);function we(){var Le=ee!==null&&ee.apply(this,arguments)||this;return Le.found=!1,Le}return we.prototype.visitStartAnchor=function(Le){this.found=!0},we}(n.BaseRegExpVisitor),ae=(0,x.default)(L,function(ee){var we=ee.PATTERN;try{var Le=(0,q.getRegExpAst)(we),Be=new D;return Be.visit(Le),Be.found}catch{return J.test(we.source)}}),Q=(0,m.default)(ae,function(ee){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+ee.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:a.LexerDefinitionErrorType.SOI_ANCHOR_FOUND,tokenTypes:[ee]}});return Q}e.findStartOfInputAnchor=S;function I(L){var D=(0,x.default)(L,function(Q){var ee=Q[W];return ee instanceof RegExp&&(ee.multiline||ee.global)}),ae=(0,m.default)(D,function(Q){return{message:"Token Type: ->"+Q.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:a.LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[Q]}});return ae}e.findUnsupportedFlags=I;function U(L){var D=[],ae=(0,m.default)(L,function(we){return(0,N.default)(L,function(Le,Be){return we.PATTERN.source===Be.PATTERN.source&&!(0,P.default)(D,Be)&&Be.PATTERN!==a.Lexer.NA&&(D.push(Be),Le.push(Be)),Le},[])});ae=(0,d.default)(ae);var Q=(0,x.default)(ae,function(we){return we.length>1}),ee=(0,m.default)(Q,function(we){var Le=(0,m.default)(we,function($e){return $e.name}),Be=(0,i.default)(we).PATTERN;return{message:"The same RegExp pattern ->".concat(Be,"<-")+"has been used in all of the following Token Types: ".concat(Le.join(", ")," <-"),type:a.LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenTypes:we}});return ee}e.findDuplicatePatterns=U;function me(L){var D=(0,x.default)(L,function(Q){if(!(0,_.default)(Q,"GROUP"))return!1;var ee=Q.GROUP;return ee!==a.Lexer.SKIPPED&&ee!==a.Lexer.NA&&!(0,b.default)(ee)}),ae=(0,m.default)(D,function(Q){return{message:"Token Type: ->"+Q.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:a.LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenTypes:[Q]}});return ae}e.findInvalidGroupType=me;function Y(L,D){var ae=(0,x.default)(L,function(ee){return ee.PUSH_MODE!==void 0&&!(0,P.default)(D,ee.PUSH_MODE)}),Q=(0,m.default)(ae,function(ee){var we="Token Type: ->".concat(ee.name,"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->").concat(ee.PUSH_MODE,"<-")+"which does not exist";return{message:we,type:a.LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[ee]}});return Q}e.findModesThatDoNotExist=Y;function be(L){var D=[],ae=(0,N.default)(L,function(Q,ee,we){var Le=ee.PATTERN;return Le===a.Lexer.NA||((0,b.default)(Le)?Q.push({str:Le,idx:we,tokenType:ee}):(0,A.default)(Le)&&k(Le)&&Q.push({str:Le.source,idx:we,tokenType:ee})),Q},[]);return(0,g.default)(L,function(Q,ee){(0,g.default)(ae,function(we){var Le=we.str,Be=we.idx,$e=we.tokenType;if(ee<Be&&X(Le,Q.PATTERN)){var De="Token: ->".concat($e.name,`<- can never be matched.
`)+"Because it appears AFTER the Token Type ->".concat(Q.name,"<-")+`in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;D.push({message:De,type:a.LexerDefinitionErrorType.UNREACHABLE_PATTERN,tokenTypes:[Q,$e]})}})}),D}e.findUnreachablePatterns=be;function X(L,D){if((0,A.default)(D)){var ae=D.exec(L);return ae!==null&&ae.index===0}else{if((0,v.default)(D))return D(L,0,[],{});if((0,_.default)(D,"exec"))return D.exec(L,0,[],{});if(typeof D=="string")return D===L;throw Error("non exhaustive match")}}function k(L){var D=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return(0,y.default)(D,function(ae){return L.source.indexOf(ae)!==-1})===void 0}function B(L){var D=L.ignoreCase?"i":"";return new RegExp("^(?:".concat(L.source,")"),D)}e.addStartOfInput=B;function H(L){var D=L.ignoreCase?"iy":"y";return new RegExp("".concat(L.source),D)}e.addStickyFlag=H;function re(L,D,ae){var Q=[];return(0,_.default)(L,e.DEFAULT_MODE)||Q.push({message:"A MultiMode Lexer cannot be initialized without a <"+e.DEFAULT_MODE+`> property in its definition
`,type:a.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),(0,_.default)(L,e.MODES)||Q.push({message:"A MultiMode Lexer cannot be initialized without a <"+e.MODES+`> property in its definition
`,type:a.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),(0,_.default)(L,e.MODES)&&(0,_.default)(L,e.DEFAULT_MODE)&&!(0,_.default)(L.modes,L.defaultMode)&&Q.push({message:"A MultiMode Lexer cannot be initialized with a ".concat(e.DEFAULT_MODE,": <").concat(L.defaultMode,">")+`which does not exist
`,type:a.LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),(0,_.default)(L,e.MODES)&&(0,g.default)(L.modes,function(ee,we){(0,g.default)(ee,function(Le,Be){(0,w.default)(Le)&&Q.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+"<".concat(we,"> at index: <").concat(Be,`>
`),type:a.LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),Q}e.performRuntimeChecks=re;function ne(L,D,ae){var Q=[],ee=!1,we=(0,d.default)((0,o.default)((0,c.default)(L.modes))),Le=(0,l.default)(we,function($e){return $e[W]===a.Lexer.NA}),Be=Oe(ae);return D&&(0,g.default)(Le,function($e){var De=pe($e,Be);if(De!==!1){var xt=ue($e,De),Vt={message:xt,type:De.issue,tokenType:$e};Q.push(Vt)}else(0,_.default)($e,"LINE_BREAKS")?$e.LINE_BREAKS===!0&&(ee=!0):(0,K.canMatchCharCode)(Be,$e.PATTERN)&&(ee=!0)}),D&&!ee&&Q.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:a.LexerDefinitionErrorType.NO_LINE_BREAKS_FLAGS}),Q}e.performWarningRuntimeChecks=ne;function p(L){var D={},ae=(0,T.default)(L);return(0,g.default)(ae,function(Q){var ee=L[Q];if((0,h.default)(ee))D[Q]=[];else throw Error("non exhaustive match")}),D}e.cloneEmptyGroups=p;function ye(L){var D=L.PATTERN;if((0,A.default)(D))return!1;if((0,v.default)(D))return!0;if((0,_.default)(D,"exec"))return!0;if((0,b.default)(D))return!1;throw Error("non exhaustive match")}e.isCustomPattern=ye;function $(L){return(0,b.default)(L)&&L.length===1?L.charCodeAt(0):!1}e.isShortPattern=$,e.LineTerminatorOptimizedTester={test:function(L){for(var D=L.length,ae=this.lastIndex;ae<D;ae++){var Q=L.charCodeAt(ae);if(Q===10)return this.lastIndex=ae+1,!0;if(Q===13)return L.charCodeAt(ae+1)===10?this.lastIndex=ae+2:this.lastIndex=ae+1,!0}return!1},lastIndex:0};function pe(L,D){if((0,_.default)(L,"LINE_BREAKS"))return!1;if((0,A.default)(L.PATTERN)){try{(0,K.canMatchCharCode)(D,L.PATTERN)}catch(ae){return{issue:a.LexerDefinitionErrorType.IDENTIFY_TERMINATOR,errMsg:ae.message}}return!1}else{if((0,b.default)(L.PATTERN))return!1;if(ye(L))return{issue:a.LexerDefinitionErrorType.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function ue(L,D){if(D.issue===a.LexerDefinitionErrorType.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+"	The problem is in the <".concat(L.name,`> Token Type
`)+"	 Root cause: ".concat(D.errMsg,`.
`)+"	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(D.issue===a.LexerDefinitionErrorType.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+"	The problem is in the <".concat(L.name,`> Token Type
`)+"	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}e.buildLineBreakIssueMessage=ue;function Oe(L){var D=(0,m.default)(L,function(ae){return(0,b.default)(ae)?ae.charCodeAt(0):ae});return D}function Ne(L,D,ae){L[D]===void 0?L[D]=[ae]:L[D].push(ae)}e.minOptimizationVal=256;var ke=[];function _e(L){return L<e.minOptimizationVal?L:ke[L]}e.charCodeToOptimizedIndex=_e;function de(){if((0,s.default)(ke)){ke=new Array(65536);for(var L=0;L<65536;L++)ke[L]=L>255?255+~~(L/255):L}}})(mu);function S$(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var wu=S$,Qn={};(function(e){var t=Ae&&Ae.__importDefault||function(N){return N&&N.__esModule?N:{default:N}};Object.defineProperty(e,"__esModule",{value:!0}),e.isTokenType=e.hasExtendingTokensTypesMapProperty=e.hasExtendingTokensTypesProperty=e.hasCategoriesProperty=e.hasShortKeyProperty=e.singleAssignCategoriesToksMap=e.assignCategoriesMapProp=e.assignCategoriesTokensProp=e.assignTokenDefaultProps=e.expandCategories=e.augmentTokenTypes=e.tokenIdxToClass=e.tokenShortNameIdx=e.tokenStructuredMatcherNoCategories=e.tokenStructuredMatcher=void 0;var r=t(Br),n=t(xs),a=t(lt),i=t(an),s=t(bu),d=t(nr),h=t(Yt),c=t(vr),o=t(nn),l=t(Nn);function u(N,P){var z=N.tokenTypeIdx;return z===P.tokenTypeIdx?!0:P.isParent===!0&&P.categoryMatchesMap[z]===!0}e.tokenStructuredMatcher=u;function f(N,P){return N.tokenTypeIdx===P.tokenTypeIdx}e.tokenStructuredMatcherNoCategories=f,e.tokenShortNameIdx=1,e.tokenIdxToClass={};function m(N){var P=g(N);b(P),w(P),v(P),(0,h.default)(P,function(z){z.isParent=z.categoryMatches.length>0})}e.augmentTokenTypes=m;function g(N){for(var P=(0,l.default)(N),z=N,K=!0;K;){z=(0,n.default)((0,i.default)((0,d.default)(z,function(W){return W.CATEGORIES})));var q=(0,s.default)(z,P);P=P.concat(q),(0,r.default)(q)?K=!1:z=q}return P}e.expandCategories=g;function b(N){(0,h.default)(N,function(P){_(P)||(e.tokenIdxToClass[e.tokenShortNameIdx]=P,P.tokenTypeIdx=e.tokenShortNameIdx++),T(P)&&!(0,a.default)(P.CATEGORIES)&&(P.CATEGORIES=[P.CATEGORIES]),T(P)||(P.CATEGORIES=[]),A(P)||(P.categoryMatches=[]),x(P)||(P.categoryMatchesMap={})})}e.assignTokenDefaultProps=b;function v(N){(0,h.default)(N,function(P){P.categoryMatches=[],(0,h.default)(P.categoryMatchesMap,function(z,K){P.categoryMatches.push(e.tokenIdxToClass[K].tokenTypeIdx)})})}e.assignCategoriesTokensProp=v;function w(N){(0,h.default)(N,function(P){y([],P)})}e.assignCategoriesMapProp=w;function y(N,P){(0,h.default)(N,function(z){P.categoryMatchesMap[z.tokenTypeIdx]=!0}),(0,h.default)(P.CATEGORIES,function(z){var K=N.concat(P);(0,o.default)(K,z)||y(K,z)})}e.singleAssignCategoriesToksMap=y;function _(N){return(0,c.default)(N,"tokenTypeIdx")}e.hasShortKeyProperty=_;function T(N){return(0,c.default)(N,"CATEGORIES")}e.hasCategoriesProperty=T;function A(N){return(0,c.default)(N,"categoryMatches")}e.hasExtendingTokensTypesProperty=A;function x(N){return(0,c.default)(N,"categoryMatchesMap")}e.hasExtendingTokensTypesMapProperty=x;function C(N){return(0,c.default)(N,"tokenTypeIdx")}e.isTokenType=C})(Qn);var qi={};Object.defineProperty(qi,"__esModule",{value:!0});qi.defaultLexerErrorProvider=void 0;qi.defaultLexerErrorProvider={buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->".concat(e.image,"<- The Mode Stack is empty")},buildUnexpectedCharactersMessage:function(e,t,r,n,a){return"unexpected character: ->".concat(e.charAt(t),"<- at offset: ").concat(t,",")+" skipped ".concat(r," characters.")}};(function(e){var t=Ae&&Ae.__importDefault||function(A){return A&&A.__esModule?A:{default:A}};Object.defineProperty(e,"__esModule",{value:!0}),e.Lexer=e.LexerDefinitionErrorType=void 0;var r=mu,n=t(hu),a=t(Br),i=t(lt),s=t(wu),d=t(vu),h=t(nr),c=t(Yt),o=t(mr),l=t(Ga),u=t(zi),f=t(ws),m=t(jn),g=t(Nn),b=Ba,v=Qn,w=qi,y=wn;(function(A){A[A.MISSING_PATTERN=0]="MISSING_PATTERN",A[A.INVALID_PATTERN=1]="INVALID_PATTERN",A[A.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",A[A.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",A[A.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",A[A.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",A[A.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",A[A.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",A[A.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",A[A.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",A[A.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",A[A.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",A[A.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",A[A.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",A[A.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",A[A.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",A[A.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(e.LexerDefinitionErrorType||(e.LexerDefinitionErrorType={}));var _={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:w.defaultLexerErrorProvider,traceInitPerf:!1,skipValidations:!1};Object.freeze(_);var T=function(){function A(x,C){C===void 0&&(C=_);var N=this;if(this.lexerDefinition=x,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=function(z,K){if(N.traceInitPerf===!0){N.traceInitIndent++;var q=new Array(N.traceInitIndent+1).join("	");N.traceInitIndent<N.traceInitMaxIdent&&console.log("".concat(q,"--> <").concat(z,">"));var W=(0,b.timer)(K),ce=W.time,V=W.value,G=ce>10?console.warn:console.log;return N.traceInitIndent<N.traceInitMaxIdent&&G("".concat(q,"<-- <").concat(z,"> time: ").concat(ce,"ms")),N.traceInitIndent--,V}else return K()},typeof C=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=(0,f.default)({},_,C);var P=this.config.traceInitPerf;P===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof P=="number"&&(this.traceInitMaxIdent=P,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var z,K=!0;N.TRACE_INIT("Lexer Config handling",function(){if(N.config.lineTerminatorsPattern===_.lineTerminatorsPattern)N.config.lineTerminatorsPattern=r.LineTerminatorOptimizedTester;else if(N.config.lineTerminatorCharacters===_.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(C.safeMode&&C.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');N.trackStartLines=/full|onlyStart/i.test(N.config.positionTracking),N.trackEndLines=/full/i.test(N.config.positionTracking),(0,i.default)(x)?z={modes:{defaultMode:(0,g.default)(x)},defaultMode:r.DEFAULT_MODE}:(K=!1,z=(0,g.default)(x))}),N.config.skipValidations===!1&&(N.TRACE_INIT("performRuntimeChecks",function(){N.lexerDefinitionErrors=N.lexerDefinitionErrors.concat((0,r.performRuntimeChecks)(z,N.trackStartLines,N.config.lineTerminatorCharacters))}),N.TRACE_INIT("performWarningRuntimeChecks",function(){N.lexerDefinitionWarning=N.lexerDefinitionWarning.concat((0,r.performWarningRuntimeChecks)(z,N.trackStartLines,N.config.lineTerminatorCharacters))})),z.modes=z.modes?z.modes:{},(0,c.default)(z.modes,function(V,G){z.modes[G]=(0,d.default)(V,function(j){return(0,l.default)(j)})});var q=(0,o.default)(z.modes);if((0,c.default)(z.modes,function(V,G){N.TRACE_INIT("Mode: <".concat(G,"> processing"),function(){if(N.modes.push(G),N.config.skipValidations===!1&&N.TRACE_INIT("validatePatterns",function(){N.lexerDefinitionErrors=N.lexerDefinitionErrors.concat((0,r.validatePatterns)(V,q))}),(0,a.default)(N.lexerDefinitionErrors)){(0,v.augmentTokenTypes)(V);var j;N.TRACE_INIT("analyzeTokenTypes",function(){j=(0,r.analyzeTokenTypes)(V,{lineTerminatorCharacters:N.config.lineTerminatorCharacters,positionTracking:C.positionTracking,ensureOptimizations:C.ensureOptimizations,safeMode:C.safeMode,tracer:N.TRACE_INIT})}),N.patternIdxToConfig[G]=j.patternIdxToConfig,N.charCodeToPatternIdxToConfig[G]=j.charCodeToPatternIdxToConfig,N.emptyGroups=(0,f.default)({},N.emptyGroups,j.emptyGroups),N.hasCustom=j.hasCustom||N.hasCustom,N.canModeBeOptimized[G]=j.canBeOptimized}})}),N.defaultMode=z.defaultMode,!(0,a.default)(N.lexerDefinitionErrors)&&!N.config.deferDefinitionErrorsHandling){var W=(0,h.default)(N.lexerDefinitionErrors,function(V){return V.message}),ce=W.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+ce)}(0,c.default)(N.lexerDefinitionWarning,function(V){(0,b.PRINT_WARNING)(V.message)}),N.TRACE_INIT("Choosing sub-methods implementations",function(){if(r.SUPPORT_STICKY?(N.chopInput=u.default,N.match=N.matchWithTest):(N.updateLastIndex=n.default,N.match=N.matchWithExec),K&&(N.handleModes=n.default),N.trackStartLines===!1&&(N.computeNewColumn=u.default),N.trackEndLines===!1&&(N.updateTokenEndLineColumnLocation=n.default),/full/i.test(N.config.positionTracking))N.createTokenInstance=N.createFullToken;else if(/onlyStart/i.test(N.config.positionTracking))N.createTokenInstance=N.createStartOnlyToken;else if(/onlyOffset/i.test(N.config.positionTracking))N.createTokenInstance=N.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'.concat(N.config.positionTracking,'"'));N.hasCustom?(N.addToken=N.addTokenUsingPush,N.handlePayload=N.handlePayloadWithCustom):(N.addToken=N.addTokenUsingMemberAccess,N.handlePayload=N.handlePayloadNoCustom)}),N.TRACE_INIT("Failed Optimization Warnings",function(){var V=(0,m.default)(N.canModeBeOptimized,function(G,j,ie){return j===!1&&G.push(ie),G},[]);if(C.ensureOptimizations&&!(0,a.default)(V))throw Error("Lexer Modes: < ".concat(V.join(", "),` > cannot be optimized.
`)+`	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),N.TRACE_INIT("clearRegExpParserCache",function(){(0,y.clearRegExpParserCache)()}),N.TRACE_INIT("toFastProperties",function(){(0,b.toFastProperties)(N)})})}return A.prototype.tokenize=function(x,C){if(C===void 0&&(C=this.defaultMode),!(0,a.default)(this.lexerDefinitionErrors)){var N=(0,h.default)(this.lexerDefinitionErrors,function(z){return z.message}),P=N.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+P)}return this.tokenizeInternal(x,C)},A.prototype.tokenizeInternal=function(x,C){var N=this,P,z,K,q,W,ce,V,G,j,ie,fe,ve,xe,Te,Me,J=x,S=J.length,I=0,U=0,me=this.hasCustom?0:Math.floor(x.length/10),Y=new Array(me),be=[],X=this.trackStartLines?1:void 0,k=this.trackStartLines?1:void 0,B=(0,r.cloneEmptyGroups)(this.emptyGroups),H=this.trackStartLines,re=this.config.lineTerminatorsPattern,ne=0,p=[],ye=[],$=[],pe=[];Object.freeze(pe);var ue;function Oe(){return p}function Ne(te){var se=(0,r.charCodeToOptimizedIndex)(te),F=ye[se];return F===void 0?pe:F}var ke=function(te){if($.length===1&&te.tokenType.PUSH_MODE===void 0){var se=N.config.errorMessageProvider.buildUnableToPopLexerModeMessage(te);be.push({offset:te.startOffset,line:te.startLine,column:te.startColumn,length:te.image.length,message:se})}else{$.pop();var F=(0,s.default)($);p=N.patternIdxToConfig[F],ye=N.charCodeToPatternIdxToConfig[F],ne=p.length;var E=N.canModeBeOptimized[F]&&N.config.safeMode===!1;ye&&E?ue=Ne:ue=Oe}};function _e(te){$.push(te),ye=this.charCodeToPatternIdxToConfig[te],p=this.patternIdxToConfig[te],ne=p.length,ne=p.length;var se=this.canModeBeOptimized[te]&&this.config.safeMode===!1;ye&&se?ue=Ne:ue=Oe}_e.call(this,C);for(var de;I<S;){ce=null;var L=J.charCodeAt(I),D=ue(L),ae=D.length;for(P=0;P<ae;P++){de=D[P];var Q=de.pattern;V=null;var ee=de.short;if(ee!==!1?L===ee&&(ce=Q):de.isCustom===!0?(Me=Q.exec(J,I,Y,B),Me!==null?(ce=Me[0],Me.payload!==void 0&&(V=Me.payload)):ce=null):(this.updateLastIndex(Q,I),ce=this.match(Q,x,I)),ce!==null){if(W=de.longerAlt,W!==void 0){var we=W.length;for(K=0;K<we;K++){var Le=p[W[K]],Be=Le.pattern;if(G=null,Le.isCustom===!0?(Me=Be.exec(J,I,Y,B),Me!==null?(q=Me[0],Me.payload!==void 0&&(G=Me.payload)):q=null):(this.updateLastIndex(Be,I),q=this.match(Be,x,I)),q&&q.length>ce.length){ce=q,V=G,de=Le;break}}}break}}if(ce!==null){if(j=ce.length,ie=de.group,ie!==void 0&&(fe=de.tokenTypeIdx,ve=this.createTokenInstance(ce,I,fe,de.tokenType,X,k,j),this.handlePayload(ve,V),ie===!1?U=this.addToken(Y,U,ve):B[ie].push(ve)),x=this.chopInput(x,j),I=I+j,k=this.computeNewColumn(k,j),H===!0&&de.canLineTerminator===!0){var $e=0,De=void 0,xt=void 0;re.lastIndex=0;do De=re.test(ce),De===!0&&(xt=re.lastIndex-1,$e++);while(De===!0);$e!==0&&(X=X+$e,k=j-xt,this.updateTokenEndLineColumnLocation(ve,ie,xt,$e,X,k,j))}this.handleModes(de,ke,_e,ve)}else{for(var Vt=I,ar=X,Ee=k,oe=!1;!oe&&I<S;)for(J.charCodeAt(I),x=this.chopInput(x,1),I++,z=0;z<ne;z++){var ge=p[z],Q=ge.pattern,ee=ge.short;if(ee!==!1?J.charCodeAt(I)===ee&&(oe=!0):ge.isCustom===!0?oe=Q.exec(J,I,Y,B)!==null:(this.updateLastIndex(Q,I),oe=Q.exec(x)!==null),oe===!0)break}xe=I-Vt,Te=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(J,Vt,xe,ar,Ee),be.push({offset:Vt,line:ar,column:Ee,length:xe,message:Te})}}return this.hasCustom||(Y.length=U),{tokens:Y,groups:B,errors:be}},A.prototype.handleModes=function(x,C,N,P){if(x.pop===!0){var z=x.push;C(P),z!==void 0&&N.call(this,z)}else x.push!==void 0&&N.call(this,x.push)},A.prototype.chopInput=function(x,C){return x.substring(C)},A.prototype.updateLastIndex=function(x,C){x.lastIndex=C},A.prototype.updateTokenEndLineColumnLocation=function(x,C,N,P,z,K,q){var W,ce;C!==void 0&&(W=N===q-1,ce=W?-1:0,P===1&&W===!0||(x.endLine=z+ce,x.endColumn=K-1+-ce))},A.prototype.computeNewColumn=function(x,C){return x+C},A.prototype.createOffsetOnlyToken=function(x,C,N,P){return{image:x,startOffset:C,tokenTypeIdx:N,tokenType:P}},A.prototype.createStartOnlyToken=function(x,C,N,P,z,K){return{image:x,startOffset:C,startLine:z,startColumn:K,tokenTypeIdx:N,tokenType:P}},A.prototype.createFullToken=function(x,C,N,P,z,K,q){return{image:x,startOffset:C,endOffset:C+q-1,startLine:z,endLine:z,startColumn:K,endColumn:K+q-1,tokenTypeIdx:N,tokenType:P}},A.prototype.addTokenUsingPush=function(x,C,N){return x.push(N),C},A.prototype.addTokenUsingMemberAccess=function(x,C,N){return x[C]=N,C++,C},A.prototype.handlePayloadNoCustom=function(x,C){},A.prototype.handlePayloadWithCustom=function(x,C){C!==null&&(x.payload=C)},A.prototype.matchWithTest=function(x,C,N){var P=x.test(C);return P===!0?C.substring(N,x.lastIndex):null},A.prototype.matchWithExec=function(x,C){var N=x.exec(C);return N!==null?N[0]:null},A.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",A.NA=/NOT_APPLICABLE/,A}();e.Lexer=T})(Ki);(function(e){var t=Ae&&Ae.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(e,"__esModule",{value:!0}),e.tokenMatcher=e.createTokenInstance=e.EOF=e.createToken=e.hasTokenLabel=e.tokenName=e.tokenLabel=void 0;var r=t(ys),n=t(vr),a=t(Ga),i=Ki,s=Qn;function d(x){return c(x)?x.LABEL:x.name}e.tokenLabel=d;function h(x){return x.name}e.tokenName=h;function c(x){return(0,r.default)(x.LABEL)&&x.LABEL!==""}e.hasTokenLabel=c;var o="parent",l="categories",u="label",f="group",m="push_mode",g="pop_mode",b="longer_alt",v="line_breaks",w="start_chars_hint";function y(x){return _(x)}e.createToken=y;function _(x){var C=x.pattern,N={};if(N.name=x.name,(0,a.default)(C)||(N.PATTERN=C),(0,n.default)(x,o))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return(0,n.default)(x,l)&&(N.CATEGORIES=x[l]),(0,s.augmentTokenTypes)([N]),(0,n.default)(x,u)&&(N.LABEL=x[u]),(0,n.default)(x,f)&&(N.GROUP=x[f]),(0,n.default)(x,g)&&(N.POP_MODE=x[g]),(0,n.default)(x,m)&&(N.PUSH_MODE=x[m]),(0,n.default)(x,b)&&(N.LONGER_ALT=x[b]),(0,n.default)(x,v)&&(N.LINE_BREAKS=x[v]),(0,n.default)(x,w)&&(N.START_CHARS_HINT=x[w]),N}e.EOF=y({name:"EOF",pattern:i.Lexer.NA}),(0,s.augmentTokenTypes)([e.EOF]);function T(x,C,N,P,z,K,q,W){return{image:C,startOffset:N,endOffset:P,startLine:z,endLine:K,startColumn:q,endColumn:W,tokenTypeIdx:x.tokenTypeIdx,tokenType:x}}e.createTokenInstance=T;function A(x,C){return(0,s.tokenStructuredMatcher)(x,C)}e.tokenMatcher=A})(Xn);var Xi={};(function(e){var t=Ae&&Ae.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(e,"__esModule",{value:!0}),e.defaultGrammarValidatorErrorProvider=e.defaultGrammarResolverErrorProvider=e.defaultParserErrorProvider=void 0;var r=Xn,n=t(Yi),a=t(nr),i=t(jn),s=It,d=It;e.defaultParserErrorProvider={buildMismatchTokenMessage:function(h){var c=h.expected,o=h.actual;h.previous,h.ruleName;var l=(0,r.hasTokenLabel)(c),u=l?"--> ".concat((0,r.tokenLabel)(c)," <--"):"token of type --> ".concat(c.name," <--"),f="Expecting ".concat(u," but found --> '").concat(o.image,"' <--");return f},buildNotAllInputParsedMessage:function(h){var c=h.firstRedundant;return h.ruleName,"Redundant input, expecting EOF but found: "+c.image},buildNoViableAltMessage:function(h){var c=h.expectedPathsPerAlt,o=h.actual;h.previous;var l=h.customUserDescription;h.ruleName;var u="Expecting: ",f=(0,n.default)(o).image,m=`
but found: '`+f+"'";if(l)return u+l+m;var g=(0,i.default)(c,function(y,_){return y.concat(_)},[]),b=(0,a.default)(g,function(y){return"[".concat((0,a.default)(y,function(_){return(0,r.tokenLabel)(_)}).join(", "),"]")}),v=(0,a.default)(b,function(y,_){return"  ".concat(_+1,". ").concat(y)}),w=`one of these possible Token sequences:
`.concat(v.join(`
`));return u+w+m},buildEarlyExitMessage:function(h){var c=h.expectedIterationPaths,o=h.actual,l=h.customUserDescription;h.ruleName;var u="Expecting: ",f=(0,n.default)(o).image,m=`
but found: '`+f+"'";if(l)return u+l+m;var g=(0,a.default)(c,function(v){return"[".concat((0,a.default)(v,function(w){return(0,r.tokenLabel)(w)}).join(","),"]")}),b=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+"<".concat(g.join(" ,"),">");return u+b+m}},Object.freeze(e.defaultParserErrorProvider),e.defaultGrammarResolverErrorProvider={buildRuleNotFoundError:function(h,c){var o="Invalid grammar, reference to a rule which is not defined: ->"+c.nonTerminalName+`<-
inside top level rule: ->`+h.name+"<-";return o}},e.defaultGrammarValidatorErrorProvider={buildDuplicateFoundError:function(h,c){function o(w){return w instanceof s.Terminal?w.terminalType.name:w instanceof s.NonTerminal?w.nonTerminalName:""}var l=h.name,u=(0,n.default)(c),f=u.idx,m=(0,d.getProductionDslName)(u),g=o(u),b=f>0,v="->".concat(m).concat(b?f:"","<- ").concat(g?"with argument: ->".concat(g,"<-"):"",`
                  appears more than once (`).concat(c.length," times) in the top level rule: ->").concat(l,`<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `);return v=v.replace(/[ \t]+/g," "),v=v.replace(/\s\s+/g,`
`),v},buildNamespaceConflictError:function(h){var c=`Namespace conflict found in grammar.
`+"The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <".concat(h.name,`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return c},buildAlternationPrefixAmbiguityError:function(h){var c=(0,a.default)(h.prefixPath,function(u){return(0,r.tokenLabel)(u)}).join(", "),o=h.alternation.idx===0?"":h.alternation.idx,l="Ambiguous alternatives: <".concat(h.ambiguityIndices.join(" ,"),`> due to common lookahead prefix
`)+"in <OR".concat(o,"> inside <").concat(h.topLevelRule.name,`> Rule,
`)+"<".concat(c,`> may appears as a prefix path in all these alternatives.
`)+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return l},buildAlternationAmbiguityError:function(h){var c=(0,a.default)(h.prefixPath,function(u){return(0,r.tokenLabel)(u)}).join(", "),o=h.alternation.idx===0?"":h.alternation.idx,l="Ambiguous Alternatives Detected: <".concat(h.ambiguityIndices.join(" ,"),"> in <OR").concat(o,">")+" inside <".concat(h.topLevelRule.name,`> Rule,
`)+"<".concat(c,`> may appears as a prefix path in all these alternatives.
`);return l=l+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,l},buildEmptyRepetitionError:function(h){var c=(0,d.getProductionDslName)(h.repetition);h.repetition.idx!==0&&(c+=h.repetition.idx);var o="The repetition <".concat(c,"> within Rule <").concat(h.topLevelRule.name,`> can never consume any tokens.
`)+"This could lead to an infinite loop.";return o},buildTokenNameError:function(h){return"deprecated"},buildEmptyAlternationError:function(h){var c="Ambiguous empty alternative: <".concat(h.emptyChoiceIdx+1,">")+" in <OR".concat(h.alternation.idx,"> inside <").concat(h.topLevelRule.name,`> Rule.
`)+"Only the last alternative may be an empty alternative.";return c},buildTooManyAlternativesError:function(h){var c=`An Alternation cannot have more than 256 alternatives:
`+"<OR".concat(h.alternation.idx,"> inside <").concat(h.topLevelRule.name,`> Rule.
 has `).concat(h.alternation.definition.length+1," alternatives.");return c},buildLeftRecursionError:function(h){var c=h.topLevelRule.name,o=(0,a.default)(h.leftRecursionPath,function(f){return f.name}),l="".concat(c," --> ").concat(o.concat([c]).join(" --> ")),u=`Left Recursion found in grammar.
`+"rule: <".concat(c,`> can be invoked from itself (directly or indirectly)
`)+`without consuming any Tokens. The grammar path that causes this is: 
 `.concat(l,`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`;return u},buildInvalidRuleNameError:function(h){return"deprecated"},buildDuplicateRuleNameError:function(h){var c;h.topLevelRule instanceof s.Rule?c=h.topLevelRule.name:c=h.topLevelRule;var o="Duplicate definition, rule: ->".concat(c,"<- is already defined in the grammar: ->").concat(h.grammarName,"<-");return o}}})(Xi);var Ta={},Ra={},L$=Ae&&Ae.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),tv=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ra,"__esModule",{value:!0});Ra.GastRefResolverVisitor=Ra.resolveGrammar=void 0;var $$=ur,D$=tv(Yt),U$=tv(tn),F$=It;function B$(e,t){var r=new rv(e,t);return r.resolveRefs(),r.errors}Ra.resolveGrammar=B$;var rv=function(e){L$(t,e);function t(r,n){var a=e.call(this)||this;return a.nameToTopRule=r,a.errMsgProvider=n,a.errors=[],a}return t.prototype.resolveRefs=function(){var r=this;(0,D$.default)((0,U$.default)(this.nameToTopRule),function(n){r.currTopLevel=n,n.accept(r)})},t.prototype.visitNonTerminal=function(r){var n=this.nameToTopRule[r.nonTerminalName];if(n)r.referencedRule=n;else{var a=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,r);this.errors.push({message:a,type:$$.ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:r.nonTerminalName})}},t}(F$.GAstVisitor);Ra.GastRefResolverVisitor=rv;var ot={};function V$(e,t,r,n){for(var a=-1,i=e==null?0:e.length;++a<i;){var s=e[a];t(n,s,r(s),e)}return n}var z$=V$,G$=qn;function H$(e,t,r,n){return G$(e,function(a,i,s){t(n,a,r(a),s)}),n}var W$=H$,K$=z$,Y$=W$,q$=Vr,X$=lt;function j$(e,t){return function(r,n){var a=X$(r)?K$:Y$,i=t?t():{};return a(r,e,q$(n),i)}}var Q$=j$,Z$=au,J$=Q$,eD=Object.prototype,tD=eD.hasOwnProperty,rD=J$(function(e,t,r){tD.call(e,r)?e[r].push(t):Z$(e,r,[t])}),nv=rD,nD=fu,aD=nr;function iD(e,t){return nD(aD(e,t),1)}var oD=iD,ji={},Nt={},sD=ou,lD=Hi;function cD(e,t,r){var n=e==null?0:e.length;return n?(t=r||t===void 0?1:lD(t),t=n-t,sD(e,0,t<0?0:t)):[]}var _u=cD,Zn=Ae&&Ae.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Jn=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Nt,"__esModule",{value:!0});Nt.nextPossibleTokensAfter=Nt.possiblePathsFrom=Nt.NextTerminalAfterAtLeastOneSepWalker=Nt.NextTerminalAfterAtLeastOneWalker=Nt.NextTerminalAfterManySepWalker=Nt.NextTerminalAfterManyWalker=Nt.AbstractNextTerminalAfterProductionWalker=Nt.NextAfterTokenWalker=Nt.AbstractNextPossibleTokensWalker=void 0;var av=Va,Ts=Jn(Yi),Vo=Jn(Br),ch=Jn(_u),jt=Jn(su),uD=Jn(wu),dD=Jn(Yt),Gn=Jn(Nn),fD=Nr,qe=It,iv=function(e){Zn(t,e);function t(r,n){var a=e.call(this)||this;return a.topProd=r,a.path=n,a.possibleTokTypes=[],a.nextProductionName="",a.nextProductionOccurrence=0,a.found=!1,a.isAtEndOfPath=!1,a}return t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=(0,Gn.default)(this.path.ruleStack).reverse(),this.occurrenceStack=(0,Gn.default)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(r,n){n===void 0&&(n=[]),this.found||e.prototype.walk.call(this,r,n)},t.prototype.walkProdRef=function(r,n,a){if(r.referencedRule.name===this.nextProductionName&&r.idx===this.nextProductionOccurrence){var i=n.concat(a);this.updateExpectedNext(),this.walk(r.referencedRule,i)}},t.prototype.updateExpectedNext=function(){(0,Vo.default)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}(av.RestWalker);Nt.AbstractNextPossibleTokensWalker=iv;var hD=function(e){Zn(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.path=n,a.nextTerminalName="",a.nextTerminalOccurrence=0,a.nextTerminalName=a.path.lastTok.name,a.nextTerminalOccurrence=a.path.lastTokOccurrence,a}return t.prototype.walkTerminal=function(r,n,a){if(this.isAtEndOfPath&&r.terminalType.name===this.nextTerminalName&&r.idx===this.nextTerminalOccurrence&&!this.found){var i=n.concat(a),s=new qe.Alternative({definition:i});this.possibleTokTypes=(0,fD.first)(s),this.found=!0}},t}(iv);Nt.NextAfterTokenWalker=hD;var Qi=function(e){Zn(t,e);function t(r,n){var a=e.call(this)||this;return a.topRule=r,a.occurrence=n,a.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},a}return t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}(av.RestWalker);Nt.AbstractNextTerminalAfterProductionWalker=Qi;var pD=function(e){Zn(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.walkMany=function(r,n,a){if(r.idx===this.occurrence){var i=(0,Ts.default)(n.concat(a));this.result.isEndOfRule=i===void 0,i instanceof qe.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkMany.call(this,r,n,a)},t}(Qi);Nt.NextTerminalAfterManyWalker=pD;var gD=function(e){Zn(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.walkManySep=function(r,n,a){if(r.idx===this.occurrence){var i=(0,Ts.default)(n.concat(a));this.result.isEndOfRule=i===void 0,i instanceof qe.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkManySep.call(this,r,n,a)},t}(Qi);Nt.NextTerminalAfterManySepWalker=gD;var mD=function(e){Zn(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.walkAtLeastOne=function(r,n,a){if(r.idx===this.occurrence){var i=(0,Ts.default)(n.concat(a));this.result.isEndOfRule=i===void 0,i instanceof qe.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOne.call(this,r,n,a)},t}(Qi);Nt.NextTerminalAfterAtLeastOneWalker=mD;var vD=function(e){Zn(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.walkAtLeastOneSep=function(r,n,a){if(r.idx===this.occurrence){var i=(0,Ts.default)(n.concat(a));this.result.isEndOfRule=i===void 0,i instanceof qe.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOneSep.call(this,r,n,a)},t}(Qi);Nt.NextTerminalAfterAtLeastOneSepWalker=vD;function ov(e,t,r){r===void 0&&(r=[]),r=(0,Gn.default)(r);var n=[],a=0;function i(c){return c.concat((0,jt.default)(e,a+1))}function s(c){var o=ov(i(c),t,r);return n.concat(o)}for(;r.length<t&&a<e.length;){var d=e[a];if(d instanceof qe.Alternative)return s(d.definition);if(d instanceof qe.NonTerminal)return s(d.definition);if(d instanceof qe.Option)n=s(d.definition);else if(d instanceof qe.RepetitionMandatory){var h=d.definition.concat([new qe.Repetition({definition:d.definition})]);return s(h)}else if(d instanceof qe.RepetitionMandatoryWithSeparator){var h=[new qe.Alternative({definition:d.definition}),new qe.Repetition({definition:[new qe.Terminal({terminalType:d.separator})].concat(d.definition)})];return s(h)}else if(d instanceof qe.RepetitionWithSeparator){var h=d.definition.concat([new qe.Repetition({definition:[new qe.Terminal({terminalType:d.separator})].concat(d.definition)})]);n=s(h)}else if(d instanceof qe.Repetition){var h=d.definition.concat([new qe.Repetition({definition:d.definition})]);n=s(h)}else{if(d instanceof qe.Alternation)return(0,dD.default)(d.definition,function(c){(0,Vo.default)(c.definition)===!1&&(n=s(c.definition))}),n;if(d instanceof qe.Terminal)r.push(d.terminalType);else throw Error("non exhaustive match")}a++}return n.push({partialPath:r,suffixDef:(0,jt.default)(e,a)}),n}Nt.possiblePathsFrom=ov;function bD(e,t,r,n){var a="EXIT_NONE_TERMINAL",i=[a],s="EXIT_ALTERNATIVE",d=!1,h=t.length,c=h-n-1,o=[],l=[];for(l.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!(0,Vo.default)(l);){var u=l.pop();if(u===s){d&&(0,uD.default)(l).idx<=c&&l.pop();continue}var f=u.def,m=u.idx,g=u.ruleStack,b=u.occurrenceStack;if(!(0,Vo.default)(f)){var v=f[0];if(v===a){var w={idx:m,def:(0,jt.default)(f),ruleStack:(0,ch.default)(g),occurrenceStack:(0,ch.default)(b)};l.push(w)}else if(v instanceof qe.Terminal)if(m<h-1){var y=m+1,_=t[y];if(r(_,v.terminalType)){var w={idx:y,def:(0,jt.default)(f),ruleStack:g,occurrenceStack:b};l.push(w)}}else if(m===h-1)o.push({nextTokenType:v.terminalType,nextTokenOccurrence:v.idx,ruleStack:g,occurrenceStack:b}),d=!0;else throw Error("non exhaustive match");else if(v instanceof qe.NonTerminal){var T=(0,Gn.default)(g);T.push(v.nonTerminalName);var A=(0,Gn.default)(b);A.push(v.idx);var w={idx:m,def:v.definition.concat(i,(0,jt.default)(f)),ruleStack:T,occurrenceStack:A};l.push(w)}else if(v instanceof qe.Option){var x={idx:m,def:(0,jt.default)(f),ruleStack:g,occurrenceStack:b};l.push(x),l.push(s);var C={idx:m,def:v.definition.concat((0,jt.default)(f)),ruleStack:g,occurrenceStack:b};l.push(C)}else if(v instanceof qe.RepetitionMandatory){var N=new qe.Repetition({definition:v.definition,idx:v.idx}),P=v.definition.concat([N],(0,jt.default)(f)),w={idx:m,def:P,ruleStack:g,occurrenceStack:b};l.push(w)}else if(v instanceof qe.RepetitionMandatoryWithSeparator){var z=new qe.Terminal({terminalType:v.separator}),N=new qe.Repetition({definition:[z].concat(v.definition),idx:v.idx}),P=v.definition.concat([N],(0,jt.default)(f)),w={idx:m,def:P,ruleStack:g,occurrenceStack:b};l.push(w)}else if(v instanceof qe.RepetitionWithSeparator){var x={idx:m,def:(0,jt.default)(f),ruleStack:g,occurrenceStack:b};l.push(x),l.push(s);var z=new qe.Terminal({terminalType:v.separator}),K=new qe.Repetition({definition:[z].concat(v.definition),idx:v.idx}),P=v.definition.concat([K],(0,jt.default)(f)),C={idx:m,def:P,ruleStack:g,occurrenceStack:b};l.push(C)}else if(v instanceof qe.Repetition){var x={idx:m,def:(0,jt.default)(f),ruleStack:g,occurrenceStack:b};l.push(x),l.push(s);var K=new qe.Repetition({definition:v.definition,idx:v.idx}),P=v.definition.concat([K],(0,jt.default)(f)),C={idx:m,def:P,ruleStack:g,occurrenceStack:b};l.push(C)}else if(v instanceof qe.Alternation)for(var q=v.definition.length-1;q>=0;q--){var W=v.definition[q],ce={idx:m,def:W.definition.concat((0,jt.default)(f)),ruleStack:g,occurrenceStack:b};l.push(ce),l.push(s)}else if(v instanceof qe.Alternative)l.push({idx:m,def:v.definition.concat((0,jt.default)(f)),ruleStack:g,occurrenceStack:b});else if(v instanceof qe.Rule)l.push(yD(v,m,g,b));else throw Error("non exhaustive match")}}return o}Nt.nextPossibleTokensAfter=bD;function yD(e,t,r,n){var a=(0,Gn.default)(r);a.push(e.name);var i=(0,Gn.default)(n);return i.push(1),{idx:t,def:e.definition,ruleStack:a,occurrenceStack:i}}(function(e){var t=Ae&&Ae.__extends||function(){var V=function(G,j){return V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ie,fe){ie.__proto__=fe}||function(ie,fe){for(var ve in fe)Object.prototype.hasOwnProperty.call(fe,ve)&&(ie[ve]=fe[ve])},V(G,j)};return function(G,j){if(typeof j!="function"&&j!==null)throw new TypeError("Class extends value "+String(j)+" is not a constructor or null");V(G,j);function ie(){this.constructor=G}G.prototype=j===null?Object.create(j):(ie.prototype=j.prototype,new ie)}}(),r=Ae&&Ae.__importDefault||function(V){return V&&V.__esModule?V:{default:V}};Object.defineProperty(e,"__esModule",{value:!0}),e.areTokenCategoriesNotUsed=e.isStrictPrefixOfPath=e.containsPath=e.getLookaheadPathsForOptionalProd=e.getLookaheadPathsForOr=e.lookAheadSequenceFromAlternatives=e.buildSingleAlternativeLookaheadFunction=e.buildAlternativesLookAheadFunc=e.buildLookaheadFuncForOptionalProd=e.buildLookaheadFuncForOr=e.getProdType=e.PROD_TYPE=void 0;var n=r(Br),a=r(an),i=r(Ns),s=r(nr),d=r(Yt),h=r(vr),c=r(jn),o=Nt,l=Va,u=Qn,f=It,m=It,g;(function(V){V[V.OPTION=0]="OPTION",V[V.REPETITION=1]="REPETITION",V[V.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",V[V.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",V[V.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",V[V.ALTERNATION=5]="ALTERNATION"})(g=e.PROD_TYPE||(e.PROD_TYPE={}));function b(V){if(V instanceof f.Option)return g.OPTION;if(V instanceof f.Repetition)return g.REPETITION;if(V instanceof f.RepetitionMandatory)return g.REPETITION_MANDATORY;if(V instanceof f.RepetitionMandatoryWithSeparator)return g.REPETITION_MANDATORY_WITH_SEPARATOR;if(V instanceof f.RepetitionWithSeparator)return g.REPETITION_WITH_SEPARATOR;if(V instanceof f.Alternation)return g.ALTERNATION;throw Error("non exhaustive match")}e.getProdType=b;function v(V,G,j,ie,fe,ve){var xe=z(V,G,j),Te=ce(xe)?u.tokenStructuredMatcherNoCategories:u.tokenStructuredMatcher;return ve(xe,ie,Te,fe)}e.buildLookaheadFuncForOr=v;function w(V,G,j,ie,fe,ve){var xe=K(V,G,fe,j),Te=ce(xe)?u.tokenStructuredMatcherNoCategories:u.tokenStructuredMatcher;return ve(xe[0],Te,ie)}e.buildLookaheadFuncForOptionalProd=w;function y(V,G,j,ie){var fe=V.length,ve=(0,i.default)(V,function(Me){return(0,i.default)(Me,function(J){return J.length===1})});if(G)return function(Me){for(var J=(0,s.default)(Me,function(H){return H.GATE}),S=0;S<fe;S++){var I=V[S],U=I.length,me=J[S];if(me!==void 0&&me.call(this)===!1)continue;e:for(var Y=0;Y<U;Y++){for(var be=I[Y],X=be.length,k=0;k<X;k++){var B=this.LA(k+1);if(j(B,be[k])===!1)continue e}return S}}};if(ve&&!ie){var xe=(0,s.default)(V,function(Me){return(0,a.default)(Me)}),Te=(0,c.default)(xe,function(Me,J,S){return(0,d.default)(J,function(I){(0,h.default)(Me,I.tokenTypeIdx)||(Me[I.tokenTypeIdx]=S),(0,d.default)(I.categoryMatches,function(U){(0,h.default)(Me,U)||(Me[U]=S)})}),Me},{});return function(){var Me=this.LA(1);return Te[Me.tokenTypeIdx]}}else return function(){for(var Me=0;Me<fe;Me++){var J=V[Me],S=J.length;e:for(var I=0;I<S;I++){for(var U=J[I],me=U.length,Y=0;Y<me;Y++){var be=this.LA(Y+1);if(j(be,U[Y])===!1)continue e}return Me}}}}e.buildAlternativesLookAheadFunc=y;function _(V,G,j){var ie=(0,i.default)(V,function(J){return J.length===1}),fe=V.length;if(ie&&!j){var ve=(0,a.default)(V);if(ve.length===1&&(0,n.default)(ve[0].categoryMatches)){var xe=ve[0],Te=xe.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===Te}}else{var Me=(0,c.default)(ve,function(J,S,I){return J[S.tokenTypeIdx]=!0,(0,d.default)(S.categoryMatches,function(U){J[U]=!0}),J},[]);return function(){var J=this.LA(1);return Me[J.tokenTypeIdx]===!0}}}else return function(){e:for(var J=0;J<fe;J++){for(var S=V[J],I=S.length,U=0;U<I;U++){var me=this.LA(U+1);if(G(me,S[U])===!1)continue e}return!0}return!1}}e.buildSingleAlternativeLookaheadFunction=_;var T=function(V){t(G,V);function G(j,ie,fe){var ve=V.call(this)||this;return ve.topProd=j,ve.targetOccurrence=ie,ve.targetProdType=fe,ve}return G.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},G.prototype.checkIsTarget=function(j,ie,fe,ve){return j.idx===this.targetOccurrence&&this.targetProdType===ie?(this.restDef=fe.concat(ve),!0):!1},G.prototype.walkOption=function(j,ie,fe){this.checkIsTarget(j,g.OPTION,ie,fe)||V.prototype.walkOption.call(this,j,ie,fe)},G.prototype.walkAtLeastOne=function(j,ie,fe){this.checkIsTarget(j,g.REPETITION_MANDATORY,ie,fe)||V.prototype.walkOption.call(this,j,ie,fe)},G.prototype.walkAtLeastOneSep=function(j,ie,fe){this.checkIsTarget(j,g.REPETITION_MANDATORY_WITH_SEPARATOR,ie,fe)||V.prototype.walkOption.call(this,j,ie,fe)},G.prototype.walkMany=function(j,ie,fe){this.checkIsTarget(j,g.REPETITION,ie,fe)||V.prototype.walkOption.call(this,j,ie,fe)},G.prototype.walkManySep=function(j,ie,fe){this.checkIsTarget(j,g.REPETITION_WITH_SEPARATOR,ie,fe)||V.prototype.walkOption.call(this,j,ie,fe)},G}(l.RestWalker),A=function(V){t(G,V);function G(j,ie,fe){var ve=V.call(this)||this;return ve.targetOccurrence=j,ve.targetProdType=ie,ve.targetRef=fe,ve.result=[],ve}return G.prototype.checkIsTarget=function(j,ie){j.idx===this.targetOccurrence&&this.targetProdType===ie&&(this.targetRef===void 0||j===this.targetRef)&&(this.result=j.definition)},G.prototype.visitOption=function(j){this.checkIsTarget(j,g.OPTION)},G.prototype.visitRepetition=function(j){this.checkIsTarget(j,g.REPETITION)},G.prototype.visitRepetitionMandatory=function(j){this.checkIsTarget(j,g.REPETITION_MANDATORY)},G.prototype.visitRepetitionMandatoryWithSeparator=function(j){this.checkIsTarget(j,g.REPETITION_MANDATORY_WITH_SEPARATOR)},G.prototype.visitRepetitionWithSeparator=function(j){this.checkIsTarget(j,g.REPETITION_WITH_SEPARATOR)},G.prototype.visitAlternation=function(j){this.checkIsTarget(j,g.ALTERNATION)},G}(m.GAstVisitor);function x(V){for(var G=new Array(V),j=0;j<V;j++)G[j]=[];return G}function C(V){for(var G=[""],j=0;j<V.length;j++){for(var ie=V[j],fe=[],ve=0;ve<G.length;ve++){var xe=G[ve];fe.push(xe+"_"+ie.tokenTypeIdx);for(var Te=0;Te<ie.categoryMatches.length;Te++){var Me="_"+ie.categoryMatches[Te];fe.push(xe+Me)}}G=fe}return G}function N(V,G,j){for(var ie=0;ie<V.length;ie++)if(ie!==j)for(var fe=V[ie],ve=0;ve<G.length;ve++){var xe=G[ve];if(fe[xe]===!0)return!1}return!0}function P(V,G){for(var j=(0,s.default)(V,function(S){return(0,o.possiblePathsFrom)([S],1)}),ie=x(j.length),fe=(0,s.default)(j,function(S){var I={};return(0,d.default)(S,function(U){var me=C(U.partialPath);(0,d.default)(me,function(Y){I[Y]=!0})}),I}),ve=j,xe=1;xe<=G;xe++){var Te=ve;ve=x(Te.length);for(var Me=function(S){for(var I=Te[S],U=0;U<I.length;U++){var me=I[U].partialPath,Y=I[U].suffixDef,be=C(me),X=N(fe,be,S);if(X||(0,n.default)(Y)||me.length===G){var k=ie[S];if(q(k,me)===!1){k.push(me);for(var B=0;B<be.length;B++){var H=be[B];fe[S][H]=!0}}}else{var re=(0,o.possiblePathsFrom)(Y,xe+1,me);ve[S]=ve[S].concat(re),(0,d.default)(re,function(ne){var p=C(ne.partialPath);(0,d.default)(p,function(ye){fe[S][ye]=!0})})}}},J=0;J<Te.length;J++)Me(J)}return ie}e.lookAheadSequenceFromAlternatives=P;function z(V,G,j,ie){var fe=new A(V,g.ALTERNATION,ie);return G.accept(fe),P(fe.result,j)}e.getLookaheadPathsForOr=z;function K(V,G,j,ie){var fe=new A(V,j);G.accept(fe);var ve=fe.result,xe=new T(G,V,j),Te=xe.startWalking(),Me=new f.Alternative({definition:ve}),J=new f.Alternative({definition:Te});return P([Me,J],ie)}e.getLookaheadPathsForOptionalProd=K;function q(V,G){e:for(var j=0;j<V.length;j++){var ie=V[j];if(ie.length===G.length){for(var fe=0;fe<ie.length;fe++){var ve=G[fe],xe=ie[fe],Te=ve===xe||xe.categoryMatchesMap[ve.tokenTypeIdx]!==void 0;if(Te===!1)continue e}return!0}}return!1}e.containsPath=q;function W(V,G){return V.length<G.length&&(0,i.default)(V,function(j,ie){var fe=G[ie];return j===fe||fe.categoryMatchesMap[j.tokenTypeIdx]})}e.isStrictPrefixOfPath=W;function ce(V){return(0,i.default)(V,function(G){return(0,i.default)(G,function(j){return(0,i.default)(j,function(ie){return(0,n.default)(ie.categoryMatches)})})})}e.areTokenCategoriesNotUsed=ce})(ji);var Nu=Ae&&Ae.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Bt=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ot,"__esModule",{value:!0});ot.checkPrefixAlternativesAmbiguities=ot.validateSomeNonEmptyLookaheadPath=ot.validateTooManyAlts=ot.RepetitionCollector=ot.validateAmbiguousAlternationAlternatives=ot.validateEmptyOrAlternative=ot.getFirstNoneTerminal=ot.validateNoLeftRecursion=ot.validateRuleIsOverridden=ot.validateRuleDoesNotAlreadyExist=ot.OccurrenceValidationCollector=ot.identifyProductionForDuplicates=ot.validateGrammar=void 0;var sv=Bt(Yi),Zi=Bt(Br),ED=Bt(su),lv=Bt(an),wD=Bt(Eu),_D=Bt(vu),ND=Bt(bu),Hn=Bt(nr),Ai=Bt(Yt),AD=Bt(nv),Au=Bt(jn),CD=Bt(Tm),xD=Bt(tn),Cu=Bt(nn),hr=Bt(oD),TD=Bt(Nn),Wr=ur,xu=It,Oa=ji,RD=Nt,yr=It,Tu=It,OD=Bt(_u),kD=Bt(xs),ID=Qn;function MD(e,t,r,n,a){var i=(0,hr.default)(e,function(f){return PD(f,n)}),s=(0,hr.default)(e,function(f){return Ru(f,f,n)}),d=[],h=[],c=[];(0,Zi.default)(s)&&(d=(0,hr.default)(e,function(f){return hv(f,n)}),h=(0,hr.default)(e,function(f){return pv(f,t,n)}),c=vv(e,t,n));var o=$D(e,r,n),l=(0,hr.default)(e,function(f){return mv(f,n)}),u=(0,hr.default)(e,function(f){return fv(f,e,a,n)});return i.concat(c,s,d,h,o,l,u)}ot.validateGrammar=MD;function PD(e,t){var r=new dv;e.accept(r);var n=r.allProductions,a=(0,AD.default)(n,cv),i=(0,CD.default)(a,function(d){return d.length>1}),s=(0,Hn.default)((0,xD.default)(i),function(d){var h=(0,sv.default)(d),c=t.buildDuplicateFoundError(e,d),o=(0,xu.getProductionDslName)(h),l={message:c,type:Wr.ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:o,occurrence:h.idx},u=uv(h);return u&&(l.parameter=u),l});return s}function cv(e){return"".concat((0,xu.getProductionDslName)(e),"_#_").concat(e.idx,"_#_").concat(uv(e))}ot.identifyProductionForDuplicates=cv;function uv(e){return e instanceof yr.Terminal?e.terminalType.name:e instanceof yr.NonTerminal?e.nonTerminalName:""}var dv=function(e){Nu(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.allProductions=[],r}return t.prototype.visitNonTerminal=function(r){this.allProductions.push(r)},t.prototype.visitOption=function(r){this.allProductions.push(r)},t.prototype.visitRepetitionWithSeparator=function(r){this.allProductions.push(r)},t.prototype.visitRepetitionMandatory=function(r){this.allProductions.push(r)},t.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.allProductions.push(r)},t.prototype.visitRepetition=function(r){this.allProductions.push(r)},t.prototype.visitAlternation=function(r){this.allProductions.push(r)},t.prototype.visitTerminal=function(r){this.allProductions.push(r)},t}(Tu.GAstVisitor);ot.OccurrenceValidationCollector=dv;function fv(e,t,r,n){var a=[],i=(0,Au.default)(t,function(d,h){return h.name===e.name?d+1:d},0);if(i>1){var s=n.buildDuplicateRuleNameError({topLevelRule:e,grammarName:r});a.push({message:s,type:Wr.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e.name})}return a}ot.validateRuleDoesNotAlreadyExist=fv;function SD(e,t,r){var n=[],a;return(0,Cu.default)(t,e)||(a="Invalid rule override, rule: ->".concat(e,"<- cannot be overridden in the grammar: ->").concat(r,"<-")+"as it is not defined in any of the super grammars ",n.push({message:a,type:Wr.ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:e})),n}ot.validateRuleIsOverridden=SD;function Ru(e,t,r,n){n===void 0&&(n=[]);var a=[],i=gi(t.definition);if((0,Zi.default)(i))return[];var s=e.name,d=(0,Cu.default)(i,e);d&&a.push({message:r.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:n}),type:Wr.ParserDefinitionErrorType.LEFT_RECURSION,ruleName:s});var h=(0,ND.default)(i,n.concat([e])),c=(0,hr.default)(h,function(o){var l=(0,TD.default)(n);return l.push(o),Ru(e,o,r,l)});return a.concat(c)}ot.validateNoLeftRecursion=Ru;function gi(e){var t=[];if((0,Zi.default)(e))return t;var r=(0,sv.default)(e);if(r instanceof yr.NonTerminal)t.push(r.referencedRule);else if(r instanceof yr.Alternative||r instanceof yr.Option||r instanceof yr.RepetitionMandatory||r instanceof yr.RepetitionMandatoryWithSeparator||r instanceof yr.RepetitionWithSeparator||r instanceof yr.Repetition)t=t.concat(gi(r.definition));else if(r instanceof yr.Alternation)t=(0,lv.default)((0,Hn.default)(r.definition,function(s){return gi(s.definition)}));else if(!(r instanceof yr.Terminal))throw Error("non exhaustive match");var n=(0,xu.isOptionalProd)(r),a=e.length>1;if(n&&a){var i=(0,ED.default)(e);return t.concat(gi(i))}else return t}ot.getFirstNoneTerminal=gi;var Ou=function(e){Nu(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.alternations=[],r}return t.prototype.visitAlternation=function(r){this.alternations.push(r)},t}(Tu.GAstVisitor);function hv(e,t){var r=new Ou;e.accept(r);var n=r.alternations,a=(0,hr.default)(n,function(i){var s=(0,OD.default)(i.definition);return(0,hr.default)(s,function(d,h){var c=(0,RD.nextPossibleTokensAfter)([d],[],ID.tokenStructuredMatcher,1);return(0,Zi.default)(c)?[{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:i,emptyChoiceIdx:h}),type:Wr.ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:i.idx,alternative:h+1}]:[]})});return a}ot.validateEmptyOrAlternative=hv;function pv(e,t,r){var n=new Ou;e.accept(n);var a=n.alternations;a=(0,_D.default)(a,function(s){return s.ignoreAmbiguities===!0});var i=(0,hr.default)(a,function(s){var d=s.idx,h=s.maxLookahead||t,c=(0,Oa.getLookaheadPathsForOr)(d,e,h,s),o=LD(c,s,e,r),l=bv(c,s,e,r);return o.concat(l)});return i}ot.validateAmbiguousAlternationAlternatives=pv;var gv=function(e){Nu(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.allProductions=[],r}return t.prototype.visitRepetitionWithSeparator=function(r){this.allProductions.push(r)},t.prototype.visitRepetitionMandatory=function(r){this.allProductions.push(r)},t.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.allProductions.push(r)},t.prototype.visitRepetition=function(r){this.allProductions.push(r)},t}(Tu.GAstVisitor);ot.RepetitionCollector=gv;function mv(e,t){var r=new Ou;e.accept(r);var n=r.alternations,a=(0,hr.default)(n,function(i){return i.definition.length>255?[{message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:i}),type:Wr.ParserDefinitionErrorType.TOO_MANY_ALTS,ruleName:e.name,occurrence:i.idx}]:[]});return a}ot.validateTooManyAlts=mv;function vv(e,t,r){var n=[];return(0,Ai.default)(e,function(a){var i=new gv;a.accept(i);var s=i.allProductions;(0,Ai.default)(s,function(d){var h=(0,Oa.getProdType)(d),c=d.maxLookahead||t,o=d.idx,l=(0,Oa.getLookaheadPathsForOptionalProd)(o,a,h,c),u=l[0];if((0,Zi.default)((0,lv.default)(u))){var f=r.buildEmptyRepetitionError({topLevelRule:a,repetition:d});n.push({message:f,type:Wr.ParserDefinitionErrorType.NO_NON_EMPTY_LOOKAHEAD,ruleName:a.name})}})}),n}ot.validateSomeNonEmptyLookaheadPath=vv;function LD(e,t,r,n){var a=[],i=(0,Au.default)(e,function(d,h,c){return t.definition[c].ignoreAmbiguities===!0||(0,Ai.default)(h,function(o){var l=[c];(0,Ai.default)(e,function(u,f){c!==f&&(0,Oa.containsPath)(u,o)&&t.definition[f].ignoreAmbiguities!==!0&&l.push(f)}),l.length>1&&!(0,Oa.containsPath)(a,o)&&(a.push(o),d.push({alts:l,path:o}))}),d},[]),s=(0,Hn.default)(i,function(d){var h=(0,Hn.default)(d.alts,function(o){return o+1}),c=n.buildAlternationAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:h,prefixPath:d.path});return{message:c,type:Wr.ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:t.idx,alternatives:d.alts}});return s}function bv(e,t,r,n){var a=(0,Au.default)(e,function(s,d,h){var c=(0,Hn.default)(d,function(o){return{idx:h,path:o}});return s.concat(c)},[]),i=(0,kD.default)((0,hr.default)(a,function(s){var d=t.definition[s.idx];if(d.ignoreAmbiguities===!0)return[];var h=s.idx,c=s.path,o=(0,wD.default)(a,function(u){return t.definition[u.idx].ignoreAmbiguities!==!0&&u.idx<h&&(0,Oa.isStrictPrefixOfPath)(u.path,c)}),l=(0,Hn.default)(o,function(u){var f=[u.idx+1,h+1],m=t.idx===0?"":t.idx,g=n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:f,prefixPath:u.path});return{message:g,type:Wr.ParserDefinitionErrorType.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:m,alternatives:f}});return l}));return i}ot.checkPrefixAlternativesAmbiguities=bv;function $D(e,t,r){var n=[],a=(0,Hn.default)(t,function(i){return i.name});return(0,Ai.default)(e,function(i){var s=i.name;if((0,Cu.default)(a,s)){var d=r.buildNamespaceConflictError(i);n.push({message:d,type:Wr.ParserDefinitionErrorType.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:s})}}),n}var yv=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ta,"__esModule",{value:!0});Ta.validateGrammar=Ta.resolveGrammar=void 0;var DD=yv(Yt),Ev=yv(Jm),UD=Ra,FD=ot,wv=Xi;function BD(e){var t=(0,Ev.default)(e,{errMsgProvider:wv.defaultGrammarResolverErrorProvider}),r={};return(0,DD.default)(e.rules,function(n){r[n.name]=n}),(0,UD.resolveGrammar)(r,t.errMsgProvider)}Ta.resolveGrammar=BD;function VD(e){return e=(0,Ev.default)(e,{errMsgProvider:wv.defaultGrammarValidatorErrorProvider}),(0,FD.validateGrammar)(e.rules,e.maxLookahead,e.tokenTypes,e.errMsgProvider,e.grammarName)}Ta.validateGrammar=VD;var ku={},Wt={},Ji=Ae&&Ae.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),zD=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Wt,"__esModule",{value:!0});Wt.EarlyExitException=Wt.NotAllInputParsedException=Wt.NoViableAltException=Wt.MismatchedTokenException=Wt.isRecognitionException=void 0;var GD=zD(nn),_v="MismatchedTokenException",Nv="NoViableAltException",Av="EarlyExitException",Cv="NotAllInputParsedException",xv=[_v,Nv,Av,Cv];Object.freeze(xv);function HD(e){return(0,GD.default)(xv,e.name)}Wt.isRecognitionException=HD;var Rs=function(e){Ji(t,e);function t(r,n){var a=this.constructor,i=e.call(this,r)||this;return i.token=n,i.resyncedTokens=[],Object.setPrototypeOf(i,a.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,i.constructor),i}return t}(Error),WD=function(e){Ji(t,e);function t(r,n,a){var i=e.call(this,r,n)||this;return i.previousToken=a,i.name=_v,i}return t}(Rs);Wt.MismatchedTokenException=WD;var KD=function(e){Ji(t,e);function t(r,n,a){var i=e.call(this,r,n)||this;return i.previousToken=a,i.name=Nv,i}return t}(Rs);Wt.NoViableAltException=KD;var YD=function(e){Ji(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.name=Cv,a}return t}(Rs);Wt.NotAllInputParsedException=YD;var qD=function(e){Ji(t,e);function t(r,n,a){var i=e.call(this,r,n)||this;return i.previousToken=a,i.name=Av,i}return t}(Rs);Wt.EarlyExitException=qD;(function(e){var t=Ae&&Ae.__extends||function(){var w=function(y,_){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,A){T.__proto__=A}||function(T,A){for(var x in A)Object.prototype.hasOwnProperty.call(A,x)&&(T[x]=A[x])},w(y,_)};return function(y,_){if(typeof _!="function"&&_!==null)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");w(y,_);function T(){this.constructor=y}y.prototype=_===null?Object.create(_):(T.prototype=_.prototype,new T)}}(),r=Ae&&Ae.__importDefault||function(w){return w&&w.__esModule?w:{default:w}};Object.defineProperty(e,"__esModule",{value:!0}),e.attemptInRepetitionRecovery=e.Recoverable=e.InRuleRecoveryException=e.IN_RULE_RECOVERY_EXCEPTION=e.EOF_FOLLOW_KEY=void 0;var n=Xn,a=r(Br),i=r(_u),s=r(an),d=r(nr),h=r(yu),c=r(vr),o=r(nn),l=r(Nn),u=Wt,f=Wi,m=ur;e.EOF_FOLLOW_KEY={},e.IN_RULE_RECOVERY_EXCEPTION="InRuleRecoveryException";var g=function(w){t(y,w);function y(_){var T=w.call(this,_)||this;return T.name=e.IN_RULE_RECOVERY_EXCEPTION,T}return y}(Error);e.InRuleRecoveryException=g;var b=function(){function w(){}return w.prototype.initRecoverable=function(y){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=(0,c.default)(y,"recoveryEnabled")?y.recoveryEnabled:m.DEFAULT_PARSER_CONFIG.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=v)},w.prototype.getTokenToInsert=function(y){var _=(0,n.createTokenInstance)(y,"",NaN,NaN,NaN,NaN,NaN,NaN);return _.isInsertedInRecovery=!0,_},w.prototype.canTokenTypeBeInsertedInRecovery=function(y){return!0},w.prototype.canTokenTypeBeDeletedInRecovery=function(y){return!0},w.prototype.tryInRepetitionRecovery=function(y,_,T,A){for(var x=this,C=this.findReSyncTokenType(),N=this.exportLexerState(),P=[],z=!1,K=this.LA(1),q=this.LA(1),W=function(){var ce=x.LA(0),V=x.errorMessageProvider.buildMismatchTokenMessage({expected:A,actual:K,previous:ce,ruleName:x.getCurrRuleFullName()}),G=new u.MismatchedTokenException(V,K,x.LA(0));G.resyncedTokens=(0,i.default)(P),x.SAVE_ERROR(G)};!z;)if(this.tokenMatcher(q,A)){W();return}else if(T.call(this)){W(),y.apply(this,_);return}else this.tokenMatcher(q,C)?z=!0:(q=this.SKIP_TOKEN(),this.addToResyncTokens(q,P));this.importLexerState(N)},w.prototype.shouldInRepetitionRecoveryBeTried=function(y,_,T){return!(T===!1||this.tokenMatcher(this.LA(1),y)||this.isBackTracking()||this.canPerformInRuleRecovery(y,this.getFollowsForInRuleRecovery(y,_)))},w.prototype.getFollowsForInRuleRecovery=function(y,_){var T=this.getCurrentGrammarPath(y,_),A=this.getNextPossibleTokenTypes(T);return A},w.prototype.tryInRuleRecovery=function(y,_){if(this.canRecoverWithSingleTokenInsertion(y,_)){var T=this.getTokenToInsert(y);return T}if(this.canRecoverWithSingleTokenDeletion(y)){var A=this.SKIP_TOKEN();return this.consumeToken(),A}throw new g("sad sad panda")},w.prototype.canPerformInRuleRecovery=function(y,_){return this.canRecoverWithSingleTokenInsertion(y,_)||this.canRecoverWithSingleTokenDeletion(y)},w.prototype.canRecoverWithSingleTokenInsertion=function(y,_){var T=this;if(!this.canTokenTypeBeInsertedInRecovery(y)||(0,a.default)(_))return!1;var A=this.LA(1),x=(0,h.default)(_,function(C){return T.tokenMatcher(A,C)})!==void 0;return x},w.prototype.canRecoverWithSingleTokenDeletion=function(y){if(!this.canTokenTypeBeDeletedInRecovery(y))return!1;var _=this.tokenMatcher(this.LA(2),y);return _},w.prototype.isInCurrentRuleReSyncSet=function(y){var _=this.getCurrFollowKey(),T=this.getFollowSetFromFollowKey(_);return(0,o.default)(T,y)},w.prototype.findReSyncTokenType=function(){for(var y=this.flattenFollowSet(),_=this.LA(1),T=2;;){var A=(0,h.default)(y,function(x){var C=(0,n.tokenMatcher)(_,x);return C});if(A!==void 0)return A;_=this.LA(T),T++}},w.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return e.EOF_FOLLOW_KEY;var y=this.getLastExplicitRuleShortName(),_=this.getLastExplicitRuleOccurrenceIndex(),T=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(y),idxInCallingRule:_,inRule:this.shortRuleNameToFullName(T)}},w.prototype.buildFullFollowKeyStack=function(){var y=this,_=this.RULE_STACK,T=this.RULE_OCCURRENCE_STACK;return(0,d.default)(_,function(A,x){return x===0?e.EOF_FOLLOW_KEY:{ruleName:y.shortRuleNameToFullName(A),idxInCallingRule:T[x],inRule:y.shortRuleNameToFullName(_[x-1])}})},w.prototype.flattenFollowSet=function(){var y=this,_=(0,d.default)(this.buildFullFollowKeyStack(),function(T){return y.getFollowSetFromFollowKey(T)});return(0,s.default)(_)},w.prototype.getFollowSetFromFollowKey=function(y){if(y===e.EOF_FOLLOW_KEY)return[n.EOF];var _=y.ruleName+y.idxInCallingRule+f.IN+y.inRule;return this.resyncFollows[_]},w.prototype.addToResyncTokens=function(y,_){return this.tokenMatcher(y,n.EOF)||_.push(y),_},w.prototype.reSyncTo=function(y){for(var _=[],T=this.LA(1);this.tokenMatcher(T,y)===!1;)T=this.SKIP_TOKEN(),this.addToResyncTokens(T,_);return(0,i.default)(_)},w.prototype.attemptInRepetitionRecovery=function(y,_,T,A,x,C,N){},w.prototype.getCurrentGrammarPath=function(y,_){var T=this.getHumanReadableRuleStack(),A=(0,l.default)(this.RULE_OCCURRENCE_STACK),x={ruleStack:T,occurrenceStack:A,lastTok:y,lastTokOccurrence:_};return x},w.prototype.getHumanReadableRuleStack=function(){var y=this;return(0,d.default)(this.RULE_STACK,function(_){return y.shortRuleNameToFullName(_)})},w}();e.Recoverable=b;function v(w,y,_,T,A,x,C){var N=this.getKeyForAutomaticLookahead(T,A),P=this.firstAfterRepMap[N];if(P===void 0){var z=this.getCurrRuleFullName(),K=this.getGAstProductions()[z],q=new x(K,A);P=q.startWalking(),this.firstAfterRepMap[N]=P}var W=P.token,ce=P.occurrence,V=P.isEndOfRule;this.RULE_STACK.length===1&&V&&W===void 0&&(W=n.EOF,ce=1),!(W===void 0||ce===void 0)&&this.shouldInRepetitionRecoveryBeTried(W,ce,C)&&this.tryInRepetitionRecovery(w,y,_,W)}e.attemptInRepetitionRecovery=v})(ku);var ka={},Os={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getKeyForAutomaticLookahead=e.AT_LEAST_ONE_SEP_IDX=e.MANY_SEP_IDX=e.AT_LEAST_ONE_IDX=e.MANY_IDX=e.OPTION_IDX=e.OR_IDX=e.BITS_FOR_ALT_IDX=e.BITS_FOR_RULE_IDX=e.BITS_FOR_OCCURRENCE_IDX=e.BITS_FOR_METHOD_TYPE=void 0,e.BITS_FOR_METHOD_TYPE=4,e.BITS_FOR_OCCURRENCE_IDX=8,e.BITS_FOR_RULE_IDX=12,e.BITS_FOR_ALT_IDX=8,e.OR_IDX=1<<e.BITS_FOR_OCCURRENCE_IDX,e.OPTION_IDX=2<<e.BITS_FOR_OCCURRENCE_IDX,e.MANY_IDX=3<<e.BITS_FOR_OCCURRENCE_IDX,e.AT_LEAST_ONE_IDX=4<<e.BITS_FOR_OCCURRENCE_IDX,e.MANY_SEP_IDX=5<<e.BITS_FOR_OCCURRENCE_IDX,e.AT_LEAST_ONE_SEP_IDX=6<<e.BITS_FOR_OCCURRENCE_IDX;function t(r,n,a){return a|n|r}e.getKeyForAutomaticLookahead=t,32-e.BITS_FOR_ALT_IDX})(Os);var XD=Ae&&Ae.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Tv=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ka,"__esModule",{value:!0});ka.collectMethods=ka.LooksAhead=void 0;var qr=ji,On=Tv(Yt),uh=Tv(vr),dh=ur,Xr=Os,jD=It,na=It,QD=function(){function e(){}return e.prototype.initLooksAhead=function(t){this.dynamicTokensEnabled=(0,uh.default)(t,"dynamicTokensEnabled")?t.dynamicTokensEnabled:dh.DEFAULT_PARSER_CONFIG.dynamicTokensEnabled,this.maxLookahead=(0,uh.default)(t,"maxLookahead")?t.maxLookahead:dh.DEFAULT_PARSER_CONFIG.maxLookahead,this.lookAheadFuncsCache=new Map},e.prototype.preComputeLookaheadFunctions=function(t){var r=this;(0,On.default)(t,function(n){r.TRACE_INIT("".concat(n.name," Rule Lookahead"),function(){var a=Rv(n),i=a.alternation,s=a.repetition,d=a.option,h=a.repetitionMandatory,c=a.repetitionMandatoryWithSeparator,o=a.repetitionWithSeparator;(0,On.default)(i,function(l){var u=l.idx===0?"":l.idx;r.TRACE_INIT("".concat((0,na.getProductionDslName)(l)).concat(u),function(){var f=(0,qr.buildLookaheadFuncForOr)(l.idx,n,l.maxLookahead||r.maxLookahead,l.hasPredicates,r.dynamicTokensEnabled,r.lookAheadBuilderForAlternatives),m=(0,Xr.getKeyForAutomaticLookahead)(r.fullRuleNameToShort[n.name],Xr.OR_IDX,l.idx);r.setLaFuncCache(m,f)})}),(0,On.default)(s,function(l){r.computeLookaheadFunc(n,l.idx,Xr.MANY_IDX,qr.PROD_TYPE.REPETITION,l.maxLookahead,(0,na.getProductionDslName)(l))}),(0,On.default)(d,function(l){r.computeLookaheadFunc(n,l.idx,Xr.OPTION_IDX,qr.PROD_TYPE.OPTION,l.maxLookahead,(0,na.getProductionDslName)(l))}),(0,On.default)(h,function(l){r.computeLookaheadFunc(n,l.idx,Xr.AT_LEAST_ONE_IDX,qr.PROD_TYPE.REPETITION_MANDATORY,l.maxLookahead,(0,na.getProductionDslName)(l))}),(0,On.default)(c,function(l){r.computeLookaheadFunc(n,l.idx,Xr.AT_LEAST_ONE_SEP_IDX,qr.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,l.maxLookahead,(0,na.getProductionDslName)(l))}),(0,On.default)(o,function(l){r.computeLookaheadFunc(n,l.idx,Xr.MANY_SEP_IDX,qr.PROD_TYPE.REPETITION_WITH_SEPARATOR,l.maxLookahead,(0,na.getProductionDslName)(l))})})})},e.prototype.computeLookaheadFunc=function(t,r,n,a,i,s){var d=this;this.TRACE_INIT("".concat(s).concat(r===0?"":r),function(){var h=(0,qr.buildLookaheadFuncForOptionalProd)(r,t,i||d.maxLookahead,d.dynamicTokensEnabled,a,d.lookAheadBuilderForOptional),c=(0,Xr.getKeyForAutomaticLookahead)(d.fullRuleNameToShort[t.name],n,r);d.setLaFuncCache(c,h)})},e.prototype.lookAheadBuilderForOptional=function(t,r,n){return(0,qr.buildSingleAlternativeLookaheadFunction)(t,r,n)},e.prototype.lookAheadBuilderForAlternatives=function(t,r,n,a){return(0,qr.buildAlternativesLookAheadFunc)(t,r,n,a)},e.prototype.getKeyForAutomaticLookahead=function(t,r){var n=this.getLastExplicitRuleShortName();return(0,Xr.getKeyForAutomaticLookahead)(n,t,r)},e.prototype.getLaFuncFromCache=function(t){return this.lookAheadFuncsCache.get(t)},e.prototype.setLaFuncCache=function(t,r){this.lookAheadFuncsCache.set(t,r)},e}();ka.LooksAhead=QD;var ZD=function(e){XD(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},r}return t.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},t.prototype.visitOption=function(r){this.dslMethods.option.push(r)},t.prototype.visitRepetitionWithSeparator=function(r){this.dslMethods.repetitionWithSeparator.push(r)},t.prototype.visitRepetitionMandatory=function(r){this.dslMethods.repetitionMandatory.push(r)},t.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.dslMethods.repetitionMandatoryWithSeparator.push(r)},t.prototype.visitRepetition=function(r){this.dslMethods.repetition.push(r)},t.prototype.visitAlternation=function(r){this.dslMethods.alternation.push(r)},t}(jD.GAstVisitor),go=new ZD;function Rv(e){go.reset(),e.accept(go);var t=go.dslMethods;return go.reset(),t}ka.collectMethods=Rv;var ks={},Sr={};Object.defineProperty(Sr,"__esModule",{value:!0});Sr.addNoneTerminalToCst=Sr.addTerminalToCst=Sr.setNodeLocationFull=Sr.setNodeLocationOnlyOffset=void 0;function JD(e,t){isNaN(e.startOffset)===!0?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset&&(e.endOffset=t.endOffset)}Sr.setNodeLocationOnlyOffset=JD;function e4(e,t){isNaN(e.startOffset)===!0?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}Sr.setNodeLocationFull=e4;function t4(e,t,r){e.children[r]===void 0?e.children[r]=[t]:e.children[r].push(t)}Sr.addTerminalToCst=t4;function r4(e,t,r){e.children[t]===void 0?e.children[t]=[r]:e.children[t].push(r)}Sr.addNoneTerminalToCst=r4;var Ov={},Is={};Object.defineProperty(Is,"__esModule",{value:!0});Is.defineNameProp=void 0;var n4="name";function a4(e,t){Object.defineProperty(e,n4,{enumerable:!1,configurable:!0,writable:!1,value:t})}Is.defineNameProp=a4;(function(e){var t=Ae&&Ae.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(e,"__esModule",{value:!0}),e.validateRedundantMethods=e.validateMissingCstMethods=e.validateVisitor=e.CstVisitorDefinitionError=e.createBaseVisitorConstructorWithDefaults=e.createBaseSemanticVisitorConstructor=e.defaultVisit=void 0;var r=t(Br),n=t(xs),a=t(lt),i=t(nr),s=t(Yt),d=t(Eu),h=t(mr),c=t($i),o=t(Ga),l=t(nn),u=Is;function f(T,A){for(var x=(0,h.default)(T),C=x.length,N=0;N<C;N++)for(var P=x[N],z=T[P],K=z.length,q=0;q<K;q++){var W=z[q];W.tokenTypeIdx===void 0&&this[W.name](W.children,A)}}e.defaultVisit=f;function m(T,A){var x=function(){};(0,u.defineNameProp)(x,T+"BaseSemantics");var C={visit:function(N,P){if((0,a.default)(N)&&(N=N[0]),!(0,o.default)(N))return this[N.name](N.children,P)},validateVisitor:function(){var N=v(this,A);if(!(0,r.default)(N)){var P=(0,i.default)(N,function(z){return z.msg});throw Error("Errors Detected in CST Visitor <".concat(this.constructor.name,`>:
	`)+"".concat(P.join(`

`).replace(/\n/g,`
	`)))}}};return x.prototype=C,x.prototype.constructor=x,x._RULE_NAMES=A,x}e.createBaseSemanticVisitorConstructor=m;function g(T,A,x){var C=function(){};(0,u.defineNameProp)(C,T+"BaseSemanticsWithDefaults");var N=Object.create(x.prototype);return(0,s.default)(A,function(P){N[P]=f}),C.prototype=N,C.prototype.constructor=C,C}e.createBaseVisitorConstructorWithDefaults=g;var b;(function(T){T[T.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",T[T.MISSING_METHOD=1]="MISSING_METHOD"})(b=e.CstVisitorDefinitionError||(e.CstVisitorDefinitionError={}));function v(T,A){var x=w(T,A),C=_(T,A);return x.concat(C)}e.validateVisitor=v;function w(T,A){var x=(0,d.default)(A,function(N){return(0,c.default)(T[N])===!1}),C=(0,i.default)(x,function(N){return{msg:"Missing visitor method: <".concat(N,"> on ").concat(T.constructor.name," CST Visitor."),type:b.MISSING_METHOD,methodName:N}});return(0,n.default)(C)}e.validateMissingCstMethods=w;var y=["constructor","visit","validateVisitor"];function _(T,A){var x=[];for(var C in T)(0,c.default)(T[C])&&!(0,l.default)(y,C)&&!(0,l.default)(A,C)&&x.push({msg:"Redundant visitor method: <".concat(C,"> on ").concat(T.constructor.name,` CST Visitor
`)+`There is no Grammar Rule corresponding to this method's name.
`,type:b.REDUNDANT_METHOD,methodName:C});return x}e.validateRedundantMethods=_})(Ov);var Ms=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ks,"__esModule",{value:!0});ks.TreeBuilder=void 0;var aa=Sr,qt=Ms(hu),i4=Ms(vr),fh=Ms(mr),hh=Ms(Ga),ph=Ov,o4=ur,s4=function(){function e(){}return e.prototype.initTreeBuilder=function(t){if(this.CST_STACK=[],this.outputCst=t.outputCst,this.nodeLocationTracking=(0,i4.default)(t,"nodeLocationTracking")?t.nodeLocationTracking:o4.DEFAULT_PARSER_CONFIG.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=qt.default,this.cstFinallyStateUpdate=qt.default,this.cstPostTerminal=qt.default,this.cstPostNonTerminal=qt.default,this.cstPostRule=qt.default;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=aa.setNodeLocationFull,this.setNodeLocationFromNode=aa.setNodeLocationFull,this.cstPostRule=qt.default,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=qt.default,this.setNodeLocationFromNode=qt.default,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=aa.setNodeLocationOnlyOffset,this.setNodeLocationFromNode=aa.setNodeLocationOnlyOffset,this.cstPostRule=qt.default,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=qt.default,this.setNodeLocationFromNode=qt.default,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=qt.default,this.setNodeLocationFromNode=qt.default,this.cstPostRule=qt.default,this.setInitialNodeLocation=qt.default;else throw Error('Invalid <nodeLocationTracking> config option: "'.concat(t.nodeLocationTracking,'"'))},e.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(t){t.location={startOffset:NaN,endOffset:NaN}},e.prototype.setInitialNodeLocationOnlyOffsetRegular=function(t){t.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},e.prototype.setInitialNodeLocationFullRecovery=function(t){t.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.setInitialNodeLocationFullRegular=function(t){var r=this.LA(1);t.location={startOffset:r.startOffset,startLine:r.startLine,startColumn:r.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.cstInvocationStateUpdate=function(t){var r={name:t,children:Object.create(null)};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},e.prototype.cstFinallyStateUpdate=function(){this.CST_STACK.pop()},e.prototype.cstPostRuleFull=function(t){var r=this.LA(0),n=t.location;n.startOffset<=r.startOffset?(n.endOffset=r.endOffset,n.endLine=r.endLine,n.endColumn=r.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)},e.prototype.cstPostRuleOnlyOffset=function(t){var r=this.LA(0),n=t.location;n.startOffset<=r.startOffset?n.endOffset=r.endOffset:n.startOffset=NaN},e.prototype.cstPostTerminal=function(t,r){var n=this.CST_STACK[this.CST_STACK.length-1];(0,aa.addTerminalToCst)(n,r,t),this.setNodeLocationFromToken(n.location,r)},e.prototype.cstPostNonTerminal=function(t,r){var n=this.CST_STACK[this.CST_STACK.length-1];(0,aa.addNoneTerminalToCst)(n,r,t),this.setNodeLocationFromNode(n.location,t.location)},e.prototype.getBaseCstVisitorConstructor=function(){if((0,hh.default)(this.baseCstVisitorConstructor)){var t=(0,ph.createBaseSemanticVisitorConstructor)(this.className,(0,fh.default)(this.gastProductionsCache));return this.baseCstVisitorConstructor=t,t}return this.baseCstVisitorConstructor},e.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if((0,hh.default)(this.baseCstVisitorWithDefaultsConstructor)){var t=(0,ph.createBaseVisitorConstructorWithDefaults)(this.className,(0,fh.default)(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=t,t}return this.baseCstVisitorWithDefaultsConstructor},e.prototype.getLastExplicitRuleShortName=function(){var t=this.RULE_STACK;return t[t.length-1]},e.prototype.getPreviousExplicitRuleShortName=function(){var t=this.RULE_STACK;return t[t.length-2]},e.prototype.getLastExplicitRuleOccurrenceIndex=function(){var t=this.RULE_OCCURRENCE_STACK;return t[t.length-1]},e}();ks.TreeBuilder=s4;var Ps={};Object.defineProperty(Ps,"__esModule",{value:!0});Ps.LexerAdapter=void 0;var gh=ur,l4=function(){function e(){}return e.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(e.prototype,"input",{get:function(){return this.tokVector},set:function(t){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=t,this.tokVectorLength=t.length},enumerable:!1,configurable:!0}),e.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):gh.END_OF_FILE},e.prototype.LA=function(t){var r=this.currIdx+t;return r<0||this.tokVectorLength<=r?gh.END_OF_FILE:this.tokVector[r]},e.prototype.consumeToken=function(){this.currIdx++},e.prototype.exportLexerState=function(){return this.currIdx},e.prototype.importLexerState=function(t){this.currIdx=t},e.prototype.resetLexerState=function(){this.currIdx=-1},e.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},e.prototype.getLexerPosition=function(){return this.exportLexerState()},e}();Ps.LexerAdapter=l4;var Ss={},kv=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ss,"__esModule",{value:!0});Ss.RecognizerApi=void 0;var c4=kv(tn),u4=kv(nn),d4=Wt,yl=ur,f4=Xi,h4=ot,p4=It,g4=function(){function e(){}return e.prototype.ACTION=function(t){return t.call(this)},e.prototype.consume=function(t,r,n){return this.consumeInternal(r,t,n)},e.prototype.subrule=function(t,r,n){return this.subruleInternal(r,t,n)},e.prototype.option=function(t,r){return this.optionInternal(r,t)},e.prototype.or=function(t,r){return this.orInternal(r,t)},e.prototype.many=function(t,r){return this.manyInternal(t,r)},e.prototype.atLeastOne=function(t,r){return this.atLeastOneInternal(t,r)},e.prototype.CONSUME=function(t,r){return this.consumeInternal(t,0,r)},e.prototype.CONSUME1=function(t,r){return this.consumeInternal(t,1,r)},e.prototype.CONSUME2=function(t,r){return this.consumeInternal(t,2,r)},e.prototype.CONSUME3=function(t,r){return this.consumeInternal(t,3,r)},e.prototype.CONSUME4=function(t,r){return this.consumeInternal(t,4,r)},e.prototype.CONSUME5=function(t,r){return this.consumeInternal(t,5,r)},e.prototype.CONSUME6=function(t,r){return this.consumeInternal(t,6,r)},e.prototype.CONSUME7=function(t,r){return this.consumeInternal(t,7,r)},e.prototype.CONSUME8=function(t,r){return this.consumeInternal(t,8,r)},e.prototype.CONSUME9=function(t,r){return this.consumeInternal(t,9,r)},e.prototype.SUBRULE=function(t,r){return this.subruleInternal(t,0,r)},e.prototype.SUBRULE1=function(t,r){return this.subruleInternal(t,1,r)},e.prototype.SUBRULE2=function(t,r){return this.subruleInternal(t,2,r)},e.prototype.SUBRULE3=function(t,r){return this.subruleInternal(t,3,r)},e.prototype.SUBRULE4=function(t,r){return this.subruleInternal(t,4,r)},e.prototype.SUBRULE5=function(t,r){return this.subruleInternal(t,5,r)},e.prototype.SUBRULE6=function(t,r){return this.subruleInternal(t,6,r)},e.prototype.SUBRULE7=function(t,r){return this.subruleInternal(t,7,r)},e.prototype.SUBRULE8=function(t,r){return this.subruleInternal(t,8,r)},e.prototype.SUBRULE9=function(t,r){return this.subruleInternal(t,9,r)},e.prototype.OPTION=function(t){return this.optionInternal(t,0)},e.prototype.OPTION1=function(t){return this.optionInternal(t,1)},e.prototype.OPTION2=function(t){return this.optionInternal(t,2)},e.prototype.OPTION3=function(t){return this.optionInternal(t,3)},e.prototype.OPTION4=function(t){return this.optionInternal(t,4)},e.prototype.OPTION5=function(t){return this.optionInternal(t,5)},e.prototype.OPTION6=function(t){return this.optionInternal(t,6)},e.prototype.OPTION7=function(t){return this.optionInternal(t,7)},e.prototype.OPTION8=function(t){return this.optionInternal(t,8)},e.prototype.OPTION9=function(t){return this.optionInternal(t,9)},e.prototype.OR=function(t){return this.orInternal(t,0)},e.prototype.OR1=function(t){return this.orInternal(t,1)},e.prototype.OR2=function(t){return this.orInternal(t,2)},e.prototype.OR3=function(t){return this.orInternal(t,3)},e.prototype.OR4=function(t){return this.orInternal(t,4)},e.prototype.OR5=function(t){return this.orInternal(t,5)},e.prototype.OR6=function(t){return this.orInternal(t,6)},e.prototype.OR7=function(t){return this.orInternal(t,7)},e.prototype.OR8=function(t){return this.orInternal(t,8)},e.prototype.OR9=function(t){return this.orInternal(t,9)},e.prototype.MANY=function(t){this.manyInternal(0,t)},e.prototype.MANY1=function(t){this.manyInternal(1,t)},e.prototype.MANY2=function(t){this.manyInternal(2,t)},e.prototype.MANY3=function(t){this.manyInternal(3,t)},e.prototype.MANY4=function(t){this.manyInternal(4,t)},e.prototype.MANY5=function(t){this.manyInternal(5,t)},e.prototype.MANY6=function(t){this.manyInternal(6,t)},e.prototype.MANY7=function(t){this.manyInternal(7,t)},e.prototype.MANY8=function(t){this.manyInternal(8,t)},e.prototype.MANY9=function(t){this.manyInternal(9,t)},e.prototype.MANY_SEP=function(t){this.manySepFirstInternal(0,t)},e.prototype.MANY_SEP1=function(t){this.manySepFirstInternal(1,t)},e.prototype.MANY_SEP2=function(t){this.manySepFirstInternal(2,t)},e.prototype.MANY_SEP3=function(t){this.manySepFirstInternal(3,t)},e.prototype.MANY_SEP4=function(t){this.manySepFirstInternal(4,t)},e.prototype.MANY_SEP5=function(t){this.manySepFirstInternal(5,t)},e.prototype.MANY_SEP6=function(t){this.manySepFirstInternal(6,t)},e.prototype.MANY_SEP7=function(t){this.manySepFirstInternal(7,t)},e.prototype.MANY_SEP8=function(t){this.manySepFirstInternal(8,t)},e.prototype.MANY_SEP9=function(t){this.manySepFirstInternal(9,t)},e.prototype.AT_LEAST_ONE=function(t){this.atLeastOneInternal(0,t)},e.prototype.AT_LEAST_ONE1=function(t){return this.atLeastOneInternal(1,t)},e.prototype.AT_LEAST_ONE2=function(t){this.atLeastOneInternal(2,t)},e.prototype.AT_LEAST_ONE3=function(t){this.atLeastOneInternal(3,t)},e.prototype.AT_LEAST_ONE4=function(t){this.atLeastOneInternal(4,t)},e.prototype.AT_LEAST_ONE5=function(t){this.atLeastOneInternal(5,t)},e.prototype.AT_LEAST_ONE6=function(t){this.atLeastOneInternal(6,t)},e.prototype.AT_LEAST_ONE7=function(t){this.atLeastOneInternal(7,t)},e.prototype.AT_LEAST_ONE8=function(t){this.atLeastOneInternal(8,t)},e.prototype.AT_LEAST_ONE9=function(t){this.atLeastOneInternal(9,t)},e.prototype.AT_LEAST_ONE_SEP=function(t){this.atLeastOneSepFirstInternal(0,t)},e.prototype.AT_LEAST_ONE_SEP1=function(t){this.atLeastOneSepFirstInternal(1,t)},e.prototype.AT_LEAST_ONE_SEP2=function(t){this.atLeastOneSepFirstInternal(2,t)},e.prototype.AT_LEAST_ONE_SEP3=function(t){this.atLeastOneSepFirstInternal(3,t)},e.prototype.AT_LEAST_ONE_SEP4=function(t){this.atLeastOneSepFirstInternal(4,t)},e.prototype.AT_LEAST_ONE_SEP5=function(t){this.atLeastOneSepFirstInternal(5,t)},e.prototype.AT_LEAST_ONE_SEP6=function(t){this.atLeastOneSepFirstInternal(6,t)},e.prototype.AT_LEAST_ONE_SEP7=function(t){this.atLeastOneSepFirstInternal(7,t)},e.prototype.AT_LEAST_ONE_SEP8=function(t){this.atLeastOneSepFirstInternal(8,t)},e.prototype.AT_LEAST_ONE_SEP9=function(t){this.atLeastOneSepFirstInternal(9,t)},e.prototype.RULE=function(t,r,n){if(n===void 0&&(n=yl.DEFAULT_RULE_CONFIG),(0,u4.default)(this.definedRulesNames,t)){var a=f4.defaultGrammarValidatorErrorProvider.buildDuplicateRuleNameError({topLevelRule:t,grammarName:this.className}),i={message:a,type:yl.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:t};this.definitionErrors.push(i)}this.definedRulesNames.push(t);var s=this.defineRule(t,r,n);return this[t]=s,s},e.prototype.OVERRIDE_RULE=function(t,r,n){n===void 0&&(n=yl.DEFAULT_RULE_CONFIG);var a=(0,h4.validateRuleIsOverridden)(t,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(a);var i=this.defineRule(t,r,n);return this[t]=i,i},e.prototype.BACKTRACK=function(t,r){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{return t.apply(this,r),!0}catch(a){if((0,d4.isRecognitionException)(a))return!1;throw a}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},e.prototype.getGAstProductions=function(){return this.gastProductionsCache},e.prototype.getSerializedGastProductions=function(){return(0,p4.serializeGrammar)((0,c4.default)(this.gastProductionsCache))},e}();Ss.RecognizerApi=g4;var Ls={},Kr=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ls,"__esModule",{value:!0});Ls.RecognizerEngine=void 0;var mh=Kr(Br),El=Kr(lt),wl=Kr(an),vh=Kr(Ns),m4=Kr(pu),v4=Kr(Dr),Za=Kr(vr),Ja=Kr(tn),bh=Kr(jn),yh=Kr(Nn),ir=Os,mo=Wt,Eh=ji,ia=Nt,wh=ur,b4=ku,_h=Xn,ei=Qn,y4=function(){function e(){}return e.prototype.initRecognizerEngine=function(t,r){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=ei.tokenStructuredMatcherNoCategories,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},(0,Za.default)(r,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if((0,El.default)(t)){if((0,mh.default)(t))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof t[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if((0,El.default)(t))this.tokensMap=(0,bh.default)(t,function(d,h){return d[h.name]=h,d},{});else if((0,Za.default)(t,"modes")&&(0,vh.default)((0,wl.default)((0,Ja.default)(t.modes)),ei.isTokenType)){var n=(0,wl.default)((0,Ja.default)(t.modes)),a=(0,m4.default)(n);this.tokensMap=(0,bh.default)(a,function(d,h){return d[h.name]=h,d},{})}else if((0,v4.default)(t))this.tokensMap=(0,yh.default)(t);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=_h.EOF;var i=(0,Za.default)(t,"modes")?(0,wl.default)((0,Ja.default)(t.modes)):(0,Ja.default)(t),s=(0,vh.default)(i,function(d){return(0,mh.default)(d.categoryMatches)});this.tokenMatcher=s?ei.tokenStructuredMatcherNoCategories:ei.tokenStructuredMatcher,(0,ei.augmentTokenTypes)((0,Ja.default)(this.tokensMap))},e.prototype.defineRule=function(t,r,n){if(this.selfAnalysisDone)throw Error("Grammar rule <".concat(t,`> may not be defined after the 'performSelfAnalysis' method has been called'
`)+"Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var a=(0,Za.default)(n,"resyncEnabled")?n.resyncEnabled:wh.DEFAULT_RULE_CONFIG.resyncEnabled,i=(0,Za.default)(n,"recoveryValueFunc")?n.recoveryValueFunc:wh.DEFAULT_RULE_CONFIG.recoveryValueFunc,s=this.ruleShortNameIdx<<ir.BITS_FOR_METHOD_TYPE+ir.BITS_FOR_OCCURRENCE_IDX;this.ruleShortNameIdx++,this.shortRuleNameToFull[s]=t,this.fullRuleNameToShort[t]=s;var d;this.outputCst===!0?d=function(){for(var o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];try{this.ruleInvocationStateUpdate(s,t,this.subruleIdx),r.apply(this,o);var u=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(u),u}catch(f){return this.invokeRuleCatch(f,a,i)}finally{this.ruleFinallyStateUpdate()}}:d=function(){for(var o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];try{return this.ruleInvocationStateUpdate(s,t,this.subruleIdx),r.apply(this,o)}catch(u){return this.invokeRuleCatch(u,a,i)}finally{this.ruleFinallyStateUpdate()}};var h=Object.assign(d,{ruleName:t,originalGrammarAction:r});return h},e.prototype.invokeRuleCatch=function(t,r,n){var a=this.RULE_STACK.length===1,i=r&&!this.isBackTracking()&&this.recoveryEnabled;if((0,mo.isRecognitionException)(t)){var s=t;if(i){var d=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(d))if(s.resyncedTokens=this.reSyncTo(d),this.outputCst){var h=this.CST_STACK[this.CST_STACK.length-1];return h.recoveredNode=!0,h}else return n();else{if(this.outputCst){var h=this.CST_STACK[this.CST_STACK.length-1];h.recoveredNode=!0,s.partialCstResult=h}throw s}}else{if(a)return this.moveToTerminatedState(),n();throw s}}else throw t},e.prototype.optionInternal=function(t,r){var n=this.getKeyForAutomaticLookahead(ir.OPTION_IDX,r);return this.optionInternalLogic(t,r,n)},e.prototype.optionInternalLogic=function(t,r,n){var a=this,i=this.getLaFuncFromCache(n),s;if(typeof t!="function"){s=t.DEF;var d=t.GATE;if(d!==void 0){var h=i;i=function(){return d.call(a)&&h.call(a)}}}else s=t;if(i.call(this)===!0)return s.call(this)},e.prototype.atLeastOneInternal=function(t,r){var n=this.getKeyForAutomaticLookahead(ir.AT_LEAST_ONE_IDX,t);return this.atLeastOneInternalLogic(t,r,n)},e.prototype.atLeastOneInternalLogic=function(t,r,n){var a=this,i=this.getLaFuncFromCache(n),s;if(typeof r!="function"){s=r.DEF;var d=r.GATE;if(d!==void 0){var h=i;i=function(){return d.call(a)&&h.call(a)}}}else s=r;if(i.call(this)===!0)for(var c=this.doSingleRepetition(s);i.call(this)===!0&&c===!0;)c=this.doSingleRepetition(s);else throw this.raiseEarlyExitException(t,Eh.PROD_TYPE.REPETITION_MANDATORY,r.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[t,r],i,ir.AT_LEAST_ONE_IDX,t,ia.NextTerminalAfterAtLeastOneWalker)},e.prototype.atLeastOneSepFirstInternal=function(t,r){var n=this.getKeyForAutomaticLookahead(ir.AT_LEAST_ONE_SEP_IDX,t);this.atLeastOneSepFirstInternalLogic(t,r,n)},e.prototype.atLeastOneSepFirstInternalLogic=function(t,r,n){var a=this,i=r.DEF,s=r.SEP,d=this.getLaFuncFromCache(n);if(d.call(this)===!0){i.call(this);for(var h=function(){return a.tokenMatcher(a.LA(1),s)};this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,s,h,i,ia.NextTerminalAfterAtLeastOneSepWalker],h,ir.AT_LEAST_ONE_SEP_IDX,t,ia.NextTerminalAfterAtLeastOneSepWalker)}else throw this.raiseEarlyExitException(t,Eh.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,r.ERR_MSG)},e.prototype.manyInternal=function(t,r){var n=this.getKeyForAutomaticLookahead(ir.MANY_IDX,t);return this.manyInternalLogic(t,r,n)},e.prototype.manyInternalLogic=function(t,r,n){var a=this,i=this.getLaFuncFromCache(n),s;if(typeof r!="function"){s=r.DEF;var d=r.GATE;if(d!==void 0){var h=i;i=function(){return d.call(a)&&h.call(a)}}}else s=r;for(var c=!0;i.call(this)===!0&&c===!0;)c=this.doSingleRepetition(s);this.attemptInRepetitionRecovery(this.manyInternal,[t,r],i,ir.MANY_IDX,t,ia.NextTerminalAfterManyWalker,c)},e.prototype.manySepFirstInternal=function(t,r){var n=this.getKeyForAutomaticLookahead(ir.MANY_SEP_IDX,t);this.manySepFirstInternalLogic(t,r,n)},e.prototype.manySepFirstInternalLogic=function(t,r,n){var a=this,i=r.DEF,s=r.SEP,d=this.getLaFuncFromCache(n);if(d.call(this)===!0){i.call(this);for(var h=function(){return a.tokenMatcher(a.LA(1),s)};this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,s,h,i,ia.NextTerminalAfterManySepWalker],h,ir.MANY_SEP_IDX,t,ia.NextTerminalAfterManySepWalker)}},e.prototype.repetitionSepSecondInternal=function(t,r,n,a,i){for(;n();)this.CONSUME(r),a.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,r,n,a,i],n,ir.AT_LEAST_ONE_SEP_IDX,t,i)},e.prototype.doSingleRepetition=function(t){var r=this.getLexerPosition();t.call(this);var n=this.getLexerPosition();return n>r},e.prototype.orInternal=function(t,r){var n=this.getKeyForAutomaticLookahead(ir.OR_IDX,r),a=(0,El.default)(t)?t:t.DEF,i=this.getLaFuncFromCache(n),s=i.call(this,a);if(s!==void 0){var d=a[s];return d.ALT.call(this)}this.raiseNoAltException(r,t.ERR_MSG)},e.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var t=this.LA(1),r=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:t,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new mo.NotAllInputParsedException(r,t))}},e.prototype.subruleInternal=function(t,r,n){var a;try{var i=n!==void 0?n.ARGS:void 0;return this.subruleIdx=r,a=t.apply(this,i),this.cstPostNonTerminal(a,n!==void 0&&n.LABEL!==void 0?n.LABEL:t.ruleName),a}catch(s){throw this.subruleInternalError(s,n,t.ruleName)}},e.prototype.subruleInternalError=function(t,r,n){throw(0,mo.isRecognitionException)(t)&&t.partialCstResult!==void 0&&(this.cstPostNonTerminal(t.partialCstResult,r!==void 0&&r.LABEL!==void 0?r.LABEL:n),delete t.partialCstResult),t},e.prototype.consumeInternal=function(t,r,n){var a;try{var i=this.LA(1);this.tokenMatcher(i,t)===!0?(this.consumeToken(),a=i):this.consumeInternalError(t,i,n)}catch(s){a=this.consumeInternalRecovery(t,r,s)}return this.cstPostTerminal(n!==void 0&&n.LABEL!==void 0?n.LABEL:t.name,a),a},e.prototype.consumeInternalError=function(t,r,n){var a,i=this.LA(0);throw n!==void 0&&n.ERR_MSG?a=n.ERR_MSG:a=this.errorMessageProvider.buildMismatchTokenMessage({expected:t,actual:r,previous:i,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new mo.MismatchedTokenException(a,r,i))},e.prototype.consumeInternalRecovery=function(t,r,n){if(this.recoveryEnabled&&n.name==="MismatchedTokenException"&&!this.isBackTracking()){var a=this.getFollowsForInRuleRecovery(t,r);try{return this.tryInRuleRecovery(t,a)}catch(i){throw i.name===b4.IN_RULE_RECOVERY_EXCEPTION?n:i}}else throw n},e.prototype.saveRecogState=function(){var t=this.errors,r=(0,yh.default)(this.RULE_STACK);return{errors:t,lexerState:this.exportLexerState(),RULE_STACK:r,CST_STACK:this.CST_STACK}},e.prototype.reloadRecogState=function(t){this.errors=t.errors,this.importLexerState(t.lexerState),this.RULE_STACK=t.RULE_STACK},e.prototype.ruleInvocationStateUpdate=function(t,r,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(t),this.cstInvocationStateUpdate(r)},e.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},e.prototype.getCurrRuleFullName=function(){var t=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[t]},e.prototype.shortRuleNameToFullName=function(t){return this.shortRuleNameToFull[t]},e.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),_h.EOF)},e.prototype.reset=function(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},e}();Ls.RecognizerEngine=y4;var $s={},Iv=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($s,"__esModule",{value:!0});$s.ErrorHandler=void 0;var _l=Wt,E4=Iv(vr),Nh=Iv(Nn),Ah=ji,w4=ur,_4=function(){function e(){}return e.prototype.initErrorHandler=function(t){this._errors=[],this.errorMessageProvider=(0,E4.default)(t,"errorMessageProvider")?t.errorMessageProvider:w4.DEFAULT_PARSER_CONFIG.errorMessageProvider},e.prototype.SAVE_ERROR=function(t){if((0,_l.isRecognitionException)(t))return t.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:(0,Nh.default)(this.RULE_OCCURRENCE_STACK)},this._errors.push(t),t;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(e.prototype,"errors",{get:function(){return(0,Nh.default)(this._errors)},set:function(t){this._errors=t},enumerable:!1,configurable:!0}),e.prototype.raiseEarlyExitException=function(t,r,n){for(var a=this.getCurrRuleFullName(),i=this.getGAstProductions()[a],s=(0,Ah.getLookaheadPathsForOptionalProd)(t,i,r,this.maxLookahead),d=s[0],h=[],c=1;c<=this.maxLookahead;c++)h.push(this.LA(c));var o=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:d,actual:h,previous:this.LA(0),customUserDescription:n,ruleName:a});throw this.SAVE_ERROR(new _l.EarlyExitException(o,this.LA(1),this.LA(0)))},e.prototype.raiseNoAltException=function(t,r){for(var n=this.getCurrRuleFullName(),a=this.getGAstProductions()[n],i=(0,Ah.getLookaheadPathsForOr)(t,a,this.maxLookahead),s=[],d=1;d<=this.maxLookahead;d++)s.push(this.LA(d));var h=this.LA(0),c=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:i,actual:s,previous:h,customUserDescription:r,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new _l.NoViableAltException(c,this.LA(1),h))},e}();$s.ErrorHandler=_4;var Ds={},Mv=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ds,"__esModule",{value:!0});Ds.ContentAssist=void 0;var Ch=Nt,N4=Mv(Yi),A4=Mv(Ga),C4=function(){function e(){}return e.prototype.initContentAssist=function(){},e.prototype.computeContentAssist=function(t,r){var n=this.gastProductionsCache[t];if((0,A4.default)(n))throw Error("Rule ->".concat(t,"<- does not exist in this grammar."));return(0,Ch.nextPossibleTokensAfter)([n],r,this.tokenMatcher,this.maxLookahead)},e.prototype.getNextPossibleTokenTypes=function(t){var r=(0,N4.default)(t.ruleStack),n=this.getGAstProductions(),a=n[r],i=new Ch.NextAfterTokenWalker(a,t).startWalking();return i},e}();Ds.ContentAssist=C4;var Us={},Ha=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Us,"__esModule",{value:!0});Us.GastRecorder=void 0;var zo=Ha(wu),x4=Ha(lt),T4=Ha(cu),R4=Ha(Yt),Pv=Ha($i),mi=Ha(vr),Or=It,O4=Ki,Sv=Qn,Lv=Xn,k4=ur,I4=Os,Fs={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Fs);var xh=!0,Th=Math.pow(2,I4.BITS_FOR_OCCURRENCE_IDX)-1,$v=(0,Lv.createToken)({name:"RECORDING_PHASE_TOKEN",pattern:O4.Lexer.NA});(0,Sv.augmentTokenTypes)([$v]);var Dv=(0,Lv.createTokenInstance)($v,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(Dv);var M4={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}},P4=function(){function e(){}return e.prototype.initGastRecorder=function(t){this.recordingProdStack=[],this.RECORDING_PHASE=!1},e.prototype.enableRecording=function(){var t=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var r=function(a){var i=a>0?a:"";t["CONSUME".concat(i)]=function(s,d){return this.consumeInternalRecord(s,a,d)},t["SUBRULE".concat(i)]=function(s,d){return this.subruleInternalRecord(s,a,d)},t["OPTION".concat(i)]=function(s){return this.optionInternalRecord(s,a)},t["OR".concat(i)]=function(s){return this.orInternalRecord(s,a)},t["MANY".concat(i)]=function(s){this.manyInternalRecord(a,s)},t["MANY_SEP".concat(i)]=function(s){this.manySepFirstInternalRecord(a,s)},t["AT_LEAST_ONE".concat(i)]=function(s){this.atLeastOneInternalRecord(a,s)},t["AT_LEAST_ONE_SEP".concat(i)]=function(s){this.atLeastOneSepFirstInternalRecord(a,s)}},n=0;n<10;n++)r(n);t.consume=function(a,i,s){return this.consumeInternalRecord(i,a,s)},t.subrule=function(a,i,s){return this.subruleInternalRecord(i,a,s)},t.option=function(a,i){return this.optionInternalRecord(i,a)},t.or=function(a,i){return this.orInternalRecord(i,a)},t.many=function(a,i){this.manyInternalRecord(a,i)},t.atLeastOne=function(a,i){this.atLeastOneInternalRecord(a,i)},t.ACTION=t.ACTION_RECORD,t.BACKTRACK=t.BACKTRACK_RECORD,t.LA=t.LA_RECORD})},e.prototype.disableRecording=function(){var t=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var r=t,n=0;n<10;n++){var a=n>0?n:"";delete r["CONSUME".concat(a)],delete r["SUBRULE".concat(a)],delete r["OPTION".concat(a)],delete r["OR".concat(a)],delete r["MANY".concat(a)],delete r["MANY_SEP".concat(a)],delete r["AT_LEAST_ONE".concat(a)],delete r["AT_LEAST_ONE_SEP".concat(a)]}delete r.consume,delete r.subrule,delete r.option,delete r.or,delete r.many,delete r.atLeastOne,delete r.ACTION,delete r.BACKTRACK,delete r.LA})},e.prototype.ACTION_RECORD=function(t){},e.prototype.BACKTRACK_RECORD=function(t,r){return function(){return!0}},e.prototype.LA_RECORD=function(t){return k4.END_OF_FILE},e.prototype.topLevelRuleRecord=function(t,r){try{var n=new Or.Rule({definition:[],name:t});return n.name=t,this.recordingProdStack.push(n),r.call(this),this.recordingProdStack.pop(),n}catch(a){if(a.KNOWN_RECORDER_ERROR!==!0)try{a.message=a.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw a}throw a}},e.prototype.optionInternalRecord=function(t,r){return ti.call(this,Or.Option,t,r)},e.prototype.atLeastOneInternalRecord=function(t,r){ti.call(this,Or.RepetitionMandatory,r,t)},e.prototype.atLeastOneSepFirstInternalRecord=function(t,r){ti.call(this,Or.RepetitionMandatoryWithSeparator,r,t,xh)},e.prototype.manyInternalRecord=function(t,r){ti.call(this,Or.Repetition,r,t)},e.prototype.manySepFirstInternalRecord=function(t,r){ti.call(this,Or.RepetitionWithSeparator,r,t,xh)},e.prototype.orInternalRecord=function(t,r){return S4.call(this,t,r)},e.prototype.subruleInternalRecord=function(t,r,n){if(Go(r),!t||(0,mi.default)(t,"ruleName")===!1){var a=new Error("<SUBRULE".concat(Rh(r),"> argument is invalid")+" expecting a Parser method reference but got: <".concat(JSON.stringify(t),">")+`
 inside top level rule: <`.concat(this.recordingProdStack[0].name,">"));throw a.KNOWN_RECORDER_ERROR=!0,a}var i=(0,zo.default)(this.recordingProdStack),s=t.ruleName,d=new Or.NonTerminal({idx:r,nonTerminalName:s,label:n==null?void 0:n.LABEL,referencedRule:void 0});return i.definition.push(d),this.outputCst?M4:Fs},e.prototype.consumeInternalRecord=function(t,r,n){if(Go(r),!(0,Sv.hasShortKeyProperty)(t)){var a=new Error("<CONSUME".concat(Rh(r),"> argument is invalid")+" expecting a TokenType reference but got: <".concat(JSON.stringify(t),">")+`
 inside top level rule: <`.concat(this.recordingProdStack[0].name,">"));throw a.KNOWN_RECORDER_ERROR=!0,a}var i=(0,zo.default)(this.recordingProdStack),s=new Or.Terminal({idx:r,terminalType:t,label:n==null?void 0:n.LABEL});return i.definition.push(s),Dv},e}();Us.GastRecorder=P4;function ti(e,t,r,n){n===void 0&&(n=!1),Go(r);var a=(0,zo.default)(this.recordingProdStack),i=(0,Pv.default)(t)?t:t.DEF,s=new e({definition:[],idx:r});return n&&(s.separator=t.SEP),(0,mi.default)(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(s),i.call(this),a.definition.push(s),this.recordingProdStack.pop(),Fs}function S4(e,t){var r=this;Go(t);var n=(0,zo.default)(this.recordingProdStack),a=(0,x4.default)(e)===!1,i=a===!1?e:e.DEF,s=new Or.Alternation({definition:[],idx:t,ignoreAmbiguities:a&&e.IGNORE_AMBIGUITIES===!0});(0,mi.default)(e,"MAX_LOOKAHEAD")&&(s.maxLookahead=e.MAX_LOOKAHEAD);var d=(0,T4.default)(i,function(h){return(0,Pv.default)(h.GATE)});return s.hasPredicates=d,n.definition.push(s),(0,R4.default)(i,function(h){var c=new Or.Alternative({definition:[]});s.definition.push(c),(0,mi.default)(h,"IGNORE_AMBIGUITIES")?c.ignoreAmbiguities=h.IGNORE_AMBIGUITIES:(0,mi.default)(h,"GATE")&&(c.ignoreAmbiguities=!0),r.recordingProdStack.push(c),h.ALT.call(r),r.recordingProdStack.pop()}),Fs}function Rh(e){return e===0?"":"".concat(e)}function Go(e){if(e<0||e>Th){var t=new Error("Invalid DSL Method idx value: <".concat(e,`>
	`)+"Idx value must be a none negative value smaller than ".concat(Th+1));throw t.KNOWN_RECORDER_ERROR=!0,t}}var Bs={},L4=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Bs,"__esModule",{value:!0});Bs.PerformanceTracer=void 0;var $4=L4(vr),D4=Ba,U4=ur,F4=function(){function e(){}return e.prototype.initPerformanceTracer=function(t){if((0,$4.default)(t,"traceInitPerf")){var r=t.traceInitPerf,n=typeof r=="number";this.traceInitMaxIdent=n?r:1/0,this.traceInitPerf=n?r>0:r}else this.traceInitMaxIdent=0,this.traceInitPerf=U4.DEFAULT_PARSER_CONFIG.traceInitPerf;this.traceInitIndent=-1},e.prototype.TRACE_INIT=function(t,r){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log("".concat(n,"--> <").concat(t,">"));var a=(0,D4.timer)(r),i=a.time,s=a.value,d=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&d("".concat(n,"<-- <").concat(t,"> time: ").concat(i,"ms")),this.traceInitIndent--,s}else return r()},e}();Bs.PerformanceTracer=F4;var Vs={};Object.defineProperty(Vs,"__esModule",{value:!0});Vs.applyMixins=void 0;function B4(e,t){t.forEach(function(r){var n=r.prototype;Object.getOwnPropertyNames(n).forEach(function(a){if(a!=="constructor"){var i=Object.getOwnPropertyDescriptor(n,a);i&&(i.get||i.set)?Object.defineProperty(e.prototype,a,i):e.prototype[a]=r.prototype[a]}})})}Vs.applyMixins=B4;(function(e){var t=Ae&&Ae.__extends||function(){var q=function(W,ce){return q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(V,G){V.__proto__=G}||function(V,G){for(var j in G)Object.prototype.hasOwnProperty.call(G,j)&&(V[j]=G[j])},q(W,ce)};return function(W,ce){if(typeof ce!="function"&&ce!==null)throw new TypeError("Class extends value "+String(ce)+" is not a constructor or null");q(W,ce);function V(){this.constructor=W}W.prototype=ce===null?Object.create(ce):(V.prototype=ce.prototype,new V)}}(),r=Ae&&Ae.__importDefault||function(q){return q&&q.__esModule?q:{default:q}};Object.defineProperty(e,"__esModule",{value:!0}),e.EmbeddedActionsParser=e.CstParser=e.Parser=e.EMPTY_ALT=e.ParserDefinitionErrorType=e.DEFAULT_RULE_CONFIG=e.DEFAULT_PARSER_CONFIG=e.END_OF_FILE=void 0;var n=r(Br),a=r(nr),i=r(Yt),s=r(tn),d=r(vr),h=r(Nn),c=Ba,o=Mr,l=Xn,u=Xi,f=Ta,m=ku,g=ka,b=ks,v=Ps,w=Ss,y=Ls,_=$s,T=Ds,A=Us,x=Bs,C=Vs;e.END_OF_FILE=(0,l.createTokenInstance)(l.EOF,"",NaN,NaN,NaN,NaN,NaN,NaN),Object.freeze(e.END_OF_FILE),e.DEFAULT_PARSER_CONFIG=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:u.defaultParserErrorProvider,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),e.DEFAULT_RULE_CONFIG=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),function(q){q[q.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",q[q.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",q[q.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",q[q.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",q[q.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",q[q.LEFT_RECURSION=5]="LEFT_RECURSION",q[q.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",q[q.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",q[q.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",q[q.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",q[q.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",q[q.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",q[q.TOO_MANY_ALTS=12]="TOO_MANY_ALTS"}(e.ParserDefinitionErrorType||(e.ParserDefinitionErrorType={}));function N(q){return q===void 0&&(q=void 0),function(){return q}}e.EMPTY_ALT=N;var P=function(){function q(W,ce){this.definitionErrors=[],this.selfAnalysisDone=!1;var V=this;if(V.initErrorHandler(ce),V.initLexerAdapter(),V.initLooksAhead(ce),V.initRecognizerEngine(W,ce),V.initRecoverable(ce),V.initTreeBuilder(ce),V.initContentAssist(),V.initGastRecorder(ce),V.initPerformanceTracer(ce),(0,d.default)(ce,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=(0,d.default)(ce,"skipValidations")?ce.skipValidations:e.DEFAULT_PARSER_CONFIG.skipValidations}return q.performSelfAnalysis=function(W){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")},q.prototype.performSelfAnalysis=function(){var W=this;this.TRACE_INIT("performSelfAnalysis",function(){var ce;W.selfAnalysisDone=!0;var V=W.className;W.TRACE_INIT("toFastProps",function(){(0,c.toFastProperties)(W)}),W.TRACE_INIT("Grammar Recording",function(){try{W.enableRecording(),(0,i.default)(W.definedRulesNames,function(j){var ie=W[j],fe=ie.originalGrammarAction,ve;W.TRACE_INIT("".concat(j," Rule"),function(){ve=W.topLevelRuleRecord(j,fe)}),W.gastProductionsCache[j]=ve})}finally{W.disableRecording()}});var G=[];if(W.TRACE_INIT("Grammar Resolving",function(){G=(0,f.resolveGrammar)({rules:(0,s.default)(W.gastProductionsCache)}),W.definitionErrors=W.definitionErrors.concat(G)}),W.TRACE_INIT("Grammar Validations",function(){if((0,n.default)(G)&&W.skipValidations===!1){var j=(0,f.validateGrammar)({rules:(0,s.default)(W.gastProductionsCache),maxLookahead:W.maxLookahead,tokenTypes:(0,s.default)(W.tokensMap),errMsgProvider:u.defaultGrammarValidatorErrorProvider,grammarName:V});W.definitionErrors=W.definitionErrors.concat(j)}}),(0,n.default)(W.definitionErrors)&&(W.recoveryEnabled&&W.TRACE_INIT("computeAllProdsFollows",function(){var j=(0,o.computeAllProdsFollows)((0,s.default)(W.gastProductionsCache));W.resyncFollows=j}),W.TRACE_INIT("ComputeLookaheadFunctions",function(){W.preComputeLookaheadFunctions((0,s.default)(W.gastProductionsCache))})),!q.DEFER_DEFINITION_ERRORS_HANDLING&&!(0,n.default)(W.definitionErrors))throw ce=(0,a.default)(W.definitionErrors,function(j){return j.message}),new Error(`Parser Definition Errors detected:
 `.concat(ce.join(`
-------------------------------
`)))})},q.DEFER_DEFINITION_ERRORS_HANDLING=!1,q}();e.Parser=P,(0,C.applyMixins)(P,[m.Recoverable,g.LooksAhead,b.TreeBuilder,v.LexerAdapter,y.RecognizerEngine,w.RecognizerApi,_.ErrorHandler,T.ContentAssist,A.GastRecorder,x.PerformanceTracer]);var z=function(q){t(W,q);function W(ce,V){V===void 0&&(V=e.DEFAULT_PARSER_CONFIG);var G=(0,h.default)(V);return G.outputCst=!0,q.call(this,ce,G)||this}return W}(P);e.CstParser=z;var K=function(q){t(W,q);function W(ce,V){V===void 0&&(V=e.DEFAULT_PARSER_CONFIG);var G=(0,h.default)(V);return G.outputCst=!1,q.call(this,ce,G)||this}return W}(P);e.EmbeddedActionsParser=K})(ur);var zs={},Gs={},V4=Ae&&Ae.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Wa=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.buildModel=void 0;var Uv=It,oi=Wa(nr),z4=Wa(an),G4=Wa(tn),H4=Wa(cu),W4=Wa(nv),K4=Wa(ws);function Y4(e){var t=new q4,r=(0,G4.default)(e);return(0,oi.default)(r,function(n){return t.visitRule(n)})}Gs.buildModel=Y4;var q4=function(e){V4(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.visitRule=function(r){var n=this.visitEach(r.definition),a=(0,W4.default)(n,function(s){return s.propertyName}),i=(0,oi.default)(a,function(s,d){var h=!(0,H4.default)(s,function(o){return!o.canBeNull}),c=s[0].type;return s.length>1&&(c=(0,oi.default)(s,function(o){return o.type})),{name:d,type:c,optional:h}});return{name:r.name,properties:i}},t.prototype.visitAlternative=function(r){return this.visitEachAndOverrideWith(r.definition,{canBeNull:!0})},t.prototype.visitOption=function(r){return this.visitEachAndOverrideWith(r.definition,{canBeNull:!0})},t.prototype.visitRepetition=function(r){return this.visitEachAndOverrideWith(r.definition,{canBeNull:!0})},t.prototype.visitRepetitionMandatory=function(r){return this.visitEach(r.definition)},t.prototype.visitRepetitionMandatoryWithSeparator=function(r){return this.visitEach(r.definition).concat({propertyName:r.separator.name,canBeNull:!0,type:vo(r.separator)})},t.prototype.visitRepetitionWithSeparator=function(r){return this.visitEachAndOverrideWith(r.definition,{canBeNull:!0}).concat({propertyName:r.separator.name,canBeNull:!0,type:vo(r.separator)})},t.prototype.visitAlternation=function(r){return this.visitEachAndOverrideWith(r.definition,{canBeNull:!0})},t.prototype.visitTerminal=function(r){return[{propertyName:r.label||r.terminalType.name,canBeNull:!1,type:vo(r)}]},t.prototype.visitNonTerminal=function(r){return[{propertyName:r.label||r.nonTerminalName,canBeNull:!1,type:vo(r)}]},t.prototype.visitEachAndOverrideWith=function(r,n){return(0,oi.default)(this.visitEach(r),function(a){return(0,K4.default)({},a,n)})},t.prototype.visitEach=function(r){var n=this;return(0,z4.default)((0,oi.default)(r,function(a){return n.visit(a)}))},t}(Uv.GAstVisitor);function vo(e){return e instanceof Uv.NonTerminal?{kind:"rule",name:e.referencedRule.name}:{kind:"token"}}var Hs={},X4=ou;function j4(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:X4(e,t,r)}var Q4=j4,Z4="\\ud800-\\udfff",J4="\\u0300-\\u036f",e5="\\ufe20-\\ufe2f",t5="\\u20d0-\\u20ff",r5=J4+e5+t5,n5="\\ufe0e\\ufe0f",a5="\\u200d",i5=RegExp("["+a5+Z4+r5+n5+"]");function o5(e){return i5.test(e)}var Fv=o5;function s5(e){return e.split("")}var l5=s5,Bv="\\ud800-\\udfff",c5="\\u0300-\\u036f",u5="\\ufe20-\\ufe2f",d5="\\u20d0-\\u20ff",f5=c5+u5+d5,h5="\\ufe0e\\ufe0f",p5="["+Bv+"]",cc="["+f5+"]",uc="\\ud83c[\\udffb-\\udfff]",g5="(?:"+cc+"|"+uc+")",Vv="[^"+Bv+"]",zv="(?:\\ud83c[\\udde6-\\uddff]){2}",Gv="[\\ud800-\\udbff][\\udc00-\\udfff]",m5="\\u200d",Hv=g5+"?",Wv="["+h5+"]?",v5="(?:"+m5+"(?:"+[Vv,zv,Gv].join("|")+")"+Wv+Hv+")*",b5=Wv+Hv+v5,y5="(?:"+[Vv+cc+"?",cc,zv,Gv,p5].join("|")+")",E5=RegExp(uc+"(?="+uc+")|"+y5+b5,"g");function w5(e){return e.match(E5)||[]}var _5=w5,N5=l5,A5=Fv,C5=_5;function x5(e){return A5(e)?C5(e):N5(e)}var T5=x5,R5=Q4,O5=Fv,k5=T5,I5=mm;function M5(e){return function(t){t=I5(t);var r=O5(t)?k5(t):void 0,n=r?r[0]:t.charAt(0),a=r?R5(r,1).join(""):t.slice(1);return n[e]()+a}}var P5=M5,S5=P5,L5=S5("toUpperCase"),$5=L5,Ka=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Hs,"__esModule",{value:!0});Hs.genDts=void 0;var D5=Ka(an),U5=Ka(lt),Ws=Ka(nr),F5=Ka(jn),B5=Ka(pu),Kv=Ka($5);function V5(e,t){var r=[];return r=r.concat('import type { CstNode, ICstVisitor, IToken } from "chevrotain";'),r=r.concat((0,D5.default)((0,Ws.default)(e,function(n){return z5(n)}))),t.includeVisitorInterface&&(r=r.concat(K5(t.visitorInterfaceName,e))),r.join(`

`)+`
`}Hs.genDts=V5;function z5(e){var t=G5(e),r=H5(e);return[t,r]}function G5(e){var t=Yv(e.name),r=Iu(e.name);return"export interface ".concat(t,` extends CstNode {
  name: "`).concat(e.name,`";
  children: `).concat(r,`;
}`)}function H5(e){var t=Iu(e.name);return"export type ".concat(t,` = {
  `).concat((0,Ws.default)(e.properties,function(r){return W5(r)}).join(`
  `),`
};`)}function W5(e){var t=q5(e.type);return"".concat(e.name).concat(e.optional?"?":"",": ").concat(t,"[];")}function K5(e,t){return"export interface ".concat(e,`<IN, OUT> extends ICstVisitor<IN, OUT> {
  `).concat((0,Ws.default)(t,function(r){return Y5(r)}).join(`
  `),`
}`)}function Y5(e){var t=Iu(e.name);return"".concat(e.name,"(children: ").concat(t,", param?: IN): OUT;")}function q5(e){if((0,U5.default)(e)){var t=(0,B5.default)((0,Ws.default)(e,function(n){return Oh(n)})),r=(0,F5.default)(t,function(n,a){return n+" | "+a});return"("+r+")"}else return Oh(e)}function Oh(e){return e.kind==="token"?"IToken":Yv(e.name)}function Yv(e){return(0,Kv.default)(e)+"CstNode"}function Iu(e){return(0,Kv.default)(e)+"CstChildren"}var Ho=Ae&&Ae.__assign||function(){return Ho=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Ho.apply(this,arguments)};Object.defineProperty(zs,"__esModule",{value:!0});zs.generateCstDts=void 0;var X5=Gs,j5=Hs,Q5={includeVisitorInterface:!0,visitorInterfaceName:"ICstNodeVisitor"};function Z5(e,t){var r=Ho(Ho({},Q5),t),n=(0,X5.buildModel)(e);return(0,j5.genDts)(n,r)}zs.generateCstDts=Z5;var Ks={};Object.defineProperty(Ks,"__esModule",{value:!0});Ks.createSyntaxDiagramsCode=void 0;var kh=Si;function J5(e,t){var r=t===void 0?{}:t,n=r.resourceBase,a=n===void 0?"https://unpkg.com/chevrotain@".concat(kh.VERSION,"/diagrams/"):n,i=r.css,s=i===void 0?"https://unpkg.com/chevrotain@".concat(kh.VERSION,"/diagrams/diagrams.css"):i,d=`
<!-- This is a generated file -->
<!DOCTYPE html>
<meta charset="utf-8">
<style>
  body {
    background-color: hsl(30, 20%, 95%)
  }
</style>

`,h=`
<link rel='stylesheet' href='`.concat(s,`'>
`),c=`
<script src='`.concat(a,`vendor/railroad-diagrams.js'><\/script>
<script src='`).concat(a,`src/diagrams_builder.js'><\/script>
<script src='`).concat(a,`src/diagrams_behavior.js'><\/script>
<script src='`).concat(a,`src/main.js'><\/script>
`),o=`
<div id="diagrams" align="center"></div>    
`,l=`
<script>
    window.serializedGrammar = `.concat(JSON.stringify(e,null,"  "),`;
<\/script>
`),u=`
<script>
    var diagramsDiv = document.getElementById("diagrams");
    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);
<\/script>
`;return d+h+c+o+l+u}Ks.createSyntaxDiagramsCode=J5;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Parser=e.createSyntaxDiagramsCode=e.clearCache=e.generateCstDts=e.GAstVisitor=e.serializeProduction=e.serializeGrammar=e.Terminal=e.Rule=e.RepetitionWithSeparator=e.RepetitionMandatoryWithSeparator=e.RepetitionMandatory=e.Repetition=e.Option=e.NonTerminal=e.Alternative=e.Alternation=e.defaultLexerErrorProvider=e.NoViableAltException=e.NotAllInputParsedException=e.MismatchedTokenException=e.isRecognitionException=e.EarlyExitException=e.defaultParserErrorProvider=e.tokenName=e.tokenMatcher=e.tokenLabel=e.EOF=e.createTokenInstance=e.createToken=e.LexerDefinitionErrorType=e.Lexer=e.EMPTY_ALT=e.ParserDefinitionErrorType=e.EmbeddedActionsParser=e.CstParser=e.VERSION=void 0;var t=Si;Object.defineProperty(e,"VERSION",{enumerable:!0,get:function(){return t.VERSION}});var r=ur;Object.defineProperty(e,"CstParser",{enumerable:!0,get:function(){return r.CstParser}}),Object.defineProperty(e,"EmbeddedActionsParser",{enumerable:!0,get:function(){return r.EmbeddedActionsParser}}),Object.defineProperty(e,"ParserDefinitionErrorType",{enumerable:!0,get:function(){return r.ParserDefinitionErrorType}}),Object.defineProperty(e,"EMPTY_ALT",{enumerable:!0,get:function(){return r.EMPTY_ALT}});var n=Ki;Object.defineProperty(e,"Lexer",{enumerable:!0,get:function(){return n.Lexer}}),Object.defineProperty(e,"LexerDefinitionErrorType",{enumerable:!0,get:function(){return n.LexerDefinitionErrorType}});var a=Xn;Object.defineProperty(e,"createToken",{enumerable:!0,get:function(){return a.createToken}}),Object.defineProperty(e,"createTokenInstance",{enumerable:!0,get:function(){return a.createTokenInstance}}),Object.defineProperty(e,"EOF",{enumerable:!0,get:function(){return a.EOF}}),Object.defineProperty(e,"tokenLabel",{enumerable:!0,get:function(){return a.tokenLabel}}),Object.defineProperty(e,"tokenMatcher",{enumerable:!0,get:function(){return a.tokenMatcher}}),Object.defineProperty(e,"tokenName",{enumerable:!0,get:function(){return a.tokenName}});var i=Xi;Object.defineProperty(e,"defaultParserErrorProvider",{enumerable:!0,get:function(){return i.defaultParserErrorProvider}});var s=Wt;Object.defineProperty(e,"EarlyExitException",{enumerable:!0,get:function(){return s.EarlyExitException}}),Object.defineProperty(e,"isRecognitionException",{enumerable:!0,get:function(){return s.isRecognitionException}}),Object.defineProperty(e,"MismatchedTokenException",{enumerable:!0,get:function(){return s.MismatchedTokenException}}),Object.defineProperty(e,"NotAllInputParsedException",{enumerable:!0,get:function(){return s.NotAllInputParsedException}}),Object.defineProperty(e,"NoViableAltException",{enumerable:!0,get:function(){return s.NoViableAltException}});var d=qi;Object.defineProperty(e,"defaultLexerErrorProvider",{enumerable:!0,get:function(){return d.defaultLexerErrorProvider}});var h=It;Object.defineProperty(e,"Alternation",{enumerable:!0,get:function(){return h.Alternation}}),Object.defineProperty(e,"Alternative",{enumerable:!0,get:function(){return h.Alternative}}),Object.defineProperty(e,"NonTerminal",{enumerable:!0,get:function(){return h.NonTerminal}}),Object.defineProperty(e,"Option",{enumerable:!0,get:function(){return h.Option}}),Object.defineProperty(e,"Repetition",{enumerable:!0,get:function(){return h.Repetition}}),Object.defineProperty(e,"RepetitionMandatory",{enumerable:!0,get:function(){return h.RepetitionMandatory}}),Object.defineProperty(e,"RepetitionMandatoryWithSeparator",{enumerable:!0,get:function(){return h.RepetitionMandatoryWithSeparator}}),Object.defineProperty(e,"RepetitionWithSeparator",{enumerable:!0,get:function(){return h.RepetitionWithSeparator}}),Object.defineProperty(e,"Rule",{enumerable:!0,get:function(){return h.Rule}}),Object.defineProperty(e,"Terminal",{enumerable:!0,get:function(){return h.Terminal}});var c=It;Object.defineProperty(e,"serializeGrammar",{enumerable:!0,get:function(){return c.serializeGrammar}}),Object.defineProperty(e,"serializeProduction",{enumerable:!0,get:function(){return c.serializeProduction}}),Object.defineProperty(e,"GAstVisitor",{enumerable:!0,get:function(){return c.GAstVisitor}});var o=zs;Object.defineProperty(e,"generateCstDts",{enumerable:!0,get:function(){return o.generateCstDts}});function l(){console.warn(`The clearCache function was 'soft' removed from the Chevrotain API.
	 It performs no action other than printing this message.
	 Please avoid using it as it will be completely removed in the future`)}e.clearCache=l;var u=Ks;Object.defineProperty(e,"createSyntaxDiagramsCode",{enumerable:!0,get:function(){return u.createSyntaxDiagramsCode}});var f=function(){function m(){throw new Error(`The Parser class has been deprecated, use CstParser or EmbeddedActionsParser instead.	
See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_7-0-0`)}return m}();e.Parser=f})(qg);var Xe=t_(qg);Xe.Alternation;Xe.Alternative;Xe.CstParser;Xe.EMPTY_ALT;Xe.EOF;Xe.EarlyExitException;const eU=Xe.EmbeddedActionsParser;Xe.GAstVisitor;const qv=Xe.Lexer;Xe.LexerDefinitionErrorType;Xe.MismatchedTokenException;Xe.NoViableAltException;Xe.NonTerminal;const tU=Xe.NotAllInputParsedException;Xe.Option;Xe.Parser;Xe.ParserDefinitionErrorType;Xe.Repetition;Xe.RepetitionMandatory;Xe.RepetitionMandatoryWithSeparator;Xe.RepetitionWithSeparator;Xe.Rule;Xe.Terminal;Xe.VERSION;Xe.clearCache;Xe.createSyntaxDiagramsCode;const Ye=Xe.createToken;Xe.createTokenInstance;Xe.defaultLexerErrorProvider;Xe.defaultParserErrorProvider;Xe.generateCstDts;Xe.isRecognitionException;Xe.serializeGrammar;Xe.serializeProduction;Xe.tokenLabel;Xe.tokenMatcher;Xe.tokenName;const Mu={},rU=Ye({name:"WhiteSpace",pattern:/\s+/,group:qv.SKIPPED}),nU=Ye({name:"String",pattern:/"(""|[^"])*"/}),aU=Ye({name:"SingleQuotedString",pattern:/'(''|[^'])*'/}),iU=Ye({name:"SheetQuoted",pattern:/'((?![\\/[\]*?:]).)+?'!/}),oU=Ye({name:"Function",pattern:/[A-Za-z_]+[A-Za-z_0-9.]*\(/}),sU=Ye({name:"FormulaErrorT",pattern:/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A/}),lU=Ye({name:"RefError",pattern:/#REF!/}),Pu=Ye({name:"Name",pattern:/[a-zA-Z_][a-zA-Z0-9_.?]*/}),cU=Ye({name:"Sheet",pattern:/[A-Za-z_.\d\u007F-\uFFFF]+!/}),uU=Ye({name:"Cell",pattern:/[$]?[A-Za-z]{1,3}[$]?[1-9][0-9]*/,longer_alt:Pu}),dU=Ye({name:"Number",pattern:/[0-9]+[.]?[0-9]*([eE][+-][0-9]+)?/}),fU=Ye({name:"Boolean",pattern:/TRUE|FALSE/i}),hU=Ye({name:"Column",pattern:/[$]?[A-Za-z]{1,3}/,longer_alt:Pu}),pU=Ye({name:"At",pattern:/@/}),gU=Ye({name:"Comma",pattern:/,/}),mU=Ye({name:"Colon",pattern:/:/}),vU=Ye({name:"Semicolon",pattern:/;/}),bU=Ye({name:"OpenParen",pattern:/\(/}),yU=Ye({name:"CloseParen",pattern:/\)/}),EU=Ye({name:"OpenSquareParen",pattern:/\[/}),wU=Ye({name:"CloseSquareParen",pattern:/]/}),_U=Ye({name:"exclamationMark",pattern:/!/}),NU=Ye({name:"OpenCurlyParen",pattern:/{/}),AU=Ye({name:"CloseCurlyParen",pattern:/}/}),CU=Ye({name:"QuoteS",pattern:/'/}),Ih=Ye({name:"MulOp",pattern:/\*/}),xU=Ye({name:"PlusOp",pattern:/\+/}),TU=Ye({name:"DivOp",pattern:/\//}),RU=Ye({name:"MinOp",pattern:/-/}),OU=Ye({name:"ConcatOp",pattern:/&/}),kU=Ye({name:"ExOp",pattern:/\^/}),IU=Ye({name:"PercentOp",pattern:/%/}),MU=Ye({name:"GtOp",pattern:/>/}),PU=Ye({name:"EqOp",pattern:/=/}),SU=Ye({name:"LtOp",pattern:/</}),LU=Ye({name:"NeqOp",pattern:/<>/}),$U=Ye({name:"GteOp",pattern:/>=/}),DU=Ye({name:"LteOp",pattern:/<=/}),Su=[rU,nU,iU,aU,oU,sU,lU,cU,uU,fU,hU,Pu,dU,pU,gU,mU,vU,bU,yU,EU,wU,_U,NU,AU,CU,Ih,xU,TU,RU,OU,kU,Ih,IU,LU,$U,DU,MU,PU,SU],UU=new qv(Su,{ensureOptimizations:!0});Su.forEach(e=>{Mu[e.name]=e});const dc=e=>{const t=UU.tokenize(e);if(t.errors.length>0){const r=t.errors[0],n=r.line,a=r.column;let i=`
${e.split(`
`)[n-1]}
`;i+=`${Array(a-1).fill(" ").join("")}^
`;const s={message:`${i}Error at position ${n}:${a}
${r.message}`,errorLocation:{line:n,column:a}};throw M.ERROR(r.message,s)}return t},{String:Mh,SheetQuoted:FU,Function:BU,FormulaErrorT:Ph,RefError:Sh,Cell:VU,Sheet:zU,Name:GU,Number:Lh,Boolean:$h,Column:HU,At:r8,Comma:bo,Colon:WU,Semicolon:KU,OpenParen:YU,CloseParen:Dh,OpenSquareParen:n8,CloseSquareParen:a8,ExclamationMark:i8,OpenCurlyParen:qU,CloseCurlyParen:XU,MulOp:jU,PlusOp:Nl,DivOp:QU,MinOp:Al,ConcatOp:ZU,ExOp:JU,PercentOp:eF,NeqOp:tF,GteOp:rF,LteOp:nF,GtOp:aF,EqOp:iF,LtOp:oF}=Mu;class Xv extends eU{constructor(r,n){super(Mu,{maxLookahead:1,skipValidations:!0});le(this,"utils");le(this,"binaryOperatorsPrecedence");le(this,"formulaWithPercentOp");le(this,"formulaWithUnaryOp");le(this,"formulaWithIntersect");le(this,"formulaWithRange");le(this,"formula");le(this,"referenceWithoutInfix");le(this,"paren");le(this,"constant");le(this,"functionCall");le(this,"constantArray");le(this,"formulaWithBinaryOp");le(this,"constantForArray");le(this,"plusMinusOp");le(this,"arguments");le(this,"referenceItem");le(this,"prefixName");le(this,"c1");this.utils=n,this.binaryOperatorsPrecedence=[["^"],["*","/"],["+","-"],["&"],["<",">","=","<>","<=",">="]];const a=this;a.RULE("formulaWithBinaryOp",()=>{const i=[],s=[a.SUBRULE(a.formulaWithPercentOp)];return a.MANY(()=>{i.push(a.OR(a.c1||(a.c1=[{ALT:()=>a.CONSUME(aF).image},{ALT:()=>a.CONSUME(iF).image},{ALT:()=>a.CONSUME(oF).image},{ALT:()=>a.CONSUME(tF).image},{ALT:()=>a.CONSUME(rF).image},{ALT:()=>a.CONSUME(nF).image},{ALT:()=>a.CONSUME(ZU).image},{ALT:()=>a.CONSUME(Nl).image},{ALT:()=>a.CONSUME(Al).image},{ALT:()=>a.CONSUME(jU).image},{ALT:()=>a.CONSUME(QU).image},{ALT:()=>a.CONSUME(JU).image}]))),s.push(a.SUBRULE2(a.formulaWithPercentOp))}),a.ACTION(()=>{for(const d of this.binaryOperatorsPrecedence)for(let h=0,c=i.length;h<c;h++){const o=i[h];!d.includes(o)||(i.splice(h,1),s.splice(h,2,this.utils.applyInfix(s[h],o,s[h+1])),h--,c--)}}),s[0]}),a.RULE("plusMinusOp",()=>a.OR([{ALT:()=>a.CONSUME(Nl).image},{ALT:()=>a.CONSUME(Al).image}])),a.RULE("formulaWithPercentOp",()=>{let i=a.SUBRULE(a.formulaWithUnaryOp);return a.OPTION(()=>{const s=a.CONSUME(eF).image;i=a.ACTION(()=>this.utils.applyPostfix(i,s))}),i}),a.RULE("formulaWithUnaryOp",()=>{const i=[];a.MANY(()=>{const d=a.OR([{ALT:()=>a.CONSUME(Nl).image},{ALT:()=>a.CONSUME(Al).image}]);i.push(d)});const s=a.SUBRULE(a.formulaWithIntersect);return i.length>0?a.ACTION(()=>this.utils.applyPrefix(i,s)):s}),a.RULE("formulaWithIntersect",()=>{const i=a.SUBRULE(a.formulaWithRange),s=[i];return a.MANY({GATE:()=>{const d=a.LA(0);return a.LA(1).startOffset>d.endOffset+1},DEF:()=>{s.push(a.SUBRULE3(a.formulaWithRange))}}),s.length>1?a.ACTION(()=>a.ACTION(()=>this.utils.applyIntersect(s))):i}),a.RULE("formulaWithRange",()=>{const i=a.SUBRULE(a.formula),s=[i];return a.MANY(()=>{a.CONSUME(WU),s.push(a.SUBRULE2(a.formula))}),s.length>1?a.ACTION(()=>a.ACTION(()=>this.utils.applyRange(s))):i}),a.RULE("formula",()=>a.OR9([{ALT:()=>a.SUBRULE(a.referenceWithoutInfix)},{ALT:()=>a.SUBRULE(a.paren)},{ALT:()=>a.SUBRULE(a.constant)},{ALT:()=>a.SUBRULE(a.functionCall)},{ALT:()=>a.SUBRULE(a.constantArray)}])),a.RULE("paren",()=>{a.CONSUME(YU);let i;const s=[];return s.push(a.SUBRULE(a.formulaWithBinaryOp)),a.MANY(()=>{a.CONSUME(bo),s.push(a.SUBRULE2(a.formulaWithBinaryOp))}),s.length>1?i=a.ACTION(()=>this.utils.applyUnion(s)):i=s[0],a.CONSUME(Dh),i}),a.RULE("constantArray",()=>{const i=[[]];let s=0;return a.CONSUME(qU),i[s].push(a.SUBRULE(a.constantForArray)),a.MANY(()=>{const d=a.OR([{ALT:()=>a.CONSUME(bo).image},{ALT:()=>a.CONSUME(KU).image}]),h=a.SUBRULE2(a.constantForArray);d===","||(s++,i[s]=[]),i[s].push(h)}),a.CONSUME(XU),a.ACTION(()=>this.utils.toArray(i))}),a.RULE("constantForArray",()=>a.OR([{ALT:()=>{const i=a.OPTION(()=>a.SUBRULE(a.plusMinusOp)),s=a.CONSUME(Lh).image,d=a.ACTION(()=>this.utils.toNumber(s));return i?a.ACTION(()=>this.utils.applyPrefix([i],d)):d}},{ALT:()=>{const i=a.CONSUME(Mh).image;return a.ACTION(()=>this.utils.toString(i))}},{ALT:()=>{const i=a.CONSUME($h).image;return a.ACTION(()=>this.utils.toBoolean(i))}},{ALT:()=>{const i=a.CONSUME(Ph).image;return a.ACTION(()=>this.utils.toError(i))}},{ALT:()=>{const i=a.CONSUME(Sh).image;return a.ACTION(()=>this.utils.toError(i))}}])),a.RULE("constant",()=>a.OR([{ALT:()=>{const i=a.CONSUME(Lh).image;return a.ACTION(()=>this.utils.toNumber(i))}},{ALT:()=>{const i=a.CONSUME(Mh).image;return a.ACTION(()=>this.utils.toString(i))}},{ALT:()=>{const i=a.CONSUME($h).image;return a.ACTION(()=>this.utils.toBoolean(i))}},{ALT:()=>{const i=a.CONSUME(Ph).image;return a.ACTION(()=>this.utils.toError(i))}}])),a.RULE("functionCall",()=>{const i=a.CONSUME(BU).image.slice(0,-1),s=a.SUBRULE(a.arguments);return a.CONSUME(Dh),a.ACTION(()=>r.callFunction(i,s))}),a.RULE("arguments",()=>{a.MANY2(()=>{a.CONSUME2(bo)});const i=[];return a.OPTION(()=>{i.push(a.SUBRULE(a.formulaWithBinaryOp)),a.MANY(()=>{a.CONSUME1(bo),i.push(null),a.OPTION3(()=>{i.pop(),i.push(a.SUBRULE2(a.formulaWithBinaryOp))})})}),i}),a.RULE("referenceWithoutInfix",()=>a.OR([{ALT:()=>a.SUBRULE(a.referenceItem)},{ALT:()=>{const i=a.SUBRULE(a.prefixName),s=a.SUBRULE2(a.formulaWithRange);return a.ACTION(()=>{if(this.utils.isFormulaError(s))return s;s.ref.sheet=i}),s}}])),a.RULE("referenceItem",()=>a.OR([{ALT:()=>{const i=a.CONSUME(VU).image;return a.ACTION(()=>this.utils.parseCellAddress(i))}},{ALT:()=>{const i=a.CONSUME(GU).image;return a.ACTION(()=>r.getVariable(i))}},{ALT:()=>{const i=a.CONSUME(HU).image;return a.ACTION(()=>this.utils.parseCol(i))}},{ALT:()=>{const i=a.CONSUME(Sh).image;return a.ACTION(()=>this.utils.toError(i))}}])),a.RULE("prefixName",()=>a.OR([{ALT:()=>a.CONSUME(zU).image.slice(0,-1)},{ALT:()=>a.CONSUME(FU).image.slice(1,-2).replace(/''/g,"'")}])),this.performSelfAnalysis()}}const Uh=1048576,Fh=16384;class Ro{constructor(t){le(this,"context");le(this,"columnNameToNumber",t=>zn.columnNameToNumber(t));le(this,"parseRow",t=>{const r=+t;if(!Number.isInteger(r))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+t}}});le(this,"parseRowRange",(t,r)=>({ref:{from:{col:null,row:Math.min(t,r)},to:{col:null,row:Math.max(t,r)}}}));le(this,"toArray",t=>t);le(this,"toNumber",t=>Number(t));le(this,"toString",t=>t.substring(1,t.length-1).replace(/""/g,'"'));le(this,"toBoolean",t=>t==="TRUE");le(this,"toError",t=>new M(t.toUpperCase()));le(this,"isFormulaError",t=>t instanceof M);this.context=t}parseCellAddress(t){const r=t.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{address:r[0],col:this.columnNameToNumber(r[2]),row:+r[4]}}}parseCol(t){return{ref:{col:this.columnNameToNumber(t),row:void 0}}}parseColRange(t,r){return t=this.columnNameToNumber(t),r=this.columnNameToNumber(r),{ref:{from:{col:Math.min(t,r),row:null},to:{col:Math.max(t,r),row:null}}}}_applyPrefix(t,r,n){return this.isFormulaError(r)?r:y_.unaryOp(t,r,n)}async applyPrefixAsync(t,r){const{val:n,isArray:a}=this.extractRefValue(await r);return this._applyPrefix(t,n,a)}applyPrefix(t,r){if(this.context.async)return this.applyPrefixAsync(t,r);const{val:n,isArray:a}=this.extractRefValue(r);return this._applyPrefix(t,n,a)}_applyPostfix(t,r,n){return this.isFormulaError(t)?t:E_.percentOp(t,n,r)}async applyPostfixAsync(t,r){const{val:n,isArray:a}=this.extractRefValue(await t);return this._applyPostfix(n,a,r)}applyPostfix(t,r){if(this.context.async)return this.applyPostfixAsync(t,r);const{val:n,isArray:a}=this.extractRefValue(t);return this._applyPostfix(n,a,r)}_applyInfix(t,r,n){const a=t.val,i=t.isArray,s=n.val,d=n.isArray;if(this.isFormulaError(a))return a;if(this.isFormulaError(s))return s;if(ul.compareOp.includes(r))return va.compareOp(a,r,s,i,d);if(ul.concatOp.includes(r))return va.concatOp(a,r,s,i,d);if(ul.mathOp.includes(r))return va.mathOp(a,r,s,i,d);throw new Error(`Unrecognized infix: ${r}`)}async applyInfixAsync(t,r,n){const a=this.extractRefValue(await t),i=this.extractRefValue(await n);return this._applyInfix(a,r,i)}applyInfix(t,r,n){if(this.context.async)return this.applyInfixAsync(t,r,n);const a=this.extractRefValue(t),i=this.extractRefValue(n);return this._applyInfix(a,r,i)}applyIntersect(t){if(this.isFormulaError(t[0]))return t[0];if(!t[0].ref)throw Error(`Expecting a reference, but got ${t[0]}.`);let r,n,a,i,s;const d=t.shift().ref,h=d.sheet;if(d.from)r=Math.max(d.from.row,d.to.row),a=Math.min(d.from.row,d.to.row),n=Math.max(d.from.col,d.to.col),i=Math.min(d.from.col,d.to.col);else{if(d.row===void 0||d.col===void 0)throw Error("Cannot intersect the whole row or column.");r=a=d.row,n=i=d.col}let c;return t.forEach(o=>{if(this.isFormulaError(o))return o;if(o=o.ref,!o)throw Error(`Expecting a reference, but got ${o}.`);if(o.from){const l=Math.max(o.from.row,o.to.row),u=Math.min(o.from.row,o.to.row),f=Math.max(o.from.col,o.to.col),m=Math.min(o.from.col,o.to.col);(u>r||l<a||m>n||f<i||h!==o.sheet)&&(c=M.NULL),r=Math.min(r,l),a=Math.max(a,u),n=Math.min(n,f),i=Math.max(i,m)}else{if(o.row===void 0||o.col===void 0)throw Error("Cannot intersect the whole row or column.");(o.row>r||o.row<a||o.col>n||o.col<i||h!==o.sheet)&&(c=M.NULL),r=a=o.row,n=i=o.col}}),c||(r===a&&n===i?s={ref:{sheet:h,row:r,col:n}}:s={ref:{sheet:h,from:{row:a,col:i},to:{row:r,col:n}}},s.ref.sheet||delete s.ref.sheet,s)}applyUnion(t){const r=new Vn;for(let n=0;n<t.length;n++){if(this.isFormulaError(t[n]))return t[n];r.add(this.extractRefValue(t[n]).val,t[n])}return r}applyRange(t){let r,n=-1,a=-1,i=Uh+1,s=Fh+1;return t.forEach(d=>{if(this.isFormulaError(d))return d;typeof d=="number"&&(d=this.parseRow(d)),d=d.ref,d.row===void 0&&(i=1,n=Uh),d.col===void 0&&(s=1,a=Fh),d.row>n&&(n=d.row),d.row<i&&(i=d.row),d.col>a&&(a=d.col),d.col<s&&(s=d.col)}),n===i&&a===s?r={ref:{row:n,col:a}}:r={ref:{from:{row:i,col:s},to:{row:n,col:a}}},r}extractRefValue(t){const r=t;let n=!1;return Array.isArray(r)&&(n=!0),t.ref?{val:this.context.retrieveRef(t),isArray:n}:{val:r,isArray:n}}static formatChevrotainError(t,r){let n,a,i="";return t instanceof tU?(n=t.token.startLine,a=t.token.startColumn):(n=t.previousToken.startLine,a=t.previousToken.startColumn+1),i+=`
${r.split(`
`)[n-1]}
`,i+=`${Array(a-1).fill(" ").join("")}^
`,i+=`Error at position ${n}:${a}
${t.message}`,t.errorLocation={line:n,column:a},M.ERROR(i,t)}}class sF{constructor(t,r=!1){le(this,"logs");le(this,"isTest");le(this,"utils");le(this,"onVariable");le(this,"functions");le(this,"onRange");le(this,"onCell");le(this,"funsNullAs0");le(this,"funsNeedContextAndNoDataRetrieve");le(this,"funsNeedContext");le(this,"funsPreserveRef");le(this,"parser");le(this,"position");le(this,"async");this.logs=[],this.isTest=r,this.utils=new Ro(this),t=ct({functions:{},functionsNeedContext:{},onVariable:()=>null,onCell:()=>0,onRange:()=>[[0]]},t),this.onVariable=t.onVariable,this.functions=ct(ct(ct(ct(ct(ct(ct(ct(ct(ct(ct(ct({},gn),Jl),cf),lf),Ke),sf),Pt),Lt),of),O_),t.functions),t.functionsNeedContext),this.onRange=t.onRange,this.onCell=t.onCell,this.funsNullAs0=Object.keys(gn).concat(Object.keys(Ke)).concat(Object.keys(Lt)).concat(Object.keys(sf)).concat(Object.keys(lf)).concat(Object.keys(Jl)).concat(Object.keys(of)),this.funsNeedContextAndNoDataRetrieve=["ROW","ROWS","COLUMN","COLUMNS","SUMIF","INDEX","AVERAGEIF","IF"],this.funsNeedContext=[...Object.keys(t.functionsNeedContext),...this.funsNeedContextAndNoDataRetrieve,"INDEX","OFFSET","INDIRECT","IF","CHOOSE","WEBSERVICE"],this.funsPreserveRef=Object.keys(cf),this.parser=new Xv(this,this.utils)}static get allTokens(){return Su}getCell(t){return t.sheet==null&&(t.sheet=this.position?this.position.sheet:void 0),this.onCell(t)}getRange(t){return t.sheet==null&&(t.sheet=this.position?this.position.sheet:void 0),this.onRange(t)}getVariable(t){const r={ref:this.onVariable(t,this.position.sheet,this.position)};return r.ref==null?M.NAME:r}retrieveRef(t){return Et.isRangeRef(t)?this.getRange(t.ref):Et.isCellRef(t)?this.getCell(t.ref):t}_callFunction(t,r){t.indexOf("_xlfn.")===0&&(t=t.slice(6)),t=t.toUpperCase();const n=this.funsNullAs0.includes(t)?0:"";if(this.funsNeedContextAndNoDataRetrieve.includes(t)||(r=r.map(a=>{if(a===null)return{value:n,isArray:!1,omitted:!0};const i=this.utils.extractRefValue(a);return this.funsPreserveRef.includes(t)?{value:i.val,isArray:i.isArray,ref:a.ref}:{value:i.val,isArray:i.isArray,isRangeRef:!!Et.isRangeRef(a),isCellRef:!!Et.isCellRef(a)}})),this.functions[t]){let a;try{!this.funsNeedContextAndNoDataRetrieve.includes(t)&&!this.funsNeedContext.includes(t)?a=this.functions[t](...r):a=this.functions[t](this,...r)}catch(i){if(i instanceof M)return i;throw i}if(a===void 0){if(this.isTest)return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}};throw M.NOT_IMPLEMENTED(t)}return a}if(this.isTest)return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}};throw M.NOT_IMPLEMENTED(t)}async callFunctionAsync(t,r){const n=[];for(const i of r)n.push(await i);const a=await this._callFunction(t,n);return Et.checkFunctionResult(a)}callFunction(t,r){if(this.async)return this.callFunctionAsync(t,r);const n=this._callFunction(t,r);return Et.checkFunctionResult(n)}supportedFunctions(){const t=[];return Object.keys(this.functions).forEach(n=>{try{if(this.functions[n](0,0,0,0,0,0,0,0,0,0,0)===void 0)return;t.push(n)}catch(a){a instanceof Error&&t.push(n)}}),t.sort()}checkFormulaResult(t,r=!1){const n=typeof t;if(n==="number"){if(isNaN(t))return M.VALUE;if(!isFinite(t))return M.NUM;t+=0}else if(n==="object"){if(t instanceof M)return t;if(r){if(t.ref&&(t=this.retrieveRef(t)),typeof t=="object"&&!Array.isArray(t)&&t!=null)return M.VALUE}else if(t.ref&&t.ref.row&&!t.ref.from)t=this.retrieveRef(t);else if(t.ref&&t.ref.from&&t.ref.from.col===t.ref.to.col)t=this.retrieveRef({ref:{row:t.ref.from.row,col:t.ref.from.col}});else if(Array.isArray(t))t=t[0][0];else return M.VALUE}return t}parse(t,r,n=!1){if(t.length===0)throw Error("Input must not be empty.");this.position=r,this.async=!1;const a=dc(t);this.parser.input=a.tokens;let i;try{if(i=this.parser.formulaWithBinaryOp(),i=this.checkFormulaResult(i,n),i instanceof M)return i}catch(s){throw M.ERROR(s.message,s)}if(this.parser.errors.length>0){const s=this.parser.errors[0];throw Ro.formatChevrotainError(s,t)}return i}async parseAsync(t,r,n=!1){if(t.length===0)throw Error("Input must not be empty.");this.position=r,this.async=!0;const a=dc(t);this.parser.input=a.tokens;let i;try{if(i=await this.parser.formulaWithBinaryOp(),i=this.checkFormulaResult(i,n),i instanceof M)return i}catch(s){throw M.ERROR(s.message,s)}if(this.parser.errors.length>0){const s=this.parser.errors[0];throw Ro.formatChevrotainError(s,t)}return i}}const Bh=1048576,Vh=16384;class zh{constructor(t){le(this,"context");le(this,"columnNameToNumber",t=>zn.columnNameToNumber(t));le(this,"parseRow",t=>{const r=+t;if(!Number.isInteger(r))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+t}}});le(this,"toArray",t=>t);le(this,"toNumber",t=>Number(t));le(this,"toString",t=>t.substring(1,t.length-1).replace(/""/g,'"'));le(this,"toBoolean",t=>t==="TRUE");le(this,"toError",t=>new M(t.toUpperCase()));le(this,"isFormulaError",t=>t instanceof M);this.context=t}parseCellAddress(t){const r=t.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{col:this.columnNameToNumber(r[2]),row:+r[4]}}}parseCol(t){return{ref:{col:this.columnNameToNumber(t),row:void 0}}}applyPrefix(t,r){return this.extractRefValue(r),0}applyPostfix(t,r){return this.extractRefValue(t),0}applyInfix(t,r,n){return this.extractRefValue(t),this.extractRefValue(n),0}applyIntersect(t){if(this.isFormulaError(t[0]))return t[0];if(!t[0].ref)throw Error(`Expecting a reference, but got ${t[0]}.`);let r,n,a,i,s;const d=t.shift().ref,h=d.sheet;if(d.from)r=Math.max(d.from.row,d.to.row),a=Math.min(d.from.row,d.to.row),n=Math.max(d.from.col,d.to.col),i=Math.min(d.from.col,d.to.col);else{if(d.row===void 0||d.col===void 0)throw Error("Cannot intersect the whole row or column.");r=a=d.row,n=i=d.col}let c;return t.forEach(o=>{if(this.isFormulaError(o))return o;if(o=o.ref,!o)throw Error(`Expecting a reference, but got ${o}.`);if(o.from){const l=Math.max(o.from.row,o.to.row),u=Math.min(o.from.row,o.to.row),f=Math.max(o.from.col,o.to.col),m=Math.min(o.from.col,o.to.col);(u>r||l<a||m>n||f<i||h!==o.sheet)&&(c=M.NULL),r=Math.min(r,l),a=Math.max(a,u),n=Math.min(n,f),i=Math.max(i,m)}else{if(o.row===void 0||o.col===void 0)throw Error("Cannot intersect the whole row or column.");(o.row>r||o.row<a||o.col>n||o.col<i||h!==o.sheet)&&(c=M.NULL),r=a=o.row,n=i=o.col}}),c||(r===a&&n===i?s={ref:{sheet:h,row:r,col:n}}:s={ref:{sheet:h,from:{row:a,col:i},to:{row:r,col:n}}},s.ref.sheet||delete s.ref.sheet,s)}applyUnion(t){const r=new Vn;for(let n=0;n<t.length;n++){if(this.isFormulaError(t[n]))return t[n];r.add(this.extractRefValue(t[n]).val,t[n])}return r}applyRange(t){let r,n=-1,a=-1,i=Bh+1,s=Vh+1;return t.forEach(d=>{if(this.isFormulaError(d))return d;typeof d=="number"&&(d=this.parseRow(d)),d=d.ref,d.row===void 0&&(i=1,n=Bh),d.col===void 0&&(s=1,a=Vh),d.row>n&&(n=d.row),d.row<i&&(i=d.row),d.col>a&&(a=d.col),d.col<s&&(s=d.col)}),n===i&&a===s?r={ref:{row:n,col:a}}:r={ref:{from:{row:i,col:s},to:{row:n,col:a}}},r}extractRefValue(t){const r=Array.isArray(t);return t.ref?{val:this.context.retrieveRef(t),isArray:r}:{val:t,isArray:r}}}class lF{constructor(t){le(this,"data");le(this,"utils");le(this,"onVariable");le(this,"functions");le(this,"parser");le(this,"position");this.data=[],this.utils=new zh(this),t=ct({onVariable:()=>null},t),this.utils=new zh(this),this.onVariable=t.onVariable,this.functions={},this.parser=new Xv(this,this.utils)}getCell(t){return t.row!=null&&(t.sheet==null&&(t.sheet=this.position?this.position.sheet:void 0),this.data.findIndex(n=>n.from&&n.from.row<=t.row&&n.to.row>=t.row&&n.from.col<=t.col&&n.to.col>=t.col||n.row===t.row&&n.col===t.col&&n.sheet===t.sheet)===-1&&this.data.push(t)),0}getRange(t){return t.from.row!=null&&(t.sheet==null&&(t.sheet=this.position?this.position.sheet:void 0),this.data.findIndex(n=>n.from&&n.from.row===t.from.row&&n.from.col===t.from.col&&n.to.row===t.to.row&&n.to.col===t.to.col)===-1&&this.data.push(t)),[[0]]}getVariable(t){const r={ref:this.onVariable(t,this.position.sheet)};return r.ref==null?M.NAME:(Et.isCellRef(r)?this.getCell(r.ref):this.getRange(r.ref),0)}retrieveRef(t){return Et.isRangeRef(t)?this.getRange(t.ref):Et.isCellRef(t)?this.getCell(t.ref):t}callFunction(t,r){return r.forEach(n=>{n!=null&&this.retrieveRef(n)}),{value:0,ref:{}}}checkFormulaResult(t){this.retrieveRef(t)}parse(t,r,n=!1){if(t.length===0)throw Error("Input must not be empty.");this.data=[],this.position=r;const a=dc(t);this.parser.input=a.tokens;try{const i=this.parser.formulaWithBinaryOp();this.checkFormulaResult(i)}catch(i){if(!n)throw M.ERROR(i.message,i)}if(this.parser.errors.length>0&&!n){const i=this.parser.errors[0];throw Ro.formatChevrotainError(i,t)}return this.data}}class kn{constructor(t,r,n,a,i,s,d,h,c,o,l,u,f,m,g,b,v,w,y,_,T,A,x,C,N,P,z){le(this,"r");le(this,"c");le(this,"rs");le(this,"cs");le(this,"fd");le(this,"v");le(this,"mv");le(this,"s");le(this,"se");le(this,"t");le(this,"fs");le(this,"ff");le(this,"bl");le(this,"it");le(this,"ol");le(this,"cl");le(this,"ul");le(this,"bg");le(this,"bgt");le(this,"fc");le(this,"bdt");le(this,"bdb");le(this,"bdl");le(this,"bdr");le(this,"av");le(this,"ah");le(this,"cf");Object.assign(this,{r:t,c:r,v:n,mv:a,fd:i,s,se:d,t:h,rs:c,cs:o,fs:l,ff:u,bl:f,it:m,ol:g,cl:b,ul:v,bg:w,bgt:y,fc:_,bdt:T,bdb:A,bdl:x,bdr:C,av:N,ah:P,cf:z})}}var cF={id:String,editable:{type:Boolean,default:!0},type:{type:String,default:"primary"},size:{type:String,default:"normal"},border:{type:String,default:"full"},data:Array,alignH:{type:String,default:"center"},alignV:{type:String,default:"center"},minDimensions:{type:Array,default:[10,10]},resizeColumn:{type:Boolean,default:!0},resizeRow:{type:Boolean,default:!0},gridRowHeight:{type:Number},gridColumnWidth:{type:Number},loading:{type:Boolean,default:!1},functions:{type:Object,default:null},scrollY:{type:Object,default:{enable:!0,gt:60,oSize:0}}};let Gh;const ca=[],uF=500;function dF(){ca.length&&(ca.forEach(e=>{e.targetList.forEach(t=>{const{target:r,width:n,height:a}=t,i=r.clientWidth,s=r.clientHeight;(i&&n!==i||s&&a!==s)&&(t.width=i,t.height=s,setTimeout(e.callback))})}),jv())}function jv(){clearTimeout(Gh),Gh=setTimeout(dF,uF)}class fF{constructor(t){le(this,"targetList",[]);le(this,"callback");this.callback=t}observe(t){if(t){const{targetList:r}=this;r.some(n=>n.target===t)||r.push({target:t,width:t.clientWidth,height:t.clientHeight}),ca.length||jv(),ca.some(n=>n===this)||ca.push(this)}}disconnect(){ca.length=0}}function Hh(e){return window.ResizeObserver?new window.ResizeObserver(e):new fF(e)}class ri{constructor(t,r,n,a,i,s,d,h){le(this,"index");le(this,"type");le(this,"width");le(this,"renderWidth");le(this,"minWidth");le(this,"visible");le(this,"fixed");le(this,"fixedType");Object.assign(this,{index:t,type:r,width:n,renderWidth:a,minWidth:i,visible:s,fixed:d,fixedType:h})}}class yo{constructor(t,r,n,a,i,s,d,h){le(this,"index");le(this,"type");le(this,"height");le(this,"renderHeight");le(this,"minHeight");le(this,"visible");le(this,"fixed");le(this,"fixedType");Object.assign(this,{index:t,type:r,height:n,renderHeight:a,minHeight:i,visible:s,fixed:d,fixedType:h})}}class hF{constructor(t){le(this,"_marked");le(this,"_edgeTo");le(this,"_cycle",[]);le(this,"_onStack");le(this,"dfs",(t,r)=>{this._marked[r]=!0,this._onStack[r]=!0,t.adj.get(r)&&t.adj.get(r).forEach(n=>{if(this._cycle===null||this._cycle===void 0||this._cycle.length===0){if(!this._marked[n])this._edgeTo[n]=r,this.dfs(t,n);else if(this._onStack[n]){for(let a=r;a!==n;a=this._edgeTo[a])this._cycle.push(a);this._cycle.push(n),this._cycle.push(r)}}}),this._onStack[r]=!1});le(this,"hasCycle",()=>this._cycle!==null&&this._cycle!==void 0&&this._cycle.length>0);this._marked=Array.from({length:t.v}),this._edgeTo=Array.from({length:t.v}),this._onStack=Array.from({length:t.v});for(let r=0;r<t.v;r++)this._marked[r]||this.dfs(t,r)}get onStack(){return this._onStack}set onStack(t){this._onStack=t}get cycle(){return this._cycle}set cycle(t){this._cycle=t}get edgeTo(){return this._edgeTo}set edgeTo(t){this._edgeTo=t}get marked(){return this._marked}set marked(t){this._marked=t}}class Eo{constructor(t,r,n,a){this.data=t,this.prev=r,this.next=n,this.list=a}get value(){return this.data}get index(){if(!!this.list)return this.list.findIndex(t=>t===this.value)}insertBefore(t){return this.list!==null?this.list.insertBefore(this,t):new pr(t,this.data)}insertAfter(t){return this.list!==null?this.list.insertAfter(this,t):new pr(this.data,t)}remove(){if(this.list===null)throw new ReferenceError("Node does not belong to any list");return this.list.removeNode(this)}}class pr{constructor(...t){le(this,"head");le(this,"tail");le(this,"size");this.head=null,this.tail=null,this.size=0;for(let r=0;r<t.length;r++)this.append(t[r])}get length(){return this.size}static from(t){return new pr(...t)}get(t){const r=this.getNode(t);return r!==void 0?r.data:void 0}getNode(t){if(this.head===null||t<0||t>=this.length)return;const r=t<this.length/2,n=r?t:this.length-t-1,a=r?"next":"prev";let i=r?this.head:this.tail;for(let s=0;s<n;s++)i=i[a];return i}findNodeIndex(t){let r=0,n=this.head;for(;n;){if(t(n.data,r,this))return{index:r,node:n};n=n.next,r+=1}}findNode(t){const r=this.findNodeIndex(t);return r!==void 0?r.node:void 0}find(t){const r=this.findNodeIndex(t);return r!==void 0?r.node.data:void 0}findIndex(t){const r=this.findNodeIndex(t);return r!==void 0?r.index:-1}append(...t){for(const r of t){const n=new Eo(r,this.tail,null,this);this.head===null&&(this.head=n),this.tail!==null&&(this.tail.next=n),this.tail=n,this.size+=1}return this}push(...t){return this.append(...t),this.length}prepend(...t){const r=Array.from(t).reverse();for(const n of r){const a=new Eo(n,null,this.head,this);this.tail===null&&(this.tail=a),this.head!==null&&(this.head.prev=a),this.head=a,this.size+=1}return this}insertAt(t,r){if(this.head===null)return this.append(r);if(t<=0)return this.prepend(r);let n=this.head,a=0;for(;a<t-1&&n.next!==null;)a+=1,n=n.next;return n.insertAfter(r),this}removeNode(t){if(t.list!==this)throw new ReferenceError("Node does not belong to this list");return t.prev!==null&&(t.prev.next=t.next),t.next!==null&&(t.next.prev=t.prev),this.head===t&&(this.head=t.next),this.tail===t&&(this.tail=t.prev),this.size-=1,t.next=null,t.prev=null,t.list=null,t}removeAt(t){const r=this.getNode(t);return r!==void 0?this.removeNode(r):void 0}insertBefore(t,r){const n=new Eo(r,t.prev,t,this);return t.prev===null&&(this.head=n),t.prev!==null&&(t.prev.next=n),t.prev=n,this.size+=1,this}sort(t){if(this.head===null||this.tail===null)return this;if(this.length<2)return this;const r=(n,a)=>{if(n===a)return;const i=a.data;let s=n,d=n;for(;s&&s!==a;){if(t(s.data,i)){if(s!==d){const c=d.data;d.data=s.data,s.data=c}d=d.next}s=s.next}a.data=d.data,d.data=i,n.next!==a.prev&&(d.prev&&d!==n&&r(n,d.prev),d.next&&d!==a&&r(d.next,a))};return r(this.head,this.tail),this}insertAfter(t,r){const n=new Eo(r,t,t.next,this);return t.next===null&&(this.tail=n),t.next!==null&&(t.next.prev=n),t.next=n,this.size+=1,this}shift(){return this.removeFromAnyEnd(this.head)}pop(){return this.removeFromAnyEnd(this.tail)}merge(t){this.tail!==null&&(this.tail.next=t.head),t.head!==null&&(t.head.prev=this.tail),this.head=this.head||t.head,this.tail=t.tail||this.tail,this.size+=t.size,t.size=this.size,t.head=this.head,t.tail=this.tail}clear(){return this.head=null,this.tail=null,this.size=0,this}slice(t,r){const n=new pr;let a=r;if(this.head===null||this.tail===null)return n;(a===void 0||a<t)&&(a=this.length);let i=this.getNode(t);for(let s=0;s<a-t&&i!==null&&i!==void 0;s++)n.append(i.data),i=i.next;return n}reverse(){let t=this.head;for(;t;){const n=t.next;t.next=t.prev,t.prev=n,t=t.prev}const r=this.tail;return this.tail=this.head,this.head=r,this}forEach(t,r=!1){let n=r?this.length-1:0,a=r?this.tail:this.head;const i=r?-1:1,s=r?"prev":"next";for(;a;)t(a.data,n,this),a=a[s],n+=i}map(t,r=!1){const n=new pr;return this.forEach((a,i)=>n.append(t(a,i,this)),r),n}filter(t,r=!1){const n=new pr;return this.forEach((a,i)=>{t(a,i,this)&&n.append(a)},r),n}reduce(t,r,n=!1){let a=n?this.length-1:0;const i=n?-1:1,s=n?"prev":"next";let d=n?this.tail:this.head,h;if(r!==void 0)h=r;else if(d)h=d.data,d=d[s];else throw new TypeError("Reduce of empty LinkedList with no initial value");for(;d;)h=t(h,d.data,a,this),a+=i,d=d[s];return h}toArray(){return[...this]}toString(t=" "){return this.reduce((r,n)=>`${r}${t}${n}`)}*[Symbol.iterator](){let t=this.head;for(;t!==null;)yield t.data,t=t.next}removeFromAnyEnd(t){return t!==null?this.removeNode(t).data:void 0}}class pF{constructor(t){le(this,"_v");le(this,"_e");le(this,"_g");le(this,"_adj");le(this,"addEdge",(t,r)=>{this._adj.get(t).append(r),this._e++});this._g=t;const r=Object.keys(this._g);this._v=r.length,this._e=0,this._adj=pr.from([...Array.from({length:this._v},()=>new pr)]),this._adj.forEach((n,a)=>{this._g[r[a]].children.forEach(i=>{this.addEdge(a,r.indexOf(i))})})}get g(){return this._g}set g(t){this._g=t}get adj(){return this._adj}set adj(t){this._adj=t}get e(){return this._e}set e(t){this._e=t}get v(){return this._v}set v(t){this._v=t}}class gF{constructor(t){le(this,"_marked");le(this,"_pre");le(this,"_post");le(this,"_reversePost");le(this,"dfs",(t,r)=>{this._pre.append(r),this._marked[r]=!0,t.adj.get(r)&&t.adj.get(r).forEach(n=>{this._marked[n]||this.dfs(t,n)}),this._post.append(r),this._reversePost.push(r)});this._pre=new pr,this._post=new pr,this._reversePost=new pr,this._marked=Array.from({length:t.v});for(let r=0;r<t.v;r++)this._marked[r]||this.dfs(t,r)}get pre(){return this._pre}set pre(t){this._pre=t}get reversePost(){return this._reversePost}set reversePost(t){this._reversePost=t}get marked(){return this._marked}set marked(t){this._marked=t}get post(){return this._post}set post(t){this._post=t}}function Wh(e){return e==="xxx-large"?20:e==="xx-large"?18:e==="x-large"?16:e==="large"?14:e==="normal"?12:e==="small"?10:e==="mini"?8:12}function Tt(e){return Object.prototype.toString.call(e)==="[object Object]"}function Ci(e,t){if(e){if(t==="xxx-large")return Math.max(44,e);if(t==="xx-large")return Math.max(40,e);if(t==="x-large")return Math.max(36,e);if(t==="large")return Math.max(32,e);if(t==="normal")return Math.max(28,e);if(t==="small")return Math.max(24,e);if(t==="mini")return Math.max(20,e)}else{if(t==="xxx-large")return 44;if(t==="xx-large")return 40;if(t==="x-large")return 36;if(t==="large")return 32;if(t==="normal")return 28;if(t==="small")return 24;if(t==="mini")return 20}return 28}function Wo(e,t){if(e){if(t==="xxx-large")return Math.max(180,e);if(t==="xx-large")return Math.max(168,e);if(t==="x-large")return Math.max(156,e);if(t==="large")return Math.max(144,e);if(t==="normal")return Math.max(132,e);if(t==="small")return Math.max(120,e);if(t==="mini")return Math.max(108,e)}else{if(t==="xxx-large")return 180;if(t==="xx-large")return 168;if(t==="x-large")return 156;if(t==="large")return 144;if(t==="normal")return 132;if(t==="small")return 120;if(t==="mini")return 108}return 132}function Qv(e,t){const r=Object.keys(e);if(r.length===0)return{noErrorVertexes:e,errorMap:t};const n=Object.keys(t);let a=!1;for(let i=0;i<r.length;i++){if(e.hasOwnProperty(r[i])&&e[r[i]].children&&e[r[i]].children.length>0&&e[r[i]].children.find(d=>n.indexOf(d)>=0)!=null){a=!0,t[r[i]]=e[r[i]],delete e[r[i]];break}a&&Qv(e,t)}return{noErrorVertexes:e,errorMap:t}}function Zv(e,t){const r=Object.keys(e);let n;const a=new pF(e),i=new hF(a);if(i.hasCycle()){for(let s=0;s<i.cycle.length;s++)t.hasOwnProperty(r[i.cycle[s]])||(t[r[i.cycle[s]]]=[e[r[i.cycle[s]]]].concat()[0],delete e[r[i.cycle[s]]]);n=Zv(e,t)}else{const s=new gF(a),d=[];s.reversePost&&s.reversePost.length>0&&s.reversePost.forEach(h=>{d.push(r[h])}),n={g:a,topological:d,noCycleVertexes:e,cycleVertexes:t}}return n}const mF=(e,t,r,n)=>{if(Object.keys(r).length&&Object.keys(n).length){let a=0,i=0;do n[`${a}`]===0?i+=0:r[`${a}`]?i+=r[`${a}`]:i+=t,a++;while(e>=i);return a-1}if(Object.keys(r).length){let a=0,i=0;do i+=r[`${a}`]?r[`${a}`]:t,a++;while(e>=i);return a-1}if(Object.keys(n).length){let a=0,i=0;do i+=n[`${a}`]===0?0:t,a++;while(e>=i);return a-1}return Math.floor(e/t)},vF=(e,t,r,n)=>{if(Object.keys(r).length&&Object.keys(n).length){let a=0,i=0;do n[`${a}`]===0?i+=0:r[`${a}`]?i+=r[`${a}`]:i+=t,a++;while(e>=i);return a-1}if(Object.keys(r).length){let a=0,i=0;do i+=r[`${a}`]?r[`${a}`]:t,a++;while(e>=i);return a-1}if(Object.keys(n).length){let a=0,i=0;do i+=n[`${a}`]===0?0:t,a++;while(e>=i);return a-1}return Math.floor(e/t)},fc=(e,t,r,n,a)=>{let i=0;for(let s=e;s<=t;s++)Object.keys(a).length&&a[`${s}`]===0?i+=0:Object.keys(n).length&&n[`${s}`]?i+=n[`${s}`]:i+=r;return i},ba=(e,t,r,n)=>{if(Object.keys(r).length&&Object.keys(n).length){let a=0,i=0;for(;e>a;)n[`${a}`]===0?i+=0:r[`${a}`]?i+=r[`${a}`]:i+=t,a++;return i}if(Object.keys(r).length){let a=0,i=0;for(;e>a;)i+=r[`${a}`]?r[`${a}`]:t,a++;return i}if(Object.keys(n).length){let a=0,i=0;for(;e>a;)i+=n[`${a}`]===0?0:t,a++;return i}return Math.max(0,e*t)},hc=(e,t,r,n,a)=>{let i=0;for(let s=e;s<=t;s++)Object.keys(a).length&&a[`${s}`]===0?i+=0:Object.keys(n).length&&n[`${s+1}`]?i+=n[`${s+1}`]:i+=r;return i},ya=(e,t,r,n)=>{if(Object.keys(r).length&&Object.keys(n).length){let a=1,i=0;for(;e>a;)n[`${a}`]===0?i+=0:r[`${a}`]?i+=r[`${a}`]:i+=t,a++;return i}if(Object.keys(r).length){let a=1,i=0;for(;e>a;)i+=r[`${a}`]?r[`${a}`]:t,a++;return i}if(Object.keys(n).length){let a=1,i=0;for(;e>a;)i+=n[`${a}`]===0?0:t,a++;return i}return Math.max(0,(e-1)*t)},bF=(e,t,r,n,a)=>{let i=0,s=0;for(;s<e;)s+=a[`${t+i}`]===0?0:n[`${t+i}`]?n[`${t+i}`]:r,i++;return i},yF=(e,t,r,n,a)=>{let i=0,s=0;for(;s<e;)s+=a[`${t+i}`]===0?0:n[`${t+i}`]?n[`${t+i}`]:r,i++;return i},Kh=(e,t,r,n,a)=>{let i=0;if(Object.keys(n).length&&Object.keys(a).length){for(const s in Object.keys(n))n.hasOwnProperty(Object.keys(n)[s])&&(i+=n[Object.keys(n)[s]]-r);for(const s in Object.keys(a))a.hasOwnProperty(Object.keys(a)[s])&&(n[Object.keys(a)[s]]?i-=n[Object.keys(a)[s]]:i-=r)}else if(Object.keys(n).length)for(const s in Object.keys(n))n.hasOwnProperty(Object.keys(n)[s])&&(i+=n[Object.keys(n)[s]]-r);else if(Object.keys(a).length)for(const s in Object.keys(a))a.hasOwnProperty(Object.keys(a)[s])&&(i-=r);return e+(t-1)*r+i},EF=(e,t,r,n)=>{let a=0;if(Object.keys(r).length&&Object.keys(n).length){for(const i in Object.keys(r))r.hasOwnProperty(Object.keys(r)[i])&&(a+=r[Object.keys(r)[i]]-t);for(const i in Object.keys(n))n.hasOwnProperty(Object.keys(n)[i])&&(r[Object.keys(n)[i]]?a-=r[Object.keys(n)[i]]:a-=t)}if(Object.keys(r).length)for(const i in Object.keys(r))r.hasOwnProperty(Object.keys(r)[i])&&(a+=r[Object.keys(r)[i]]-t);if(Object.keys(n).length)for(const i in Object.keys(n))n.hasOwnProperty(Object.keys(n)[i])&&(a-=t);return e*t+a},wo=(e,t)=>0;function wF(e,t=0,{start:r=!0,middle:n=!0,once:a=!1}={}){let i=0,s,d=!1;function h(...c){if(d)return;const o=Date.now()-i;i=Date.now(),r?(r=!1,e.apply(this,c),a&&h.cancel()):(n&&o<t||!n)&&(clearTimeout(s),s=setTimeout(()=>{i=Date.now(),e.apply(this,c),a&&h.cancel()},n?t-o:t))}return h.cancel=()=>{clearTimeout(s),d=!0},h}function Yh(e,t=0,{start:r=!1,middle:n=!1,once:a=!1}={}){return wF(e,t,{start:r,middle:n,once:a})}const _F=Zt.isFirefox?"DOMMouseScroll":"mousewheel",Jv=[];function Ko(e){const t=e.type===_F;Jv.forEach(({type:r,cb:n})=>{(r===e.type||t&&r==="mousewheel")&&n(e)})}const Mt={on(e,t,r){r&&Jv.push({comp:e,type:t,cb:r})},off(e,t){console.log(e,t)},trigger:Ko};Xw&&document.addEventListener("contextmenu",Ko,!1);jw&&(window.addEventListener("mousedown",Ko,!1),window.addEventListener("mousewheel",Ko,!1));var qh=it({name:"VmaGrid",props:cF,emits:["update:data","change"],setup(e,t){const r=Ut("VmaGridHeader"),n=Ut("VmaGridBody"),a=Ut("VmaGridStylePlugin"),i=Ut("VmaGridBorderPlugin"),s=Ut("VmaGridAlignPlugin"),d=Se(),h=Se(),c=Se(),o=Se(),l=Se(),u=Se(),f=Se(),m=Se(),g=Se(),b=Se(),v=Se(),w=Se(),y=Se(),_=Se(),T=Se(),A=Se(),x=Se(),C=Se(),N=Se(),P=Se(),z=Se(),K=Se(),q=Se(),W=Se(),ce=Se(),V=Se(),G=Se(),j=Se(),ie=Se(),fe=Se(),ve=Se(),xe=Se(),Te=Se(),Me=Se(),J=Se(),S=Se(),I=Se(),U=Se(),me=Se(),Y=Se(),be=Se(),X=Se(),k=Se(),B=Se(),H=Se(),re=Se(),ne={refColumnResizeBar:d,refRowResizeBar:h,refGrid:c,refGridBody:o,refGridLeftFixedBody:l,refGridLeftFixedBodyScrollWrapper:u,refGridLeftFixedBodyX:m,refGridLeftFixedBodyY:f,refGridBodyX:b,refGridBodyY:g,refGridTopFixedBody:v,refGridBottomFixedBody:w,refGridLeftTopFixedBody:y,refGridBodyTable:_,refGridLeftFixedBodyTable:T,refGridTopFixedBodyTable:A,refGridBottomFixedBodyTable:x,refGridLeftTopFixedBodyTable:C,refGridBodyColgroup:N,refGridLeftFixedBodyColgroup:P,refGridTopFixedBodyColgroup:z,refGridBottomFixedBodyColgroup:K,refGridLeftTopFixedBodyColgroup:q,refGridHeader:W,refGridLeftFixedHeader:ce,refGridLeftFixedHeaderX:V,refGridHeaderTable:G,refGridLeftFixedHeaderTable:j,refGridHeaderColgroup:ie,refGridLeftFixedHeaderColgroup:fe,refCurrentCellEditor:ve,refCurrentCellBorderTop:xe,refCurrentCellBorderRight:Te,refCurrentCellBorderBottom:Me,refCurrentCellBorderLeft:J,refCurrentCellBorderCorner:S,refCurrentAreaBorderTop:I,refCurrentAreaBorderRight:U,refCurrentAreaBorderBottom:me,refCurrentAreaBorderLeft:Y,refCurrentAreaBorderCorner:be,refGridCtxMenu:X,refColorPicker:k,refStylePlugin:B,refBorderPlugin:H,refAlignPlugin:re},p=Cr({loading:!1,dimensionX:0,dimensionY:0,sheets:[],sheet:{},sheetData:[],sheetDataType:"map",sheetConfig:{rh:[],cw:[],rv:[],cv:[]},currentSheetData:[],columnConfigs:[],columnLeftFixedConfigs:[],rowConfigs:[],rowTopFixedConfigs:[],rowBottomFixedConfigs:[],headerColgroup:{},headerLeftFixedColgroup:{},headerTable:{},headerLeftFixedTable:{},bodyTable:[],footerTable:[],gridBodyScrollTop:0,gridBodyScrollLeft:0,overflowX:!1,overflowY:!1,scrollbarWidth:0,scrollbarHeight:0,gridWidth:0,tableWidth:0,gridHeight:0,gridHeaderWidth:0,gridLeftFixedHeaderWidth:0,gridHeaderTableWidth:0,gridHeaderHeight:0,gridLeftFixedHeaderHeight:0,gridHeaderTableHeight:0,gridBodyHeight:0,gridBodyTableHeight:0,gridFooterHeight:0,gridLeftFixedBodyHeight:0,gridLeftFixedBodyWidth:0,columns:{firstList:[],leftList:[],otherList:[]},rows:{topList:[],otherList:[]},cells:{errorMap:{},cycleMap:{},noCycleMap:{}},currentCell:null,currentCellBorderStyle:{transform:"translateX(0) translateY(0)",left:0,top:0,width:0,height:0},currentCellEditorStyle:{transform:"translateX(0) translateY(0)",display:"none",left:0,top:0,width:0,height:0},currentCellEditorActive:!1,currentCellEditorContent:null,currentAreaBorderStyle:{transform:"translateX(0) translateY(0)",left:0,top:0,width:0,height:0},startIndex:0,endIndex:0,startColIndex:0,endColIndex:0,lastScrollLeft:0,lastScrollTop:0,lastScrollTime:0,gridRowsHeightChanged:{},gridColumnsWidthChanged:{},gridRowsVisibleChanged:{},gridColumnsVisibleChanged:{},ctxMenuStore:{selected:null,visible:!1,showChild:!1,selectChild:null,list:[],style:null},currentAreaStatus:!1});let ye;const $={uId:At.create().toString(),props:e,context:t,reactiveData:p,getRefs:()=>ne},pe=Ge(()=>Wo(e.gridColumnWidth,e.size)),ue=Ge(()=>Ci(e.gridRowHeight,e.size)),Oe=Ge(()=>Math.max(Wh(e.size)+p.endIndex.toString().length*Wh(e.size),40)),Ne=(Ee,oe,ge)=>Ee?oe&&ge?"11":ge?"10":oe?"9":"8":oe&&ge?"3":ge?"2":oe?"1":"0",ke=()=>{const Ee=c.value.clientWidth,oe=c.value.clientHeight,ge=o.value.clientWidth,te=o.value.clientHeight,se=o.value.offsetWidth,F=o.value.offsetHeight,{firstList:E,leftList:O}=p.columns;p.gridWidth=Ee,p.gridHeight=oe,p.gridHeaderHeight=G.value.clientHeight,p.gridHeaderTableHeight=p.gridHeaderHeight,p.gridHeaderTableWidth=p.tableWidth,p.gridHeaderWidth=p.gridWidth,p.gridLeftFixedHeaderWidth=E.concat(O).reduce((tt,Ie)=>tt+(Ie.visible?typeof Ie.renderWidth=="string"?pe.value:Ie.renderWidth:0),0),p.gridBodyHeight=p.gridHeight-p.gridHeaderHeight,p.overflowX=F>te,p.overflowY=se>ge,p.scrollbarWidth=Math.max(se-ge,0),p.scrollbarHeight=Math.max(F-te,0);const{columnConfigs:Ce,scrollbarWidth:Ve,tableWidth:et}=p;if(ie.value.children&&ie.value.children.length&&(Array.from(ie.value.children).forEach((tt,Ie)=>{const Pe=tt.attributes.idx.value;Pe===0?tt.style.width=`${Oe.value}px`:Pe<Ce.length?tt.style.width=`${Ce[Pe].visible?typeof Ce[Pe].renderWidth=="string"?pe.value:Ce[Pe].renderWidth:0}px`:tt.style.width=`${Ve}px`}),Array.from(N.value.children).forEach((tt,Ie)=>{const Pe=tt.attributes.idx.value;Pe===0?tt.style.width=`${Oe.value}px`:Pe<Ce.length&&(tt.style.width=`${Ce[Pe].visible?typeof Ce[Pe].renderWidth=="string"?pe.value:Ce[Pe].renderWidth:0}px`)})),fe.value.children&&fe.value.children.length&&(Array.from(fe.value.children).forEach((tt,Ie)=>{const Pe=tt.attributes.idx.value;Pe===0?tt.style.width=`${Oe.value}px`:Pe<Ce.length?tt.style.width=`${Ce[Pe].visible?typeof Ce[Pe].renderWidth=="string"?pe.value:Ce[Pe].renderWidth:0}px`:tt.style.width=`${Ve}px`}),Array.from(P.value.children).forEach((tt,Ie)=>{const Pe=tt.attributes.idx.value;Pe===0?tt.style.width=`${Oe.value}px`:Pe<Ce.length&&(tt.style.width=`${Ce[Pe].visible?typeof Ce[Pe].renderWidth=="string"?pe.value:Ce[Pe].renderWidth:0}px`)})),j.value.style.width=`${et+Ve}px`,l.value.style.width=`${p.gridLeftFixedHeaderWidth}px`,l.value.style.height=`${p.gridBodyHeight-p.scrollbarHeight}px`,m.value.style.width=`${Kh(Oe.value,p.columnConfigs.length,pe.value,p.gridColumnsWidthChanged,p.gridColumnsVisibleChanged)}px`,V.value.style.width=`${Kh(Oe.value,p.columnConfigs.length,pe.value,p.gridColumnsWidthChanged,p.gridColumnsVisibleChanged)+Ve}px`,f.value.style.height=`${EF(p.rowConfigs.length,ue.value,p.gridRowsHeightChanged,p.gridRowsVisibleChanged)}px`,b.value.style.width=m.value.style.width,g.value.style.height=f.value.style.height,l.value.style.top=`${p.gridHeaderHeight}px`,_.value&&(_.value.style.width=`${p.tableWidth}px`,T.value.style.width=`${p.tableWidth}px`),G.value&&(G.value.style.width=`${p.tableWidth+p.scrollbarWidth}px`),$.calcCurrentCellPosition(),p.currentArea&&Object.keys(p.currentArea).length>1){const tt=$.reactiveData.currentArea.start.c>$.reactiveData.currentArea.end.c?$.reactiveData.currentArea.end.c:$.reactiveData.currentArea.start.c,Ie=$.reactiveData.currentArea.end.c<$.reactiveData.currentArea.start.c?$.reactiveData.currentArea.start.c:$.reactiveData.currentArea.end.c,Pe=$.reactiveData.currentArea.start.r>$.reactiveData.currentArea.end.r?$.reactiveData.currentArea.end.r:$.reactiveData.currentArea.start.r,je=$.reactiveData.currentArea.end.r<$.reactiveData.currentArea.start.r?$.reactiveData.currentArea.start.r:$.reactiveData.currentArea.end.r;pt(()=>{_.value.querySelectorAll(".cell-active").forEach((vt,Jt)=>{vt.classList.remove("cell-active")});for(let vt=Pe;vt<=je;vt++)for(let Jt=tt;Jt<=Ie;Jt++)_.value.querySelectorAll(`td[row="${vt}"][col="${Jt+1}"]`).forEach(An=>{An.classList.add("cell-active")})})}},_e=()=>{let Ee=0;const{firstList:oe,otherList:ge}=p.columns;oe.forEach(te=>{Ee+=Oe.value,te.renderWidth=Oe.value}),ge.forEach(te=>{Ee+=te.visible?typeof te.renderWidth=="string"?pe.value:te.renderWidth:0}),p.tableWidth=Ee,pt(()=>{ke()})},de=()=>{const Ee=[],oe=[],ge=[];p.startColIndex!==0&&Ee.push(p.columnConfigs[0]);for(let te=p.startColIndex;te<=p.endColIndex&&!(te>p.columnConfigs.length-1);te++){const se=p.columnConfigs[te];te===0?Ee.push(se):se.visible&&(ge.push(se),se.fixed==="left"&&oe.push(se))}Object.assign(p.columns,{firstList:Ee,leftList:oe,otherList:ge}),pt(()=>{_e()})},L=()=>{const oe=`${ya(p.startColIndex,pe.value,p.gridColumnsWidthChanged,p.gridColumnsVisibleChanged)}px`,te=`${ba(p.startIndex,ue.value,p.gridRowsHeightChanged,p.gridRowsVisibleChanged)}px`;if(_.value&&(_.value.style.transform=`translateX(${oe}) translateY(${te})`,_.value.style.width=`${p.tableWidth}px`,T.value.style.transform=`translateY(${te})`,T.value.style.width=`${p.tableWidth}px`),G.value&&(G.value.style.transform=`translateX(${oe})`,G.value.style.width=`${p.tableWidth+p.scrollbarWidth}px`),p.currentArea&&Object.keys(p.currentArea).length>1){const se=$.reactiveData.currentArea.start.c>$.reactiveData.currentArea.end.c?$.reactiveData.currentArea.end.c:$.reactiveData.currentArea.start.c,F=$.reactiveData.currentArea.end.c<$.reactiveData.currentArea.start.c?$.reactiveData.currentArea.start.c:$.reactiveData.currentArea.end.c,E=$.reactiveData.currentArea.start.r>$.reactiveData.currentArea.end.r?$.reactiveData.currentArea.end.r:$.reactiveData.currentArea.start.r,O=$.reactiveData.currentArea.end.r<$.reactiveData.currentArea.start.r?$.reactiveData.currentArea.start.r:$.reactiveData.currentArea.end.r;pt(()=>{_.value.querySelectorAll(".cell-active").forEach((Ce,Ve)=>{Ce.classList.remove("cell-active")});for(let Ce=E;Ce<=O;Ce++)for(let Ve=se;Ve<=F;Ve++)_.value.querySelectorAll(`td[row="${Ce}"][col="${Ve+1}"]`).forEach(et=>{et.classList.add("cell-active")})})}},D=Ee=>new Promise(oe=>{const ge=Ee.scrollLeft,te=vF(ge,pe.value,p.gridColumnsWidthChanged,p.gridColumnsVisibleChanged),se=o.value.clientWidth,F=Math.max(Math.ceil(se/pe.value),bF(se,te,pe.value,p.gridColumnsWidthChanged,p.gridColumnsVisibleChanged)),E={startColIndex:Math.max(0,te+1-5),endColIndex:te+F+1+5},{startColIndex:O,endColIndex:Ce}=E,{startColIndex:Ve,endColIndex:et}=p;(te<=0||te>=Ce-F-1-5)&&(Ve!==O||et!==Ce)&&(p.startColIndex=O,p.endColIndex=Ce,L()),oe()}),ae=Ee=>new Promise(oe=>{const ge=Ee.scrollTop,te=mF(ge,ue.value,p.gridRowsHeightChanged,p.gridRowsVisibleChanged),se=o.value.clientHeight||c.value.clientHeight,F=Math.max(Math.ceil(se/ue.value),yF(se,te,ue.value,p.gridRowsHeightChanged,p.gridRowsVisibleChanged)),E={startIndex:Math.max(0,te+1-5),endIndex:te+F+1+5},{startIndex:O,endIndex:Ce}=E,{startIndex:Ve,endIndex:et}=p;(te<=0||te>=Ce-F-1-5)&&(Ve!==O||et!==Ce)&&(p.startIndex=O,p.endIndex=Ce,L()),oe()}),Q=Yh(Ee=>{D(Ee).then(()=>{de()})},50),ee=Yh(Ee=>{ae(Ee).then(()=>{ke()})},50),we=()=>pt().then(()=>{D(o.value).then(()=>{ae(o.value).then(()=>{de()})})});Object.assign($,{updateColumn:(Ee,oe,ge)=>{if(Ee==="hideColumn"&&(p.columnConfigs[ge].visible=!1,p.gridColumnsVisibleChanged[`${ge-1}`]=0,p.currentCell&&Object.keys(p.currentCell).length>0&&p.currentCell.c===Number(ge)-1&&(p.currentCell={}),$.recalculate(!0).then(()=>{$.calcCurrentCellPosition()})),Ee==="showAllColumns"){if(Object.keys(p.gridColumnsVisibleChanged).length)for(const te in Object.keys(p.gridColumnsVisibleChanged))p.gridColumnsVisibleChanged.hasOwnProperty(Object.keys(p.gridColumnsVisibleChanged)[te])&&(p.columnConfigs[parseInt(Object.keys(p.gridColumnsVisibleChanged)[te],10)+1].visible=!0);p.gridColumnsVisibleChanged={},$.recalculate(!0).then(()=>{$.calcCurrentCellPosition()})}if(Ee==="showFrontColumns"){if(Object.keys(p.gridColumnsVisibleChanged).length){let te=1;const se=[];for(;p.gridColumnsVisibleChanged.hasOwnProperty(`${Number(ge)-te-1}`);)p.columnConfigs[Number(ge)-te].visible=!0,se.push(`${Number(ge)-te-1}`),te++;const F={};Object.keys(p.gridColumnsVisibleChanged).map(E=>(se.indexOf(E)<0&&(F[E]=p.gridColumnsVisibleChanged[E]),null)),p.gridColumnsVisibleChanged=F}$.recalculate(!0).then(()=>{$.calcCurrentCellPosition()})}if(Ee==="showBackColumns"){if(Object.keys(p.gridColumnsVisibleChanged).length){let te=1;const se=[];for(;p.gridColumnsVisibleChanged.hasOwnProperty(`${Number(ge)+te-1}`);)p.columnConfigs[Number(ge)+te].visible=!0,se.push(`${Number(ge)+te-1}`),te++;const F={};Object.keys(p.gridColumnsVisibleChanged).map(E=>(se.indexOf(E)<0&&(F[E]=p.gridColumnsVisibleChanged[E]),null)),p.gridColumnsVisibleChanged=F}$.recalculate(!0).then(()=>{$.calcCurrentCellPosition()})}if(Ee==="insertFirstColumn"){if(p.columnConfigs.map(F=>(F.index>=1&&(F.index+=1),F)),p.columnConfigs.splice(1,0,new ri(1,null,null,"default",null,!0,!1,"center")),p.currentArea&&Object.keys(p.currentArea).length>1){const F=p.currentArea.start.c>p.currentArea.end.c?p.currentArea.end.c:p.currentArea.start.c,E=p.currentArea.end.c<p.currentArea.start.c?p.currentArea.start.c:p.currentArea.end.c;1-1<=F?(p.currentArea.start.c+=1,p.currentArea.end.c+=1):1-1>F&&1-1<=E&&(p.currentArea.end.c+=1)}const te={};Object.keys(p.gridColumnsVisibleChanged).map(F=>{if(Number(F)>=1){const E=Number(F)+1;te[E]=p.gridColumnsVisibleChanged[F]}else te[F]=p.gridColumnsVisibleChanged[F];return null}),p.gridColumnsVisibleChanged=te;const se={};Object.keys(p.gridColumnsWidthChanged).map(F=>{if(Number(F)>=1){const E=Number(F)+1;se[E]=p.gridColumnsWidthChanged[F]}else se[F]=p.gridColumnsWidthChanged[F];return null}),p.gridColumnsWidthChanged=se,p.currentSheetData.map((F,E)=>(F.map(O=>(O.c>=1-1&&(O.c+=1),null)),F.splice(Number(1-1),0,new kn(E,1-1,null,null,null,!1,null,0,1,1,null,null,!1,!1,!1,!1,!1,null,"0",null,!1,!1,!1,!1,null,null,null)),null)),$.recalculate(!0).then(()=>{$.calc()}).then(()=>{$.calcCurrentCellPosition()})}if(Ee==="insertColumnBefore"){if(p.columnConfigs.map(F=>(F.index>=ge&&(F.index+=1),F)),p.columnConfigs.splice(ge,0,new ri(Number(ge),null,null,"default",null,!0,!1,"center")),p.currentArea&&Object.keys(p.currentArea).length>1){const F=p.currentArea.start.c>p.currentArea.end.c?p.currentArea.end.c:p.currentArea.start.c,E=p.currentArea.end.c<p.currentArea.start.c?p.currentArea.start.c:p.currentArea.end.c;Number(ge)-1<=F?(p.currentArea.start.c+=1,p.currentArea.end.c+=1):Number(ge)-1>F&&Number(ge)-1<=E&&(p.currentArea.end.c+=1)}const te={};Object.keys(p.gridColumnsVisibleChanged).map(F=>{if(Number(F)>=ge){const E=Number(F)+1;te[E]=p.gridColumnsVisibleChanged[F]}else te[F]=p.gridColumnsVisibleChanged[F];return null}),p.gridColumnsVisibleChanged=te;const se={};Object.keys(p.gridColumnsWidthChanged).map(F=>{if(Number(F)>=ge){const E=Number(F)+1;se[E]=p.gridColumnsWidthChanged[F]}else se[F]=p.gridColumnsWidthChanged[F];return null}),p.gridColumnsWidthChanged=se,p.currentSheetData.map((F,E)=>(F.map(O=>(O.c>=ge-1&&(O.c+=1),null)),F.splice(Number(ge-1),0,new kn(E,Number(ge)-1,null,null,null,!1,null,0,1,1,null,null,!1,!1,!1,!1,!1,null,"0",null,!1,!1,!1,!1,null,null,null)),null)),$.recalculate(!0).then(()=>{$.calc()}).then(()=>{$.calcCurrentCellPosition()})}if(Ee==="insertColumnAfter"){if(p.columnConfigs.map(F=>(F.index>ge&&(F.index+=1),F)),p.columnConfigs.splice(Number(ge)+1,0,new ri(Number(ge)+1,null,null,"default",null,!0,!1,"center")),p.currentArea&&Object.keys(p.currentArea).length>1){const F=p.currentArea.start.c>p.currentArea.end.c?p.currentArea.end.c:p.currentArea.start.c,E=p.currentArea.end.c<p.currentArea.start.c?p.currentArea.start.c:p.currentArea.end.c;Number(ge)-1<F?(p.currentArea.start.c+=1,p.currentArea.end.c+=1):Number(ge)-1>=F&&Number(ge)-1<E&&(p.currentArea.end.c+=1)}const te={};Object.keys(p.gridColumnsVisibleChanged).map(F=>{if(Number(F)>=ge){const E=Number(F)+1;te[E]=p.gridColumnsVisibleChanged[F]}else te[F]=p.gridColumnsVisibleChanged[F];return null}),p.gridColumnsVisibleChanged=te;const se={};Object.keys(p.gridColumnsWidthChanged).map(F=>{if(Number(F)>ge){const E=Number(F)+1;se[E]=p.gridColumnsWidthChanged[F]}else se[F]=p.gridColumnsWidthChanged[F];return null}),p.gridColumnsWidthChanged=se,p.currentSheetData.map((F,E)=>(F.map(O=>(O.c>ge-1&&(O.c+=1),null)),F.splice(Number(ge),0,new kn(E,Number(ge),null,null,null,!1,null,0,1,1,null,null,!1,!1,!1,!1,!1,null,"0",null,!1,!1,!1,!1,null,null,null)),null)),$.recalculate(!0).then(()=>{$.calc()}).then(()=>{$.calcCurrentCellPosition()})}if(Ee==="deleteColumn"){if(p.columnConfigs.splice(Number(ge),1),p.columnConfigs.map(F=>(F.index>ge&&(F.index-=1),F)),p.currentArea&&Object.keys(p.currentArea).length>1){const F=p.currentArea.start.c>p.currentArea.end.c?p.currentArea.end.c:p.currentArea.start.c,E=p.currentArea.end.c<p.currentArea.start.c?p.currentArea.start.c:p.currentArea.end.c;Number(ge)-1<F?(p.currentArea.start.c-=1,p.currentArea.end.c-=1):Number(ge)-1>=F&&Number(ge)-1<=E&&(p.currentArea.end.c-=1)}const te={};Object.keys(p.gridColumnsVisibleChanged).map(F=>{if(Number(F)!==Number(ge)-1)if(Number(F)>=Number(ge)){const E=Number(F)-1;te[E]=p.gridColumnsVisibleChanged[F]}else te[F]=p.gridColumnsVisibleChanged[F];return null}),p.gridColumnsVisibleChanged=te;const se={};if(Object.keys(p.gridColumnsWidthChanged).map(F=>{if(Number(F)!==Number(ge))if(Number(F)>=Number(ge)){const E=Number(F)-1;se[E]=p.gridColumnsWidthChanged[F]}else se[F]=p.gridColumnsWidthChanged[F];return null}),p.gridColumnsWidthChanged=se,p.currentSheetData.map((F,E)=>(F.splice(Number(ge)-1,1),F.map(O=>(O.c>ge-1&&(O.c-=1),null)),null)),p.currentCell&&Object.keys(p.currentCell).length>0){const{c:F}=p.currentCell;F===Number(ge)-1&&(p.currentCell={})}$.recalculate(!0).then(()=>{$.calc()}).then(()=>{$.calcCurrentCellPosition()})}},updateRow:(Ee,oe,ge)=>{if(Ee==="hideRow"&&(p.rowConfigs[oe].visible=!1,p.gridRowsVisibleChanged[`${oe}`]=0,p.currentCell&&Object.keys(p.currentCell).length>0&&p.currentCell.r===Number(oe)&&(p.currentCell={}),$.recalculate(!0).then(()=>{$.calcCurrentCellPosition()})),Ee==="showAllRows"){if(Object.keys(p.gridRowsVisibleChanged).length)for(const te in Object.keys(p.gridRowsVisibleChanged))p.gridRowsVisibleChanged.hasOwnProperty(Object.keys(p.gridRowsVisibleChanged)[te])&&(p.rowConfigs[parseInt(Object.keys(p.gridRowsVisibleChanged)[te],10)].visible=!0);p.gridRowsVisibleChanged={},$.recalculate(!0).then(()=>{$.calcCurrentCellPosition()})}if(Ee==="showUpRows"){if(Object.keys(p.gridRowsVisibleChanged).length){let te=1;const se=[];for(;p.gridRowsVisibleChanged.hasOwnProperty(`${Number(oe)-te}`);)p.rowConfigs[Number(oe)-te].visible=!0,se.push(`${Number(oe)-te}`),te++;const F={};Object.keys(p.gridRowsVisibleChanged).map(E=>(se.indexOf(E)<0&&(F[E]=p.gridRowsVisibleChanged[E]),null)),p.gridRowsVisibleChanged=F}$.recalculate(!0).then(()=>{$.calcCurrentCellPosition()})}if(Ee==="showDownRows"){if(Object.keys(p.gridRowsVisibleChanged).length){let te=1;const se=[];for(;p.gridRowsVisibleChanged.hasOwnProperty(`${Number(oe)+te}`);)p.rowConfigs[Number(oe)+te].visible=!0,se.push(`${Number(oe)+te}`),te++;const F={};Object.keys(p.gridRowsVisibleChanged).map(E=>(se.indexOf(E)<0&&(F[E]=p.gridRowsVisibleChanged[E]),null)),p.gridRowsVisibleChanged=F}$.recalculate(!0).then(()=>{$.calcCurrentCellPosition()})}if(Ee==="insertFirstRow"){if(p.rowConfigs.map(E=>(E.index>=0&&(E.index+=1),E)),p.rowConfigs.splice(0,0,new yo(0,null,null,"default",null,!0,!1,"center")),p.currentArea&&Object.keys(p.currentArea).length>1){const E=p.currentArea.start.r>p.currentArea.end.r?p.currentArea.end.r:p.currentArea.start.r,O=p.currentArea.end.r<p.currentArea.start.r?p.currentArea.start.r:p.currentArea.end.r;E>=0?(p.currentArea.start.r+=1,p.currentArea.end.r+=1):Number(oe)>E&&Number(oe)<=O&&(p.currentArea.end.r+=1)}const te={};Object.keys(p.gridRowsVisibleChanged).map(E=>{if(Number(E)>=0){const O=Number(E)+1;te[O]=p.gridRowsVisibleChanged[E]}else te[E]=p.gridRowsVisibleChanged[E];return null}),p.gridRowsVisibleChanged=te;const se={};Object.keys(p.gridRowsHeightChanged).map(E=>{if(Number(E)>=0){const O=Number(E)+1;se[O]=p.gridRowsHeightChanged[E]}else se[E]=p.gridRowsHeightChanged[E];return null}),p.gridRowsHeightChanged=se,p.currentSheetData.map((E,O)=>(E.map(Ce=>(Ce.r>=0&&(Ce.r+=1),null)),null));const F=[];for(let E=0;E<p.columnConfigs.length-1;E++)F.push(new kn(0,E,null,null,null,!1,null,0,1,1,null,null,!1,!1,!1,!1,!1,null,"0",null,!1,!1,!1,!1,null,null,null));p.currentSheetData.splice(0,0,F),$.recalculate(!0).then(()=>{$.calc()}).then(()=>{$.calcCurrentCellPosition()})}if(Ee==="insertRowBefore"){if(p.rowConfigs.map(E=>(E.index>=oe&&(E.index+=1),E)),p.rowConfigs.splice(oe,0,new yo(Number(oe),null,null,"default",null,!0,!1,"center")),p.currentArea&&Object.keys(p.currentArea).length>1){const E=p.currentArea.start.r>p.currentArea.end.r?p.currentArea.end.r:p.currentArea.start.r,O=p.currentArea.end.r<p.currentArea.start.r?p.currentArea.start.r:p.currentArea.end.r;Number(oe)<=E?(p.currentArea.start.r+=1,p.currentArea.end.r+=1):Number(oe)>E&&Number(oe)<=O&&(p.currentArea.end.r+=1)}const te={};Object.keys(p.gridRowsVisibleChanged).map(E=>{if(Number(E)>=oe){const O=Number(E)+1;te[O]=p.gridRowsVisibleChanged[E]}else te[E]=p.gridRowsVisibleChanged[E];return null}),p.gridRowsVisibleChanged=te;const se={};Object.keys(p.gridRowsHeightChanged).map(E=>{if(Number(E)>=oe){const O=Number(E)+1;se[O]=p.gridRowsHeightChanged[E]}else se[E]=p.gridRowsHeightChanged[E];return null}),p.gridRowsHeightChanged=se,p.currentSheetData.map((E,O)=>(E.map(Ce=>(Ce.r>=oe&&(Ce.r+=1),null)),null));const F=[];for(let E=0;E<p.columnConfigs.length-1;E++)F.push(new kn(Number(oe),E,null,null,null,!1,null,0,1,1,null,null,!1,!1,!1,!1,!1,null,"0",null,!1,!1,!1,!1,null,null,null));p.currentSheetData.splice(Number(oe),0,F),$.recalculate(!0).then(()=>{$.calc()}).then(()=>{$.calcCurrentCellPosition()})}if(Ee==="insertRowAfter"){if(p.rowConfigs.map(E=>(E.index>oe&&(E.index+=1),E)),p.rowConfigs.splice(Number(oe)+1,0,new yo(Number(oe)+1,null,null,"default",null,!0,!1,"center")),p.currentArea&&Object.keys(p.currentArea).length>1){const E=p.currentArea.start.r>p.currentArea.end.r?p.currentArea.end.r:p.currentArea.start.r,O=p.currentArea.end.r<p.currentArea.start.r?p.currentArea.start.r:p.currentArea.end.r;Number(oe)<E?(p.currentArea.start.r+=1,p.currentArea.end.r+=1):Number(oe)>=E&&Number(oe)<=O&&(p.currentArea.end.r+=1)}const te={};Object.keys(p.gridRowsVisibleChanged).map(E=>{if(Number(E)>oe){const O=Number(E)+1;te[O]=p.gridRowsVisibleChanged[E]}else te[E]=p.gridRowsVisibleChanged[E];return null}),p.gridRowsVisibleChanged=te;const se={};Object.keys(p.gridRowsHeightChanged).map(E=>{if(Number(E)>oe){const O=Number(E)+1;se[O]=p.gridRowsHeightChanged[E]}else se[E]=p.gridRowsHeightChanged[E];return null}),p.gridRowsHeightChanged=se,p.currentSheetData.map((E,O)=>(E.map(Ce=>(Ce.r>oe&&(Ce.r+=1),null)),null));const F=[];for(let E=0;E<p.columnConfigs.length-1;E++)F.push(new kn(Number(oe)+1,E,null,null,null,!1,null,0,1,1,null,null,!1,!1,!1,!1,!1,null,"0",null,!1,!1,!1,!1,null,null,null));p.currentSheetData.splice(Number(oe)+1,0,F),$.recalculate(!0).then(()=>{$.calc()}).then(()=>{$.calcCurrentCellPosition()})}if(Ee==="deleteRow"){if(p.rowConfigs.splice(Number(oe),1),p.rowConfigs.map(F=>(F.index>oe&&(F.index-=1),F)),p.currentArea&&Object.keys(p.currentArea).length>1){const F=p.currentArea.start.r>p.currentArea.end.r?p.currentArea.end.r:p.currentArea.start.r,E=p.currentArea.end.r<p.currentArea.start.r?p.currentArea.start.r:p.currentArea.end.r;Number(oe)<F?(p.currentArea.start.r-=1,p.currentArea.end.r-=1):Number(oe)>=F&&Number(oe)<=E&&(p.currentArea.end.r-=1)}const te={};Object.keys(p.gridRowsVisibleChanged).map(F=>{if(Number(F)!==Number(oe))if(Number(F)>Number(oe)){const E=Number(F)-1;te[E]=p.gridRowsVisibleChanged[F]}else te[F]=p.gridRowsVisibleChanged[F];return null}),p.gridRowsVisibleChanged=te;const se={};if(Object.keys(p.gridRowsHeightChanged).map(F=>{if(Number(F)!==Number(oe))if(Number(F)>Number(oe)){const E=Number(F)-1;se[E]=p.gridRowsHeightChanged[F]}else se[F]=p.gridRowsHeightChanged[F];return null}),p.gridRowsHeightChanged=se,p.currentSheetData.map((F,E)=>(F.map(O=>(O.r>oe&&(O.r-=1),null)),null)),p.currentSheetData.splice(Number(oe),1),p.currentCell&&Object.keys(p.currentCell).length>0){const{r:F}=p.currentCell;F===Number(oe)&&(p.currentCell={})}$.recalculate(!0).then(()=>{$.calc()}).then(()=>{$.calcCurrentCellPosition()})}},updateCell:(Ee,oe,ge,te,se,F)=>{if(Ee==="cellFrontColor")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].fc=F;if(Ee==="cellBackColor")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].bg=F,p.currentSheetData[Number(E)][Number(O)].bgt=Ne(!!p.currentSheetData[Number(E)][Number(O)].bg,!!p.currentSheetData[Number(E)][Number(O)].bdb||p.currentSheetData[Number(E)][Number(O)+1]&&!!p.currentSheetData[Number(E)][Number(O)+1].bdt,!!p.currentSheetData[Number(E)][Number(O)].bdr||p.currentSheetData[Number(E)][Number(O)+1]&&!!p.currentSheetData[Number(E)][Number(O)+1].bdl);if(Ee==="updateCellFontSize")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].fs=Number(F);if(Ee==="updateCellFontFamily")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].ff=F;if(Ee==="updateCellFontStyle"){if(F==="bl"){const E=p.currentCell.bl;for(let O=Number(oe);O<=Number(te);O++)for(let Ce=Number(ge)-1;Ce<=Number(se)-1;Ce++)p.currentSheetData[Number(O)][Number(Ce)].bl=!E}if(F==="it"){const E=p.currentCell.it;for(let O=Number(oe);O<=Number(te);O++)for(let Ce=Number(ge)-1;Ce<=Number(se)-1;Ce++)p.currentSheetData[Number(O)][Number(Ce)].it=!E}if(F==="ol"){const E=p.currentCell.ol;for(let O=Number(oe);O<=Number(te);O++)for(let Ce=Number(ge)-1;Ce<=Number(se)-1;Ce++)p.currentSheetData[Number(O)][Number(Ce)].ol=!E}if(F==="cl"){const E=p.currentCell.cl;for(let O=Number(oe);O<=Number(te);O++)for(let Ce=Number(ge)-1;Ce<=Number(se)-1;Ce++)p.currentSheetData[Number(O)][Number(Ce)].cl=!E}if(F==="ul"){const E=p.currentCell.ul;for(let O=Number(oe);O<=Number(te);O++)for(let Ce=Number(ge)-1;Ce<=Number(se)-1;Ce++)p.currentSheetData[Number(O)][Number(Ce)].ul=!E}}if(Ee==="updateCellBorder"){if(F==="top"||F==="out"||F==="all"||F==="none"){p.currentCell.bdt;for(let E=Number(oe)-1;E<=Number(oe);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(oe)][Number(O)].bdt=F!=="none",Number(E)>=0&&(p.currentSheetData[Number(E)][Number(O)].bgt=Ne(!!p.currentSheetData[Number(E)][Number(O)].bg,!!p.currentSheetData[Number(E)][Number(O)].bdb||(Number(E)+1<p.rowConfigs.length?!!p.currentSheetData[Number(E)+1][Number(O)].bdt:!1),!!p.currentSheetData[Number(E)][Number(O)].bdr||(Number(O)+1<p.columnConfigs.length-1?!!p.currentSheetData[Number(E)][Number(O)+1].bdl:!1)))}if(F==="bottom"||F==="out"||F==="all"||F==="none"){p.currentCell.bdb;for(let E=Number(te);E<=Number(te)+1;E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(te)][Number(O)].bdb=F!=="none",E<p.rowConfigs.length&&(p.currentSheetData[Number(E)][Number(O)].bgt=Ne(!!p.currentSheetData[Number(E)][Number(O)].bg,!!p.currentSheetData[Number(E)][Number(O)].bdb||(Number(E)+1<p.rowConfigs.length?!!p.currentSheetData[Number(E)+1][Number(O)].bdt:!1),!!p.currentSheetData[Number(E)][Number(O)].bdr||(Number(O)+1<p.columnConfigs.length-1?!!p.currentSheetData[Number(E)][Number(O)+1].bdl:!1)))}if(F==="left"||F==="out"||F==="all"||F==="none"){p.currentCell.bdl;for(let E=Number(oe);E<=Number(te);E++){p.currentSheetData[Number(E)][Number(Number(ge)-1)].bdl=F!=="none";for(let O=Number(ge)-1-1;O<=Number(ge)-1;O++)Number(O)>=0&&(p.currentSheetData[Number(E)][Number(O)].bgt=Ne(!!p.currentSheetData[Number(E)][Number(O)].bg,!!p.currentSheetData[Number(E)][Number(O)].bdb||(Number(E)+1<p.rowConfigs.length?!!p.currentSheetData[Number(E)+1][Number(O)].bdt:!1),!!p.currentSheetData[Number(E)][Number(O)].bdr||(Number(O)+1<p.columnConfigs.length-1?!!p.currentSheetData[Number(E)][Number(O)+1].bdl:!1)))}}if(F==="right"||F==="out"||F==="all"||F==="none"){p.currentCell.bdr;for(let E=Number(oe);E<=Number(te);E++){p.currentSheetData[Number(E)][Number(se)-1].bdr=F!=="none";for(let O=Number(se)-1;O<=Number(se)-1+1;O++)O<p.columnConfigs.length-1&&(p.currentSheetData[Number(E)][Number(O)].bgt=Ne(!!p.currentSheetData[Number(E)][Number(O)].bg,!!p.currentSheetData[Number(E)][Number(O)].bdb||(Number(E)+1<p.rowConfigs.length?!!p.currentSheetData[Number(E)+1][Number(O)].bdt:!1),!!p.currentSheetData[Number(E)][Number(O)].bdr||(Number(O)+1<p.columnConfigs.length-1?!!p.currentSheetData[Number(E)][Number(O)+1].bdl:!1)))}}if(F==="inner"||F==="all"||F==="none"){for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].bdt=F!=="none",Number(E)>=0&&(p.currentSheetData[Number(E)][Number(O)].bgt=Ne(!!p.currentSheetData[Number(E)][Number(O)].bg,!!p.currentSheetData[Number(E)][Number(O)].bdb||(Number(E)+1<p.rowConfigs.length?!!p.currentSheetData[Number(E)+1][Number(O)].bdt:!1),!!p.currentSheetData[Number(E)][Number(O)].bdr||(Number(O)+1<p.columnConfigs.length-1?!!p.currentSheetData[Number(E)][Number(O)+1].bdl:!1)));for(let E=Number(oe);E<=Number(te)-1;E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].bdb=F!=="none",E<p.rowConfigs.length&&(p.currentSheetData[Number(E)][Number(O)].bgt=Ne(!!p.currentSheetData[Number(E)][Number(O)].bg,!!p.currentSheetData[Number(E)][Number(O)].bdb||(Number(E)+1<p.rowConfigs.length?!!p.currentSheetData[Number(E)+1][Number(O)].bdt:!1),!!p.currentSheetData[Number(E)][Number(O)].bdr||(Number(O)+1<p.columnConfigs.length-1?!!p.currentSheetData[Number(E)][Number(O)+1].bdl:!1)));for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].bdl=F!=="none",Number(O)>=0&&(p.currentSheetData[Number(E)][Number(O)].bgt=Ne(!!p.currentSheetData[Number(E)][Number(O)].bg,!!p.currentSheetData[Number(E)][Number(O)].bdb||(Number(E)+1<p.rowConfigs.length?!!p.currentSheetData[Number(E)+1][Number(O)].bdt:!1),!!p.currentSheetData[Number(E)][Number(O)].bdr||(Number(O)+1<p.columnConfigs.length-1?!!p.currentSheetData[Number(E)][Number(O)+1].bdl:!1)));for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1-1;O++)p.currentSheetData[Number(E)][Number(O)].bdr=F!=="none",O<p.columnConfigs.length-1&&(p.currentSheetData[Number(E)][Number(O)].bgt=Ne(!!p.currentSheetData[Number(E)][Number(O)].bg,!!p.currentSheetData[Number(E)][Number(O)].bdb||(Number(E)+1<p.rowConfigs.length?!!p.currentSheetData[Number(E)+1][Number(O)].bdt:!1),!!p.currentSheetData[Number(E)][Number(O)].bdr||(Number(O)+1<p.columnConfigs.length-1?!!p.currentSheetData[Number(E)][Number(O)+1].bdl:!1)))}if(p.currentArea&&Object.keys(p.currentArea).length>1){const E=$.reactiveData.currentArea.start.c>$.reactiveData.currentArea.end.c?$.reactiveData.currentArea.end.c:$.reactiveData.currentArea.start.c,O=$.reactiveData.currentArea.end.c<$.reactiveData.currentArea.start.c?$.reactiveData.currentArea.start.c:$.reactiveData.currentArea.end.c,Ce=$.reactiveData.currentArea.start.r>$.reactiveData.currentArea.end.r?$.reactiveData.currentArea.end.r:$.reactiveData.currentArea.start.r,Ve=$.reactiveData.currentArea.end.r<$.reactiveData.currentArea.start.r?$.reactiveData.currentArea.start.r:$.reactiveData.currentArea.end.r;pt(()=>{_.value.querySelectorAll(".cell-active").forEach((et,tt)=>{et.classList.remove("cell-active")});for(let et=Ce;et<=Ve;et++)for(let tt=E;tt<=O;tt++)_.value.querySelectorAll(`td[row="${et}"][col="${tt+1}"]`).forEach(Ie=>{Ie.classList.add("cell-active")})})}}if(Ee==="updateCellAlign"){if(F==="avt")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].av="top";if(F==="avm")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].av="middle";if(F==="avb")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].av="bottom";if(F==="ahl")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].ah="left";if(F==="ahc")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].ah="center";if(F==="ahr")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].ah="right"}if(Ee==="updateCellFormat"){if(F==="general")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].cf={fd:"",t:"g"};if(F==="date")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].cf={fd:"yyyy-mm-dd",t:"dd"};if(F==="time")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].cf={fd:"hh:mm:ss",t:"dt"};if(F==="fraction")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].cf={fd:"0/00",t:"df"};if(F==="scientific-notation")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].cf={fd:"0.00E+0",t:"ds"};if(F==="number")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].cf={fd:"#,##0.00;-#,##0.00;0",t:"dn"};if(F==="string")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].cf={fd:"@",t:"s"};if(F==="percent")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].cf={fd:"#,##0.00%",t:"dp"}}if(Ee==="updateCellFastFormat"){if(F==="decimal-places-add"){for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)if(p.currentSheetData[Number(E)][Number(O)].cf&&p.currentSheetData[Number(E)][Number(O)].cf.t&&(p.currentSheetData[Number(E)][Number(O)].cf.t==="dp"||p.currentSheetData[Number(E)][Number(O)].cf.t==="ds"||p.currentSheetData[Number(E)][Number(O)].cf.t==="dn")&&new RegExp("0[.]*[0]*[;,%E]","g").test(p.currentSheetData[Number(E)][Number(O)].cf.fd)){if(console.log(p.currentSheetData[Number(E)][Number(O)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0]),p.currentSheetData[Number(E)][Number(O)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0].length===2){const Ve=p.currentSheetData[Number(E)][Number(O)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0],et=`${Ve.slice(0,1)}.0${Ve.slice(1)}`;p.currentSheetData[Number(E)][Number(O)].cf.fd=p.currentSheetData[Number(E)][Number(O)].cf.fd.replaceAll(Ve,et)}else if(p.currentSheetData[Number(E)][Number(O)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0].length>2){const Ve=p.currentSheetData[Number(E)][Number(O)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0];console.log(Ve);const et=`${Ve.slice(0,p.currentSheetData[Number(E)][Number(O)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0].length-1)}0${Ve.slice(p.currentSheetData[Number(E)][Number(O)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0].length-1)}`;console.log(et),p.currentSheetData[Number(E)][Number(O)].cf.fd=p.currentSheetData[Number(E)][Number(O)].cf.fd.replaceAll(Ve,et)}}}if(F==="decimal-places-reduce"){for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)if(p.currentSheetData[Number(E)][Number(O)].cf&&p.currentSheetData[Number(E)][Number(O)].cf.t&&(p.currentSheetData[Number(E)][Number(O)].cf.t==="dp"||p.currentSheetData[Number(E)][Number(O)].cf.t==="ds"||p.currentSheetData[Number(E)][Number(O)].cf.t==="dn")&&new RegExp("0[.]*[0]*[;,%E]","g").test(p.currentSheetData[Number(E)][Number(O)].cf.fd)&&p.currentSheetData[Number(E)][Number(O)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0].length>3){const Ve=p.currentSheetData[Number(E)][Number(O)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0];let et=Ve.slice(0,Ve.length-2)+Ve.slice(Ve.length-1,Ve.length);et.length===3&&(et=et.slice(0,1)+et.slice(2)),p.currentSheetData[Number(E)][Number(O)].cf.fd=p.currentSheetData[Number(E)][Number(O)].cf.fd.replaceAll(Ve,et)}}if(F==="thousandths")for(let E=Number(oe);E<=Number(te);E++)for(let O=Number(ge)-1;O<=Number(se)-1;O++)p.currentSheetData[Number(E)][Number(O)].cf&&p.currentSheetData[Number(E)][Number(O)].cf.t&&(p.currentSheetData[Number(E)][Number(O)].cf.t==="dn"||p.currentSheetData[Number(E)][Number(O)].cf.t==="dp")&&(p.currentSheetData[Number(E)][Number(O)].cf.t==="dn"&&(p.currentSheetData[Number(E)][Number(O)].cf.fd.indexOf(",")>=0?p.currentSheetData[Number(E)][Number(O)].cf.fd=p.currentSheetData[Number(E)][Number(O)].cf.fd.replaceAll(",",""):p.currentSheetData[Number(E)][Number(O)].cf.fd=p.currentSheetData[Number(E)][Number(O)].cf.fd.replaceAll("###","#,##")),p.currentSheetData[Number(E)][Number(O)].cf.t==="dp"&&(p.currentSheetData[Number(E)][Number(O)].cf.fd.indexOf(",")>=0?p.currentSheetData[Number(E)][Number(O)].cf.fd=p.currentSheetData[Number(E)][Number(O)].cf.fd.replaceAll(",",""):p.currentSheetData[Number(E)][Number(O)].cf.fd=p.currentSheetData[Number(E)][Number(O)].cf.fd.replaceAll("###","#,##")))}},getCell:(Ee,oe,ge)=>Ee==="cellFrontColor"?p.currentSheetData[Number(oe)][Number(ge)-1].fc:Ee==="cellBackColor"?p.currentSheetData[Number(oe)][Number(ge)-1].bg:null,calcCurrentCellDisplay:()=>{if(p.currentCell){const{r:Ee,c:oe}=p.currentCell;Ee<=p.endIndex&&Ee>=p.startIndex&&oe<=p.endColIndex&&oe>=p.startColIndex&&p.currentCellEditorActive?p.currentCellEditorStyle.display="block":p.currentCellEditorStyle.display="none"}else p.currentCellEditorStyle.display="none"},calcCurrentCellPosition:()=>{if(p.currentCell){const Ee=ya(p.startColIndex,pe.value,p.gridColumnsWidthChanged,p.gridColumnsVisibleChanged),oe=ba(p.startIndex,ue.value,p.gridRowsHeightChanged,p.gridRowsVisibleChanged);pt(()=>{const{r:ge,c:te}=p.currentCell;_.value.querySelectorAll(`td[row="${ge}"][col="${te+1}"]`).forEach(se=>{const F=`${Ee+se.offsetLeft}px`,E=`${oe+se.offsetTop}px`,O=`${Ee+se.offsetLeft-1}px`,Ce=`${oe+se.offsetTop-1}px`;p.currentCellEditorStyle.transform=`translateX(${F}) translateY(${E})`,p.currentCellEditorStyle.height=`${se.offsetHeight}px`,p.currentCellEditorStyle.width=`${se.offsetWidth}px`,p.currentCellBorderStyle.transform=`translateX(${O}) translateY(${Ce})`,p.currentCellBorderStyle.height=`${se.offsetHeight}px`,p.currentCellBorderStyle.width=`${se.offsetWidth}px`})})}if(p.currentArea&&Object.keys(p.currentArea).length>1){const Ee=$.reactiveData.currentArea.start.c>$.reactiveData.currentArea.end.c?$.reactiveData.currentArea.end.c:$.reactiveData.currentArea.start.c,oe=$.reactiveData.currentArea.end.c<$.reactiveData.currentArea.start.c?$.reactiveData.currentArea.start.c:$.reactiveData.currentArea.end.c,ge=$.reactiveData.currentArea.start.r>$.reactiveData.currentArea.end.r?$.reactiveData.currentArea.end.r:$.reactiveData.currentArea.start.r,te=$.reactiveData.currentArea.end.r<$.reactiveData.currentArea.start.r?$.reactiveData.currentArea.start.r:$.reactiveData.currentArea.end.r,se=ya(p.startColIndex,pe.value,p.gridColumnsWidthChanged,p.gridColumnsVisibleChanged),F=ba(p.startIndex,ue.value,p.gridRowsHeightChanged,p.gridRowsVisibleChanged);pt(()=>{_.value.querySelectorAll(`td[row="${ge}"][col="${Ee+1}"]`).forEach(E=>{const O=`${se+E.offsetLeft-1}px`,Ce=`${F+E.offsetTop-1}px`;p.currentAreaBorderStyle.transform=`translateX(${O}) translateY(${Ce})`;const Ve=hc(Ee,oe,pe.value,$.reactiveData.gridColumnsWidthChanged,$.reactiveData.gridColumnsVisibleChanged),et=fc(ge,te,ue.value,$.reactiveData.gridRowsHeightChanged,$.reactiveData.gridRowsVisibleChanged);$.reactiveData.currentAreaBorderStyle.height=`${et}px`,$.reactiveData.currentAreaBorderStyle.width=`${Ve}px`})})}},triggerScrollXEvent:Ee=>{const oe=Ee.currentTarget||Ee.target;Q(oe)},triggerScrollYEvent:Ee=>{const oe=Ee.currentTarget||Ee.target;ee(oe)},recalculate:Ee=>(de(),Ee?we().then(()=>(de(),we())):we()),getParentElem(){const Ee=c.value;if($){const oe=$.getRefs().refGrid.value;return oe?oe.parentNode:null}return Ee?Ee.parentNode:null},calc:()=>{const Ee=[];p.cells.errorMap={},p.cells.cycleMap={},p.cells.noCycleMap={};const oe={row:1,col:1,sheet:p.sheet.name},ge=new lF({}),te=[];p.currentSheetData.forEach(Ie=>{Ie.forEach(Pe=>{let je=!1,vt=!0,Jt=null,An=null;if(Pe&&Pe.v&&typeof Pe.v=="string"&&Pe.v.trim().startsWith("=")){je=!0,Jt="#DEPPARSEERROR!";try{An=ge.parse(Pe.v.trim().substring(1),oe),vt=!1,Jt=null}catch{console.error(`parse error: ${Pe.c-1}_${Pe.r}`)}vt&&te.push(`${Pe.c-1}_${Pe.r}`),An!==null&&An.find($u=>$u.row>p.rowConfigs.length||$u.col>p.columnConfigs.length)&&(Jt="#REFERROR!",te.push(`${Pe.c-1}_${Pe.r}`),vt=!0,An=null),Pe.mv=je?vt?Jt:null:Pe&&Pe.v?Pe.v:null,Pe.fd=je?vt?null:An:null,Pe.se=Jt,Ee.push(Pe)}else Pe.mv=Pe.v})});const se={};Ee.forEach(Ie=>{te.indexOf(`${Ie.c}_${Ie.r}`)>=0?p.cells.errorMap[`${Ie.c}_${Ie.r}`]={c:Ie.c,r:Ie.r,children:[],ref:Ie}:(se[`${Ie.c}_${Ie.r}`]={c:Ie.c,r:Ie.r,children:[],ref:Ie},Ie.fd&&Ie.fd.length>0&&Ie.fd.forEach(Pe=>{if(Pe.hasOwnProperty("from")||Pe.hasOwnProperty("to"))for(let je=Pe.from.row;je<=Pe.to.row;je++)for(let vt=Pe.from.col;vt<=Pe.to.col;vt++)se.hasOwnProperty(`${vt-1}_${je-1}`)||te.indexOf(`${vt-1}_${je-1}`)<0&&(se[`${vt-1}_${je-1}`]={c:vt-1,r:je-1,children:[],ref:p.currentSheetData[je-1][vt-1]}),se[`${Ie.c}_${Ie.r}`].children.indexOf(`${vt-1}_${je-1}`)<0&&se[`${Ie.c}_${Ie.r}`].children.push(`${vt-1}_${je-1}`);else se.hasOwnProperty(`${Pe.col-1}_${Pe.row-1}`)||te.indexOf(`${Pe.col-1}_${Pe.row-1}`)<0&&(se[`${Pe.col-1}_${Pe.row-1}`]={c:Pe.col-1,r:Pe.row-1,children:[],ref:p.currentSheetData[Pe.row-1][Pe.col-1]}),se[`${Ie.c}_${Ie.r}`].children.indexOf(`${Pe.col-1}_${Pe.row-1}`)<0&&se[`${Ie.c}_${Ie.r}`].children.push(`${Pe.col-1}_${Pe.row-1}`)}))}),console.time("filterVertexes");const{noErrorVertexes:F}=Qv(se,p.cells.errorMap),E=Object.keys(p.cells.errorMap);if(E.length>0)for(let Ie=0;Ie<E.length;Ie++)p.cells.errorMap[E[Ie]].ref.se!==null?p.cells.errorMap[E[Ie]].ref.mv=p.cells.errorMap[E[Ie]].ref.se:(p.cells.errorMap[E[Ie]].ref.mv="#REFERROR!",p.cells.errorMap[E[Ie]].ref.se="#REFERROR!");const{topological:O,noCycleVertexes:Ce,cycleVertexes:Ve}=Zv(F,{});p.cells.cycleMap=Ve,p.cells.noCycleMap=Ce;const et=Object.keys(Ve);for(let Ie=0;Ie<et.length;Ie++)Ve[et[Ie]].ref.mv="#CYCLEERROR!";const tt=new sF({functions:e.functions,onCell:Ie=>p.currentSheetData[Ie.row-1][Ie.col-1].mv,onRange:Ie=>{const Pe=[];for(let je=Ie.from.row-1;je<Ie.to.row;je++){const vt=[];for(let Jt=Ie.from.col-1;Jt<Ie.to.col;Jt++)vt.push(p.currentSheetData[je][Jt].mv);Pe.push(vt)}return Pe}});for(let Ie=0;Ie<O.length;Ie++)if(Ce[O[Ie]]&&Ce[O[Ie]].ref&&Ce[O[Ie]].ref.v&&typeof Ce[O[Ie]].ref.v=="string"&&Ce[O[Ie]].ref.v.trim().startsWith("=")){let Pe=!0;try{let je=tt.parse(Ce[O[Ie]].ref.v.trim().substring(1),{row:1,col:1});je&&je.result&&(je=je.result),typeof je=="number"||typeof je=="string"?Ce[O[Ie]].ref.mv=je:Ce[O[Ie]].ref.mv=`${je}`,Pe=!1}catch(je){console.error(O[Ie],je)}Pe&&(Ce[O[Ie]].ref.mv="#ERROR!",Ce[O[Ie]].ref.se="#ERROR!")}console.timeEnd("filterVertexes")}}),os.hooks.forEach(Ee=>{if(Ee.setupGrid){const oe=Ee.setupGrid($);oe&&typeof oe=="object"&&Object.assign($,oe)}});const Be=()=>new Promise(Ee=>{p.sheet=e.data.find(te=>te.status===1),p.sheet===void 0&&e.data.length>0&&(p.sheet=e.data[0]),p.dimensionX=e.minDimensions[1],p.dimensionY=e.minDimensions[0],p.columnConfigs=[],p.rowConfigs=[],p.currentSheetData=[],p.currentCell=null,p.currentCellEditorActive=!1,p.currentCellEditorContent=null,p.currentCellEditorStyle={transform:"translateX(0) translateY(0)",display:"none",left:0,top:0,width:0,height:0},p.currentCellBorderStyle={transform:"translateX(0) translateY(0)",left:0,top:0,width:0,height:0},p.currentArea={},p.currentAreaStatus=!1,p.currentAreaBorderStyle={transform:"translateX(0) translateY(0)",left:0,top:0,width:0,height:0},p.sheet.r&&p.sheet.r>p.dimensionY&&(p.dimensionY=p.sheet.r),p.sheet.c&&p.sheet.c>p.dimensionX&&(p.dimensionX=p.sheet.c),p.sheet.dataType&&p.sheet.dataType==="table"?p.sheetDataType="table":p.sheetDataType="map",p.sheet.data&&(p.sheetData=p.sheet.data,p.sheetDataType==="map"&&p.sheetData.map(te=>{te.r&&te.r>p.dimensionY&&(p.dimensionY=te.r),te.c&&te.c>p.dimensionX&&(p.dimensionX=te.c)}),p.sheetDataType==="table"&&(p.sheetData.length>p.dimensionY&&(p.dimensionY=p.sheetData.length),p.sheetData.length>0&&p.sheetData[0].length>p.dimensionX&&(p.dimensionX=p.sheetData[0].length))),p.sheet.config&&(p.sheetConfig=p.sheet.config);const oe=[...Array(p.dimensionX.valueOf())];p.columnConfigs.push(new ri(0,null,null,"default",null,!0,!1,"center")),oe.forEach((te,se)=>{let F=null,E=!1;if(p.sheetConfig.cw&&p.sheetConfig.cw.length){for(let O=0;O<p.sheetConfig.cw.length;O++)if(p.sheetConfig.cw[O].hasOwnProperty("c")&&Rr(p.sheetConfig.cw[O].c)&&p.sheetConfig.cw[O].hasOwnProperty("w")&&Rr(p.sheetConfig.cw[O].w)&&Number(p.sheetConfig.cw[O].c)===se+1){F=p.sheetConfig.cw[O].w,p.gridColumnsWidthChanged[`${se+1}`]=p.sheetConfig.cw[O].w;break}}if(p.sheetConfig.cv&&p.sheetConfig.cv.length){for(let O=0;O<p.sheetConfig.cv.length;O++)if(p.sheetConfig.cv[O].hasOwnProperty("c")&&Rr(p.sheetConfig.cv[O].c)&&p.sheetConfig.cv[O].hasOwnProperty("v")&&Rr(p.sheetConfig.cv[O].v)&&p.sheetConfig.cv[O].v===0&&Number(p.sheetConfig.cv[O].c)-1===se){E=!0,p.gridColumnsVisibleChanged[`${se}`]=p.sheetConfig.cv[O].v;break}}p.columnConfigs.push(new ri(se+1,null,null,F||"default",null,!E,!1,"center"))}),console.log(p.columnConfigs),p.startColIndex=0,p.endColIndex=0;const ge=[...Array(p.dimensionY.valueOf())];ge.forEach((te,se)=>{let F=null,E=!1;if(p.sheetConfig.rh&&p.sheetConfig.rh.length){for(let O=0;O<p.sheetConfig.rh.length;O++)if(p.sheetConfig.rh[O].hasOwnProperty("r")&&Rr(p.sheetConfig.rh[O].r)&&p.sheetConfig.rh[O].hasOwnProperty("h")&&Rr(p.sheetConfig.rh[O].h)&&Number(p.sheetConfig.rh[O].r)-1===se){F=p.sheetConfig.rh[O].h,p.gridRowsHeightChanged[`${se}`]=p.sheetConfig.rh[O].h;break}}if(p.sheetConfig.rv&&p.sheetConfig.rv.length){for(let O=0;O<p.sheetConfig.rv.length;O++)if(p.sheetConfig.rv[O].hasOwnProperty("r")&&Rr(p.sheetConfig.rv[O].r)&&p.sheetConfig.rv[O].hasOwnProperty("v")&&Rr(p.sheetConfig.rv[O].v)&&p.sheetConfig.rv[O].v===0&&Number(p.sheetConfig.rv[O].r)-1===se){E=!0,p.gridRowsVisibleChanged[`${se}`]=p.sheetConfig.rv[O].v;break}}p.rowConfigs.push(new yo(se,null,null,F||"default",null,!E,!1,"center"))}),console.log(p.rowConfigs),p.startIndex=0,p.endIndex=0,p.currentSheetData=new Array(ge.length).fill(null).map(()=>new Array(oe.length-1).fill(null)),p.rowConfigs.forEach(te=>{p.columnConfigs.forEach((se,F)=>{if(F>0){let E,O,Ce;p.sheetDataType==="map"&&(E=p.sheetData.find(Ve=>Ve.r===te.index+1&&Ve.c===se.index),O=p.sheetData.find(Ve=>Ve.r===te.index+1&&Ve.c===se.index+1),Ce=p.sheetData.find(Ve=>Ve.r===te.index+1+1&&Ve.c===se.index)),p.sheetDataType==="table"&&(E=p.sheetData[te.index]&&p.sheetData[te.index][se.index-1]?p.sheetData[te.index][se.index-1]:null,O=p.sheetData[te.index]&&p.sheetData[te.index][se.index]?p.sheetData[te.index][se.index]:null,Ce=p.sheetData[te.index+1]&&p.sheetData[te.index][se.index-1]?p.sheetData[te.index+1][se.index-1]:null),p.currentSheetData[te.index][se.index-1]=new kn(te.index,se.index-1,p.sheetDataType==="map"||Tt(E)?E&&E.v?E.v:null:E,null,null,!1,null,0,1,1,p.sheetDataType==="map"?E&&E.fs?E.fs:null:Tt(E)&&E&&E.fs?E.fs:null,p.sheetDataType==="map"?E&&E.ff?E.ff:null:Tt(E)&&E&&E.ff?E.ff:null,!!((p.sheetDataType==="map"||Tt(E))&&E&&E.bl),!!((p.sheetDataType==="map"||Tt(E))&&E&&E.it),!!((p.sheetDataType==="map"||Tt(E))&&E&&E.ol),!!((p.sheetDataType==="map"||Tt(E))&&E&&E.cl),!!((p.sheetDataType==="map"||Tt(E))&&E&&E.ul),p.sheetDataType==="map"?E&&E.bg?E.bg:null:Tt(E)&&E&&E.bg?E.bg:null,Ne(p.sheetDataType==="map"?E&&E.bg?E.bg:null:Tt(E)&&E&&E.bg?E.bg:null,(p.sheetDataType==="map"||Tt(Ce)?Ce&&Ce.bdt:null)||(p.sheetDataType==="map"||Tt(E)?E&&E.bdb:null),(p.sheetDataType==="map"||Tt(O)?O&&O.bdl:null)||(p.sheetDataType==="map"||Tt(E)?E&&E.bdr:null)),E&&E.fc?E.fc:null,!!((p.sheetDataType==="map"||Tt(E))&&E&&E.bdt),!!((p.sheetDataType==="map"||Tt(E))&&E&&E.bdb),!!((p.sheetDataType==="map"||Tt(E))&&E&&E.bdl),!!((p.sheetDataType==="map"||Tt(E))&&E&&E.bdr),p.sheetDataType==="map"?E&&E.av?E.av:null:Tt(E)&&E&&E.av?E.av:null,p.sheetDataType==="map"?E&&E.ah?E.ah:null:Tt(E)&&E&&E.ah?E.ah:null,p.sheetDataType==="map"?E&&E.cf?E.cf:null:Tt(E)&&E&&E.cf?E.cf:null)}})}),console.log(p.currentSheetData),Ee()}),$e=Ee=>{if($.closeMenu){const{ctxMenuStore:oe}=p,ge=X.value;oe.visible&&ge&&!Zt.getEventTargetNode(Ee,ge).flag&&$.closeMenu()}},De=()=>{$.closeMenu&&$.closeMenu(),$.recalculate(!0)},xt=Ee=>{if($.closeMenu){const{ctxMenuStore:oe}=p,ge=X.value;oe.visible&&ge&&!Zt.getEventTargetNode(Ee,ge).flag&&$.closeMenu()}},Vt=Ee=>{if($.closeMenu){const{ctxMenuStore:oe}=p,ge=X.value;oe.visible&&ge&&!Zt.getEventTargetNode(Ee,ge).flag&&$.closeMenu()}};rr(()=>e.size,()=>{$.recalculate(!0).then(()=>{$.calcCurrentCellPosition()}).finally(()=>{Mt.on($,"mousewheel",$e),Mt.on($,"mousedown",xt),Mt.on($,"keydown",Vt),Mt.on($,"resize",De),$.handleContextmenuEvent&&Mt.on($,"contextmenu",$.handleContextmenuEvent)})}),rr(()=>p.currentCell,()=>{$.calcCurrentCellPosition()},{deep:!0}),rr(()=>p.currentCellEditorActive,()=>{$.calcCurrentCellDisplay()}),rr(()=>e.data,()=>{console.log(e.data),Be().then(()=>{$.recalculate(!0).then(()=>{const Ee=c.value,oe=$.getParentElem();ye=Hh(()=>{$.recalculate(!0)}),Ee&&ye.observe(Ee),oe&&ye.observe(oe),Mt.on($,"mousewheel",$e),Mt.on($,"mousedown",xt),Mt.on($,"keydown",Vt),Mt.on($,"resize",De),$.handleContextmenuEvent&&Mt.on($,"contextmenu",$.handleContextmenuEvent)}).finally(()=>{$.calc()})})},{deep:!0}),xr(()=>{Be().then(()=>{$.recalculate(!0).then(()=>{const Ee=c.value,oe=$.getParentElem();ye=Hh(()=>{$.recalculate(!0)}),Ee&&ye.observe(Ee),oe&&ye.observe(oe),Mt.on($,"mousewheel",$e),Mt.on($,"mousedown",xt),Mt.on($,"keydown",Vt),Mt.on($,"resize",De),$.handleContextmenuEvent&&Mt.on($,"contextmenu",$.handleContextmenuEvent)}).finally(()=>{$.calc()})})}),ki(()=>{ye&&ye.disconnect(),$.closeMenu&&$.closeMenu()}),Ii(()=>{Mt.off($,"mousedown"),Mt.off($,"mousewheel"),Mt.off($,"keydown"),Mt.off($,"resize"),Mt.off($,"contextmenu")});const ar=()=>Z("div",{ref:c,class:["vma-grid",`${e.size}`,`${e.type}`,{"overflow-x":p.overflowX,"overflow-y":p.overflowY}]},[e.resizeColumn?Z("div",{ref:d,class:["column-resize-bar",`${e.type}`],style:p.overflowX?{height:`calc(100% - ${p.scrollbarHeight}px)`}:{}}):mt(),e.resizeRow?Z("div",{ref:h,class:["row-resize-bar",`${e.type}`],style:p.overflowY?{width:`calc(100% - ${p.scrollbarWidth}px)`}:{}}):mt(),Z(Ut("VmaGridCtxMenu"),{ref:X}),Z(r,{uid:$.uId,class:["left"],style:{height:`${p.gridHeaderHeight}px`,width:`${p.gridLeftFixedHeaderWidth}px`},fixedType:"left",type:e.type}),Z(r,{uid:$.uId,class:["center"],style:{height:`${p.gridHeaderHeight}px`,width:`${p.gridHeaderWidth}px`},fixedType:"center",type:e.type}),Z(n,{uid:$.uId,class:["left-top"],fixedType:"left-top",type:e.type}),Z(n,{uid:$.uId,class:["left"],fixedType:"left",type:e.type}),Z(n,{uid:$.uId,class:["top"],fixedType:"top",type:e.type}),Z(n,{uid:$.uId,class:["center"],style:{height:`${p.gridBodyHeight}px`},fixedType:"center",type:e.type}),a.name?Z(a,{type:"font-size",ref:B}):mt(),i.name?Z(i,{type:"foo",ref:H}):mt(),s.name?Z(s,{type:"foo",ref:re}):mt()]);return $.renderVN=ar,wt("$vmaCalcGrid",$),$},render(){return this.renderVN()}}),Xh=it({name:"VmaGridHeader",props:{fixedType:{type:String,default:"center"},type:{type:String,default:"default"}},setup(e,t){const r=_t("$vmaCalcGrid",{}),{refGridHeader:n,refGridLeftFixedHeader:a,refGridLeftFixedHeaderX:i,refGridHeaderTable:s,refGridLeftFixedHeaderTable:d,refGridHeaderColgroup:h,refGridLeftFixedHeaderColgroup:c}=r.getRefs(),o=Ut("VmaGridCell"),l=Cr({}),u={uId:At.create().toString(),props:e,context:t,reactiveData:l},f=()=>{const b=[];r.reactiveData.startColIndex!==0&&b.push(Z("col",{idx:0,style:{width:`${r.reactiveData.columnConfigs[0].renderWidth}px`}}));for(let v=r.reactiveData.startColIndex;v<=r.reactiveData.endColIndex&&!(v>r.reactiveData.columnConfigs.length-1);v++)b.push(Z("col",{idx:v,style:{width:`${r.reactiveData.columnConfigs[v].renderWidth}px`}}));return b},m=()=>{const b=[],v=[];r.reactiveData.startColIndex!==0&&v.push(Z(o,{cat:"grid-corner",type:`${e.type}`,r:0,c:0,row:0,col:0}));for(let w=r.reactiveData.startColIndex;w<=r.reactiveData.endColIndex&&!(w>r.reactiveData.columnConfigs.length-1);w++)if(w===0)v.push(Z(o,{cat:"grid-corner",type:`${e.type}`,r:0,c:0,row:0,col:0}));else{const y=r.reactiveData.columnConfigs[w];v.push(Z(o,{cat:"column-indicator",type:`${e.type}`,r:0,c:y.index,row:0,col:y.index}))}return v.concat(r.reactiveData.scrollbarWidth?[Z(o,{cat:"gutter-corner",type:`${e.type}`,r:0,c:r.reactiveData.columnConfigs.length,row:0,col:r.reactiveData.columnConfigs.length})]:[mt()]),b.push(Z("tr",{style:{height:`${Ci(r.props.gridRowHeight,r.props.size)}px`}},v)),b},g=()=>Z("div",{ref:e.fixedType==="center"?n:a,class:["header-wrapper",`${e.type}`]},[Z("div",{ref:i,style:{float:"left",height:"1px",marginTop:"-1px"}}),Z("table",{ref:e.fixedType==="center"?s:d,class:["header",`${e.type}`]},[Z("colgroup",{ref:e.fixedType==="center"?h:c},f().concat(r.reactiveData.scrollbarWidth?[Z("col",{idx:r.reactiveData.columnConfigs.length,style:{width:`${r.reactiveData.scrollbarWidth}px`}})]:[mt()])),Z("thead",{class:[`${e.type}`]},m())])]);return u.renderVN=g,wt("$vmaCalcGridHeader",u),u},render(){return this.renderVN()}}),jh=it({name:"VmaGridBody",props:{fixedType:{type:String,default:"center"},type:{type:String,default:"default"}},setup(e,t){const r=_t("$vmaCalcGrid",{}),{refGridBody:n,refGridLeftFixedBody:a,refGridLeftFixedBodyX:i,refGridLeftFixedBodyY:s,refGridBodyX:d,refGridBodyY:h,refGridTopFixedBody:c,refGridLeftFixedBodyScrollWrapper:o,refGridLeftTopFixedBody:l,refGridBodyTable:u,refGridLeftFixedBodyTable:f,refGridBodyColgroup:m,refGridLeftFixedBodyColgroup:g,refGridHeader:b,refCurrentCellEditor:v,refCurrentCellBorderTop:w,refCurrentCellBorderRight:y,refCurrentCellBorderBottom:_,refCurrentCellBorderLeft:T,refCurrentCellBorderCorner:A,refCurrentAreaBorderTop:x,refCurrentAreaBorderRight:C,refCurrentAreaBorderBottom:N,refCurrentAreaBorderLeft:P,refCurrentAreaBorderCorner:z}=r.getRefs(),{columnConfigs:K,rowConfigs:q}=r.reactiveData,W=Ut("VmaGridCell"),ce=Ge(()=>Ci(r.props.gridRowHeight,r.props.size)),V=Ge(()=>Wo(r.props.gridColumnWidth,r.props.size)),G=Cr({}),j={uId:At.create().toString(),props:e,context:t,reactiveData:G},ie=Ut("VmaGridTextarea");Ge(()=>K),Ge(()=>q);const fe=()=>{const re=[];r.reactiveData.startColIndex!==0&&re.push(Z("col",{idx:0}));for(let ne=r.reactiveData.startColIndex;ne<=r.reactiveData.endColIndex&&!(ne>r.reactiveData.columnConfigs.length-1);ne++)re.push(Z("col",{idx:ne}));return re},ve=()=>{const re=[];for(let ne=r.reactiveData.startIndex;ne<=r.reactiveData.endIndex&&!(ne>r.reactiveData.rowConfigs.length-1);ne++){const p=r.reactiveData.rowConfigs[ne],ye=[];r.reactiveData.startColIndex!==0&&ye.push(Z(W,{cat:"row-indicator",type:`${e.type}`,r:p.index,c:0,row:p.index,col:0}));for(let $=r.reactiveData.startColIndex;$<=r.reactiveData.endColIndex&&!($>r.reactiveData.columnConfigs.length-1);$++)if($===0)ye.push(Z(W,{cat:"row-indicator",type:`${e.type}`,r:p.index,c:0,row:p.index,col:0,id:`${p.index}_0`}));else{const pe=r.reactiveData.columnConfigs[$];ye.push(Z(W,{cat:"normal",type:`${e.type}`,r:p.index,c:pe.index,row:p.index,col:pe.index,id:`${p.index}_${pe.index}`,cf:r.reactiveData.currentSheetData[p.index][pe.index-1].cf}))}re.push(Z("tr",{row:ne,style:{height:p.visible?typeof p.renderHeight=="string"?`${ce.value}px`:`${p.renderHeight}px`:0}},ye))}return re},xe=re=>{e.fixedType==="center"?(b.value.scrollLeft=n.value.scrollLeft,o.value.scrollTop=n.value.scrollTop):e.fixedType==="left"&&(n.value.scrollTop=o.value.scrollTop),r.triggerScrollXEvent(re),r.triggerScrollYEvent(re)};let Te,Me=0,J=0,S=0,I=!1,U=0,me=0,Y=0,be=!1;const X=(re,ne,p)=>{const ye=be===p?Math.max(0,U-Y):0;be=p,U=Math.abs(p?ne-ye:ne+ye),me=0,Y=0,clearTimeout(Te);const $=()=>{if(Y<U){me=Math.max(5,Math.floor(me*1.5)),Y+=me,Y>U&&(me-=Y-U);const{scrollTop:pe,clientHeight:ue,scrollHeight:Oe}=n.value,Ne=pe+me*(p?-1:1);n.value.scrollTop=Ne,a.value.scrollTop=Ne,(p?Ne<Oe-ue:Ne>=0)&&(Te=setTimeout($,10))}};$()},k=(re,ne,p)=>{const ye=I===p?Math.max(0,Me-S):0;I=p,Me=Math.abs(p?ne-ye:ne+ye),J=0,S=0,clearTimeout(Te);const $=()=>{if(S<Me){J=Math.max(5,Math.floor(J*1.5)),S+=J,S>Me&&(J-=S-Me);const{scrollLeft:pe,clientWidth:ue,scrollWidth:Oe}=n.value,Ne=pe+J*(p?-1:1);n.value.scrollLeft=Ne,(p?Ne<Oe-ue:Ne>=0)&&(Te=setTimeout($,10))}};$()},B=re=>{e.fixedType==="center"?(n.value.onscroll=xe,o.value.onscroll=null):e.fixedType==="left"&&(n.value.onscroll=null,o.value.onscroll=xe);const{deltaX:ne,deltaY:p}=re,ye=p<0,$=ne<0,pe=e.fixedType==="left"?a.value:n.value;let ue=!1;(ne===0&&ye?pe.scrollTop<=0:pe.scrollTop>=pe.scrollHeight-pe.clientHeight-10*ce.value)&&(ue=!0);let Oe=!1;if((p===0&&$?pe.scrollLeft<=0:pe.scrollLeft>=pe.scrollWidth-pe.clientWidth-10*V.value)&&(Oe=!0),!(Oe&&ue)){if(!Oe){const{lastScrollLeft:Ne}=r.reactiveData,ke=pe.scrollLeft+ne;ke!==Ne&&(re.preventDefault(),r.reactiveData.lastScrollLeft=ke,r.reactiveData.lastScrollTime=Date.now(),k(re,ne,$),r.triggerScrollXEvent(re))}if(!ue){const{lastScrollTop:Ne}=r.reactiveData,ke=pe.scrollTop+p;ke!==Ne&&(re.preventDefault(),r.reactiveData.lastScrollTop=ke,r.reactiveData.lastScrollTime=Date.now(),X(re,p,ye),r.triggerScrollYEvent(re))}}};xr(()=>{pt(()=>{e.fixedType==="left"?(n.value.onscroll=null,o.value.onscroll=xe):e.fixedType==="center"&&(n.value.onscroll=xe,o.value.onscroll=null)})}),ki(()=>{n&&n.value&&(n.value.onscroll=null),o&&o.value&&(o.value.onscroll=null)});const H=()=>Z("div",{ref:e.fixedType==="center"?n:e.fixedType==="left"?a:e.fixedType==="top"?c:l,class:["body-wrapper"],onWheel:B},[e.fixedType==="left"?Z("div",{ref:o,class:["fixed-wrapper"],style:{height:`${r.reactiveData.gridBodyHeight-r.reactiveData.scrollbarHeight}px`}},[Z("div",{ref:s,style:{float:"left",width:0}}),Z("div",{ref:i,style:{float:"left",height:"1px",marginTop:"-1px"}}),Z("table",{ref:f,class:["body"]},[Z("colgroup",{ref:g},fe()),Z("tbody",{},ve())])]):e.fixedType==="center"?[Z("div",{ref:h,style:{float:"left",width:0}}),Z("div",{ref:d,style:{float:"left",height:"1px",marginTop:"-1px"}}),Z("table",{ref:u,class:["body"]},[Z("colgroup",{ref:m},fe()),Z("tbody",{},ve())])]:mt(),e.fixedType==="center"?Z(ie,{ref:v,class:["cell-editor"],size:r.props.size,type:r.props.type,modelValue:r.reactiveData.currentCellEditorContent,"onUpdate:modelValue":re=>{r.reactiveData.currentCellEditorContent=re},style:{display:r.reactiveData.currentCellEditorStyle.display,transform:r.reactiveData.currentCellEditorStyle.transform,height:r.reactiveData.currentCellEditorStyle.height,width:r.reactiveData.currentCellEditorStyle.width,left:r.reactiveData.currentCellEditorStyle.left,top:r.reactiveData.currentCellEditorStyle.top},onChange:()=>{r.reactiveData.currentCell.v=Rr(r.reactiveData.currentCellEditorContent)?Number(r.reactiveData.currentCellEditorContent):r.reactiveData.currentCellEditorContent},onBlur:()=>{pt(()=>{r.calc()})}}):mt(),e.fixedType==="center"?[Z("div",{ref:T,class:["current-cell-border","left",`${e.type}`],style:{transform:r.reactiveData.currentCellBorderStyle.transform,left:r.reactiveData.currentCellBorderStyle.left,top:r.reactiveData.currentCellBorderStyle.top,height:r.reactiveData.currentCellBorderStyle.height,display:(r.reactiveData.currentCell&&Object.keys(r.reactiveData.currentCell).length>0,"none")}}),Z("div",{ref:w,class:["current-cell-border","top",`${e.type}`],style:{transform:r.reactiveData.currentCellBorderStyle.transform,left:r.reactiveData.currentCellBorderStyle.left,top:r.reactiveData.currentCellBorderStyle.top,width:r.reactiveData.currentCellBorderStyle.width,display:(r.reactiveData.currentCell&&Object.keys(r.reactiveData.currentCell).length>0,"none")}}),Z("div",{ref:y,class:["current-cell-border","right",`${e.type}`],style:{transform:r.reactiveData.currentCellBorderStyle.transform,left:r.reactiveData.currentCellBorderStyle.left+r.reactiveData.currentCellBorderStyle.width,top:r.reactiveData.currentCellBorderStyle.top,height:r.reactiveData.currentCellBorderStyle.height,display:(r.reactiveData.currentCell&&Object.keys(r.reactiveData.currentCell).length>0,"none")}}),Z("div",{ref:_,class:["current-cell-border","bottom",`${e.type}`],style:{transform:r.reactiveData.currentCellBorderStyle.transform,left:r.reactiveData.currentCellBorderStyle.left,top:r.reactiveData.currentCellBorderStyle.top+r.reactiveData.currentCellBorderStyle.height,width:r.reactiveData.currentCellBorderStyle.width,display:(r.reactiveData.currentCell&&Object.keys(r.reactiveData.currentCell).length>0,"none")}}),Z("div",{ref:A,class:["current-cell-border","corner",`${e.type}`],style:{transform:r.reactiveData.currentCellBorderStyle.transform,left:`calc(${r.reactiveData.currentCellBorderStyle.left+r.reactiveData.currentCellBorderStyle.width} - 3px)`,top:`calc(${r.reactiveData.currentCellBorderStyle.top+r.reactiveData.currentCellBorderStyle.height} - 3px)`,display:(r.reactiveData.currentCell&&Object.keys(r.reactiveData.currentCell).length>0,"none")}})]:mt(),e.fixedType==="center"?[Z("div",{ref:P,class:["current-area-border","left",`${e.type}`],style:{transform:r.reactiveData.currentAreaBorderStyle.transform,left:r.reactiveData.currentAreaBorderStyle.left,top:r.reactiveData.currentAreaBorderStyle.top,height:r.reactiveData.currentAreaBorderStyle.height,display:r.reactiveData.currentArea&&Object.keys(r.reactiveData.currentArea).length>0?"block":"none"}}),Z("div",{ref:x,class:["current-area-border","top",`${e.type}`],style:{transform:r.reactiveData.currentAreaBorderStyle.transform,left:r.reactiveData.currentAreaBorderStyle.left,top:r.reactiveData.currentAreaBorderStyle.top,width:r.reactiveData.currentAreaBorderStyle.width,display:r.reactiveData.currentArea&&Object.keys(r.reactiveData.currentArea).length>0?"block":"none"}}),Z("div",{ref:C,class:["current-area-border","right",`${e.type}`],style:{transform:r.reactiveData.currentAreaBorderStyle.transform,left:r.reactiveData.currentAreaBorderStyle.left+r.reactiveData.currentAreaBorderStyle.width,top:r.reactiveData.currentAreaBorderStyle.top,height:r.reactiveData.currentAreaBorderStyle.height,display:r.reactiveData.currentArea&&Object.keys(r.reactiveData.currentArea).length>0?"block":"none"}}),Z("div",{ref:N,class:["current-area-border","bottom",`${e.type}`],style:{transform:r.reactiveData.currentAreaBorderStyle.transform,left:r.reactiveData.currentAreaBorderStyle.left,top:r.reactiveData.currentAreaBorderStyle.top+r.reactiveData.currentAreaBorderStyle.height,width:r.reactiveData.currentAreaBorderStyle.width,display:r.reactiveData.currentArea&&Object.keys(r.reactiveData.currentArea).length>0?"block":"none"}}),Z("div",{ref:z,class:["current-area-border","corner",`${e.type}`],style:{transform:r.reactiveData.currentAreaBorderStyle.transform,left:`calc(${r.reactiveData.currentAreaBorderStyle.left+r.reactiveData.currentAreaBorderStyle.width} - 3px)`,top:`calc(${r.reactiveData.currentAreaBorderStyle.top+r.reactiveData.currentAreaBorderStyle.height} - 3px)`,display:r.reactiveData.currentArea&&Object.keys(r.reactiveData.currentArea).length>0?"block":"none"}})]:mt()]);return j.renderVN=H,wt("$vmaCalcGridBody",j),j},render(){return this.renderVN()}});const NF=e=>{let t=e,r="";do{t--;const n=t%26;r+=String.fromCharCode(n+65),t=Math.trunc((t-n)/26)}while(t>0);return r.split("").reverse().join("")};var Qh=it({name:"VmaGridCell",props:{type:{type:String,default:"default"},cat:{type:String,default:"normal"},r:Number,c:Number,rs:{type:Number,default:1},cs:{type:Number,default:1},cf:{type:Object,default:()=>({fd:"General",t:"g"})}},setup(e,t){const r=_t("$vmaCalcGrid",{}),n=Ut("VmaGridIcon"),{refGridHeader:a,refGridBodyTable:i,refGridLeftFixedBody:s,refRowResizeBar:d,refColumnResizeBar:h,refCurrentCellEditor:c}=r.getRefs(),{currentSheetData:o}=r.reactiveData;I1(()=>e.cat==="normal"&&e.c?{cellBgType:o[e.r][e.c-1]&&o[e.r][e.c-1].bgt?o[e.r][e.c-1].bgt:"0",cellBgCustom:o[e.r][e.c-1]&&o[e.r][e.c-1].bg?o[e.r][e.c-1].bg:""}:{cellBgType:"",cellBgCustom:""});const l=Cr({}),u={uId:At.create().toString(),props:e,context:t,reactiveData:l},f=Ge(()=>Ci(r.props.gridRowHeight,r.props.size)),m=Ge(()=>Wo(r.props.gridColumnWidth,r.props.size)),g=C=>{const N=o[e.r][e.c-1];if(N.cf&&N.cf.t&&N.cf.t!=="g"){const P=Number(N.mv);try{isNaN(P)?C=ma.format(N.cf.fd,N.mv):C=ma.format(N.cf.fd,P)}catch(z){console.error(z)}}return C},b=()=>{const C=o[e.r][e.c-1];return C&&C.mv?g(C.mv):null},v=()=>{let C="";return e.cat==="column-indicator"&&(C=NF(e.c.valueOf())),e.cat==="row-indicator"&&(C=(e.r+1).toString()),e.cat==="normal"&&(C=b()),Z("span",{class:["cell-content"]},C)},w=C=>{const N=Zt.getEventTargetNode(C,i,"normal",P=>P.attributes.hasOwnProperty("row")&&P.attributes.hasOwnProperty("col"));if(N&&N.flag){const P=N.targetElem;r.reactiveData.currentArea.end={r:Number(P.attributes.row.value),c:Number(P.attributes.col.value)-1};const z=r.reactiveData.currentArea.start.c>r.reactiveData.currentArea.end.c?r.reactiveData.currentArea.end.c:r.reactiveData.currentArea.start.c,K=r.reactiveData.currentArea.end.c<r.reactiveData.currentArea.start.c?r.reactiveData.currentArea.start.c:r.reactiveData.currentArea.end.c,q=r.reactiveData.currentArea.start.r>r.reactiveData.currentArea.end.r?r.reactiveData.currentArea.end.r:r.reactiveData.currentArea.start.r,W=r.reactiveData.currentArea.end.r<r.reactiveData.currentArea.start.r?r.reactiveData.currentArea.start.r:r.reactiveData.currentArea.end.r,ce=ya(r.reactiveData.startColIndex,m.value,r.reactiveData.gridColumnsWidthChanged,r.reactiveData.gridColumnsVisibleChanged),V=ba(r.reactiveData.startIndex,f.value,r.reactiveData.gridRowsHeightChanged,r.reactiveData.gridRowsVisibleChanged);pt(()=>{i.value.querySelectorAll(`td[row="${q}"][col="${z+1}"]`).forEach(G=>{const j=`${ce+G.offsetLeft-1}px`,ie=`${V+G.offsetTop-1}px`;r.reactiveData.currentAreaBorderStyle.transform=`translateX(${j}) translateY(${ie})`;const fe=hc(z,K,m.value,r.reactiveData.gridColumnsWidthChanged,r.reactiveData.gridColumnsVisibleChanged),ve=fc(q,W,f.value,r.reactiveData.gridRowsHeightChanged,r.reactiveData.gridRowsVisibleChanged);r.reactiveData.currentAreaBorderStyle.height=`${ve}px`,r.reactiveData.currentAreaBorderStyle.width=`${fe}px`}),i.value.querySelectorAll(".cell-active").forEach((G,j)=>{G.classList.remove("cell-active")});for(let G=q;G<=W;G++)for(let j=z;j<=K;j++)i.value.querySelectorAll(`td[row="${G}"][col="${j+1}"]`).forEach(ie=>{ie.classList.add("cell-active")})})}},y=C=>{const N=document.onmousemove,P=document.onmouseup,z=K=>{K.stopPropagation(),K.preventDefault(),w(K)};document.onmousemove=z,document.onmouseup=K=>{document.onmousemove=N,document.onmouseup=P;const q=Zt.getEventTargetNode(K,i,"normal",W=>W.attributes.hasOwnProperty("row")&&W.attributes.hasOwnProperty("col"));if(q&&q.flag){const W=q.targetElem;r.reactiveData.currentArea.end={r:Number(W.attributes.row.value),c:Number(W.attributes.col.value)-1};const ce=r.reactiveData.currentArea.start.c>r.reactiveData.currentArea.end.c?r.reactiveData.currentArea.end.c:r.reactiveData.currentArea.start.c,V=r.reactiveData.currentArea.end.c<r.reactiveData.currentArea.start.c?r.reactiveData.currentArea.start.c:r.reactiveData.currentArea.end.c,G=r.reactiveData.currentArea.start.r>r.reactiveData.currentArea.end.r?r.reactiveData.currentArea.end.r:r.reactiveData.currentArea.start.r,j=r.reactiveData.currentArea.end.r<r.reactiveData.currentArea.start.r?r.reactiveData.currentArea.start.r:r.reactiveData.currentArea.end.r,ie=ya(r.reactiveData.startColIndex,m.value,r.reactiveData.gridColumnsWidthChanged,r.reactiveData.gridColumnsVisibleChanged),fe=ba(r.reactiveData.startIndex,f.value,r.reactiveData.gridRowsHeightChanged,r.reactiveData.gridRowsVisibleChanged);pt(()=>{i.value.querySelectorAll(`td[row="${G}"][col="${ce+1}"]`).forEach(ve=>{const xe=`${ie+ve.offsetLeft-1}px`,Te=`${fe+ve.offsetTop-1}px`;r.reactiveData.currentAreaBorderStyle.transform=`translateX(${xe}) translateY(${Te})`;const Me=hc(ce,V,m.value,r.reactiveData.gridColumnsWidthChanged,r.reactiveData.gridColumnsVisibleChanged),J=fc(G,j,f.value,r.reactiveData.gridRowsHeightChanged,r.reactiveData.gridRowsVisibleChanged);r.reactiveData.currentAreaBorderStyle.height=`${J}px`,r.reactiveData.currentAreaBorderStyle.width=`${Me}px`}),i.value.querySelectorAll(".cell-active").forEach((ve,xe)=>{ve.classList.remove("cell-active")});for(let ve=G;ve<=j;ve++)for(let xe=ce;xe<=V;xe++)i.value.querySelectorAll(`td[row="${ve}"][col="${xe+1}"]`).forEach(Te=>{Te.classList.add("cell-active")})})}}},_=C=>{const{clientX:N}=C,P=document.onmousemove,z=document.onmouseup,K=C.target,q=a.value,W=Zt.getOffsetPos(K,q),ce=K.clientWidth,V=Wo(r.props.gridColumnWidth,r.props.size),G=ya(r.reactiveData.startColIndex,m.value,r.reactiveData.gridColumnsWidthChanged,r.reactiveData.gridColumnsVisibleChanged),j=ce,ie=W.left+Math.floor(j)+G,fe=K.parentNode,ve=Math.max(W.left-fe.clientWidth+j,0);let xe=0;const Te=h.value;Te.style.left=`${W.left+j+G}px`,Te.style.display="block";const Me=J=>{J.stopPropagation(),J.preventDefault();const S=J.clientX-N,I=ie+S;xe=Math.max(I,ve),Te.style.left=`${xe}px`,Te.style.display="block"};document.onmousemove=Me,document.onmouseup=()=>{if(document.onmousemove=P,document.onmouseup=z,Te.style.display="none",K.parentElement.getAttribute("col")){const J=r.reactiveData.columnConfigs.find(S=>S.index===parseInt(K.parentElement.getAttribute("col"),10));J&&(J.renderWidth=Math.max(K.parentElement.clientWidth+xe-ie,6),r.reactiveData.gridColumnsWidthChanged[`${J.index}`]=J.renderWidth,r.reactiveData.gridWidth+=J.renderWidth-V)}K.parentElement.style.width=`${Math.max(K.parentElement.clientWidth+xe-ie,6)}px`,r.recalculate(!0).then(()=>{pt(()=>{r.calcCurrentCellPosition(),r.calcCurrentCellDisplay()})})}},T=C=>{const{clientY:N}=C,P=document.onmousemove,z=document.onmouseup,K=C.target,q=s.value,W=Zt.getOffsetPos(K,q),ce=K.clientHeight,V=Ci(r.props.gridRowHeight,r.props.size),G=ba(r.reactiveData.startIndex,f.value,r.reactiveData.gridRowsHeightChanged,r.reactiveData.gridRowsVisibleChanged),j=ce,ie=W.top+Math.floor(j)+G,fe=K.parentNode,ve=Math.max(W.top-fe.clientHeight+j,0);let xe=0;const Te=d.value;Te.style.top=`${W.top+a.value.clientHeight+j+G}px`,Te.style.display="block";const Me=J=>{J.stopPropagation(),J.preventDefault();const S=J.clientY-N,I=ie+S;xe=Math.max(I,ve),Te.style.top=`${xe+a.value.clientHeight}px`,Te.style.display="block"};document.onmousemove=Me,document.onmouseup=()=>{if(document.onmousemove=P,document.onmouseup=z,Te.style.display="none",K.parentElement.getAttribute("row")){const J=r.reactiveData.rowConfigs.find(S=>S.index===parseInt(K.parentElement.getAttribute("row"),10));J&&(J.renderHeight=Math.max(K.parentElement.clientHeight+xe-ie,6),r.reactiveData.gridRowsHeightChanged[`${J.index}`]=J.renderHeight,r.reactiveData.gridHeight+=J.renderHeight-V)}K.parentElement.parentElement.style.height=`${Math.max(K.parentElement.clientHeight+xe-ie,6)}px`,r.recalculate(!0).then(()=>{pt(()=>{r.calcCurrentCellPosition(),r.calcCurrentCellDisplay()})})}},A=()=>{if(e.cat==="row-indicator")return[Z("div",{class:["cell",`${e.type}`],style:{display:"flex",justifyContent:"center",alignItems:"center"}},v()),r.props.resizeRow?Z("div",{class:["row-resize-handler",`${e.type}`],onMousedown:N=>{T(N),N.stopPropagation()}}):mt(),Z("div",{style:{display:r.reactiveData.gridRowsVisibleChanged&&Object.keys(r.reactiveData.gridRowsVisibleChanged).length>0&&r.reactiveData.gridRowsVisibleChanged.hasOwnProperty(`${e.r-1}`)?"block":"none"},class:["row-hide-info-upward"],onClick:N=>{const z=N.target.parentElement.parentElement;r.updateRow("showUpRows",z.attributes.row.value,z.attributes.col.value)}},Z(n,{name:"ellipsis-h",size:r.props.size,translateY:wo(r.props.size),scaleX:.7,scaleY:.7})),Z("div",{style:{display:r.reactiveData.gridRowsVisibleChanged&&Object.keys(r.reactiveData.gridRowsVisibleChanged).length>0&&r.reactiveData.gridRowsVisibleChanged.hasOwnProperty(`${e.r+1}`)?"block":"none"},class:["row-hide-info-downward"],onClick:N=>{const z=N.target.parentElement.parentElement;r.updateRow("showDownRows",z.attributes.row.value,z.attributes.col.value)}},Z(n,{name:"ellipsis-h",size:r.props.size,translateY:wo(r.props.size),scaleX:.7,scaleY:.7}))];if(e.cat==="column-indicator")return[Z("div",{class:["cell",`${e.type}`],style:{display:"flex",justifyContent:"center",alignItems:"center"}},v()),r.props.resizeRow?Z("div",{class:["column-resize-handler",`${e.type}`],onMousedown:N=>{_(N),N.stopPropagation()}}):mt(),Z("div",{style:{display:r.reactiveData.gridColumnsVisibleChanged&&Object.keys(r.reactiveData.gridColumnsVisibleChanged).length>0&&r.reactiveData.gridColumnsVisibleChanged.hasOwnProperty(`${e.c-1-1}`)?"block":"none"},class:["column-hide-info-frontward"],onClick:N=>{const z=N.target.parentElement.parentElement;r.updateColumn("showFrontColumns",z.attributes.row.value,z.attributes.col.value)}},Z(n,{name:"ellipsis-h",size:r.props.size,translateY:wo(r.props.size),scaleX:.7,scaleY:.7})),Z("div",{style:{display:r.reactiveData.gridColumnsVisibleChanged&&Object.keys(r.reactiveData.gridColumnsVisibleChanged).length>0&&r.reactiveData.gridColumnsVisibleChanged.hasOwnProperty(`${e.c}`)?"block":"none"},class:["column-hide-info-backward"],onClick:N=>{const z=N.target.parentElement.parentElement;r.updateColumn("showBackColumns",z.attributes.row.value,z.attributes.col.value)}},Z(n,{name:"ellipsis-h",size:r.props.size,translateY:wo(r.props.size),scaleX:.7,scaleY:.7}))];if(e.cat==="grid-corner")return[Z("div",{class:["cell",`${e.type}`]},Z("div",{class:["corner"]}))];const C=[];return o[e.r][e.c-1].cl&&C.push("line-through"),o[e.r][e.c-1].ul&&C.push("underline"),o[e.r][e.c-1].ol&&C.push("overline"),Z("div",{class:["cell",`${e.type}`],style:{display:"flex",justifyContent:o[e.r][e.c-1]&&o[e.r][e.c-1].ah?o[e.r][e.c-1].ah==="left"?"flex-start":o[e.r][e.c-1].ah==="right"?"flex-end":"center":r.props.alignH==="left"?"flex-start":r.props.alignH==="right"?"flex-end":"center",alignItems:o[e.r][e.c-1]&&o[e.r][e.c-1].av?o[e.r][e.c-1].av==="top"?"flex-start":o[e.r][e.c-1].av==="bottom"?"flex-end":"center":r.props.alignV==="top"?"flex-start":r.props.alignV==="bottom"?"flex-end":"center",fontSize:o[e.r][e.c-1].fs?`${o[e.r][e.c-1].fs}px`:null,fontFamily:o[e.r][e.c-1].ff?`${o[e.r][e.c-1].ff}`:null,fontStyle:o[e.r][e.c-1].it?"italic":null,fontWeight:o[e.r][e.c-1].bl?"bold":null,textDecoration:C.length>0?C.join(" "):null,color:o[e.r][e.c-1].fc},onMouseup:()=>{r.reactiveData.currentAreaStatus=!1},onMousedown:N=>{if(r.reactiveData.currentAreaStatus=!0,r.reactiveData.currentCellEditorActive=!1,r.reactiveData.currentCell=o[e.r][e.c-1],r.reactiveData.currentCellEditorContent=o[e.r][e.c-1].v,r.reactiveData.currentArea&&Object.keys(r.reactiveData.currentArea).length>1&&N.button===2){const P=Zt.getEventTargetNode(N,i,"normal",z=>z.attributes.hasOwnProperty("row")&&z.attributes.hasOwnProperty("col"));if(P&&P.flag){const z=P.targetElem,K=z.attributes.row.value,q=z.attributes.col.value,W=r.reactiveData.currentArea.start.c>r.reactiveData.currentArea.end.c?r.reactiveData.currentArea.end.c:r.reactiveData.currentArea.start.c,ce=r.reactiveData.currentArea.end.c<r.reactiveData.currentArea.start.c?r.reactiveData.currentArea.start.c:r.reactiveData.currentArea.end.c,V=r.reactiveData.currentArea.start.r>r.reactiveData.currentArea.end.r?r.reactiveData.currentArea.end.r:r.reactiveData.currentArea.start.r,G=r.reactiveData.currentArea.end.r<r.reactiveData.currentArea.start.r?r.reactiveData.currentArea.start.r:r.reactiveData.currentArea.end.r;Number(K)>=V&&Number(K)<=G&&Number(q-1)>=W&&Number(q-1)<=ce||(r.reactiveData.currentArea={},r.reactiveData.currentArea.start={r:Number(e.r),c:Number(e.c)-1},pt(()=>{y()}))}}else r.reactiveData.currentArea={},r.reactiveData.currentArea.start={r:Number(e.r),c:Number(e.c)-1},pt(()=>{y()})},onDblclick:()=>{r.reactiveData.currentCellEditorActive=!0,pt(()=>{c.value.$el.querySelectorAll("textarea").forEach(N=>{N.focus()})})}},v())},x=()=>Z(e.cat==="normal"||e.cat==="row-indicator"?"td":"th",{rowspan:e.rs,colspan:e.cs,class:[e.cat,`${e.type}`,`cell-bg-${e.cat==="normal"&&e.c&&o[e.r][e.c-1]&&o[e.r][e.c-1].bgt?o[e.r][e.c-1].bgt:"0"}`,{"column-indicator-active":e.cat==="column-indicator"&&r.reactiveData.currentArea&&Object.keys(r.reactiveData.currentArea).length>1&&(e.c-1>=r.reactiveData.currentArea.start.c&&e.c-1<=r.reactiveData.currentArea.end.c||e.c-1>=r.reactiveData.currentArea.end.c&&e.c-1<=r.reactiveData.currentArea.start.c),"row-indicator-active":e.cat==="row-indicator"&&r.reactiveData.currentArea&&Object.keys(r.reactiveData.currentArea).length>1&&(e.r>=r.reactiveData.currentArea.start.r&&e.r<=r.reactiveData.currentArea.end.r||e.r>=r.reactiveData.currentArea.end.r&&e.r<=r.reactiveData.currentArea.start.r)}],style:{overflow:"hidden"}},A());return u.renderVN=x,wt("$vmaCalcGridCell",u),u},render(){return this.renderVN()}});const AF={install(e){e.component(qh.name,qh),e.component(Xh.name,Xh),e.component(jh.name,jh),e.component(Qh.name,Qh)}};var Zh=it({name:"VmaGridFoobarPlugin",props:{type:{type:String,default:"foo"}},setup(e,t){const r={uId:At.create().toString(),props:e,context:t};Object.assign(r,{foobar:i=>`foobar plugin ${i}`});const a=()=>Z("div",{class:["vma-grid-foobar-plugin",e.type]});return r.renderVN=a,wt("$vmaGridFoobarPlugin",r),r},render(){return this.renderVN()}});const CF={install(e){e.component(Zh.name,Zh)}};var Jh=it({name:"VmaGridStylePlugin",props:{type:{type:String,default:"font-size"}},setup(e,t){const r={uId:At.create().toString(),props:e,context:t};Object.assign(r,{foobar:i=>`foobar plugin ${i}`,fontSize:()=>{const i=[];return i.push("8"),i.push("9"),i.push("10"),i.push("11"),i.push("12"),i.push("14"),i.push("16"),i.push("18"),i.push("20"),i.push("22"),i.push("24"),i.push("26"),i.push("28"),i.push("36"),i.push("48"),i.push("72"),i},fontFamily:()=>{const i=[];return i.push("Times New Roman"),i.push("Arial"),i.push("Tahoma"),i.push("Verdana"),i.push("\u5FAE\u8F6F\u96C5\u9ED1"),i.push("\u5B8B\u4F53"),i.push("\u9ED1\u4F53"),i.push("\u6977\u4F53"),i.push("\u4EFF\u5B8B"),i.push("\u65B0\u5B8B\u4F53"),i.push("\u534E\u6587\u65B0\u9B4F"),i.push("\u534E\u6587\u884C\u6977"),i.push("\u534E\u6587\u96B6\u4E66"),i},fontStyle:()=>{const i={};return i.bl="\u7C97\u4F53",i.it="\u659C\u4F53",i.ol="\u4E0A\u5212\u7EBF",i.cl="\u4E2D\u5212\u7EBF",i.ul="\u4E0B\u5212\u7EBF",i}});const a=()=>mt();return r.renderVN=a,wt("$vmaGridStylePlugin",r),r},render(){return this.renderVN()}});const xF={install(e){e.component(Jh.name,Jh)}};var ep=it({name:"VmaGridBorderPlugin",props:{type:{type:String,default:"foo"}},setup(e,t){const r={uId:At.create().toString(),props:e,context:t};Object.assign(r,{foobar:i=>`foobar plugin ${i}`,out:()=>"\u5916\u4FA7\u6846\u7EBF",outBolder:()=>"\u7C97\u5916\u4FA7\u6846\u7EBF",inner:()=>"\u5185\u90E8\u6846\u7EBF",all:()=>"\u6240\u6709\u6846\u7EBF",none:()=>"\u65E0\u6846\u7EBF",left:()=>"\u5DE6\u6846\u7EBF",right:()=>"\u53F3\u6846\u7EBF",top:()=>"\u4E0A\u6846\u7EBF",bottom:()=>"\u4E0B\u6846\u7EBF"});const a=()=>mt();return r.renderVN=a,wt("$vmaGridBorderPlugin",r),r},render(){return this.renderVN()}});const TF={install(e){e.component(ep.name,ep)}};var tp=it({name:"VmaGridAlignPlugin",props:{type:{type:String,default:"foo"}},setup(e,t){const r={uId:At.create().toString(),props:e,context:t};Object.assign(r,{vertical:()=>{const i={};return i.avt="\u5782\u76F4\u5C45\u4E0A",i.avm="\u5782\u76F4\u5C45\u4E2D",i.avb="\u5782\u76F4\u5C45\u4E0B",i},horizontal:()=>{const i={};return i.ahl="\u6C34\u5E73\u5C45\u5DE6",i.ahc="\u6C34\u5E73\u5C45\u4E2D",i.ahr="\u6C34\u5E73\u5C45\u53F3",i}});const a=()=>mt();return r.renderVN=a,wt("$vmaGridAlignPlugin",r),r},render(){return this.renderVN()}});const RF={install(e){e.component(tp.name,tp)}},OF=[CF,xF,TF,RF],kF=[Pw,Sw,Lw,$w,Dw,Uw,Fw,Jw,e_,AF];function IF(e,t){kF.forEach(r=>r.install(e)),OF.forEach(r=>r.install(e))}os.install=IF;var MF=_n({enhance:({app:e,router:t,siteData:r})=>{e.use(os)}});const Cl=[hE,mE,EE,ME,$E,VE,Ow,MF],PF=[["v-8daa1a0e","/",{title:"\u9996\u9875"},["/index.html","/README.md"]],["v-2f4d3eda","/basic/grid-button.html",{title:""},["/basic/grid-button","/basic/grid-button.md"]],["v-7f75cc29","/basic/grid-checkbox.html",{title:""},["/basic/grid-checkbox","/basic/grid-checkbox.md"]],["v-13863eb3","/basic/grid-icon.html",{title:"\u56FE\u6807"},["/basic/grid-icon","/basic/grid-icon.md"]],["v-12fb0d8a","/basic/grid-loading.html",{title:"Loading"},["/basic/grid-loading","/basic/grid-loading.md"]],["v-90541d2a","/basic/grid-radio.html",{title:""},["/basic/grid-radio","/basic/grid-radio.md"]],["v-0016c312","/basic/grid-textarea.html",{title:""},["/basic/grid-textarea","/basic/grid-textarea.md"]],["v-5107b6ce","/basic/grid.html",{title:""},["/basic/grid","/basic/grid.md"]],["v-1a1874fc","/formula/",{title:"Vue 3 + Typescript + Vite"},["/formula/index.html","/formula/README.md"]],["v-e0e76f98","/formula/modules.html",{title:"vma-grid"},["/formula/modules","/formula/modules.md"]],["v-a9cea3dc","/formula/classes/index.DepParser.html",{title:"Class: DepParser"},["/formula/classes/index.DepParser","/formula/classes/index.DepParser.md"]],["v-44208220","/formula/classes/index.FormulaError.html",{title:"Class: FormulaError"},["/formula/classes/index.FormulaError","/formula/classes/index.FormulaError.md"]],["v-6da1d8db","/formula/classes/index.FormulaParser.html",{title:"Class: FormulaParser"},["/formula/classes/index.FormulaParser","/formula/classes/index.FormulaParser.md"]],["v-cf6e5f3c","/formula/modules/formulas.html",{title:"Module: formulas"},["/formula/modules/formulas","/formula/modules/formulas.md"]],["v-201aed0a","/formula/modules/",{title:"Module: index"},["/formula/modules/index.html","/formula/modules/index.md"]],["v-3706649a","/404.html",{title:""},["/404"]]],SF=PF.reduce((e,[t,r,n,a])=>(e.push({name:t,path:r,component:Ed,meta:n},...a.map(i=>({path:i,redirect:r}))),e),[{name:"404",path:"/:catchAll(.*)",component:Ed}]);var LF=_y,$F=()=>{const e=iE({history:LF(K1(mn.value.base)),routes:SF,scrollBehavior:(t,r,n)=>n||(t.hash?{el:t.hash}:{top:0})});return e.beforeResolve(async(t,r)=>{var n;(t.path!==r.path||r===jr)&&([Zr.value]=await Promise.all([Mn.resolvePageData(t.name),(n=sg[t.name])==null?void 0:n.__asyncLoader()]))}),e},DF=e=>{e.component("ClientOnly",ry),e.component("Content",Dc)},UF=(e,t)=>{const r=Ge(()=>Mn.resolveRouteLocale(mn.value.locales,t.currentRoute.value.path)),n=Ge(()=>Mn.resolveSiteLocaleData(mn.value,r.value)),a=Ge(()=>Mn.resolvePageFrontmatter(Zr.value)),i=Ge(()=>Mn.resolvePageHeadTitle(Zr.value,n.value)),s=Ge(()=>Mn.resolvePageHead(i.value,a.value,n.value)),d=Ge(()=>Mn.resolvePageLang(Zr.value));return e.provide($c,r),e.provide(hg,n),e.provide(ug,a),e.provide(Q1,i),e.provide(dg,s),e.provide(fg,d),Object.defineProperties(e.config.globalProperties,{$frontmatter:{get:()=>a.value},$head:{get:()=>s.value},$headTitle:{get:()=>i.value},$lang:{get:()=>d.value},$page:{get:()=>Zr.value},$routeLocale:{get:()=>r.value},$site:{get:()=>mn.value},$siteLocale:{get:()=>n.value},$withBase:{get:()=>ny}}),{pageData:Zr,pageFrontmatter:a,pageHead:s,pageHeadTitle:i,pageLang:d,routeLocale:r,siteData:mn,siteLocaleData:n}},FF=()=>{const e=Vc(),t=j1(),r=Z1(),n=Se([]),a=()=>{t.value.forEach(s=>{const d=BF(s);d&&n.value.push(d)})},i=()=>{document.documentElement.lang=r.value,n.value.forEach(s=>{s.parentNode===document.head&&document.head.removeChild(s)}),n.value.splice(0,n.value.length),t.value.forEach(s=>{const d=VF(s);d!==null&&(document.head.appendChild(d),n.value.push(d))})};wt(ty,i),xr(()=>{a(),i(),rr(()=>e.path,()=>i())})},BF=([e,t,r=""])=>{const n=Object.entries(t).map(([d,h])=>ft(h)?`[${d}="${h}"]`:h===!0?`[${d}]`:"").join(""),a=`head > ${e}${n}`;return Array.from(document.querySelectorAll(a)).find(d=>d.innerText===r)||null},VF=([e,t,r])=>{if(!ft(e))return null;const n=document.createElement(e);return ig(t)&&Object.entries(t).forEach(([a,i])=>{ft(i)?n.setAttribute(a,i):i===!0&&n.setAttribute(a,"")}),ft(r)&&n.appendChild(document.createTextNode(r)),n},zF=B1,GF=async()=>{var r;const e=zF({name:"VuepressApp",setup(){var n;FF();for(const a of Cl)(n=a.setup)==null||n.call(a);return()=>[Z(xg),...Cl.flatMap(({rootComponents:a=[]})=>a.map(i=>Z(i)))]}}),t=$F();DF(e),UF(e,t);for(const n of Cl)await((r=n.enhance)==null?void 0:r.call(n,{app:e,router:t,siteData:mn}));return e.use(t),{app:e,router:t}};GF().then(({app:e,router:t})=>{t.isReady().then(()=>{e.mount("#app")})});export{ig as $,W1 as A,QF as B,ZF as C,ey as D,JF as E,Qt as F,e8 as G,Et as H,xi as I,Z as J,ny as K,ry as L,Lc as M,rr as N,KF as O,jF as P,Y1 as Q,K1 as R,Bc as S,R as T,ft as U,ww as V,xr as W,Yo as X,Mi as Y,t8 as Z,kg as _,Cr as a,XF as a0,Ii as a1,Nw as a2,Ut as b,qF as c,GF as createVueApp,it as d,Qp as e,kt as f,eg as g,Mc as h,M as i,Fg as j,Fn as k,X1 as l,Ge as m,ze as n,ts as o,YF as p,mt as q,Se as r,Vc as s,p0 as t,J1 as u,WF as v,ub as w,Zp as x,t1 as y,Bp as z};
