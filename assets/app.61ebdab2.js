var P0=Object.defineProperty;var S0=(e,t,r)=>t in e?P0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var le=(e,t,r)=>(S0(e,typeof t!="symbol"?t+"":t,r),r);const Ft={},L0="modulepreload",Ku={},$0="/vma-grid/",Je=function(t,r){return!r||r.length===0?t():Promise.all(r.map(n=>{if(n=`${$0}${n}`,n in Ku)return;Ku[n]=!0;const a=n.endsWith(".css"),i=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${i}`))return;const s=document.createElement("link");if(s.rel=a?"stylesheet":L0,a||(s.as="script",s.crossOrigin=""),s.href=n,document.head.appendChild(s),a)return new Promise((f,h)=>{s.addEventListener("load",f),s.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>t())},nn={"v-8daa1a0e":()=>Je(()=>import("./index.html.64dc988c.js"),[]).then(({data:e})=>e),"v-2f4d3eda":()=>Je(()=>import("./grid-button.html.dca9d15f.js"),[]).then(({data:e})=>e),"v-7f75cc29":()=>Je(()=>import("./grid-checkbox.html.87bd4df2.js"),[]).then(({data:e})=>e),"v-13863eb3":()=>Je(()=>import("./grid-icon.html.662e13e4.js"),[]).then(({data:e})=>e),"v-12fb0d8a":()=>Je(()=>import("./grid-loading.html.b1fc183c.js"),[]).then(({data:e})=>e),"v-90541d2a":()=>Je(()=>import("./grid-radio.html.ae6b148e.js"),[]).then(({data:e})=>e),"v-0016c312":()=>Je(()=>import("./grid-textarea.html.27e7ae0d.js"),[]).then(({data:e})=>e),"v-5107b6ce":()=>Je(()=>import("./grid.html.080b7d64.js"),[]).then(({data:e})=>e),"v-1a1874fc":()=>Je(()=>import("./index.html.753dbce9.js"),[]).then(({data:e})=>e),"v-e0e76f98":()=>Je(()=>import("./modules.html.dc7dab64.js"),[]).then(({data:e})=>e),"v-a9cea3dc":()=>Je(()=>import("./index.DepParser.html.648a1481.js"),[]).then(({data:e})=>e),"v-44208220":()=>Je(()=>import("./index.FormulaError.html.8ca2c5af.js"),[]).then(({data:e})=>e),"v-6da1d8db":()=>Je(()=>import("./index.FormulaParser.html.2af0d4fa.js"),[]).then(({data:e})=>e),"v-cf6e5f3c":()=>Je(()=>import("./formulas.html.2d87822e.js"),[]).then(({data:e})=>e),"v-201aed0a":()=>Je(()=>import("./index.html.2a4dd64c.js"),[]).then(({data:e})=>e),"v-3706649a":()=>Je(()=>import("./404.html.265028f6.js"),[]).then(({data:e})=>e)};function Rc(e,t){const r=Object.create(null),n=e.split(",");for(let a=0;a<n.length;a++)r[n[a]]=!0;return t?a=>!!r[a.toLowerCase()]:a=>!!r[a]}const D0="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",x0=Rc(D0);function dp(e){return!!e||e===""}function Qo(e){if(Ve(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],a=Ke(n)?F0(n):Qo(n);if(a)for(const i in a)t[i]=a[i]}return t}else{if(Ke(e))return e;if($t(e))return e}}const k0=/;(?![^(]*\))/g,U0=/:(.+)/;function F0(e){const t={};return e.split(k0).forEach(r=>{if(r){const n=r.split(U0);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function Si(e){let t="";if(Ke(e))t=e;else if(Ve(e))for(let r=0;r<e.length;r++){const n=Si(e[r]);n&&(t+=n+" ")}else if($t(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const B0=e=>Ke(e)?e:e==null?"":Ve(e)||$t(e)&&(e.toString===gp||!qe(e.toString))?JSON.stringify(e,hp,2):String(e),hp=(e,t)=>t&&t.__v_isRef?hp(e,t.value):Ea(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,a])=>(r[`${n} =>`]=a,r),{})}:pp(t)?{[`Set(${t.size})`]:[...t.values()]}:$t(t)&&!Ve(t)&&!mp(t)?String(t):t,ft={},ya=[],Rr=()=>{},V0=()=>!1,G0=/^on[^a-z]/,Li=e=>G0.test(e),Oc=e=>e.startsWith("onUpdate:"),Kt=Object.assign,wc=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},H0=Object.prototype.hasOwnProperty,et=(e,t)=>H0.call(e,t),Ve=Array.isArray,Ea=e=>Zo(e)==="[object Map]",pp=e=>Zo(e)==="[object Set]",qe=e=>typeof e=="function",Ke=e=>typeof e=="string",Ic=e=>typeof e=="symbol",$t=e=>e!==null&&typeof e=="object",vp=e=>$t(e)&&qe(e.then)&&qe(e.catch),gp=Object.prototype.toString,Zo=e=>gp.call(e),W0=e=>Zo(e).slice(8,-1),mp=e=>Zo(e)==="[object Object]",Mc=e=>Ke(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,hi=Rc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Jo=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},z0=/-(\w)/g,Ur=Jo(e=>e.replace(z0,(t,r)=>r?r.toUpperCase():"")),K0=/\B([A-Z])/g,Zn=Jo(e=>e.replace(K0,"-$1").toLowerCase()),es=Jo(e=>e.charAt(0).toUpperCase()+e.slice(1)),Zs=Jo(e=>e?`on${es(e)}`:""),Ai=(e,t)=>!Object.is(e,t),Js=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},Lo=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},yp=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let qu;const q0=()=>qu||(qu=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let lr;class Y0{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&lr&&(this.parent=lr,this.index=(lr.scopes||(lr.scopes=[])).push(this)-1)}run(t){if(this.active){const r=lr;try{return lr=this,t()}finally{lr=r}}}on(){lr=this}off(){lr=this.parent}stop(t){if(this.active){let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.scopes)for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);if(this.parent&&!t){const a=this.parent.scopes.pop();a&&a!==this&&(this.parent.scopes[this.index]=a,a.index=this.index)}this.active=!1}}}function X0(e,t=lr){t&&t.active&&t.effects.push(e)}function j0(){return lr}function Q0(e){lr&&lr.cleanups.push(e)}const Pc=e=>{const t=new Set(e);return t.w=0,t.n=0,t},Ep=e=>(e.w&On)>0,_p=e=>(e.n&On)>0,Z0=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=On},J0=e=>{const{deps:t}=e;if(t.length){let r=0;for(let n=0;n<t.length;n++){const a=t[n];Ep(a)&&!_p(a)?a.delete(e):t[r++]=a,a.w&=~On,a.n&=~On}t.length=r}},Ml=new WeakMap;let ci=0,On=1;const Pl=30;let Ar;const Kn=Symbol(""),Sl=Symbol("");class Sc{constructor(t,r=null,n){this.fn=t,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,X0(this,n)}run(){if(!this.active)return this.fn();let t=Ar,r=Tn;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Ar,Ar=this,Tn=!0,On=1<<++ci,ci<=Pl?Z0(this):Yu(this),this.fn()}finally{ci<=Pl&&J0(this),On=1<<--ci,Ar=this.parent,Tn=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Ar===this?this.deferStop=!0:this.active&&(Yu(this),this.onStop&&this.onStop(),this.active=!1)}}function Yu(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}let Tn=!0;const bp=[];function Ua(){bp.push(Tn),Tn=!1}function Fa(){const e=bp.pop();Tn=e===void 0?!0:e}function fr(e,t,r){if(Tn&&Ar){let n=Ml.get(e);n||Ml.set(e,n=new Map);let a=n.get(r);a||n.set(r,a=Pc()),Np(a)}}function Np(e,t){let r=!1;ci<=Pl?_p(e)||(e.n|=On,r=!Ep(e)):r=!e.has(Ar),r&&(e.add(Ar),Ar.deps.push(e))}function rn(e,t,r,n,a,i){const s=Ml.get(e);if(!s)return;let f=[];if(t==="clear")f=[...s.values()];else if(r==="length"&&Ve(e))s.forEach((h,c)=>{(c==="length"||c>=n)&&f.push(h)});else switch(r!==void 0&&f.push(s.get(r)),t){case"add":Ve(e)?Mc(r)&&f.push(s.get("length")):(f.push(s.get(Kn)),Ea(e)&&f.push(s.get(Sl)));break;case"delete":Ve(e)||(f.push(s.get(Kn)),Ea(e)&&f.push(s.get(Sl)));break;case"set":Ea(e)&&f.push(s.get(Kn));break}if(f.length===1)f[0]&&Ll(f[0]);else{const h=[];for(const c of f)c&&h.push(...c);Ll(Pc(h))}}function Ll(e,t){const r=Ve(e)?e:[...e];for(const n of r)n.computed&&Xu(n);for(const n of r)n.computed||Xu(n)}function Xu(e,t){(e!==Ar||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const e1=Rc("__proto__,__v_isRef,__isVue"),Ap=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Ic)),t1=Lc(),r1=Lc(!1,!0),n1=Lc(!0),ju=a1();function a1(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const n=at(this);for(let i=0,s=this.length;i<s;i++)fr(n,"get",i+"");const a=n[t](...r);return a===-1||a===!1?n[t](...r.map(at)):a}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){Ua();const n=at(this)[t].apply(this,r);return Fa(),n}}),e}function Lc(e=!1,t=!1){return function(n,a,i){if(a==="__v_isReactive")return!e;if(a==="__v_isReadonly")return e;if(a==="__v_isShallow")return t;if(a==="__v_raw"&&i===(e?t?_1:wp:t?Op:Rp).get(n))return n;const s=Ve(n);if(!e&&s&&et(ju,a))return Reflect.get(ju,a,i);const f=Reflect.get(n,a,i);return(Ic(a)?Ap.has(a):e1(a))||(e||fr(n,"get",a),t)?f:Vt(f)?s&&Mc(a)?f:f.value:$t(f)?e?Ir(f):kt(f):f}}const i1=Cp(),o1=Cp(!0);function Cp(e=!1){return function(r,n,a,i){let s=r[n];if(Ci(s)&&Vt(s)&&!Vt(a))return!1;if(!e&&!Ci(a)&&($l(a)||(a=at(a),s=at(s)),!Ve(r)&&Vt(s)&&!Vt(a)))return s.value=a,!0;const f=Ve(r)&&Mc(n)?Number(n)<r.length:et(r,n),h=Reflect.set(r,n,a,i);return r===at(i)&&(f?Ai(a,s)&&rn(r,"set",n,a):rn(r,"add",n,a)),h}}function s1(e,t){const r=et(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&r&&rn(e,"delete",t,void 0),n}function l1(e,t){const r=Reflect.has(e,t);return(!Ic(t)||!Ap.has(t))&&fr(e,"has",t),r}function c1(e){return fr(e,"iterate",Ve(e)?"length":Kn),Reflect.ownKeys(e)}const Tp={get:t1,set:i1,deleteProperty:s1,has:l1,ownKeys:c1},u1={get:n1,set(e,t){return!0},deleteProperty(e,t){return!0}},f1=Kt({},Tp,{get:r1,set:o1}),$c=e=>e,ts=e=>Reflect.getPrototypeOf(e);function io(e,t,r=!1,n=!1){e=e.__v_raw;const a=at(e),i=at(t);r||(t!==i&&fr(a,"get",t),fr(a,"get",i));const{has:s}=ts(a),f=n?$c:r?kc:Ti;if(s.call(a,t))return f(e.get(t));if(s.call(a,i))return f(e.get(i));e!==a&&e.get(t)}function oo(e,t=!1){const r=this.__v_raw,n=at(r),a=at(e);return t||(e!==a&&fr(n,"has",e),fr(n,"has",a)),e===a?r.has(e):r.has(e)||r.has(a)}function so(e,t=!1){return e=e.__v_raw,!t&&fr(at(e),"iterate",Kn),Reflect.get(e,"size",e)}function Qu(e){e=at(e);const t=at(this);return ts(t).has.call(t,e)||(t.add(e),rn(t,"add",e,e)),this}function Zu(e,t){t=at(t);const r=at(this),{has:n,get:a}=ts(r);let i=n.call(r,e);i||(e=at(e),i=n.call(r,e));const s=a.call(r,e);return r.set(e,t),i?Ai(t,s)&&rn(r,"set",e,t):rn(r,"add",e,t),this}function Ju(e){const t=at(this),{has:r,get:n}=ts(t);let a=r.call(t,e);a||(e=at(e),a=r.call(t,e)),n&&n.call(t,e);const i=t.delete(e);return a&&rn(t,"delete",e,void 0),i}function ef(){const e=at(this),t=e.size!==0,r=e.clear();return t&&rn(e,"clear",void 0,void 0),r}function lo(e,t){return function(n,a){const i=this,s=i.__v_raw,f=at(s),h=t?$c:e?kc:Ti;return!e&&fr(f,"iterate",Kn),s.forEach((c,o)=>n.call(a,h(c),h(o),i))}}function co(e,t,r){return function(...n){const a=this.__v_raw,i=at(a),s=Ea(i),f=e==="entries"||e===Symbol.iterator&&s,h=e==="keys"&&s,c=a[e](...n),o=r?$c:t?kc:Ti;return!t&&fr(i,"iterate",h?Sl:Kn),{next(){const{value:l,done:u}=c.next();return u?{value:l,done:u}:{value:f?[o(l[0]),o(l[1])]:o(l),done:u}},[Symbol.iterator](){return this}}}}function pn(e){return function(...t){return e==="delete"?!1:this}}function d1(){const e={get(i){return io(this,i)},get size(){return so(this)},has:oo,add:Qu,set:Zu,delete:Ju,clear:ef,forEach:lo(!1,!1)},t={get(i){return io(this,i,!1,!0)},get size(){return so(this)},has:oo,add:Qu,set:Zu,delete:Ju,clear:ef,forEach:lo(!1,!0)},r={get(i){return io(this,i,!0)},get size(){return so(this,!0)},has(i){return oo.call(this,i,!0)},add:pn("add"),set:pn("set"),delete:pn("delete"),clear:pn("clear"),forEach:lo(!0,!1)},n={get(i){return io(this,i,!0,!0)},get size(){return so(this,!0)},has(i){return oo.call(this,i,!0)},add:pn("add"),set:pn("set"),delete:pn("delete"),clear:pn("clear"),forEach:lo(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{e[i]=co(i,!1,!1),r[i]=co(i,!0,!1),t[i]=co(i,!1,!0),n[i]=co(i,!0,!0)}),[e,r,t,n]}const[h1,p1,v1,g1]=d1();function Dc(e,t){const r=t?e?g1:v1:e?p1:h1;return(n,a,i)=>a==="__v_isReactive"?!e:a==="__v_isReadonly"?e:a==="__v_raw"?n:Reflect.get(et(r,a)&&a in n?r:n,a,i)}const m1={get:Dc(!1,!1)},y1={get:Dc(!1,!0)},E1={get:Dc(!0,!1)},Rp=new WeakMap,Op=new WeakMap,wp=new WeakMap,_1=new WeakMap;function b1(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function N1(e){return e.__v_skip||!Object.isExtensible(e)?0:b1(W0(e))}function kt(e){return Ci(e)?e:xc(e,!1,Tp,m1,Rp)}function A1(e){return xc(e,!1,f1,y1,Op)}function Ir(e){return xc(e,!0,u1,E1,wp)}function xc(e,t,r,n,a){if(!$t(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=a.get(e);if(i)return i;const s=N1(e);if(s===0)return e;const f=new Proxy(e,s===2?n:r);return a.set(e,f),f}function _a(e){return Ci(e)?_a(e.__v_raw):!!(e&&e.__v_isReactive)}function Ci(e){return!!(e&&e.__v_isReadonly)}function $l(e){return!!(e&&e.__v_isShallow)}function Ip(e){return _a(e)||Ci(e)}function at(e){const t=e&&e.__v_raw;return t?at(t):e}function Mp(e){return Lo(e,"__v_skip",!0),e}const Ti=e=>$t(e)?kt(e):e,kc=e=>$t(e)?Ir(e):e;function Pp(e){Tn&&Ar&&(e=at(e),Np(e.dep||(e.dep=Pc())))}function Sp(e,t){e=at(e),e.dep&&Ll(e.dep)}function Vt(e){return!!(e&&e.__v_isRef===!0)}function be(e){return $p(e,!1)}function Lp(e){return $p(e,!0)}function $p(e,t){return Vt(e)?e:new C1(e,t)}class C1{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:at(t),this._value=r?t:Ti(t)}get value(){return Pp(this),this._value}set value(t){t=this.__v_isShallow?t:at(t),Ai(t,this._rawValue)&&(this._rawValue=t,this._value=this.__v_isShallow?t:Ti(t),Sp(this))}}function Or(e){return Vt(e)?e.value:e}const T1={get:(e,t,r)=>Or(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const a=e[t];return Vt(a)&&!Vt(r)?(a.value=r,!0):Reflect.set(e,t,r,n)}};function Dp(e){return _a(e)?e:new Proxy(e,T1)}function B5(e){const t=Ve(e)?new Array(e.length):{};for(const r in e)t[r]=O1(e,r);return t}class R1{constructor(t,r,n){this._object=t,this._key=r,this._defaultValue=n,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}}function O1(e,t,r){const n=e[t];return Vt(n)?n:new R1(e,t,r)}class w1{constructor(t,r,n,a){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new Sc(t,()=>{this._dirty||(this._dirty=!0,Sp(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!a,this.__v_isReadonly=n}get value(){const t=at(this);return Pp(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function I1(e,t,r=!1){let n,a;const i=qe(e);return i?(n=e,a=Rr):(n=e.get,a=e.set),new w1(n,a,i||!a,r)}function Rn(e,t,r,n){let a;try{a=n?e(...n):e()}catch(i){$i(i,t,r)}return a}function mr(e,t,r,n){if(qe(e)){const i=Rn(e,t,r,n);return i&&vp(i)&&i.catch(s=>{$i(s,t,r)}),i}const a=[];for(let i=0;i<e.length;i++)a.push(mr(e[i],t,r,n));return a}function $i(e,t,r,n=!0){const a=t?t.vnode:null;if(t){let i=t.parent;const s=t.proxy,f=r;for(;i;){const c=i.ec;if(c){for(let o=0;o<c.length;o++)if(c[o](e,s,f)===!1)return}i=i.parent}const h=t.appContext.config.errorHandler;if(h){Rn(h,null,10,[e,s,f]);return}}M1(e,r,a,n)}function M1(e,t,r,n=!0){console.error(e)}let $o=!1,Dl=!1;const cr=[];let en=0;const pi=[];let ui=null,ha=0;const vi=[];let _n=null,pa=0;const xp=Promise.resolve();let Uc=null,xl=null;function ht(e){const t=Uc||xp;return e?t.then(this?e.bind(this):e):t}function P1(e){let t=en+1,r=cr.length;for(;t<r;){const n=t+r>>>1;Ri(cr[n])<e?t=n+1:r=n}return t}function Fc(e){(!cr.length||!cr.includes(e,$o&&e.allowRecurse?en+1:en))&&e!==xl&&(e.id==null?cr.push(e):cr.splice(P1(e.id),0,e),kp())}function kp(){!$o&&!Dl&&(Dl=!0,Uc=xp.then(Fp))}function S1(e){const t=cr.indexOf(e);t>en&&cr.splice(t,1)}function Up(e,t,r,n){Ve(e)?r.push(...e):(!t||!t.includes(e,e.allowRecurse?n+1:n))&&r.push(e),kp()}function L1(e){Up(e,ui,pi,ha)}function $1(e){Up(e,_n,vi,pa)}function rs(e,t=null){if(pi.length){for(xl=t,ui=[...new Set(pi)],pi.length=0,ha=0;ha<ui.length;ha++)ui[ha]();ui=null,ha=0,xl=null,rs(e,t)}}function Do(e){if(rs(),vi.length){const t=[...new Set(vi)];if(vi.length=0,_n){_n.push(...t);return}for(_n=t,_n.sort((r,n)=>Ri(r)-Ri(n)),pa=0;pa<_n.length;pa++)_n[pa]();_n=null,pa=0}}const Ri=e=>e.id==null?1/0:e.id;function Fp(e){Dl=!1,$o=!0,rs(e),cr.sort((r,n)=>Ri(r)-Ri(n));const t=Rr;try{for(en=0;en<cr.length;en++){const r=cr[en];r&&r.active!==!1&&Rn(r,null,14)}}finally{en=0,cr.length=0,Do(),$o=!1,Uc=null,(cr.length||pi.length||vi.length)&&Fp(e)}}function D1(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||ft;let a=r;const i=t.startsWith("update:"),s=i&&t.slice(7);if(s&&s in n){const o=`${s==="modelValue"?"model":s}Modifiers`,{number:l,trim:u}=n[o]||ft;u&&(a=r.map(d=>d.trim())),l&&(a=r.map(yp))}let f,h=n[f=Zs(t)]||n[f=Zs(Ur(t))];!h&&i&&(h=n[f=Zs(Zn(t))]),h&&mr(h,e,6,a);const c=n[f+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[f])return;e.emitted[f]=!0,mr(c,e,6,a)}}function Bp(e,t,r=!1){const n=t.emitsCache,a=n.get(e);if(a!==void 0)return a;const i=e.emits;let s={},f=!1;if(!qe(e)){const h=c=>{const o=Bp(c,t,!0);o&&(f=!0,Kt(s,o))};!r&&t.mixins.length&&t.mixins.forEach(h),e.extends&&h(e.extends),e.mixins&&e.mixins.forEach(h)}return!i&&!f?(n.set(e,null),null):(Ve(i)?i.forEach(h=>s[h]=null):Kt(s,i),n.set(e,s),s)}function ns(e,t){return!e||!Li(t)?!1:(t=t.slice(2).replace(/Once$/,""),et(e,t[0].toLowerCase()+t.slice(1))||et(e,Zn(t))||et(e,t))}let Yt=null,Vp=null;function xo(e){const t=Yt;return Yt=e,Vp=e&&e.type.__scopeId||null,t}function x1(e,t=Yt,r){if(!t||e._n)return e;const n=(...a)=>{n._d&&hf(-1);const i=xo(t),s=e(...a);return xo(i),n._d&&hf(1),s};return n._n=!0,n._c=!0,n._d=!0,n}function el(e){const{type:t,vnode:r,proxy:n,withProxy:a,props:i,propsOptions:[s],slots:f,attrs:h,emit:c,render:o,renderCache:l,data:u,setupState:d,ctx:g,inheritAttrs:v}=e;let y,m;const b=xo(e);try{if(r.shapeFlag&4){const N=a||n;y=Nr(o.call(N,N,l,i,d,u,g)),m=h}else{const N=t;y=Nr(N.length>1?N(i,{attrs:h,slots:f,emit:c}):N(i,null)),m=t.props?h:k1(h)}}catch(N){mi.length=0,$i(N,e,1),y=Mt(ur)}let E=y;if(m&&v!==!1){const N=Object.keys(m),{shapeFlag:R}=E;N.length&&R&7&&(s&&N.some(Oc)&&(m=U1(m,s)),E=wn(E,m))}return r.dirs&&(E=wn(E),E.dirs=E.dirs?E.dirs.concat(r.dirs):r.dirs),r.transition&&(E.transition=r.transition),y=E,xo(b),y}const k1=e=>{let t;for(const r in e)(r==="class"||r==="style"||Li(r))&&((t||(t={}))[r]=e[r]);return t},U1=(e,t)=>{const r={};for(const n in e)(!Oc(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r};function F1(e,t,r){const{props:n,children:a,component:i}=e,{props:s,children:f,patchFlag:h}=t,c=i.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&h>=0){if(h&1024)return!0;if(h&16)return n?tf(n,s,c):!!s;if(h&8){const o=t.dynamicProps;for(let l=0;l<o.length;l++){const u=o[l];if(s[u]!==n[u]&&!ns(c,u))return!0}}}else return(a||f)&&(!f||!f.$stable)?!0:n===s?!1:n?s?tf(n,s,c):!0:!!s;return!1}function tf(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let a=0;a<n.length;a++){const i=n[a];if(t[i]!==e[i]&&!ns(r,i))return!0}return!1}function B1({vnode:e,parent:t},r){for(;t&&t.subTree===e;)(e=t.vnode).el=r,t=t.parent}const V1=e=>e.__isSuspense;function Gp(e,t){t&&t.pendingBranch?Ve(e)?t.effects.push(...e):t.effects.push(e):$1(e)}function Nt(e,t){if(xt){let r=xt.provides;const n=xt.parent&&xt.parent.provides;n===r&&(r=xt.provides=Object.create(n)),r[e]=t}}function mt(e,t,r=!1){const n=xt||Yt;if(n){const a=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(a&&e in a)return a[e];if(arguments.length>1)return r&&qe(t)?t.call(n.proxy):t}}function G1(e,t){return Bc(e,null,{flush:"post"})}const rf={};function ar(e,t,r){return Bc(e,t,r)}function Bc(e,t,{immediate:r,deep:n,flush:a,onTrack:i,onTrigger:s}=ft){const f=xt;let h,c=!1,o=!1;if(Vt(e)?(h=()=>e.value,c=$l(e)):_a(e)?(h=()=>e,n=!0):Ve(e)?(o=!0,c=e.some(m=>_a(m)||$l(m)),h=()=>e.map(m=>{if(Vt(m))return m.value;if(_a(m))return zn(m);if(qe(m))return Rn(m,f,2)})):qe(e)?t?h=()=>Rn(e,f,2):h=()=>{if(!(f&&f.isUnmounted))return l&&l(),mr(e,f,3,[u])}:h=Rr,t&&n){const m=h;h=()=>zn(m())}let l,u=m=>{l=y.onStop=()=>{Rn(m,f,4)}};if(wa)return u=Rr,t?r&&mr(t,f,3,[h(),o?[]:void 0,u]):h(),Rr;let d=o?[]:rf;const g=()=>{if(!!y.active)if(t){const m=y.run();(n||c||(o?m.some((b,E)=>Ai(b,d[E])):Ai(m,d)))&&(l&&l(),mr(t,f,3,[m,d===rf?void 0:d,u]),d=m)}else y.run()};g.allowRecurse=!!t;let v;a==="sync"?v=g:a==="post"?v=()=>nr(g,f&&f.suspense):v=()=>L1(g);const y=new Sc(h,v);return t?r?g():d=y.run():a==="post"?nr(y.run.bind(y),f&&f.suspense):y.run(),()=>{y.stop(),f&&f.scope&&wc(f.scope.effects,y)}}function H1(e,t,r){const n=this.proxy,a=Ke(e)?e.includes(".")?Hp(n,e):()=>n[e]:e.bind(n,n);let i;qe(t)?i=t:(i=t.handler,r=t);const s=xt;Oa(this);const f=Bc(a,i.bind(n),r);return s?Oa(s):qn(),f}function Hp(e,t){const r=t.split(".");return()=>{let n=e;for(let a=0;a<r.length&&n;a++)n=n[r[a]];return n}}function zn(e,t){if(!$t(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Vt(e))zn(e.value,t);else if(Ve(e))for(let r=0;r<e.length;r++)zn(e[r],t);else if(pp(e)||Ea(e))e.forEach(r=>{zn(r,t)});else if(mp(e))for(const r in e)zn(e[r],t);return e}function W1(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Ut(()=>{e.isMounted=!0}),xi(()=>{e.isUnmounting=!0}),e}const hr=[Function,Array],z1={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:hr,onEnter:hr,onAfterEnter:hr,onEnterCancelled:hr,onBeforeLeave:hr,onLeave:hr,onAfterLeave:hr,onLeaveCancelled:hr,onBeforeAppear:hr,onAppear:hr,onAfterAppear:hr,onAppearCancelled:hr},setup(e,{slots:t}){const r=zc(),n=W1();let a;return()=>{const i=t.default&&Kp(t.default(),!0);if(!i||!i.length)return;let s=i[0];if(i.length>1){for(const v of i)if(v.type!==ur){s=v;break}}const f=at(e),{mode:h}=f;if(n.isLeaving)return tl(s);const c=nf(s);if(!c)return tl(s);const o=kl(c,f,n,r);Ul(c,o);const l=r.subTree,u=l&&nf(l);let d=!1;const{getTransitionKey:g}=c.type;if(g){const v=g();a===void 0?a=v:v!==a&&(a=v,d=!0)}if(u&&u.type!==ur&&(!Hn(c,u)||d)){const v=kl(u,f,n,r);if(Ul(u,v),h==="out-in")return n.isLeaving=!0,v.afterLeave=()=>{n.isLeaving=!1,r.update()},tl(s);h==="in-out"&&c.type!==ur&&(v.delayLeave=(y,m,b)=>{const E=zp(n,u);E[String(u.key)]=u,y._leaveCb=()=>{m(),y._leaveCb=void 0,delete o.delayedLeave},o.delayedLeave=b})}return s}}},Wp=z1;function zp(e,t){const{leavingVNodes:r}=e;let n=r.get(t.type);return n||(n=Object.create(null),r.set(t.type,n)),n}function kl(e,t,r,n){const{appear:a,mode:i,persisted:s=!1,onBeforeEnter:f,onEnter:h,onAfterEnter:c,onEnterCancelled:o,onBeforeLeave:l,onLeave:u,onAfterLeave:d,onLeaveCancelled:g,onBeforeAppear:v,onAppear:y,onAfterAppear:m,onAppearCancelled:b}=t,E=String(e.key),N=zp(r,e),R=(T,A)=>{T&&mr(T,n,9,A)},C=(T,A)=>{const L=A[1];R(T,A),Ve(T)?T.every(G=>G.length<=1)&&L():T.length<=1&&L()},O={mode:i,persisted:s,beforeEnter(T){let A=f;if(!r.isMounted)if(a)A=v||f;else return;T._leaveCb&&T._leaveCb(!0);const L=N[E];L&&Hn(e,L)&&L.el._leaveCb&&L.el._leaveCb(),R(A,[T])},enter(T){let A=h,L=c,G=o;if(!r.isMounted)if(a)A=y||h,L=m||c,G=b||o;else return;let H=!1;const Y=T._enterCb=K=>{H||(H=!0,K?R(G,[T]):R(L,[T]),O.delayedLeave&&O.delayedLeave(),T._enterCb=void 0)};A?C(A,[T,Y]):Y()},leave(T,A){const L=String(e.key);if(T._enterCb&&T._enterCb(!0),r.isUnmounting)return A();R(l,[T]);let G=!1;const H=T._leaveCb=Y=>{G||(G=!0,A(),Y?R(g,[T]):R(d,[T]),T._leaveCb=void 0,N[L]===e&&delete N[L])};N[L]=e,u?C(u,[T,H]):H()},clone(T){return kl(T,t,r,n)}};return O}function tl(e){if(Di(e))return e=wn(e),e.children=null,e}function nf(e){return Di(e)?e.children?e.children[0]:void 0:e}function Ul(e,t){e.shapeFlag&6&&e.component?Ul(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Kp(e,t=!1,r){let n=[],a=0;for(let i=0;i<e.length;i++){let s=e[i];const f=r==null?s.key:String(r)+String(s.key!=null?s.key:i);s.type===Jt?(s.patchFlag&128&&a++,n=n.concat(Kp(s.children,t,f))):(t||s.type!==ur)&&n.push(f!=null?wn(s,{key:f}):s)}if(a>1)for(let i=0;i<n.length;i++)n[i].patchFlag=-2;return n}function He(e){return qe(e)?{setup:e,name:e.name}:e}const ba=e=>!!e.type.__asyncLoader;function Bt(e){qe(e)&&(e={loader:e});const{loader:t,loadingComponent:r,errorComponent:n,delay:a=200,timeout:i,suspensible:s=!0,onError:f}=e;let h=null,c,o=0;const l=()=>(o++,h=null,u()),u=()=>{let d;return h||(d=h=t().catch(g=>{if(g=g instanceof Error?g:new Error(String(g)),f)return new Promise((v,y)=>{f(g,()=>v(l()),()=>y(g),o+1)});throw g}).then(g=>d!==h&&h?h:(g&&(g.__esModule||g[Symbol.toStringTag]==="Module")&&(g=g.default),c=g,g)))};return He({name:"AsyncComponentWrapper",__asyncLoader:u,get __asyncResolved(){return c},setup(){const d=xt;if(c)return()=>rl(c,d);const g=b=>{h=null,$i(b,d,13,!n)};if(s&&d.suspense||wa)return u().then(b=>()=>rl(b,d)).catch(b=>(g(b),()=>n?Mt(n,{error:b}):null));const v=be(!1),y=be(),m=be(!!a);return a&&setTimeout(()=>{m.value=!1},a),i!=null&&setTimeout(()=>{if(!v.value&&!y.value){const b=new Error(`Async component timed out after ${i}ms.`);g(b),y.value=b}},i),u().then(()=>{v.value=!0,d.parent&&Di(d.parent.vnode)&&Fc(d.parent.update)}).catch(b=>{g(b),y.value=b}),()=>{if(v.value&&c)return rl(c,d);if(y.value&&n)return Mt(n,{error:y.value});if(r&&!m.value)return Mt(r)}}})}function rl(e,{vnode:{ref:t,props:r,children:n,shapeFlag:a},parent:i}){const s=Mt(e,r,n);return s.ref=t,s}const Di=e=>e.type.__isKeepAlive;function K1(e,t){qp(e,"a",t)}function q1(e,t){qp(e,"da",t)}function qp(e,t,r=xt){const n=e.__wdc||(e.__wdc=()=>{let a=r;for(;a;){if(a.isDeactivated)return;a=a.parent}return e()});if(as(t,n,r),r){let a=r.parent;for(;a&&a.parent;)Di(a.parent.vnode)&&Y1(n,t,r,a),a=a.parent}}function Y1(e,t,r,n){const a=as(t,e,n,!0);ki(()=>{wc(n[t],a)},r)}function as(e,t,r=xt,n=!1){if(r){const a=r[e]||(r[e]=[]),i=t.__weh||(t.__weh=(...s)=>{if(r.isUnmounted)return;Ua(),Oa(r);const f=mr(t,r,e,s);return qn(),Fa(),f});return n?a.unshift(i):a.push(i),i}}const an=e=>(t,r=xt)=>(!wa||e==="sp")&&as(e,t,r),Yp=an("bm"),Ut=an("m"),X1=an("bu"),j1=an("u"),xi=an("bum"),ki=an("um"),Q1=an("sp"),Z1=an("rtg"),J1=an("rtc");function ey(e,t=xt){as("ec",e,t)}function V5(e,t){const r=Yt;if(r===null)return e;const n=ss(r)||r.proxy,a=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[s,f,h,c=ft]=t[i];qe(s)&&(s={mounted:s,updated:s}),s.deep&&zn(f),a.push({dir:s,instance:n,value:f,oldValue:void 0,arg:h,modifiers:c})}return e}function Lr(e,t,r,n){const a=e.dirs,i=t&&t.dirs;for(let s=0;s<a.length;s++){const f=a[s];i&&(f.oldValue=i[s].value);let h=f.dir[n];h&&(Ua(),mr(h,r,8,[e.el,f,e,t]),Fa())}}const Xp="components";function pt(e,t){return ry(Xp,e,!0,t)||e}const ty=Symbol();function ry(e,t,r=!0,n=!1){const a=Yt||xt;if(a){const i=a.type;if(e===Xp){const f=Dy(i,!1);if(f&&(f===t||f===Ur(t)||f===es(Ur(t))))return i}const s=af(a[e]||i[e],t)||af(a.appContext[e],t);return!s&&n?i:s}}function af(e,t){return e&&(e[t]||e[Ur(t)]||e[es(Ur(t))])}function G5(e,t,r,n){let a;const i=r&&r[n];if(Ve(e)||Ke(e)){a=new Array(e.length);for(let s=0,f=e.length;s<f;s++)a[s]=t(e[s],s,void 0,i&&i[s])}else if(typeof e=="number"){a=new Array(e);for(let s=0;s<e;s++)a[s]=t(s+1,s,void 0,i&&i[s])}else if($t(e))if(e[Symbol.iterator])a=Array.from(e,(s,f)=>t(s,f,void 0,i&&i[f]));else{const s=Object.keys(e);a=new Array(s.length);for(let f=0,h=s.length;f<h;f++){const c=s[f];a[f]=t(e[c],c,f,i&&i[f])}}else a=[];return r&&(r[n]=a),a}function jp(e,t,r={},n,a){if(Yt.isCE||Yt.parent&&ba(Yt.parent)&&Yt.parent.isCE)return Mt("slot",t==="default"?null:{name:t},n&&n());let i=e[t];i&&i._c&&(i._d=!1),is();const s=i&&Qp(i(r)),f=lv(Jt,{key:r.key||`_${t}`},s||(n?n():[]),s&&e._===1?64:-2);return!a&&f.scopeId&&(f.slotScopeIds=[f.scopeId+"-s"]),i&&i._c&&(i._d=!0),f}function Qp(e){return e.some(t=>Bo(t)?!(t.type===ur||t.type===Jt&&!Qp(t.children)):!0)?e:null}const Fl=e=>e?fv(e)?ss(e)||e.proxy:Fl(e.parent):null,ko=Kt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Fl(e.parent),$root:e=>Fl(e.root),$emit:e=>e.emit,$options:e=>Jp(e),$forceUpdate:e=>e.f||(e.f=()=>Fc(e.update)),$nextTick:e=>e.n||(e.n=ht.bind(e.proxy)),$watch:e=>H1.bind(e)}),ny={get({_:e},t){const{ctx:r,setupState:n,data:a,props:i,accessCache:s,type:f,appContext:h}=e;let c;if(t[0]!=="$"){const d=s[t];if(d!==void 0)switch(d){case 1:return n[t];case 2:return a[t];case 4:return r[t];case 3:return i[t]}else{if(n!==ft&&et(n,t))return s[t]=1,n[t];if(a!==ft&&et(a,t))return s[t]=2,a[t];if((c=e.propsOptions[0])&&et(c,t))return s[t]=3,i[t];if(r!==ft&&et(r,t))return s[t]=4,r[t];Bl&&(s[t]=0)}}const o=ko[t];let l,u;if(o)return t==="$attrs"&&fr(e,"get",t),o(e);if((l=f.__cssModules)&&(l=l[t]))return l;if(r!==ft&&et(r,t))return s[t]=4,r[t];if(u=h.config.globalProperties,et(u,t))return u[t]},set({_:e},t,r){const{data:n,setupState:a,ctx:i}=e;return a!==ft&&et(a,t)?(a[t]=r,!0):n!==ft&&et(n,t)?(n[t]=r,!0):et(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:a,propsOptions:i}},s){let f;return!!r[s]||e!==ft&&et(e,s)||t!==ft&&et(t,s)||(f=i[0])&&et(f,s)||et(n,s)||et(ko,s)||et(a.config.globalProperties,s)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:et(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};let Bl=!0;function ay(e){const t=Jp(e),r=e.proxy,n=e.ctx;Bl=!1,t.beforeCreate&&of(t.beforeCreate,e,"bc");const{data:a,computed:i,methods:s,watch:f,provide:h,inject:c,created:o,beforeMount:l,mounted:u,beforeUpdate:d,updated:g,activated:v,deactivated:y,beforeDestroy:m,beforeUnmount:b,destroyed:E,unmounted:N,render:R,renderTracked:C,renderTriggered:O,errorCaptured:T,serverPrefetch:A,expose:L,inheritAttrs:G,components:H,directives:Y,filters:K}=t;if(c&&iy(c,n,null,e.appContext.config.unwrapInjectedRef),s)for(const W in s){const Q=s[W];qe(Q)&&(n[W]=Q.bind(r))}if(a){const W=a.call(r,r);$t(W)&&(e.data=kt(W))}if(Bl=!0,i)for(const W in i){const Q=i[W],ie=qe(Q)?Q.bind(r,r):qe(Q.get)?Q.get.bind(r,r):Rr,de=!qe(Q)&&qe(Q.set)?Q.set.bind(r):Rr,me=xe({get:ie,set:de});Object.defineProperty(n,W,{enumerable:!0,configurable:!0,get:()=>me.value,set:Oe=>me.value=Oe})}if(f)for(const W in f)Zp(f[W],n,r,W);if(h){const W=qe(h)?h.call(r):h;Reflect.ownKeys(W).forEach(Q=>{Nt(Q,W[Q])})}o&&of(o,e,"c");function V(W,Q){Ve(Q)?Q.forEach(ie=>W(ie.bind(r))):Q&&W(Q.bind(r))}if(V(Yp,l),V(Ut,u),V(X1,d),V(j1,g),V(K1,v),V(q1,y),V(ey,T),V(J1,C),V(Z1,O),V(xi,b),V(ki,N),V(Q1,A),Ve(L))if(L.length){const W=e.exposed||(e.exposed={});L.forEach(Q=>{Object.defineProperty(W,Q,{get:()=>r[Q],set:ie=>r[Q]=ie})})}else e.exposed||(e.exposed={});R&&e.render===Rr&&(e.render=R),G!=null&&(e.inheritAttrs=G),H&&(e.components=H),Y&&(e.directives=Y)}function iy(e,t,r=Rr,n=!1){Ve(e)&&(e=Vl(e));for(const a in e){const i=e[a];let s;$t(i)?"default"in i?s=mt(i.from||a,i.default,!0):s=mt(i.from||a):s=mt(i),Vt(s)&&n?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>s.value,set:f=>s.value=f}):t[a]=s}}function of(e,t,r){mr(Ve(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function Zp(e,t,r,n){const a=n.includes(".")?Hp(r,n):()=>r[n];if(Ke(e)){const i=t[e];qe(i)&&ar(a,i)}else if(qe(e))ar(a,e.bind(r));else if($t(e))if(Ve(e))e.forEach(i=>Zp(i,t,r,n));else{const i=qe(e.handler)?e.handler.bind(r):t[e.handler];qe(i)&&ar(a,i,e)}}function Jp(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:a,optionsCache:i,config:{optionMergeStrategies:s}}=e.appContext,f=i.get(t);let h;return f?h=f:!a.length&&!r&&!n?h=t:(h={},a.length&&a.forEach(c=>Uo(h,c,s,!0)),Uo(h,t,s)),i.set(t,h),h}function Uo(e,t,r,n=!1){const{mixins:a,extends:i}=t;i&&Uo(e,i,r,!0),a&&a.forEach(s=>Uo(e,s,r,!0));for(const s in t)if(!(n&&s==="expose")){const f=oy[s]||r&&r[s];e[s]=f?f(e[s],t[s]):t[s]}return e}const oy={data:sf,props:Fn,emits:Fn,methods:Fn,computed:Fn,beforeCreate:Qt,created:Qt,beforeMount:Qt,mounted:Qt,beforeUpdate:Qt,updated:Qt,beforeDestroy:Qt,beforeUnmount:Qt,destroyed:Qt,unmounted:Qt,activated:Qt,deactivated:Qt,errorCaptured:Qt,serverPrefetch:Qt,components:Fn,directives:Fn,watch:ly,provide:sf,inject:sy};function sf(e,t){return t?e?function(){return Kt(qe(e)?e.call(this,this):e,qe(t)?t.call(this,this):t)}:t:e}function sy(e,t){return Fn(Vl(e),Vl(t))}function Vl(e){if(Ve(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function Qt(e,t){return e?[...new Set([].concat(e,t))]:t}function Fn(e,t){return e?Kt(Kt(Object.create(null),e),t):t}function ly(e,t){if(!e)return t;if(!t)return e;const r=Kt(Object.create(null),e);for(const n in t)r[n]=Qt(e[n],t[n]);return r}function cy(e,t,r,n=!1){const a={},i={};Lo(i,os,1),e.propsDefaults=Object.create(null),ev(e,t,a,i);for(const s in e.propsOptions[0])s in a||(a[s]=void 0);r?e.props=n?a:A1(a):e.type.props?e.props=a:e.props=i,e.attrs=i}function uy(e,t,r,n){const{props:a,attrs:i,vnode:{patchFlag:s}}=e,f=at(a),[h]=e.propsOptions;let c=!1;if((n||s>0)&&!(s&16)){if(s&8){const o=e.vnode.dynamicProps;for(let l=0;l<o.length;l++){let u=o[l];if(ns(e.emitsOptions,u))continue;const d=t[u];if(h)if(et(i,u))d!==i[u]&&(i[u]=d,c=!0);else{const g=Ur(u);a[g]=Gl(h,f,g,d,e,!1)}else d!==i[u]&&(i[u]=d,c=!0)}}}else{ev(e,t,a,i)&&(c=!0);let o;for(const l in f)(!t||!et(t,l)&&((o=Zn(l))===l||!et(t,o)))&&(h?r&&(r[l]!==void 0||r[o]!==void 0)&&(a[l]=Gl(h,f,l,void 0,e,!0)):delete a[l]);if(i!==f)for(const l in i)(!t||!et(t,l)&&!0)&&(delete i[l],c=!0)}c&&rn(e,"set","$attrs")}function ev(e,t,r,n){const[a,i]=e.propsOptions;let s=!1,f;if(t)for(let h in t){if(hi(h))continue;const c=t[h];let o;a&&et(a,o=Ur(h))?!i||!i.includes(o)?r[o]=c:(f||(f={}))[o]=c:ns(e.emitsOptions,h)||(!(h in n)||c!==n[h])&&(n[h]=c,s=!0)}if(i){const h=at(r),c=f||ft;for(let o=0;o<i.length;o++){const l=i[o];r[l]=Gl(a,h,l,c[l],e,!et(c,l))}}return s}function Gl(e,t,r,n,a,i){const s=e[r];if(s!=null){const f=et(s,"default");if(f&&n===void 0){const h=s.default;if(s.type!==Function&&qe(h)){const{propsDefaults:c}=a;r in c?n=c[r]:(Oa(a),n=c[r]=h.call(null,t),qn())}else n=h}s[0]&&(i&&!f?n=!1:s[1]&&(n===""||n===Zn(r))&&(n=!0))}return n}function tv(e,t,r=!1){const n=t.propsCache,a=n.get(e);if(a)return a;const i=e.props,s={},f=[];let h=!1;if(!qe(e)){const o=l=>{h=!0;const[u,d]=tv(l,t,!0);Kt(s,u),d&&f.push(...d)};!r&&t.mixins.length&&t.mixins.forEach(o),e.extends&&o(e.extends),e.mixins&&e.mixins.forEach(o)}if(!i&&!h)return n.set(e,ya),ya;if(Ve(i))for(let o=0;o<i.length;o++){const l=Ur(i[o]);lf(l)&&(s[l]=ft)}else if(i)for(const o in i){const l=Ur(o);if(lf(l)){const u=i[o],d=s[l]=Ve(u)||qe(u)?{type:u}:u;if(d){const g=ff(Boolean,d.type),v=ff(String,d.type);d[0]=g>-1,d[1]=v<0||g<v,(g>-1||et(d,"default"))&&f.push(l)}}}const c=[s,f];return n.set(e,c),c}function lf(e){return e[0]!=="$"}function cf(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function uf(e,t){return cf(e)===cf(t)}function ff(e,t){return Ve(t)?t.findIndex(r=>uf(r,e)):qe(t)&&uf(t,e)?0:-1}const rv=e=>e[0]==="_"||e==="$stable",Vc=e=>Ve(e)?e.map(Nr):[Nr(e)],fy=(e,t,r)=>{if(t._n)return t;const n=x1((...a)=>Vc(t(...a)),r);return n._c=!1,n},nv=(e,t,r)=>{const n=e._ctx;for(const a in e){if(rv(a))continue;const i=e[a];if(qe(i))t[a]=fy(a,i,n);else if(i!=null){const s=Vc(i);t[a]=()=>s}}},av=(e,t)=>{const r=Vc(t);e.slots.default=()=>r},dy=(e,t)=>{if(e.vnode.shapeFlag&32){const r=t._;r?(e.slots=at(t),Lo(t,"_",r)):nv(t,e.slots={})}else e.slots={},t&&av(e,t);Lo(e.slots,os,1)},hy=(e,t,r)=>{const{vnode:n,slots:a}=e;let i=!0,s=ft;if(n.shapeFlag&32){const f=t._;f?r&&f===1?i=!1:(Kt(a,t),!r&&f===1&&delete a._):(i=!t.$stable,nv(t,a)),s=t}else t&&(av(e,t),s={default:1});if(i)for(const f in a)!rv(f)&&!(f in s)&&delete a[f]};function iv(){return{app:null,config:{isNativeTag:V0,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let py=0;function vy(e,t){return function(n,a=null){qe(n)||(n=Object.assign({},n)),a!=null&&!$t(a)&&(a=null);const i=iv(),s=new Set;let f=!1;const h=i.app={_uid:py++,_component:n,_props:a,_container:null,_context:i,_instance:null,version:ky,get config(){return i.config},set config(c){},use(c,...o){return s.has(c)||(c&&qe(c.install)?(s.add(c),c.install(h,...o)):qe(c)&&(s.add(c),c(h,...o))),h},mixin(c){return i.mixins.includes(c)||i.mixins.push(c),h},component(c,o){return o?(i.components[c]=o,h):i.components[c]},directive(c,o){return o?(i.directives[c]=o,h):i.directives[c]},mount(c,o,l){if(!f){const u=Mt(n,a);return u.appContext=i,o&&t?t(u,c):e(u,c,l),f=!0,h._container=c,c.__vue_app__=h,ss(u.component)||u.component.proxy}},unmount(){f&&(e(null,h._container),delete h._container.__vue_app__)},provide(c,o){return i.provides[c]=o,h}};return h}}function Fo(e,t,r,n,a=!1){if(Ve(e)){e.forEach((u,d)=>Fo(u,t&&(Ve(t)?t[d]:t),r,n,a));return}if(ba(n)&&!a)return;const i=n.shapeFlag&4?ss(n.component)||n.component.proxy:n.el,s=a?null:i,{i:f,r:h}=e,c=t&&t.r,o=f.refs===ft?f.refs={}:f.refs,l=f.setupState;if(c!=null&&c!==h&&(Ke(c)?(o[c]=null,et(l,c)&&(l[c]=null)):Vt(c)&&(c.value=null)),qe(h))Rn(h,f,12,[s,o]);else{const u=Ke(h),d=Vt(h);if(u||d){const g=()=>{if(e.f){const v=u?o[h]:h.value;a?Ve(v)&&wc(v,i):Ve(v)?v.includes(i)||v.push(i):u?(o[h]=[i],et(l,h)&&(l[h]=o[h])):(h.value=[i],e.k&&(o[e.k]=h.value))}else u?(o[h]=s,et(l,h)&&(l[h]=s)):d&&(h.value=s,e.k&&(o[e.k]=s))};s?(g.id=-1,nr(g,r)):g()}}}let vn=!1;const uo=e=>/svg/.test(e.namespaceURI)&&e.tagName!=="foreignObject",fo=e=>e.nodeType===8;function gy(e){const{mt:t,p:r,o:{patchProp:n,createText:a,nextSibling:i,parentNode:s,remove:f,insert:h,createComment:c}}=e,o=(m,b)=>{if(!b.hasChildNodes()){r(null,m,b),Do(),b._vnode=m;return}vn=!1,l(b.firstChild,m,null,null,null),Do(),b._vnode=m,vn&&console.error("Hydration completed but contains mismatches.")},l=(m,b,E,N,R,C=!1)=>{const O=fo(m)&&m.data==="[",T=()=>v(m,b,E,N,R,O),{type:A,ref:L,shapeFlag:G,patchFlag:H}=b,Y=m.nodeType;b.el=m,H===-2&&(C=!1,b.dynamicChildren=null);let K=null;switch(A){case Oi:Y!==3?b.children===""?(h(b.el=a(""),s(m),m),K=m):K=T():(m.data!==b.children&&(vn=!0,m.data=b.children),K=i(m));break;case ur:Y!==8||O?K=T():K=i(m);break;case Na:if(Y!==1&&Y!==3)K=T();else{K=m;const ce=!b.children.length;for(let V=0;V<b.staticCount;V++)ce&&(b.children+=K.nodeType===1?K.outerHTML:K.data),V===b.staticCount-1&&(b.anchor=K),K=i(K);return K}break;case Jt:O?K=g(m,b,E,N,R,C):K=T();break;default:if(G&1)Y!==1||b.type.toLowerCase()!==m.tagName.toLowerCase()?K=T():K=u(m,b,E,N,R,C);else if(G&6){b.slotScopeIds=R;const ce=s(m);if(t(b,ce,null,E,N,uo(ce),C),K=O?y(m):i(m),K&&fo(K)&&K.data==="teleport end"&&(K=i(K)),ba(b)){let V;O?(V=Mt(Jt),V.anchor=K?K.previousSibling:ce.lastChild):V=m.nodeType===3?Hc(""):Mt("div"),V.el=m,b.component.subTree=V}}else G&64?Y!==8?K=T():K=b.type.hydrate(m,b,E,N,R,C,e,d):G&128&&(K=b.type.hydrate(m,b,E,N,uo(s(m)),R,C,e,l))}return L!=null&&Fo(L,null,N,b),K},u=(m,b,E,N,R,C)=>{C=C||!!b.dynamicChildren;const{type:O,props:T,patchFlag:A,shapeFlag:L,dirs:G}=b,H=O==="input"&&G||O==="option";if(H||A!==-1){if(G&&Lr(b,null,E,"created"),T)if(H||!C||A&48)for(const K in T)(H&&K.endsWith("value")||Li(K)&&!hi(K))&&n(m,K,null,T[K],!1,void 0,E);else T.onClick&&n(m,"onClick",null,T.onClick,!1,void 0,E);let Y;if((Y=T&&T.onVnodeBeforeMount)&&pr(Y,E,b),G&&Lr(b,null,E,"beforeMount"),((Y=T&&T.onVnodeMounted)||G)&&Gp(()=>{Y&&pr(Y,E,b),G&&Lr(b,null,E,"mounted")},N),L&16&&!(T&&(T.innerHTML||T.textContent))){let K=d(m.firstChild,b,m,E,N,R,C);for(;K;){vn=!0;const ce=K;K=K.nextSibling,f(ce)}}else L&8&&m.textContent!==b.children&&(vn=!0,m.textContent=b.children)}return m.nextSibling},d=(m,b,E,N,R,C,O)=>{O=O||!!b.dynamicChildren;const T=b.children,A=T.length;for(let L=0;L<A;L++){const G=O?T[L]:T[L]=Nr(T[L]);if(m)m=l(m,G,N,R,C,O);else{if(G.type===Oi&&!G.children)continue;vn=!0,r(null,G,E,null,N,R,uo(E),C)}}return m},g=(m,b,E,N,R,C)=>{const{slotScopeIds:O}=b;O&&(R=R?R.concat(O):O);const T=s(m),A=d(i(m),b,T,E,N,R,C);return A&&fo(A)&&A.data==="]"?i(b.anchor=A):(vn=!0,h(b.anchor=c("]"),T,A),A)},v=(m,b,E,N,R,C)=>{if(vn=!0,b.el=null,C){const A=y(m);for(;;){const L=i(m);if(L&&L!==A)f(L);else break}}const O=i(m),T=s(m);return f(m),r(null,b,T,O,E,N,uo(T),R),O},y=m=>{let b=0;for(;m;)if(m=i(m),m&&fo(m)&&(m.data==="["&&b++,m.data==="]")){if(b===0)return i(m);b--}return m};return[o,l]}const nr=Gp;function my(e){return yy(e,gy)}function yy(e,t){const r=q0();r.__VUE__=!0;const{insert:n,remove:a,patchProp:i,createElement:s,createText:f,createComment:h,setText:c,setElementText:o,parentNode:l,nextSibling:u,setScopeId:d=Rr,cloneNode:g,insertStaticContent:v}=e,y=(M,B,z,re=null,ne=null,p=null,Ee=!1,x=null,pe=!!B.dynamicChildren)=>{if(M===B)return;M&&!Hn(M,B)&&(re=k(M),we(M,ne,p,!0),M=null),B.patchFlag===-2&&(pe=!1,B.dynamicChildren=null);const{type:ue,ref:Me,shapeFlag:Ce}=B;switch(ue){case Oi:m(M,B,z,re);break;case ur:b(M,B,z,re);break;case Na:M==null&&E(B,z,re,Ee);break;case Jt:Y(M,B,z,re,ne,p,Ee,x,pe);break;default:Ce&1?C(M,B,z,re,ne,p,Ee,x,pe):Ce&6?K(M,B,z,re,ne,p,Ee,x,pe):(Ce&64||Ce&128)&&ue.process(M,B,z,re,ne,p,Ee,x,pe,q)}Me!=null&&ne&&Fo(Me,M&&M.ref,p,B||M,!B)},m=(M,B,z,re)=>{if(M==null)n(B.el=f(B.children),z,re);else{const ne=B.el=M.el;B.children!==M.children&&c(ne,B.children)}},b=(M,B,z,re)=>{M==null?n(B.el=h(B.children||""),z,re):B.el=M.el},E=(M,B,z,re)=>{[M.el,M.anchor]=v(M.children,B,z,re,M.el,M.anchor)},N=({el:M,anchor:B},z,re)=>{let ne;for(;M&&M!==B;)ne=u(M),n(M,z,re),M=ne;n(B,z,re)},R=({el:M,anchor:B})=>{let z;for(;M&&M!==B;)z=u(M),a(M),M=z;a(B)},C=(M,B,z,re,ne,p,Ee,x,pe)=>{Ee=Ee||B.type==="svg",M==null?O(B,z,re,ne,p,Ee,x,pe):L(M,B,ne,p,Ee,x,pe)},O=(M,B,z,re,ne,p,Ee,x)=>{let pe,ue;const{type:Me,props:Ce,shapeFlag:Pe,transition:Ae,patchFlag:fe,dirs:D}=M;if(M.el&&g!==void 0&&fe===-1)pe=M.el=g(M.el);else{if(pe=M.el=s(M.type,p,Ce&&Ce.is,Ce),Pe&8?o(pe,M.children):Pe&16&&A(M.children,pe,null,re,ne,p&&Me!=="foreignObject",Ee,x),D&&Lr(M,null,re,"created"),Ce){for(const ae in Ce)ae!=="value"&&!hi(ae)&&i(pe,ae,null,Ce[ae],p,M.children,re,ne,P);"value"in Ce&&i(pe,"value",null,Ce.value),(ue=Ce.onVnodeBeforeMount)&&pr(ue,re,M)}T(pe,M,M.scopeId,Ee,re)}D&&Lr(M,null,re,"beforeMount");const U=(!ne||ne&&!ne.pendingBranch)&&Ae&&!Ae.persisted;U&&Ae.beforeEnter(pe),n(pe,B,z),((ue=Ce&&Ce.onVnodeMounted)||U||D)&&nr(()=>{ue&&pr(ue,re,M),U&&Ae.enter(pe),D&&Lr(M,null,re,"mounted")},ne)},T=(M,B,z,re,ne)=>{if(z&&d(M,z),re)for(let p=0;p<re.length;p++)d(M,re[p]);if(ne){let p=ne.subTree;if(B===p){const Ee=ne.vnode;T(M,Ee,Ee.scopeId,Ee.slotScopeIds,ne.parent)}}},A=(M,B,z,re,ne,p,Ee,x,pe=0)=>{for(let ue=pe;ue<M.length;ue++){const Me=M[ue]=x?bn(M[ue]):Nr(M[ue]);y(null,Me,B,z,re,ne,p,Ee,x)}},L=(M,B,z,re,ne,p,Ee)=>{const x=B.el=M.el;let{patchFlag:pe,dynamicChildren:ue,dirs:Me}=B;pe|=M.patchFlag&16;const Ce=M.props||ft,Pe=B.props||ft;let Ae;z&&Ln(z,!1),(Ae=Pe.onVnodeBeforeUpdate)&&pr(Ae,z,B,M),Me&&Lr(B,M,z,"beforeUpdate"),z&&Ln(z,!0);const fe=ne&&B.type!=="foreignObject";if(ue?G(M.dynamicChildren,ue,x,z,re,fe,p):Ee||ie(M,B,x,null,z,re,fe,p,!1),pe>0){if(pe&16)H(x,B,Ce,Pe,z,re,ne);else if(pe&2&&Ce.class!==Pe.class&&i(x,"class",null,Pe.class,ne),pe&4&&i(x,"style",Ce.style,Pe.style,ne),pe&8){const D=B.dynamicProps;for(let U=0;U<D.length;U++){const ae=D[U],Z=Ce[ae],ee=Pe[ae];(ee!==Z||ae==="value")&&i(x,ae,Z,ee,ne,M.children,z,re,P)}}pe&1&&M.children!==B.children&&o(x,B.children)}else!Ee&&ue==null&&H(x,B,Ce,Pe,z,re,ne);((Ae=Pe.onVnodeUpdated)||Me)&&nr(()=>{Ae&&pr(Ae,z,B,M),Me&&Lr(B,M,z,"updated")},re)},G=(M,B,z,re,ne,p,Ee)=>{for(let x=0;x<B.length;x++){const pe=M[x],ue=B[x],Me=pe.el&&(pe.type===Jt||!Hn(pe,ue)||pe.shapeFlag&70)?l(pe.el):z;y(pe,ue,Me,null,re,ne,p,Ee,!0)}},H=(M,B,z,re,ne,p,Ee)=>{if(z!==re){for(const x in re){if(hi(x))continue;const pe=re[x],ue=z[x];pe!==ue&&x!=="value"&&i(M,x,ue,pe,Ee,B.children,ne,p,P)}if(z!==ft)for(const x in z)!hi(x)&&!(x in re)&&i(M,x,z[x],null,Ee,B.children,ne,p,P);"value"in re&&i(M,"value",z.value,re.value)}},Y=(M,B,z,re,ne,p,Ee,x,pe)=>{const ue=B.el=M?M.el:f(""),Me=B.anchor=M?M.anchor:f("");let{patchFlag:Ce,dynamicChildren:Pe,slotScopeIds:Ae}=B;Ae&&(x=x?x.concat(Ae):Ae),M==null?(n(ue,z,re),n(Me,z,re),A(B.children,z,Me,ne,p,Ee,x,pe)):Ce>0&&Ce&64&&Pe&&M.dynamicChildren?(G(M.dynamicChildren,Pe,z,ne,p,Ee,x),(B.key!=null||ne&&B===ne.subTree)&&Gc(M,B,!0)):ie(M,B,z,Me,ne,p,Ee,x,pe)},K=(M,B,z,re,ne,p,Ee,x,pe)=>{B.slotScopeIds=x,M==null?B.shapeFlag&512?ne.ctx.activate(B,z,re,Ee,pe):ce(B,z,re,ne,p,Ee,pe):V(M,B,pe)},ce=(M,B,z,re,ne,p,Ee)=>{const x=M.component=My(M,re,ne);if(Di(M)&&(x.ctx.renderer=q),Py(x),x.asyncDep){if(ne&&ne.registerDep(x,W),!M.el){const pe=x.subTree=Mt(ur);b(null,pe,B,z)}return}W(x,M,B,z,ne,p,Ee)},V=(M,B,z)=>{const re=B.component=M.component;if(F1(M,B,z))if(re.asyncDep&&!re.asyncResolved){Q(re,B,z);return}else re.next=B,S1(re.update),re.update();else B.el=M.el,re.vnode=B},W=(M,B,z,re,ne,p,Ee)=>{const x=()=>{if(M.isMounted){let{next:Me,bu:Ce,u:Pe,parent:Ae,vnode:fe}=M,D=Me,U;Ln(M,!1),Me?(Me.el=fe.el,Q(M,Me,Ee)):Me=fe,Ce&&Js(Ce),(U=Me.props&&Me.props.onVnodeBeforeUpdate)&&pr(U,Ae,Me,fe),Ln(M,!0);const ae=el(M),Z=M.subTree;M.subTree=ae,y(Z,ae,l(Z.el),k(Z),M,ne,p),Me.el=ae.el,D===null&&B1(M,ae.el),Pe&&nr(Pe,ne),(U=Me.props&&Me.props.onVnodeUpdated)&&nr(()=>pr(U,Ae,Me,fe),ne)}else{let Me;const{el:Ce,props:Pe}=B,{bm:Ae,m:fe,parent:D}=M,U=ba(B);if(Ln(M,!1),Ae&&Js(Ae),!U&&(Me=Pe&&Pe.onVnodeBeforeMount)&&pr(Me,D,B),Ln(M,!0),Ce&&X){const ae=()=>{M.subTree=el(M),X(Ce,M.subTree,M,ne,null)};U?B.type.__asyncLoader().then(()=>!M.isUnmounted&&ae()):ae()}else{const ae=M.subTree=el(M);y(null,ae,z,re,M,ne,p),B.el=ae.el}if(fe&&nr(fe,ne),!U&&(Me=Pe&&Pe.onVnodeMounted)){const ae=B;nr(()=>pr(Me,D,ae),ne)}(B.shapeFlag&256||D&&ba(D.vnode)&&D.vnode.shapeFlag&256)&&M.a&&nr(M.a,ne),M.isMounted=!0,B=z=re=null}},pe=M.effect=new Sc(x,()=>Fc(ue),M.scope),ue=M.update=()=>pe.run();ue.id=M.uid,Ln(M,!0),ue()},Q=(M,B,z)=>{B.component=M;const re=M.vnode.props;M.vnode=B,M.next=null,uy(M,B.props,re,z),hy(M,B.children,z),Ua(),rs(void 0,M.update),Fa()},ie=(M,B,z,re,ne,p,Ee,x,pe=!1)=>{const ue=M&&M.children,Me=M?M.shapeFlag:0,Ce=B.children,{patchFlag:Pe,shapeFlag:Ae}=B;if(Pe>0){if(Pe&128){me(ue,Ce,z,re,ne,p,Ee,x,pe);return}else if(Pe&256){de(ue,Ce,z,re,ne,p,Ee,x,pe);return}}Ae&8?(Me&16&&P(ue,ne,p),Ce!==ue&&o(z,Ce)):Me&16?Ae&16?me(ue,Ce,z,re,ne,p,Ee,x,pe):P(ue,ne,p,!0):(Me&8&&o(z,""),Ae&16&&A(Ce,z,re,ne,p,Ee,x,pe))},de=(M,B,z,re,ne,p,Ee,x,pe)=>{M=M||ya,B=B||ya;const ue=M.length,Me=B.length,Ce=Math.min(ue,Me);let Pe;for(Pe=0;Pe<Ce;Pe++){const Ae=B[Pe]=pe?bn(B[Pe]):Nr(B[Pe]);y(M[Pe],Ae,z,null,ne,p,Ee,x,pe)}ue>Me?P(M,ne,p,!0,!1,Ce):A(B,z,re,ne,p,Ee,x,pe,Ce)},me=(M,B,z,re,ne,p,Ee,x,pe)=>{let ue=0;const Me=B.length;let Ce=M.length-1,Pe=Me-1;for(;ue<=Ce&&ue<=Pe;){const Ae=M[ue],fe=B[ue]=pe?bn(B[ue]):Nr(B[ue]);if(Hn(Ae,fe))y(Ae,fe,z,null,ne,p,Ee,x,pe);else break;ue++}for(;ue<=Ce&&ue<=Pe;){const Ae=M[Ce],fe=B[Pe]=pe?bn(B[Pe]):Nr(B[Pe]);if(Hn(Ae,fe))y(Ae,fe,z,null,ne,p,Ee,x,pe);else break;Ce--,Pe--}if(ue>Ce){if(ue<=Pe){const Ae=Pe+1,fe=Ae<Me?B[Ae].el:re;for(;ue<=Pe;)y(null,B[ue]=pe?bn(B[ue]):Nr(B[ue]),z,fe,ne,p,Ee,x,pe),ue++}}else if(ue>Pe)for(;ue<=Ce;)we(M[ue],ne,p,!0),ue++;else{const Ae=ue,fe=ue,D=new Map;for(ue=fe;ue<=Pe;ue++){const ke=B[ue]=pe?bn(B[ue]):Nr(B[ue]);ke.key!=null&&D.set(ke.key,ue)}let U,ae=0;const Z=Pe-fe+1;let ee=!1,Ne=0;const De=new Array(Z);for(ue=0;ue<Z;ue++)De[ue]=0;for(ue=Ae;ue<=Ce;ue++){const ke=M[ue];if(ae>=Z){we(ke,ne,p,!0);continue}let Ue;if(ke.key!=null)Ue=D.get(ke.key);else for(U=fe;U<=Pe;U++)if(De[U-fe]===0&&Hn(ke,B[U])){Ue=U;break}Ue===void 0?we(ke,ne,p,!0):(De[Ue-fe]=ue+1,Ue>=Ne?Ne=Ue:ee=!0,y(ke,B[Ue],z,null,ne,p,Ee,x,pe),ae++)}const Ge=ee?Ey(De):ya;for(U=Ge.length-1,ue=Z-1;ue>=0;ue--){const ke=fe+ue,Ue=B[ke],Rt=ke+1<Me?B[ke+1].el:re;De[ue]===0?y(null,Ue,z,Rt,ne,p,Ee,x,pe):ee&&(U<0||ue!==Ge[U]?Oe(Ue,z,Rt,2):U--)}}},Oe=(M,B,z,re,ne=null)=>{const{el:p,type:Ee,transition:x,children:pe,shapeFlag:ue}=M;if(ue&6){Oe(M.component.subTree,B,z,re);return}if(ue&128){M.suspense.move(B,z,re);return}if(ue&64){Ee.move(M,B,z,q);return}if(Ee===Jt){n(p,B,z);for(let Ce=0;Ce<pe.length;Ce++)Oe(pe[Ce],B,z,re);n(M.anchor,B,z);return}if(Ee===Na){N(M,B,z);return}if(re!==2&&ue&1&&x)if(re===0)x.beforeEnter(p),n(p,B,z),nr(()=>x.enter(p),ne);else{const{leave:Ce,delayLeave:Pe,afterLeave:Ae}=x,fe=()=>n(p,B,z),D=()=>{Ce(p,()=>{fe(),Ae&&Ae()})};Pe?Pe(p,fe,D):D()}else n(p,B,z)},we=(M,B,z,re=!1,ne=!1)=>{const{type:p,props:Ee,ref:x,children:pe,dynamicChildren:ue,shapeFlag:Me,patchFlag:Ce,dirs:Pe}=M;if(x!=null&&Fo(x,null,z,M,!0),Me&256){B.ctx.deactivate(M);return}const Ae=Me&1&&Pe,fe=!ba(M);let D;if(fe&&(D=Ee&&Ee.onVnodeBeforeUnmount)&&pr(D,B,M),Me&6)$(M.component,z,re);else{if(Me&128){M.suspense.unmount(z,re);return}Ae&&Lr(M,null,B,"beforeUnmount"),Me&64?M.type.remove(M,B,z,ne,q,re):ue&&(p!==Jt||Ce>0&&Ce&64)?P(ue,B,z,!1,!0):(p===Jt&&Ce&384||!ne&&Me&16)&&P(pe,B,z),re&&Se(M)}(fe&&(D=Ee&&Ee.onVnodeUnmounted)||Ae)&&nr(()=>{D&&pr(D,B,M),Ae&&Lr(M,null,B,"unmounted")},z)},Se=M=>{const{type:B,el:z,anchor:re,transition:ne}=M;if(B===Jt){J(z,re);return}if(B===Na){R(M);return}const p=()=>{a(z),ne&&!ne.persisted&&ne.afterLeave&&ne.afterLeave()};if(M.shapeFlag&1&&ne&&!ne.persisted){const{leave:Ee,delayLeave:x}=ne,pe=()=>Ee(z,p);x?x(M.el,p,pe):pe()}else p()},J=(M,B)=>{let z;for(;M!==B;)z=u(M),a(M),M=z;a(B)},$=(M,B,z)=>{const{bum:re,scope:ne,update:p,subTree:Ee,um:x}=M;re&&Js(re),ne.stop(),p&&(p.active=!1,we(Ee,M,B,z)),x&&nr(x,B),nr(()=>{M.isUnmounted=!0},B),B&&B.pendingBranch&&!B.isUnmounted&&M.asyncDep&&!M.asyncResolved&&M.suspenseId===B.pendingId&&(B.deps--,B.deps===0&&B.resolve())},P=(M,B,z,re=!1,ne=!1,p=0)=>{for(let Ee=p;Ee<M.length;Ee++)we(M[Ee],B,z,re,ne)},k=M=>M.shapeFlag&6?k(M.component.subTree):M.shapeFlag&128?M.suspense.next():u(M.anchor||M.el),ge=(M,B,z)=>{M==null?B._vnode&&we(B._vnode,null,null,!0):y(B._vnode||null,M,B,null,null,null,z),Do(),B._vnode=M},q={p:y,um:we,m:Oe,r:Se,mt:ce,mc:A,pc:ie,pbc:G,n:k,o:e};let ye,X;return t&&([ye,X]=t(q)),{render:ge,hydrate:ye,createApp:vy(ge,ye)}}function Ln({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function Gc(e,t,r=!1){const n=e.children,a=t.children;if(Ve(n)&&Ve(a))for(let i=0;i<n.length;i++){const s=n[i];let f=a[i];f.shapeFlag&1&&!f.dynamicChildren&&((f.patchFlag<=0||f.patchFlag===32)&&(f=a[i]=bn(a[i]),f.el=s.el),r||Gc(s,f))}}function Ey(e){const t=e.slice(),r=[0];let n,a,i,s,f;const h=e.length;for(n=0;n<h;n++){const c=e[n];if(c!==0){if(a=r[r.length-1],e[a]<c){t[n]=a,r.push(n);continue}for(i=0,s=r.length-1;i<s;)f=i+s>>1,e[r[f]]<c?i=f+1:s=f;c<e[r[i]]&&(i>0&&(t[n]=r[i-1]),r[i]=n)}}for(i=r.length,s=r[i-1];i-- >0;)r[i]=s,s=t[s];return r}const _y=e=>e.__isTeleport,gi=e=>e&&(e.disabled||e.disabled===""),df=e=>typeof SVGElement!="undefined"&&e instanceof SVGElement,Hl=(e,t)=>{const r=e&&e.to;return Ke(r)?t?t(r):null:r},by={__isTeleport:!0,process(e,t,r,n,a,i,s,f,h,c){const{mc:o,pc:l,pbc:u,o:{insert:d,querySelector:g,createText:v,createComment:y}}=c,m=gi(t.props);let{shapeFlag:b,children:E,dynamicChildren:N}=t;if(e==null){const R=t.el=v(""),C=t.anchor=v("");d(R,r,n),d(C,r,n);const O=t.target=Hl(t.props,g),T=t.targetAnchor=v("");O&&(d(T,O),s=s||df(O));const A=(L,G)=>{b&16&&o(E,L,G,a,i,s,f,h)};m?A(r,C):O&&A(O,T)}else{t.el=e.el;const R=t.anchor=e.anchor,C=t.target=e.target,O=t.targetAnchor=e.targetAnchor,T=gi(e.props),A=T?r:C,L=T?R:O;if(s=s||df(C),N?(u(e.dynamicChildren,N,A,a,i,s,f),Gc(e,t,!0)):h||l(e,t,A,L,a,i,s,f,!1),m)T||ho(t,r,R,c,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const G=t.target=Hl(t.props,g);G&&ho(t,G,null,c,0)}else T&&ho(t,C,O,c,1)}},remove(e,t,r,n,{um:a,o:{remove:i}},s){const{shapeFlag:f,children:h,anchor:c,targetAnchor:o,target:l,props:u}=e;if(l&&i(o),(s||!gi(u))&&(i(c),f&16))for(let d=0;d<h.length;d++){const g=h[d];a(g,t,r,!0,!!g.dynamicChildren)}},move:ho,hydrate:Ny};function ho(e,t,r,{o:{insert:n},m:a},i=2){i===0&&n(e.targetAnchor,t,r);const{el:s,anchor:f,shapeFlag:h,children:c,props:o}=e,l=i===2;if(l&&n(s,t,r),(!l||gi(o))&&h&16)for(let u=0;u<c.length;u++)a(c[u],t,r,2);l&&n(f,t,r)}function Ny(e,t,r,n,a,i,{o:{nextSibling:s,parentNode:f,querySelector:h}},c){const o=t.target=Hl(t.props,h);if(o){const l=o._lpa||o.firstChild;if(t.shapeFlag&16)if(gi(t.props))t.anchor=c(s(e),t,f(e),r,n,a,i),t.targetAnchor=l;else{t.anchor=s(e);let u=l;for(;u;)if(u=s(u),u&&u.nodeType===8&&u.data==="teleport anchor"){t.targetAnchor=u,o._lpa=t.targetAnchor&&s(t.targetAnchor);break}c(l,t,o,r,n,a,i)}}return t.anchor&&s(t.anchor)}const Ay=by,Jt=Symbol(void 0),Oi=Symbol(void 0),ur=Symbol(void 0),Na=Symbol(void 0),mi=[];let Cr=null;function is(e=!1){mi.push(Cr=e?null:[])}function Cy(){mi.pop(),Cr=mi[mi.length-1]||null}let wi=1;function hf(e){wi+=e}function ov(e){return e.dynamicChildren=wi>0?Cr||ya:null,Cy(),wi>0&&Cr&&Cr.push(e),e}function sv(e,t,r,n,a,i){return ov(uv(e,t,r,n,a,i,!0))}function lv(e,t,r,n,a){return ov(Mt(e,t,r,n,a,!0))}function Bo(e){return e?e.__v_isVNode===!0:!1}function Hn(e,t){return e.type===t.type&&e.key===t.key}const os="__vInternal",cv=({key:e})=>e!=null?e:null,Ro=({ref:e,ref_key:t,ref_for:r})=>e!=null?Ke(e)||Vt(e)||qe(e)?{i:Yt,r:e,k:t,f:!!r}:e:null;function uv(e,t=null,r=null,n=0,a=null,i=e===Jt?0:1,s=!1,f=!1){const h={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&cv(t),ref:t&&Ro(t),scopeId:Vp,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:a,dynamicChildren:null,appContext:null};return f?(Wc(h,r),i&128&&e.normalize(h)):r&&(h.shapeFlag|=Ke(r)?8:16),wi>0&&!s&&Cr&&(h.patchFlag>0||i&6)&&h.patchFlag!==32&&Cr.push(h),h}const Mt=Ty;function Ty(e,t=null,r=null,n=0,a=null,i=!1){if((!e||e===ty)&&(e=ur),Bo(e)){const f=wn(e,t,!0);return r&&Wc(f,r),wi>0&&!i&&Cr&&(f.shapeFlag&6?Cr[Cr.indexOf(e)]=f:Cr.push(f)),f.patchFlag|=-2,f}if(xy(e)&&(e=e.__vccOpts),t){t=Ry(t);let{class:f,style:h}=t;f&&!Ke(f)&&(t.class=Si(f)),$t(h)&&(Ip(h)&&!Ve(h)&&(h=Kt({},h)),t.style=Qo(h))}const s=Ke(e)?1:V1(e)?128:_y(e)?64:$t(e)?4:qe(e)?2:0;return uv(e,t,r,n,a,s,i,!0)}function Ry(e){return e?Ip(e)||os in e?Kt({},e):e:null}function wn(e,t,r=!1){const{props:n,ref:a,patchFlag:i,children:s}=e,f=t?Oy(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:f,key:f&&cv(f),ref:t&&t.ref?r&&a?Ve(a)?a.concat(Ro(t)):[a,Ro(t)]:Ro(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:s,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Jt?i===-1?16:i|16:i,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&wn(e.ssContent),ssFallback:e.ssFallback&&wn(e.ssFallback),el:e.el,anchor:e.anchor}}function Hc(e=" ",t=0){return Mt(Oi,null,e,t)}function H5(e,t){const r=Mt(Na,null,e);return r.staticCount=t,r}function gt(e="",t=!1){return t?(is(),lv(ur,null,e)):Mt(ur,null,e)}function Nr(e){return e==null||typeof e=="boolean"?Mt(ur):Ve(e)?Mt(Jt,null,e.slice()):typeof e=="object"?bn(e):Mt(Oi,null,String(e))}function bn(e){return e.el===null||e.memo?e:wn(e)}function Wc(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(Ve(t))r=16;else if(typeof t=="object")if(n&65){const a=t.default;a&&(a._c&&(a._d=!1),Wc(e,a()),a._c&&(a._d=!0));return}else{r=32;const a=t._;!a&&!(os in t)?t._ctx=Yt:a===3&&Yt&&(Yt.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else qe(t)?(t={default:t,_ctx:Yt},r=32):(t=String(t),n&64?(r=16,t=[Hc(t)]):r=8);e.children=t,e.shapeFlag|=r}function Oy(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const a in n)if(a==="class")t.class!==n.class&&(t.class=Si([t.class,n.class]));else if(a==="style")t.style=Qo([t.style,n.style]);else if(Li(a)){const i=t[a],s=n[a];s&&i!==s&&!(Ve(i)&&i.includes(s))&&(t[a]=i?[].concat(i,s):s)}else a!==""&&(t[a]=n[a])}return t}function pr(e,t,r,n=null){mr(e,t,7,[r,n])}const wy=iv();let Iy=0;function My(e,t,r){const n=e.type,a=(t?t.appContext:e.appContext)||wy,i={uid:Iy++,vnode:e,type:n,parent:t,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,scope:new Y0(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(a.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:tv(n,a),emitsOptions:Bp(n,a),emit:null,emitted:null,propsDefaults:ft,inheritAttrs:n.inheritAttrs,ctx:ft,data:ft,props:ft,attrs:ft,slots:ft,refs:ft,setupState:ft,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=D1.bind(null,i),e.ce&&e.ce(i),i}let xt=null;const zc=()=>xt||Yt,Oa=e=>{xt=e,e.scope.on()},qn=()=>{xt&&xt.scope.off(),xt=null};function fv(e){return e.vnode.shapeFlag&4}let wa=!1;function Py(e,t=!1){wa=t;const{props:r,children:n}=e.vnode,a=fv(e);cy(e,r,a,t),dy(e,n);const i=a?Sy(e,t):void 0;return wa=!1,i}function Sy(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=Mp(new Proxy(e.ctx,ny));const{setup:n}=r;if(n){const a=e.setupContext=n.length>1?$y(e):null;Oa(e),Ua();const i=Rn(n,e,0,[e.props,a]);if(Fa(),qn(),vp(i)){if(i.then(qn,qn),t)return i.then(s=>{pf(e,s,t)}).catch(s=>{$i(s,e,0)});e.asyncDep=i}else pf(e,i,t)}else dv(e,t)}function pf(e,t,r){qe(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:$t(t)&&(e.setupState=Dp(t)),dv(e,r)}let vf;function dv(e,t,r){const n=e.type;if(!e.render){if(!t&&vf&&!n.render){const a=n.template;if(a){const{isCustomElement:i,compilerOptions:s}=e.appContext.config,{delimiters:f,compilerOptions:h}=n,c=Kt(Kt({isCustomElement:i,delimiters:f},s),h);n.render=vf(a,c)}}e.render=n.render||Rr}Oa(e),Ua(),ay(e),Fa(),qn()}function Ly(e){return new Proxy(e.attrs,{get(t,r){return fr(e,"get","$attrs"),t[r]}})}function $y(e){const t=n=>{e.exposed=n||{}};let r;return{get attrs(){return r||(r=Ly(e))},slots:e.slots,emit:e.emit,expose:t}}function ss(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Dp(Mp(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in ko)return ko[r](e)}}))}function Dy(e,t=!0){return qe(e)?e.displayName||e.name:e.name||t&&e.__name}function xy(e){return qe(e)&&"__vccOpts"in e}const xe=(e,t)=>I1(e,t,wa);function j(e,t,r){const n=arguments.length;return n===2?$t(t)&&!Ve(t)?Bo(t)?Mt(e,null,[t]):Mt(e,t):Mt(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&Bo(r)&&(r=[r]),Mt(e,t,r))}const ky="3.2.37",Uy="http://www.w3.org/2000/svg",Wn=typeof document!="undefined"?document:null,gf=Wn&&Wn.createElement("template"),Fy={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const a=t?Wn.createElementNS(Uy,e):Wn.createElement(e,r?{is:r}:void 0);return e==="select"&&n&&n.multiple!=null&&a.setAttribute("multiple",n.multiple),a},createText:e=>Wn.createTextNode(e),createComment:e=>Wn.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Wn.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,r,n,a,i){const s=r?r.previousSibling:t.lastChild;if(a&&(a===i||a.nextSibling))for(;t.insertBefore(a.cloneNode(!0),r),!(a===i||!(a=a.nextSibling)););else{gf.innerHTML=n?`<svg>${e}</svg>`:e;const f=gf.content;if(n){const h=f.firstChild;for(;h.firstChild;)f.appendChild(h.firstChild);f.removeChild(h)}t.insertBefore(f,r)}return[s?s.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}};function By(e,t,r){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}function Vy(e,t,r){const n=e.style,a=Ke(r);if(r&&!a){for(const i in r)Wl(n,i,r[i]);if(t&&!Ke(t))for(const i in t)r[i]==null&&Wl(n,i,"")}else{const i=n.display;a?t!==r&&(n.cssText=r):t&&e.removeAttribute("style"),"_vod"in e&&(n.display=i)}}const mf=/\s*!important$/;function Wl(e,t,r){if(Ve(r))r.forEach(n=>Wl(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=Gy(e,t);mf.test(r)?e.setProperty(Zn(n),r.replace(mf,""),"important"):e[n]=r}}const yf=["Webkit","Moz","ms"],nl={};function Gy(e,t){const r=nl[t];if(r)return r;let n=Ur(t);if(n!=="filter"&&n in e)return nl[t]=n;n=es(n);for(let a=0;a<yf.length;a++){const i=yf[a]+n;if(i in e)return nl[t]=i}return t}const Ef="http://www.w3.org/1999/xlink";function Hy(e,t,r,n,a){if(n&&t.startsWith("xlink:"))r==null?e.removeAttributeNS(Ef,t.slice(6,t.length)):e.setAttributeNS(Ef,t,r);else{const i=x0(t);r==null||i&&!dp(r)?e.removeAttribute(t):e.setAttribute(t,i?"":r)}}function Wy(e,t,r,n,a,i,s){if(t==="innerHTML"||t==="textContent"){n&&s(n,a,i),e[t]=r==null?"":r;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=r;const h=r==null?"":r;(e.value!==h||e.tagName==="OPTION")&&(e.value=h),r==null&&e.removeAttribute(t);return}let f=!1;if(r===""||r==null){const h=typeof e[t];h==="boolean"?r=dp(r):r==null&&h==="string"?(r="",f=!0):h==="number"&&(r=0,f=!0)}try{e[t]=r}catch{}f&&e.removeAttribute(t)}const[hv,zy]=(()=>{let e=Date.now,t=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const r=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(r&&Number(r[1])<=53)}return[e,t]})();let zl=0;const Ky=Promise.resolve(),qy=()=>{zl=0},Yy=()=>zl||(Ky.then(qy),zl=hv());function Xy(e,t,r,n){e.addEventListener(t,r,n)}function jy(e,t,r,n){e.removeEventListener(t,r,n)}function Qy(e,t,r,n,a=null){const i=e._vei||(e._vei={}),s=i[t];if(n&&s)s.value=n;else{const[f,h]=Zy(t);if(n){const c=i[t]=Jy(n,a);Xy(e,f,c,h)}else s&&(jy(e,f,s,h),i[t]=void 0)}}const _f=/(?:Once|Passive|Capture)$/;function Zy(e){let t;if(_f.test(e)){t={};let r;for(;r=e.match(_f);)e=e.slice(0,e.length-r[0].length),t[r[0].toLowerCase()]=!0}return[Zn(e.slice(2)),t]}function Jy(e,t){const r=n=>{const a=n.timeStamp||hv();(zy||a>=r.attached-1)&&mr(eE(n,r.value),t,5,[n])};return r.value=e,r.attached=Yy(),r}function eE(e,t){if(Ve(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>a=>!a._stopped&&n&&n(a))}else return t}const bf=/^on[a-z]/,tE=(e,t,r,n,a=!1,i,s,f,h)=>{t==="class"?By(e,n,a):t==="style"?Vy(e,r,n):Li(t)?Oc(t)||Qy(e,t,r,n,s):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):rE(e,t,n,a))?Wy(e,t,n,i,s,f,h):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),Hy(e,t,n,a))};function rE(e,t,r,n){return n?!!(t==="innerHTML"||t==="textContent"||t in e&&bf.test(t)&&qe(r)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||bf.test(t)&&Ke(r)?!1:t in e}function nE(e){const t=zc();if(!t)return;const r=()=>Kl(t.subTree,e(t.proxy));G1(r),Ut(()=>{const n=new MutationObserver(r);n.observe(t.subTree.el.parentNode,{childList:!0}),ki(()=>n.disconnect())})}function Kl(e,t){if(e.shapeFlag&128){const r=e.suspense;e=r.activeBranch,r.pendingBranch&&!r.isHydrating&&r.effects.push(()=>{Kl(r.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)Nf(e.el,t);else if(e.type===Jt)e.children.forEach(r=>Kl(r,t));else if(e.type===Na){let{el:r,anchor:n}=e;for(;r&&(Nf(r,t),r!==n);)r=r.nextSibling}}function Nf(e,t){if(e.nodeType===1){const r=e.style;for(const n in t)r.setProperty(`--${n}`,t[n])}}const gn="transition",Ja="animation",Kc=(e,{slots:t})=>j(Wp,aE(e),t);Kc.displayName="Transition";const pv={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Kc.props=Kt({},Wp.props,pv);const $n=(e,t=[])=>{Ve(e)?e.forEach(r=>r(...t)):e&&e(...t)},Af=e=>e?Ve(e)?e.some(t=>t.length>1):e.length>1:!1;function aE(e){const t={};for(const H in e)H in pv||(t[H]=e[H]);if(e.css===!1)return t;const{name:r="v",type:n,duration:a,enterFromClass:i=`${r}-enter-from`,enterActiveClass:s=`${r}-enter-active`,enterToClass:f=`${r}-enter-to`,appearFromClass:h=i,appearActiveClass:c=s,appearToClass:o=f,leaveFromClass:l=`${r}-leave-from`,leaveActiveClass:u=`${r}-leave-active`,leaveToClass:d=`${r}-leave-to`}=e,g=iE(a),v=g&&g[0],y=g&&g[1],{onBeforeEnter:m,onEnter:b,onEnterCancelled:E,onLeave:N,onLeaveCancelled:R,onBeforeAppear:C=m,onAppear:O=b,onAppearCancelled:T=E}=t,A=(H,Y,K)=>{Dn(H,Y?o:f),Dn(H,Y?c:s),K&&K()},L=(H,Y)=>{H._isLeaving=!1,Dn(H,l),Dn(H,d),Dn(H,u),Y&&Y()},G=H=>(Y,K)=>{const ce=H?O:b,V=()=>A(Y,H,K);$n(ce,[Y,V]),Cf(()=>{Dn(Y,H?h:i),mn(Y,H?o:f),Af(ce)||Tf(Y,n,v,V)})};return Kt(t,{onBeforeEnter(H){$n(m,[H]),mn(H,i),mn(H,s)},onBeforeAppear(H){$n(C,[H]),mn(H,h),mn(H,c)},onEnter:G(!1),onAppear:G(!0),onLeave(H,Y){H._isLeaving=!0;const K=()=>L(H,Y);mn(H,l),lE(),mn(H,u),Cf(()=>{!H._isLeaving||(Dn(H,l),mn(H,d),Af(N)||Tf(H,n,y,K))}),$n(N,[H,K])},onEnterCancelled(H){A(H,!1),$n(E,[H])},onAppearCancelled(H){A(H,!0),$n(T,[H])},onLeaveCancelled(H){L(H),$n(R,[H])}})}function iE(e){if(e==null)return null;if($t(e))return[al(e.enter),al(e.leave)];{const t=al(e);return[t,t]}}function al(e){return yp(e)}function mn(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.add(r)),(e._vtc||(e._vtc=new Set)).add(t)}function Dn(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.remove(n));const{_vtc:r}=e;r&&(r.delete(t),r.size||(e._vtc=void 0))}function Cf(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let oE=0;function Tf(e,t,r,n){const a=e._endId=++oE,i=()=>{a===e._endId&&n()};if(r)return setTimeout(i,r);const{type:s,timeout:f,propCount:h}=sE(e,t);if(!s)return n();const c=s+"end";let o=0;const l=()=>{e.removeEventListener(c,u),i()},u=d=>{d.target===e&&++o>=h&&l()};setTimeout(()=>{o<h&&l()},f+1),e.addEventListener(c,u)}function sE(e,t){const r=window.getComputedStyle(e),n=g=>(r[g]||"").split(", "),a=n(gn+"Delay"),i=n(gn+"Duration"),s=Rf(a,i),f=n(Ja+"Delay"),h=n(Ja+"Duration"),c=Rf(f,h);let o=null,l=0,u=0;t===gn?s>0&&(o=gn,l=s,u=i.length):t===Ja?c>0&&(o=Ja,l=c,u=h.length):(l=Math.max(s,c),o=l>0?s>c?gn:Ja:null,u=o?o===gn?i.length:h.length:0);const d=o===gn&&/\b(transform|all)(,|$)/.test(r[gn+"Property"]);return{type:o,timeout:l,propCount:u,hasTransform:d}}function Rf(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((r,n)=>Of(r)+Of(e[n])))}function Of(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function lE(){return document.body.offsetHeight}const cE={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},W5=(e,t)=>r=>{if(!("key"in r))return;const n=Zn(r.key);if(t.some(a=>a===n||cE[a]===n))return e(r)},z5={beforeMount(e,{value:t},{transition:r}){e._vod=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):ei(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:n}){!t!=!r&&(n?t?(n.beforeEnter(e),ei(e,!0),n.enter(e)):n.leave(e,()=>{ei(e,!1)}):ei(e,t))},beforeUnmount(e,{value:t}){ei(e,t)}};function ei(e,t){e.style.display=t?e._vod:"none"}const uE=Kt({patchProp:tE},Fy);let il,wf=!1;function fE(){return il=wf?il:my(uE),wf=!0,il}const dE=(...e)=>{const t=fE().createApp(...e),{mount:r}=t;return t.mount=n=>{const a=hE(n);if(a)return r(a,!0,a instanceof SVGElement)},t};function hE(e){return Ke(e)?document.querySelector(e):e}const on=JSON.parse('{"base":"/vma-grid/","lang":"zh-CN","title":"vma-grid","description":"vue3 calc grid - \u4E00\u4E2A\u57FA\u4E8EVue3 Typescript\u7684\u8868\u683C\u7EC4\u4EF6","head":[["link",{"rel":"stylesheet","href":"//at.alicdn.com/t/font_2410206_mfj6e1vbwo.css"}]],"locales":{}}');var pE=([e,t,r])=>e==="meta"&&t.name?`${e}.${t.name}`:["title","base"].includes(e)?e:e==="template"&&t.id?`${e}.${t.id}`:JSON.stringify([e,t,r]),Mn=e=>{const t=new Set,r=[];return e.forEach(n=>{const a=pE(n);t.has(a)||(t.add(a),r.push(n))}),r},vv=e=>/^(https?:)?\/\//.test(e),K5=e=>/^mailto:/.test(e),q5=e=>/^tel:/.test(e),gv=e=>Object.prototype.toString.call(e)==="[object Object]",vE=e=>e.replace(/\/$/,""),mv=e=>e.replace(/^\//,""),sn=(e,t)=>{const r=Object.keys(e).sort((n,a)=>{const i=a.split("/").length-n.split("/").length;return i!==0?i:a.length-n.length});for(const n of r)if(t.startsWith(n))return n;return"/"};const ln={"v-8daa1a0e":Bt(()=>Je(()=>import("./index.html.c7019b5f.js"),[])),"v-2f4d3eda":Bt(()=>Je(()=>import("./grid-button.html.bd14db56.js"),[])),"v-7f75cc29":Bt(()=>Je(()=>import("./grid-checkbox.html.5e9337bd.js"),[])),"v-13863eb3":Bt(()=>Je(()=>import("./grid-icon.html.82893493.js"),[])),"v-12fb0d8a":Bt(()=>Je(()=>import("./grid-loading.html.5649f0c4.js"),[])),"v-90541d2a":Bt(()=>Je(()=>import("./grid-radio.html.742f453e.js"),[])),"v-0016c312":Bt(()=>Je(()=>import("./grid-textarea.html.5383309f.js"),[])),"v-5107b6ce":Bt(()=>Je(()=>import("./grid.html.73d5cee5.js"),[])),"v-1a1874fc":Bt(()=>Je(()=>import("./index.html.b776adc5.js"),[])),"v-e0e76f98":Bt(()=>Je(()=>import("./modules.html.d4ed1a3a.js"),[])),"v-a9cea3dc":Bt(()=>Je(()=>import("./index.DepParser.html.8de2063b.js"),[])),"v-44208220":Bt(()=>Je(()=>import("./index.FormulaError.html.9ccd65b5.js"),[])),"v-6da1d8db":Bt(()=>Je(()=>import("./index.FormulaParser.html.66d517b5.js"),[])),"v-cf6e5f3c":Bt(()=>Je(()=>import("./formulas.html.8f7724ad.js"),[])),"v-201aed0a":Bt(()=>Je(()=>import("./index.html.2e2d2bfa.js"),[])),"v-3706649a":Bt(()=>Je(()=>import("./404.html.1bdf6caf.js"),[]))},cn={404:Bt(()=>Je(()=>import("./404.0c98b81f.js"),[])),Layout:Bt(()=>Je(()=>import("./Layout.1ce12f20.js"),[]))};var yv=be(nn),Ev=Ir({key:"",path:"",title:"",lang:"",frontmatter:{},excerpt:"",headers:[]}),tn=be(Ev),_v=()=>tn;Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updatePageData=e=>{yv.value[e.key]=()=>Promise.resolve(e),e.key===tn.value.key&&(tn.value=e)});var gE=Symbol(""),bv=Symbol(""),mE=()=>{const e=mt(bv);if(!e)throw new Error("usePageHead() is called without provider.");return e},yE=Symbol(""),Nv=Symbol(""),EE=()=>{const e=mt(Nv);if(!e)throw new Error("usePageLang() is called without provider.");return e},_E=Symbol(""),Cn=be(on),bE=()=>Cn;Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updateSiteData=e=>{Cn.value=e});var NE=Symbol(""),AE=Symbol(""),Bn=kt({resolvePageData:async e=>{const t=yv.value[e],r=await(t==null?void 0:t());return r!=null?r:Ev},resolvePageFrontmatter:e=>e.frontmatter,resolvePageHead:(e,t,r)=>{const n=Ke(t.description)?t.description:r.description,a=[...Ve(t.head)?t.head:[],...r.head,["title",{},e],["meta",{name:"description",content:n}]];return Mn(a)},resolvePageHeadTitle:(e,t)=>`${e.title?`${e.title} | `:""}${t.title}`,resolvePageLang:e=>e.lang||"en",resolveRouteLocale:(e,t)=>sn(e,t),resolveSiteLocaleData:(e,t)=>({...e,...e.locales[t]})}),CE=He({name:"ClientOnly",setup(e,t){const r=be(!1);return Ut(()=>{r.value=!0}),()=>{var n,a;return r.value?(a=(n=t.slots).default)==null?void 0:a.call(n):null}}}),TE=He({name:"Content",props:{pageKey:{type:String,required:!1,default:""}},setup(e){const t=_v(),r=xe(()=>ln[e.pageKey||t.value.key]);return()=>r.value?j(r.value):j("div","404 Not Found")}}),If=He({name:"Vuepress",setup(){const e=_v(),t=xe(()=>{let r;if(e.value.path){const n=e.value.frontmatter.layout;Ke(n)?r=n:r="Layout"}else r="404";return cn[r]||pt(r,!1)});return()=>j(t.value)}}),RE=e=>vv(e)?e:`${bE().value.base}${mv(e)}`,Av=be(nn),Cv=Ir({key:"",path:"",title:"",lang:"",frontmatter:{},excerpt:"",headers:[]}),ql=be(Cv),qc=()=>ql;Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updatePageData=e=>{Av.value[e.key]=()=>Promise.resolve(e),e.key===ql.value.key&&(ql.value=e)});var OE=be(on);Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updateSiteData=e=>{OE.value=e});kt({resolvePageData:async e=>{const t=Av.value[e],r=await(t==null?void 0:t());return r!=null?r:Cv},resolvePageFrontmatter:e=>e.frontmatter,resolvePageHead:(e,t,r)=>{const n=Ke(t.description)?t.description:r.description,a=[...Ve(t.head)?t.head:[],...r.head,["title",{},e],["meta",{name:"description",content:n}]];return Mn(a)},resolvePageHeadTitle:(e,t)=>`${e.title?`${e.title} | `:""}${t.title}`,resolvePageLang:e=>e.lang||"en",resolveRouteLocale:(e,t)=>sn(e,t),resolveSiteLocaleData:(e,t)=>({...e,...e.locales[t]})});He({name:"ClientOnly",setup(e,t){const r=be(!1);return Ut(()=>{r.value=!0}),()=>{var n,a;return r.value?(a=(n=t.slots).default)==null?void 0:a.call(n):null}}});He({name:"Content",props:{pageKey:{type:String,required:!1,default:""}},setup(e){const t=qc(),r=xe(()=>ln[e.pageKey||t.value.key]);return()=>r.value?j(r.value):j("div","404 Not Found")}});He({name:"Vuepress",setup(){const e=qc(),t=xe(()=>{let r;if(e.value.path){const n=e.value.frontmatter.layout;Ke(n)?r=n:r="Layout"}else r="404";return cn[r]||pt(r,!1)});return()=>j(t.value)}});var wE=e=>e;function Tv(e,t,r){var n,a,i;t===void 0&&(t=50),r===void 0&&(r={});var s=(n=r.isImmediate)!=null&&n,f=(a=r.callback)!=null&&a,h=r.maxWait,c=Date.now(),o=[];function l(){if(h!==void 0){var d=Date.now()-c;if(d+t>=h)return h-d}return t}var u=function(){var d=[].slice.call(arguments),g=this;return new Promise(function(v,y){var m=s&&i===void 0;if(i!==void 0&&clearTimeout(i),i=setTimeout(function(){if(i=void 0,c=Date.now(),!s){var E=e.apply(g,d);f&&f(E),o.forEach(function(N){return(0,N.resolve)(E)}),o=[]}},l()),m){var b=e.apply(g,d);return f&&f(b),v(b)}o.push({resolve:v,reject:y})})};return u.cancel=function(d){i!==void 0&&clearTimeout(i),o.forEach(function(g){return(0,g.reject)(d)}),o=[]},u}/*!
  * vue-router v4.1.2
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const va=typeof window!="undefined";function IE(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const ut=Object.assign;function ol(e,t){const r={};for(const n in t){const a=t[n];r[n]=wr(a)?a.map(e):e(a)}return r}const yi=()=>{},wr=Array.isArray,ME=/\/$/,PE=e=>e.replace(ME,"");function sl(e,t,r="/"){let n,a={},i="",s="";const f=t.indexOf("#");let h=t.indexOf("?");return f<h&&f>=0&&(h=-1),h>-1&&(n=t.slice(0,h),i=t.slice(h+1,f>-1?f:t.length),a=e(i)),f>-1&&(n=n||t.slice(0,f),s=t.slice(f,t.length)),n=DE(n!=null?n:t,r),{fullPath:n+(i&&"?")+i+s,path:n,query:a,hash:s}}function SE(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function Mf(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function LE(e,t,r){const n=t.matched.length-1,a=r.matched.length-1;return n>-1&&n===a&&Ia(t.matched[n],r.matched[a])&&Rv(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function Ia(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Rv(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!$E(e[r],t[r]))return!1;return!0}function $E(e,t){return wr(e)?Pf(e,t):wr(t)?Pf(t,e):e===t}function Pf(e,t){return wr(t)?e.length===t.length&&e.every((r,n)=>r===t[n]):e.length===1&&e[0]===t}function DE(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),n=e.split("/");let a=r.length-1,i,s;for(i=0;i<n.length;i++)if(s=n[i],s!==".")if(s==="..")a>1&&a--;else break;return r.slice(0,a).join("/")+"/"+n.slice(i-(i===n.length?1:0)).join("/")}var Ii;(function(e){e.pop="pop",e.push="push"})(Ii||(Ii={}));var Ei;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Ei||(Ei={}));function xE(e){if(!e)if(va){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),PE(e)}const kE=/^[^#]+#/;function UE(e,t){return e.replace(kE,"#")+t}function FE(e,t){const r=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-r.left-(t.left||0),top:n.top-r.top-(t.top||0)}}const ls=()=>({left:window.pageXOffset,top:window.pageYOffset});function BE(e){let t;if("el"in e){const r=e.el,n=typeof r=="string"&&r.startsWith("#"),a=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!a)return;t=FE(a,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function Sf(e,t){return(history.state?history.state.position-t:-1)+e}const Yl=new Map;function VE(e,t){Yl.set(e,t)}function GE(e){const t=Yl.get(e);return Yl.delete(e),t}let HE=()=>location.protocol+"//"+location.host;function Ov(e,t){const{pathname:r,search:n,hash:a}=t,i=e.indexOf("#");if(i>-1){let f=a.includes(e.slice(i))?e.slice(i).length:1,h=a.slice(f);return h[0]!=="/"&&(h="/"+h),Mf(h,"")}return Mf(r,e)+n+a}function WE(e,t,r,n){let a=[],i=[],s=null;const f=({state:u})=>{const d=Ov(e,location),g=r.value,v=t.value;let y=0;if(u){if(r.value=d,t.value=u,s&&s===g){s=null;return}y=v?u.position-v.position:0}else n(d);a.forEach(m=>{m(r.value,g,{delta:y,type:Ii.pop,direction:y?y>0?Ei.forward:Ei.back:Ei.unknown})})};function h(){s=r.value}function c(u){a.push(u);const d=()=>{const g=a.indexOf(u);g>-1&&a.splice(g,1)};return i.push(d),d}function o(){const{history:u}=window;!u.state||u.replaceState(ut({},u.state,{scroll:ls()}),"")}function l(){for(const u of i)u();i=[],window.removeEventListener("popstate",f),window.removeEventListener("beforeunload",o)}return window.addEventListener("popstate",f),window.addEventListener("beforeunload",o),{pauseListeners:h,listen:c,destroy:l}}function Lf(e,t,r,n=!1,a=!1){return{back:e,current:t,forward:r,replaced:n,position:window.history.length,scroll:a?ls():null}}function zE(e){const{history:t,location:r}=window,n={value:Ov(e,r)},a={value:t.state};a.value||i(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(h,c,o){const l=e.indexOf("#"),u=l>-1?(r.host&&document.querySelector("base")?e:e.slice(l))+h:HE()+e+h;try{t[o?"replaceState":"pushState"](c,"",u),a.value=c}catch(d){console.error(d),r[o?"replace":"assign"](u)}}function s(h,c){const o=ut({},t.state,Lf(a.value.back,h,a.value.forward,!0),c,{position:a.value.position});i(h,o,!0),n.value=h}function f(h,c){const o=ut({},a.value,t.state,{forward:h,scroll:ls()});i(o.current,o,!0);const l=ut({},Lf(n.value,h,null),{position:o.position+1},c);i(h,l,!1),n.value=h}return{location:n,state:a,push:f,replace:s}}function KE(e){e=xE(e);const t=zE(e),r=WE(e,t.state,t.location,t.replace);function n(i,s=!0){s||r.pauseListeners(),history.go(i)}const a=ut({location:"",base:e,go:n,createHref:UE.bind(null,e)},t,r);return Object.defineProperty(a,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(a,"state",{enumerable:!0,get:()=>t.state.value}),a}function qE(e){return typeof e=="string"||e&&typeof e=="object"}function wv(e){return typeof e=="string"||typeof e=="symbol"}const Jr={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Iv=Symbol("");var $f;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})($f||($f={}));function Ma(e,t){return ut(new Error,{type:e,[Iv]:!0},t)}function yn(e,t){return e instanceof Error&&Iv in e&&(t==null||!!(e.type&t))}const Df="[^/]+?",YE={sensitive:!1,strict:!1,start:!0,end:!0},XE=/[.+*?^${}()[\]/\\]/g;function jE(e,t){const r=ut({},YE,t),n=[];let a=r.start?"^":"";const i=[];for(const c of e){const o=c.length?[]:[90];r.strict&&!c.length&&(a+="/");for(let l=0;l<c.length;l++){const u=c[l];let d=40+(r.sensitive?.25:0);if(u.type===0)l||(a+="/"),a+=u.value.replace(XE,"\\$&"),d+=40;else if(u.type===1){const{value:g,repeatable:v,optional:y,regexp:m}=u;i.push({name:g,repeatable:v,optional:y});const b=m||Df;if(b!==Df){d+=10;try{new RegExp(`(${b})`)}catch(N){throw new Error(`Invalid custom RegExp for param "${g}" (${b}): `+N.message)}}let E=v?`((?:${b})(?:/(?:${b}))*)`:`(${b})`;l||(E=y&&c.length<2?`(?:/${E})`:"/"+E),y&&(E+="?"),a+=E,d+=20,y&&(d+=-8),v&&(d+=-20),b===".*"&&(d+=-50)}o.push(d)}n.push(o)}if(r.strict&&r.end){const c=n.length-1;n[c][n[c].length-1]+=.7000000000000001}r.strict||(a+="/?"),r.end?a+="$":r.strict&&(a+="(?:/|$)");const s=new RegExp(a,r.sensitive?"":"i");function f(c){const o=c.match(s),l={};if(!o)return null;for(let u=1;u<o.length;u++){const d=o[u]||"",g=i[u-1];l[g.name]=d&&g.repeatable?d.split("/"):d}return l}function h(c){let o="",l=!1;for(const u of e){(!l||!o.endsWith("/"))&&(o+="/"),l=!1;for(const d of u)if(d.type===0)o+=d.value;else if(d.type===1){const{value:g,repeatable:v,optional:y}=d,m=g in c?c[g]:"";if(wr(m)&&!v)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const b=wr(m)?m.join("/"):m;if(!b)if(y)u.length<2&&e.length>1&&(o.endsWith("/")?o=o.slice(0,-1):l=!0);else throw new Error(`Missing required param "${g}"`);o+=b}}return o}return{re:s,score:n,keys:i,parse:f,stringify:h}}function QE(e,t){let r=0;for(;r<e.length&&r<t.length;){const n=t[r]-e[r];if(n)return n;r++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function ZE(e,t){let r=0;const n=e.score,a=t.score;for(;r<n.length&&r<a.length;){const i=QE(n[r],a[r]);if(i)return i;r++}if(Math.abs(a.length-n.length)===1){if(xf(n))return 1;if(xf(a))return-1}return a.length-n.length}function xf(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const JE={type:0,value:""},e_=/[a-zA-Z0-9_]/;function t_(e){if(!e)return[[]];if(e==="/")return[[JE]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(d){throw new Error(`ERR (${r})/"${c}": ${d}`)}let r=0,n=r;const a=[];let i;function s(){i&&a.push(i),i=[]}let f=0,h,c="",o="";function l(){!c||(r===0?i.push({type:0,value:c}):r===1||r===2||r===3?(i.length>1&&(h==="*"||h==="+")&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:o,repeatable:h==="*"||h==="+",optional:h==="*"||h==="?"})):t("Invalid state to consume buffer"),c="")}function u(){c+=h}for(;f<e.length;){if(h=e[f++],h==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:h==="/"?(c&&l(),s()):h===":"?(l(),r=1):u();break;case 4:u(),r=n;break;case 1:h==="("?r=2:e_.test(h)?u():(l(),r=0,h!=="*"&&h!=="?"&&h!=="+"&&f--);break;case 2:h===")"?o[o.length-1]=="\\"?o=o.slice(0,-1)+h:r=3:o+=h;break;case 3:l(),r=0,h!=="*"&&h!=="?"&&h!=="+"&&f--,o="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${c}"`),l(),s(),a}function r_(e,t,r){const n=jE(t_(e.path),r),a=ut(n,{record:e,parent:t,children:[],alias:[]});return t&&!a.record.aliasOf==!t.record.aliasOf&&t.children.push(a),a}function n_(e,t){const r=[],n=new Map;t=Uf({strict:!1,end:!0,sensitive:!1},t);function a(o){return n.get(o)}function i(o,l,u){const d=!u,g=i_(o);g.aliasOf=u&&u.record;const v=Uf(t,o),y=[g];if("alias"in o){const E=typeof o.alias=="string"?[o.alias]:o.alias;for(const N of E)y.push(ut({},g,{components:u?u.record.components:g.components,path:N,aliasOf:u?u.record:g}))}let m,b;for(const E of y){const{path:N}=E;if(l&&N[0]!=="/"){const R=l.record.path,C=R[R.length-1]==="/"?"":"/";E.path=l.record.path+(N&&C+N)}if(m=r_(E,l,v),u?u.alias.push(m):(b=b||m,b!==m&&b.alias.push(m),d&&o.name&&!kf(m)&&s(o.name)),g.children){const R=g.children;for(let C=0;C<R.length;C++)i(R[C],m,u&&u.children[C])}u=u||m,h(m)}return b?()=>{s(b)}:yi}function s(o){if(wv(o)){const l=n.get(o);l&&(n.delete(o),r.splice(r.indexOf(l),1),l.children.forEach(s),l.alias.forEach(s))}else{const l=r.indexOf(o);l>-1&&(r.splice(l,1),o.record.name&&n.delete(o.record.name),o.children.forEach(s),o.alias.forEach(s))}}function f(){return r}function h(o){let l=0;for(;l<r.length&&ZE(o,r[l])>=0&&(o.record.path!==r[l].record.path||!Mv(o,r[l]));)l++;r.splice(l,0,o),o.record.name&&!kf(o)&&n.set(o.record.name,o)}function c(o,l){let u,d={},g,v;if("name"in o&&o.name){if(u=n.get(o.name),!u)throw Ma(1,{location:o});v=u.record.name,d=ut(a_(l.params,u.keys.filter(b=>!b.optional).map(b=>b.name)),o.params),g=u.stringify(d)}else if("path"in o)g=o.path,u=r.find(b=>b.re.test(g)),u&&(d=u.parse(g),v=u.record.name);else{if(u=l.name?n.get(l.name):r.find(b=>b.re.test(l.path)),!u)throw Ma(1,{location:o,currentLocation:l});v=u.record.name,d=ut({},l.params,o.params),g=u.stringify(d)}const y=[];let m=u;for(;m;)y.unshift(m.record),m=m.parent;return{name:v,path:g,params:d,matched:y,meta:s_(y)}}return e.forEach(o=>i(o)),{addRoute:i,resolve:c,removeRoute:s,getRoutes:f,getRecordMatcher:a}}function a_(e,t){const r={};for(const n of t)n in e&&(r[n]=e[n]);return r}function i_(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:o_(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function o_(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const n in e.components)t[n]=typeof r=="boolean"?r:r[n];return t}function kf(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function s_(e){return e.reduce((t,r)=>ut(t,r.meta),{})}function Uf(e,t){const r={};for(const n in e)r[n]=n in t?t[n]:e[n];return r}function Mv(e,t){return t.children.some(r=>r===e||Mv(e,r))}const Pv=/#/g,l_=/&/g,c_=/\//g,u_=/=/g,f_=/\?/g,Sv=/\+/g,d_=/%5B/g,h_=/%5D/g,Lv=/%5E/g,p_=/%60/g,$v=/%7B/g,v_=/%7C/g,Dv=/%7D/g,g_=/%20/g;function Yc(e){return encodeURI(""+e).replace(v_,"|").replace(d_,"[").replace(h_,"]")}function m_(e){return Yc(e).replace($v,"{").replace(Dv,"}").replace(Lv,"^")}function Xl(e){return Yc(e).replace(Sv,"%2B").replace(g_,"+").replace(Pv,"%23").replace(l_,"%26").replace(p_,"`").replace($v,"{").replace(Dv,"}").replace(Lv,"^")}function y_(e){return Xl(e).replace(u_,"%3D")}function E_(e){return Yc(e).replace(Pv,"%23").replace(f_,"%3F")}function __(e){return e==null?"":E_(e).replace(c_,"%2F")}function Vo(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function b_(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let a=0;a<n.length;++a){const i=n[a].replace(Sv," "),s=i.indexOf("="),f=Vo(s<0?i:i.slice(0,s)),h=s<0?null:Vo(i.slice(s+1));if(f in t){let c=t[f];wr(c)||(c=t[f]=[c]),c.push(h)}else t[f]=h}return t}function Ff(e){let t="";for(let r in e){const n=e[r];if(r=y_(r),n==null){n!==void 0&&(t+=(t.length?"&":"")+r);continue}(wr(n)?n.map(i=>i&&Xl(i)):[n&&Xl(n)]).forEach(i=>{i!==void 0&&(t+=(t.length?"&":"")+r,i!=null&&(t+="="+i))})}return t}function N_(e){const t={};for(const r in e){const n=e[r];n!==void 0&&(t[r]=wr(n)?n.map(a=>a==null?null:""+a):n==null?n:""+n)}return t}const A_=Symbol(""),Bf=Symbol(""),cs=Symbol(""),Xc=Symbol(""),jl=Symbol("");function ti(){let e=[];function t(n){return e.push(n),()=>{const a=e.indexOf(n);a>-1&&e.splice(a,1)}}function r(){e=[]}return{add:t,list:()=>e,reset:r}}function Nn(e,t,r,n,a){const i=n&&(n.enterCallbacks[a]=n.enterCallbacks[a]||[]);return()=>new Promise((s,f)=>{const h=l=>{l===!1?f(Ma(4,{from:r,to:t})):l instanceof Error?f(l):qE(l)?f(Ma(2,{from:t,to:l})):(i&&n.enterCallbacks[a]===i&&typeof l=="function"&&i.push(l),s())},c=e.call(n&&n.instances[a],t,r,h);let o=Promise.resolve(c);e.length<3&&(o=o.then(h)),o.catch(l=>f(l))})}function ll(e,t,r,n){const a=[];for(const i of e)for(const s in i.components){let f=i.components[s];if(!(t!=="beforeRouteEnter"&&!i.instances[s]))if(C_(f)){const c=(f.__vccOpts||f)[t];c&&a.push(Nn(c,r,n,i,s))}else{let h=f();a.push(()=>h.then(c=>{if(!c)return Promise.reject(new Error(`Couldn't resolve component "${s}" at "${i.path}"`));const o=IE(c)?c.default:c;i.components[s]=o;const u=(o.__vccOpts||o)[t];return u&&Nn(u,r,n,i,s)()}))}}return a}function C_(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Vf(e){const t=mt(cs),r=mt(Xc),n=xe(()=>t.resolve(Or(e.to))),a=xe(()=>{const{matched:h}=n.value,{length:c}=h,o=h[c-1],l=r.matched;if(!o||!l.length)return-1;const u=l.findIndex(Ia.bind(null,o));if(u>-1)return u;const d=Gf(h[c-2]);return c>1&&Gf(o)===d&&l[l.length-1].path!==d?l.findIndex(Ia.bind(null,h[c-2])):u}),i=xe(()=>a.value>-1&&w_(r.params,n.value.params)),s=xe(()=>a.value>-1&&a.value===r.matched.length-1&&Rv(r.params,n.value.params));function f(h={}){return O_(h)?t[Or(e.replace)?"replace":"push"](Or(e.to)).catch(yi):Promise.resolve()}return{route:n,href:xe(()=>n.value.href),isActive:i,isExactActive:s,navigate:f}}const T_=He({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Vf,setup(e,{slots:t}){const r=kt(Vf(e)),{options:n}=mt(cs),a=xe(()=>({[Hf(e.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[Hf(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const i=t.default&&t.default(r);return e.custom?i:j("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:a.value},i)}}}),R_=T_;function O_(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function w_(e,t){for(const r in t){const n=t[r],a=e[r];if(typeof n=="string"){if(n!==a)return!1}else if(!wr(a)||a.length!==n.length||n.some((i,s)=>i!==a[s]))return!1}return!0}function Gf(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Hf=(e,t,r)=>e!=null?e:t!=null?t:r,I_=He({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const n=mt(jl),a=xe(()=>e.route||n.value),i=mt(Bf,0),s=xe(()=>{let c=Or(i);const{matched:o}=a.value;let l;for(;(l=o[c])&&!l.components;)c++;return c}),f=xe(()=>a.value.matched[s.value]);Nt(Bf,xe(()=>s.value+1)),Nt(A_,f),Nt(jl,a);const h=be();return ar(()=>[h.value,f.value,e.name],([c,o,l],[u,d,g])=>{o&&(o.instances[l]=c,d&&d!==o&&c&&c===u&&(o.leaveGuards.size||(o.leaveGuards=d.leaveGuards),o.updateGuards.size||(o.updateGuards=d.updateGuards))),c&&o&&(!d||!Ia(o,d)||!u)&&(o.enterCallbacks[l]||[]).forEach(v=>v(c))},{flush:"post"}),()=>{const c=a.value,o=f.value,l=o&&o.components[e.name],u=e.name;if(!l)return Wf(r.default,{Component:l,route:c});const d=o.props[e.name],g=d?d===!0?c.params:typeof d=="function"?d(c):d:null,y=j(l,ut({},g,t,{onVnodeUnmounted:m=>{m.component.isUnmounted&&(o.instances[u]=null)},ref:h}));return Wf(r.default,{Component:y,route:c})||y}}});function Wf(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const xv=I_;function M_(e){const t=n_(e.routes,e),r=e.parseQuery||b_,n=e.stringifyQuery||Ff,a=e.history,i=ti(),s=ti(),f=ti(),h=Lp(Jr);let c=Jr;va&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const o=ol.bind(null,J=>""+J),l=ol.bind(null,__),u=ol.bind(null,Vo);function d(J,$){let P,k;return wv(J)?(P=t.getRecordMatcher(J),k=$):k=J,t.addRoute(k,P)}function g(J){const $=t.getRecordMatcher(J);$&&t.removeRoute($)}function v(){return t.getRoutes().map(J=>J.record)}function y(J){return!!t.getRecordMatcher(J)}function m(J,$){if($=ut({},$||h.value),typeof J=="string"){const X=sl(r,J,$.path),M=t.resolve({path:X.path},$),B=a.createHref(X.fullPath);return ut(X,M,{params:u(M.params),hash:Vo(X.hash),redirectedFrom:void 0,href:B})}let P;if("path"in J)P=ut({},J,{path:sl(r,J.path,$.path).path});else{const X=ut({},J.params);for(const M in X)X[M]==null&&delete X[M];P=ut({},J,{params:l(J.params)}),$.params=l($.params)}const k=t.resolve(P,$),ge=J.hash||"";k.params=o(u(k.params));const q=SE(n,ut({},J,{hash:m_(ge),path:k.path})),ye=a.createHref(q);return ut({fullPath:q,hash:ge,query:n===Ff?N_(J.query):J.query||{}},k,{redirectedFrom:void 0,href:ye})}function b(J){return typeof J=="string"?sl(r,J,h.value.path):ut({},J)}function E(J,$){if(c!==J)return Ma(8,{from:$,to:J})}function N(J){return O(J)}function R(J){return N(ut(b(J),{replace:!0}))}function C(J){const $=J.matched[J.matched.length-1];if($&&$.redirect){const{redirect:P}=$;let k=typeof P=="function"?P(J):P;return typeof k=="string"&&(k=k.includes("?")||k.includes("#")?k=b(k):{path:k},k.params={}),ut({query:J.query,hash:J.hash,params:"path"in k?{}:J.params},k)}}function O(J,$){const P=c=m(J),k=h.value,ge=J.state,q=J.force,ye=J.replace===!0,X=C(P);if(X)return O(ut(b(X),{state:ge,force:q,replace:ye}),$||P);const M=P;M.redirectedFrom=$;let B;return!q&&LE(n,k,P)&&(B=Ma(16,{to:M,from:k}),de(k,k,!0,!1)),(B?Promise.resolve(B):A(M,k)).catch(z=>yn(z)?yn(z,2)?z:ie(z):W(z,M,k)).then(z=>{if(z){if(yn(z,2))return O(ut(b(z.to),{state:ge,force:q,replace:ye}),$||M)}else z=G(M,k,!0,ye,ge);return L(M,k,z),z})}function T(J,$){const P=E(J,$);return P?Promise.reject(P):Promise.resolve()}function A(J,$){let P;const[k,ge,q]=P_(J,$);P=ll(k.reverse(),"beforeRouteLeave",J,$);for(const X of k)X.leaveGuards.forEach(M=>{P.push(Nn(M,J,$))});const ye=T.bind(null,J,$);return P.push(ye),sa(P).then(()=>{P=[];for(const X of i.list())P.push(Nn(X,J,$));return P.push(ye),sa(P)}).then(()=>{P=ll(ge,"beforeRouteUpdate",J,$);for(const X of ge)X.updateGuards.forEach(M=>{P.push(Nn(M,J,$))});return P.push(ye),sa(P)}).then(()=>{P=[];for(const X of J.matched)if(X.beforeEnter&&!$.matched.includes(X))if(wr(X.beforeEnter))for(const M of X.beforeEnter)P.push(Nn(M,J,$));else P.push(Nn(X.beforeEnter,J,$));return P.push(ye),sa(P)}).then(()=>(J.matched.forEach(X=>X.enterCallbacks={}),P=ll(q,"beforeRouteEnter",J,$),P.push(ye),sa(P))).then(()=>{P=[];for(const X of s.list())P.push(Nn(X,J,$));return P.push(ye),sa(P)}).catch(X=>yn(X,8)?X:Promise.reject(X))}function L(J,$,P){for(const k of f.list())k(J,$,P)}function G(J,$,P,k,ge){const q=E(J,$);if(q)return q;const ye=$===Jr,X=va?history.state:{};P&&(k||ye?a.replace(J.fullPath,ut({scroll:ye&&X&&X.scroll},ge)):a.push(J.fullPath,ge)),h.value=J,de(J,$,P,ye),ie()}let H;function Y(){H||(H=a.listen((J,$,P)=>{if(!Se.listening)return;const k=m(J),ge=C(k);if(ge){O(ut(ge,{replace:!0}),k).catch(yi);return}c=k;const q=h.value;va&&VE(Sf(q.fullPath,P.delta),ls()),A(k,q).catch(ye=>yn(ye,12)?ye:yn(ye,2)?(O(ye.to,k).then(X=>{yn(X,20)&&!P.delta&&P.type===Ii.pop&&a.go(-1,!1)}).catch(yi),Promise.reject()):(P.delta&&a.go(-P.delta,!1),W(ye,k,q))).then(ye=>{ye=ye||G(k,q,!1),ye&&(P.delta?a.go(-P.delta,!1):P.type===Ii.pop&&yn(ye,20)&&a.go(-1,!1)),L(k,q,ye)}).catch(yi)}))}let K=ti(),ce=ti(),V;function W(J,$,P){ie(J);const k=ce.list();return k.length?k.forEach(ge=>ge(J,$,P)):console.error(J),Promise.reject(J)}function Q(){return V&&h.value!==Jr?Promise.resolve():new Promise((J,$)=>{K.add([J,$])})}function ie(J){return V||(V=!J,Y(),K.list().forEach(([$,P])=>J?P(J):$()),K.reset()),J}function de(J,$,P,k){const{scrollBehavior:ge}=e;if(!va||!ge)return Promise.resolve();const q=!P&&GE(Sf(J.fullPath,0))||(k||!P)&&history.state&&history.state.scroll||null;return ht().then(()=>ge(J,$,q)).then(ye=>ye&&BE(ye)).catch(ye=>W(ye,J,$))}const me=J=>a.go(J);let Oe;const we=new Set,Se={currentRoute:h,listening:!0,addRoute:d,removeRoute:g,hasRoute:y,getRoutes:v,resolve:m,options:e,push:N,replace:R,go:me,back:()=>me(-1),forward:()=>me(1),beforeEach:i.add,beforeResolve:s.add,afterEach:f.add,onError:ce.add,isReady:Q,install(J){const $=this;J.component("RouterLink",R_),J.component("RouterView",xv),J.config.globalProperties.$router=$,Object.defineProperty(J.config.globalProperties,"$route",{enumerable:!0,get:()=>Or(h)}),va&&!Oe&&h.value===Jr&&(Oe=!0,N(a.location).catch(ge=>{}));const P={};for(const ge in Jr)P[ge]=xe(()=>h.value[ge]);J.provide(cs,$),J.provide(Xc,kt(P)),J.provide(jl,h);const k=J.unmount;we.add(J),J.unmount=function(){we.delete(J),we.size<1&&(c=Jr,H&&H(),H=null,h.value=Jr,Oe=!1,V=!1),k()}}};return Se}function sa(e){return e.reduce((t,r)=>t.then(()=>r()),Promise.resolve())}function P_(e,t){const r=[],n=[],a=[],i=Math.max(t.matched.length,e.matched.length);for(let s=0;s<i;s++){const f=t.matched[s];f&&(e.matched.find(c=>Ia(c,f))?n.push(f):r.push(f));const h=e.matched[s];h&&(t.matched.find(c=>Ia(c,h))||a.push(h))}return[r,n,a]}function jc(){return mt(cs)}function Qc(){return mt(Xc)}const S_=({headerLinkSelector:e,headerAnchorSelector:t,delay:r,offset:n=5})=>{const a=jc(),i=qc(),f=Tv(()=>{var y,m,b,E;const h=Math.max(window.scrollY,document.documentElement.scrollTop,document.body.scrollTop);if(Math.abs(h-0)<n){zf(a,{hash:"",force:!0});return}const o=window.innerHeight+h,l=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),u=Math.abs(l-o)<n,d=Array.from(document.querySelectorAll(e)),v=Array.from(document.querySelectorAll(t)).filter(N=>d.some(R=>R.hash===N.hash));for(let N=0;N<v.length;N++){const R=v[N],C=v[N+1],O=h>=((m=(y=R.parentElement)==null?void 0:y.offsetTop)!=null?m:0)-n,T=!C||h<((E=(b=C.parentElement)==null?void 0:b.offsetTop)!=null?E:0)-n;if(!(O&&T))continue;const L=decodeURIComponent(a.currentRoute.value.hash),G=decodeURIComponent(R.hash);if(L===G)return;if(u){for(let H=N+1;H<v.length;H++)if(L===decodeURIComponent(v[H].hash))return}zf(a,{hash:G,force:!0});return}},r);Ut(()=>{f(),window.addEventListener("scroll",f)}),xi(()=>{window.removeEventListener("scroll",f)}),ar(()=>i.value.path,f)},zf=async(e,...t)=>{const{scrollBehavior:r}=e.options;e.options.scrollBehavior=void 0,await e.replace(...t).finally(()=>e.options.scrollBehavior=r)},L_="a.sidebar-item",$_=".header-anchor",D_=300,x_=5;var k_=wE({setup(){S_({headerLinkSelector:L_,headerAnchorSelector:$_,delay:D_,offset:x_})}}),kv=be(nn),Uv=Ir({key:"",path:"",title:"",lang:"",frontmatter:{},excerpt:"",headers:[]}),Ql=be(Uv),Fv=()=>Ql;Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updatePageData=e=>{kv.value[e.key]=()=>Promise.resolve(e),e.key===Ql.value.key&&(Ql.value=e)});var U_=be(on);Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updateSiteData=e=>{U_.value=e});kt({resolvePageData:async e=>{const t=kv.value[e],r=await(t==null?void 0:t());return r!=null?r:Uv},resolvePageFrontmatter:e=>e.frontmatter,resolvePageHead:(e,t,r)=>{const n=Ke(t.description)?t.description:r.description,a=[...Ve(t.head)?t.head:[],...r.head,["title",{},e],["meta",{name:"description",content:n}]];return Mn(a)},resolvePageHeadTitle:(e,t)=>`${e.title?`${e.title} | `:""}${t.title}`,resolvePageLang:e=>e.lang||"en",resolveRouteLocale:(e,t)=>sn(e,t),resolveSiteLocaleData:(e,t)=>({...e,...e.locales[t]})});He({name:"ClientOnly",setup(e,t){const r=be(!1);return Ut(()=>{r.value=!0}),()=>{var n,a;return r.value?(a=(n=t.slots).default)==null?void 0:a.call(n):null}}});He({name:"Content",props:{pageKey:{type:String,required:!1,default:""}},setup(e){const t=Fv(),r=xe(()=>ln[e.pageKey||t.value.key]);return()=>r.value?j(r.value):j("div","404 Not Found")}});He({name:"Vuepress",setup(){const e=Fv(),t=xe(()=>{let r;if(e.value.path){const n=e.value.frontmatter.layout;Ke(n)?r=n:r="Layout"}else r="404";return cn[r]||pt(r,!1)});return()=>j(t.value)}});var F_=e=>e;const Kf=()=>window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,B_=()=>window.scrollTo({top:0,behavior:"smooth"});const V_=He({name:"BackToTop",setup(){const e=be(0),t=xe(()=>e.value>300),r=Tv(()=>{e.value=Kf()},100);Ut(()=>{e.value=Kf(),window.addEventListener("scroll",()=>r())});const n=j("div",{class:"back-to-top",onClick:B_});return()=>j(Kc,{name:"back-to-top"},()=>t.value?n:null)}});var G_=F_({rootComponents:[V_]}),Bv=be(nn),Vv=Ir({key:"",path:"",title:"",lang:"",frontmatter:{},excerpt:"",headers:[]}),Zl=be(Vv),Gv=()=>Zl;Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updatePageData=e=>{Bv.value[e.key]=()=>Promise.resolve(e),e.key===Zl.value.key&&(Zl.value=e)});var H_=Symbol(""),W_=()=>{const e=mt(H_);if(!e)throw new Error("useRouteLocale() is called without provider.");return e},z_=be(on);Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updateSiteData=e=>{z_.value=e});kt({resolvePageData:async e=>{const t=Bv.value[e],r=await(t==null?void 0:t());return r!=null?r:Vv},resolvePageFrontmatter:e=>e.frontmatter,resolvePageHead:(e,t,r)=>{const n=Ke(t.description)?t.description:r.description,a=[...Ve(t.head)?t.head:[],...r.head,["title",{},e],["meta",{name:"description",content:n}]];return Mn(a)},resolvePageHeadTitle:(e,t)=>`${e.title?`${e.title} | `:""}${t.title}`,resolvePageLang:e=>e.lang||"en",resolveRouteLocale:(e,t)=>sn(e,t),resolveSiteLocaleData:(e,t)=>({...e,...e.locales[t]})});He({name:"ClientOnly",setup(e,t){const r=be(!1);return Ut(()=>{r.value=!0}),()=>{var n,a;return r.value?(a=(n=t.slots).default)==null?void 0:a.call(n):null}}});He({name:"Content",props:{pageKey:{type:String,required:!1,default:""}},setup(e){const t=Gv(),r=xe(()=>ln[e.pageKey||t.value.key]);return()=>r.value?j(r.value):j("div","404 Not Found")}});He({name:"Vuepress",setup(){const e=Gv(),t=xe(()=>{let r;if(e.value.path){const n=e.value.frontmatter.layout;Ke(n)?r=n:r="Layout"}else r="404";return cn[r]||pt(r,!1)});return()=>j(t.value)}});var K_=e=>e;const q_=j("svg",{class:"external-link-icon",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15"},[j("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),j("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})]),Y_=He({name:"ExternalLinkIcon",props:{locales:{type:Object,required:!1,default:()=>({})}},setup(e){const t=W_(),r=xe(()=>{var n;return(n=e.locales[t.value])!=null?n:{openInNewWindow:"open in new window"}});return()=>j("span",[q_,j("span",{class:"external-link-icon-sr-only"},r.value.openInNewWindow)])}}),X_={"/":{openInNewWindow:"open in new window"}};var j_=K_({enhance({app:e}){e.component("ExternalLinkIcon",j(Y_,{locales:X_}))}}),Hv=be(nn),Wv=Ir({key:"",path:"",title:"",lang:"",frontmatter:{},excerpt:"",headers:[]}),Jl=be(Wv),zv=()=>Jl;Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updatePageData=e=>{Hv.value[e.key]=()=>Promise.resolve(e),e.key===Jl.value.key&&(Jl.value=e)});var Q_=be(on);Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updateSiteData=e=>{Q_.value=e});kt({resolvePageData:async e=>{const t=Hv.value[e],r=await(t==null?void 0:t());return r!=null?r:Wv},resolvePageFrontmatter:e=>e.frontmatter,resolvePageHead:(e,t,r)=>{const n=Ke(t.description)?t.description:r.description,a=[...Ve(t.head)?t.head:[],...r.head,["title",{},e],["meta",{name:"description",content:n}]];return Mn(a)},resolvePageHeadTitle:(e,t)=>`${e.title?`${e.title} | `:""}${t.title}`,resolvePageLang:e=>e.lang||"en",resolveRouteLocale:(e,t)=>sn(e,t),resolveSiteLocaleData:(e,t)=>({...e,...e.locales[t]})});He({name:"ClientOnly",setup(e,t){const r=be(!1);return Ut(()=>{r.value=!0}),()=>{var n,a;return r.value?(a=(n=t.slots).default)==null?void 0:a.call(n):null}}});He({name:"Content",props:{pageKey:{type:String,required:!1,default:""}},setup(e){const t=zv(),r=xe(()=>ln[e.pageKey||t.value.key]);return()=>r.value?j(r.value):j("div","404 Not Found")}});He({name:"Vuepress",setup(){const e=zv(),t=xe(()=>{let r;if(e.value.path){const n=e.value.frontmatter.layout;Ke(n)?r=n:r="Layout"}else r="404";return cn[r]||pt(r,!1)});return()=>j(t.value)}});var Z_=e=>e;/*! medium-zoom 1.0.6 | MIT License | https://github.com/francoischalifour/medium-zoom */var Vn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},po=function(t){return t.tagName==="IMG"},J_=function(t){return NodeList.prototype.isPrototypeOf(t)},Oo=function(t){return t&&t.nodeType===1},qf=function(t){var r=t.currentSrc||t.src;return r.substr(-4).toLowerCase()===".svg"},Yf=function(t){try{return Array.isArray(t)?t.filter(po):J_(t)?[].slice.call(t).filter(po):Oo(t)?[t].filter(po):typeof t=="string"?[].slice.call(document.querySelectorAll(t)).filter(po):[]}catch{throw new TypeError(`The provided selector is invalid.
Expects a CSS selector, a Node element, a NodeList or an array.
See: https://github.com/francoischalifour/medium-zoom`)}},eb=function(t){var r=document.createElement("div");return r.classList.add("medium-zoom-overlay"),r.style.background=t,r},tb=function(t){var r=t.getBoundingClientRect(),n=r.top,a=r.left,i=r.width,s=r.height,f=t.cloneNode(),h=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,c=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;return f.removeAttribute("id"),f.style.position="absolute",f.style.top=n+h+"px",f.style.left=a+c+"px",f.style.width=i+"px",f.style.height=s+"px",f.style.transform="",f},la=function(t,r){var n=Vn({bubbles:!1,cancelable:!1,detail:void 0},r);if(typeof window.CustomEvent=="function")return new CustomEvent(t,n);var a=document.createEvent("CustomEvent");return a.initCustomEvent(t,n.bubbles,n.cancelable,n.detail),a},rb=function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=window.Promise||function(H){function Y(){}H(Y,Y)},a=function(H){var Y=H.target;if(Y===A){g();return}E.indexOf(Y)!==-1&&v({target:Y})},i=function(){if(!(R||!T.original)){var H=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;Math.abs(C-H)>O.scrollOffset&&setTimeout(g,150)}},s=function(H){var Y=H.key||H.keyCode;(Y==="Escape"||Y==="Esc"||Y===27)&&g()},f=function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Y=H;if(H.background&&(A.style.background=H.background),H.container&&H.container instanceof Object&&(Y.container=Vn({},O.container,H.container)),H.template){var K=Oo(H.template)?H.template:document.querySelector(H.template);Y.template=K}return O=Vn({},O,Y),E.forEach(function(ce){ce.dispatchEvent(la("medium-zoom:update",{detail:{zoom:L}}))}),L},h=function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e(Vn({},O,H))},c=function(){for(var H=arguments.length,Y=Array(H),K=0;K<H;K++)Y[K]=arguments[K];var ce=Y.reduce(function(V,W){return[].concat(V,Yf(W))},[]);return ce.filter(function(V){return E.indexOf(V)===-1}).forEach(function(V){E.push(V),V.classList.add("medium-zoom-image")}),N.forEach(function(V){var W=V.type,Q=V.listener,ie=V.options;ce.forEach(function(de){de.addEventListener(W,Q,ie)})}),L},o=function(){for(var H=arguments.length,Y=Array(H),K=0;K<H;K++)Y[K]=arguments[K];T.zoomed&&g();var ce=Y.length>0?Y.reduce(function(V,W){return[].concat(V,Yf(W))},[]):E;return ce.forEach(function(V){V.classList.remove("medium-zoom-image"),V.dispatchEvent(la("medium-zoom:detach",{detail:{zoom:L}}))}),E=E.filter(function(V){return ce.indexOf(V)===-1}),L},l=function(H,Y){var K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return E.forEach(function(ce){ce.addEventListener("medium-zoom:"+H,Y,K)}),N.push({type:"medium-zoom:"+H,listener:Y,options:K}),L},u=function(H,Y){var K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return E.forEach(function(ce){ce.removeEventListener("medium-zoom:"+H,Y,K)}),N=N.filter(function(ce){return!(ce.type==="medium-zoom:"+H&&ce.listener.toString()===Y.toString())}),L},d=function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Y=H.target,K=function(){var V={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,left:0,top:0,right:0,bottom:0},W=void 0,Q=void 0;if(O.container)if(O.container instanceof Object)V=Vn({},V,O.container),W=V.width-V.left-V.right-O.margin*2,Q=V.height-V.top-V.bottom-O.margin*2;else{var ie=Oo(O.container)?O.container:document.querySelector(O.container),de=ie.getBoundingClientRect(),me=de.width,Oe=de.height,we=de.left,Se=de.top;V=Vn({},V,{width:me,height:Oe,left:we,top:Se})}W=W||V.width-O.margin*2,Q=Q||V.height-O.margin*2;var J=T.zoomedHd||T.original,$=qf(J)?W:J.naturalWidth||W,P=qf(J)?Q:J.naturalHeight||Q,k=J.getBoundingClientRect(),ge=k.top,q=k.left,ye=k.width,X=k.height,M=Math.min($,W)/ye,B=Math.min(P,Q)/X,z=Math.min(M,B),re=(-q+(W-ye)/2+O.margin+V.left)/z,ne=(-ge+(Q-X)/2+O.margin+V.top)/z,p="scale("+z+") translate3d("+re+"px, "+ne+"px, 0)";T.zoomed.style.transform=p,T.zoomedHd&&(T.zoomedHd.style.transform=p)};return new n(function(ce){if(Y&&E.indexOf(Y)===-1){ce(L);return}var V=function me(){R=!1,T.zoomed.removeEventListener("transitionend",me),T.original.dispatchEvent(la("medium-zoom:opened",{detail:{zoom:L}})),ce(L)};if(T.zoomed){ce(L);return}if(Y)T.original=Y;else if(E.length>0){var W=E;T.original=W[0]}else{ce(L);return}if(T.original.dispatchEvent(la("medium-zoom:open",{detail:{zoom:L}})),C=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,R=!0,T.zoomed=tb(T.original),document.body.appendChild(A),O.template){var Q=Oo(O.template)?O.template:document.querySelector(O.template);T.template=document.createElement("div"),T.template.appendChild(Q.content.cloneNode(!0)),document.body.appendChild(T.template)}if(document.body.appendChild(T.zoomed),window.requestAnimationFrame(function(){document.body.classList.add("medium-zoom--opened")}),T.original.classList.add("medium-zoom-image--hidden"),T.zoomed.classList.add("medium-zoom-image--opened"),T.zoomed.addEventListener("click",g),T.zoomed.addEventListener("transitionend",V),T.original.getAttribute("data-zoom-src")){T.zoomedHd=T.zoomed.cloneNode(),T.zoomedHd.removeAttribute("srcset"),T.zoomedHd.removeAttribute("sizes"),T.zoomedHd.src=T.zoomed.getAttribute("data-zoom-src"),T.zoomedHd.onerror=function(){clearInterval(ie),console.warn("Unable to reach the zoom image target "+T.zoomedHd.src),T.zoomedHd=null,K()};var ie=setInterval(function(){T.zoomedHd.complete&&(clearInterval(ie),T.zoomedHd.classList.add("medium-zoom-image--opened"),T.zoomedHd.addEventListener("click",g),document.body.appendChild(T.zoomedHd),K())},10)}else if(T.original.hasAttribute("srcset")){T.zoomedHd=T.zoomed.cloneNode(),T.zoomedHd.removeAttribute("sizes"),T.zoomedHd.removeAttribute("loading");var de=T.zoomedHd.addEventListener("load",function(){T.zoomedHd.removeEventListener("load",de),T.zoomedHd.classList.add("medium-zoom-image--opened"),T.zoomedHd.addEventListener("click",g),document.body.appendChild(T.zoomedHd),K()})}else K()})},g=function(){return new n(function(H){if(R||!T.original){H(L);return}var Y=function K(){T.original.classList.remove("medium-zoom-image--hidden"),document.body.removeChild(T.zoomed),T.zoomedHd&&document.body.removeChild(T.zoomedHd),document.body.removeChild(A),T.zoomed.classList.remove("medium-zoom-image--opened"),T.template&&document.body.removeChild(T.template),R=!1,T.zoomed.removeEventListener("transitionend",K),T.original.dispatchEvent(la("medium-zoom:closed",{detail:{zoom:L}})),T.original=null,T.zoomed=null,T.zoomedHd=null,T.template=null,H(L)};R=!0,document.body.classList.remove("medium-zoom--opened"),T.zoomed.style.transform="",T.zoomedHd&&(T.zoomedHd.style.transform=""),T.template&&(T.template.style.transition="opacity 150ms",T.template.style.opacity=0),T.original.dispatchEvent(la("medium-zoom:close",{detail:{zoom:L}})),T.zoomed.addEventListener("transitionend",Y)})},v=function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Y=H.target;return T.original?g():d({target:Y})},y=function(){return O},m=function(){return E},b=function(){return T.original},E=[],N=[],R=!1,C=0,O=r,T={original:null,zoomed:null,zoomedHd:null,template:null};Object.prototype.toString.call(t)==="[object Object]"?O=t:(t||typeof t=="string")&&c(t),O=Vn({margin:0,background:"#fff",scrollOffset:40,container:null,template:null},O);var A=eb(O.background);document.addEventListener("click",a),document.addEventListener("keyup",s),document.addEventListener("scroll",i),window.addEventListener("resize",g);var L={open:d,close:g,toggle:v,update:f,clone:h,attach:c,detach:o,on:l,off:u,getOptions:y,getImages:m,getZoomedImage:b};return L};function nb(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",r==="top"&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}var ab=".medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}";nb(ab);var ib=rb;const ob=Symbol("mediumZoom");const sb=".theme-default-content > img, .theme-default-content :not(a) > img",lb={},cb=300;var ub=Z_({enhance({app:e,router:t}){const r=ib(lb);r.refresh=(n=sb)=>{r.detach(),r.attach(n)},e.provide(ob,r),t.afterEach(()=>{setTimeout(()=>r.refresh(),cb)})}}),Kv=be(nn),qv=Ir({key:"",path:"",title:"",lang:"",frontmatter:{},excerpt:"",headers:[]}),ec=be(qv),Yv=()=>ec;Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updatePageData=e=>{Kv.value[e.key]=()=>Promise.resolve(e),e.key===ec.value.key&&(ec.value=e)});var fb=be(on);Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updateSiteData=e=>{fb.value=e});kt({resolvePageData:async e=>{const t=Kv.value[e],r=await(t==null?void 0:t());return r!=null?r:qv},resolvePageFrontmatter:e=>e.frontmatter,resolvePageHead:(e,t,r)=>{const n=Ke(t.description)?t.description:r.description,a=[...Ve(t.head)?t.head:[],...r.head,["title",{},e],["meta",{name:"description",content:n}]];return Mn(a)},resolvePageHeadTitle:(e,t)=>`${e.title?`${e.title} | `:""}${t.title}`,resolvePageLang:e=>e.lang||"en",resolveRouteLocale:(e,t)=>sn(e,t),resolveSiteLocaleData:(e,t)=>({...e,...e.locales[t]})});He({name:"ClientOnly",setup(e,t){const r=be(!1);return Ut(()=>{r.value=!0}),()=>{var n,a;return r.value?(a=(n=t.slots).default)==null?void 0:a.call(n):null}}});He({name:"Content",props:{pageKey:{type:String,required:!1,default:""}},setup(e){const t=Yv(),r=xe(()=>ln[e.pageKey||t.value.key]);return()=>r.value?j(r.value):j("div","404 Not Found")}});He({name:"Vuepress",setup(){const e=Yv(),t=xe(()=>{let r;if(e.value.path){const n=e.value.frontmatter.layout;Ke(n)?r=n:r="Layout"}else r="404";return cn[r]||pt(r,!1)});return()=>j(t.value)}});var db=e=>e;/**
 * NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT
 */const tt={settings:{minimum:.08,easing:"ease",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,barSelector:'[role="bar"]',parent:"body",template:'<div class="bar" role="bar"></div>'},status:null,set:e=>{const t=tt.isStarted();e=cl(e,tt.settings.minimum,1),tt.status=e===1?null:e;const r=tt.render(!t),n=r.querySelector(tt.settings.barSelector),a=tt.settings.speed,i=tt.settings.easing;return r.offsetWidth,hb(s=>{vo(n,{transform:"translate3d("+Xf(e)+"%,0,0)",transition:"all "+a+"ms "+i}),e===1?(vo(r,{transition:"none",opacity:"1"}),r.offsetWidth,setTimeout(function(){vo(r,{transition:"all "+a+"ms linear",opacity:"0"}),setTimeout(function(){tt.remove(),s()},a)},a)):setTimeout(()=>s(),a)}),tt},isStarted:()=>typeof tt.status=="number",start:()=>{tt.status||tt.set(0);const e=()=>{setTimeout(()=>{!tt.status||(tt.trickle(),e())},tt.settings.trickleSpeed)};return tt.settings.trickle&&e(),tt},done:e=>!e&&!tt.status?tt:tt.inc(.3+.5*Math.random()).set(1),inc:e=>{let t=tt.status;return t?(typeof e!="number"&&(e=(1-t)*cl(Math.random()*t,.1,.95)),t=cl(t+e,0,.994),tt.set(t)):tt.start()},trickle:()=>tt.inc(Math.random()*tt.settings.trickleRate),render:e=>{if(tt.isRendered())return document.getElementById("nprogress");jf(document.documentElement,"nprogress-busy");const t=document.createElement("div");t.id="nprogress",t.innerHTML=tt.settings.template;const r=t.querySelector(tt.settings.barSelector),n=e?"-100":Xf(tt.status||0),a=document.querySelector(tt.settings.parent);return vo(r,{transition:"all 0 linear",transform:"translate3d("+n+"%,0,0)"}),a!==document.body&&jf(a,"nprogress-custom-parent"),a==null||a.appendChild(t),t},remove:()=>{Qf(document.documentElement,"nprogress-busy"),Qf(document.querySelector(tt.settings.parent),"nprogress-custom-parent");const e=document.getElementById("nprogress");e&&pb(e)},isRendered:()=>!!document.getElementById("nprogress")},cl=(e,t,r)=>e<t?t:e>r?r:e,Xf=e=>(-1+e)*100,hb=function(){const e=[];function t(){const r=e.shift();r&&r(t)}return function(r){e.push(r),e.length===1&&t()}}(),vo=function(){const e=["Webkit","O","Moz","ms"],t={};function r(s){return s.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(f,h){return h.toUpperCase()})}function n(s){const f=document.body.style;if(s in f)return s;let h=e.length;const c=s.charAt(0).toUpperCase()+s.slice(1);let o;for(;h--;)if(o=e[h]+c,o in f)return o;return s}function a(s){return s=r(s),t[s]||(t[s]=n(s))}function i(s,f,h){f=a(f),s.style[f]=h}return function(s,f){for(const h in f){const c=f[h];c!==void 0&&Object.prototype.hasOwnProperty.call(f,h)&&i(s,h,c)}}}(),Xv=(e,t)=>(typeof e=="string"?e:Zc(e)).indexOf(" "+t+" ")>=0,jf=(e,t)=>{const r=Zc(e),n=r+t;Xv(r,t)||(e.className=n.substring(1))},Qf=(e,t)=>{const r=Zc(e);if(!Xv(e,t))return;const n=r.replace(" "+t+" "," ");e.className=n.substring(1,n.length-1)},Zc=e=>(" "+(e.className||"")+" ").replace(/\s+/gi," "),pb=e=>{e&&e.parentNode&&e.parentNode.removeChild(e)};const vb=()=>{Ut(()=>{const e=jc(),t=new Set;t.add(e.currentRoute.value.path),e.beforeEach(r=>{t.has(r.path)||tt.start()}),e.afterEach(r=>{t.add(r.path),tt.done()})})};var gb=db({setup(){vb()}}),jv=be(nn),Qv=Ir({key:"",path:"",title:"",lang:"",frontmatter:{},excerpt:"",headers:[]}),tc=be(Qv),Zv=()=>tc;Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updatePageData=e=>{jv.value[e.key]=()=>Promise.resolve(e),e.key===tc.value.key&&(tc.value=e)});var mb=Symbol(""),yb=be(on);Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updateSiteData=e=>{yb.value=e});kt({resolvePageData:async e=>{const t=jv.value[e],r=await(t==null?void 0:t());return r!=null?r:Qv},resolvePageFrontmatter:e=>e.frontmatter,resolvePageHead:(e,t,r)=>{const n=Ke(t.description)?t.description:r.description,a=[...Ve(t.head)?t.head:[],...r.head,["title",{},e],["meta",{name:"description",content:n}]];return Mn(a)},resolvePageHeadTitle:(e,t)=>`${e.title?`${e.title} | `:""}${t.title}`,resolvePageLang:e=>e.lang||"en",resolveRouteLocale:(e,t)=>sn(e,t),resolveSiteLocaleData:(e,t)=>({...e,...e.locales[t]})});He({name:"ClientOnly",setup(e,t){const r=be(!1);return Ut(()=>{r.value=!0}),()=>{var n,a;return r.value?(a=(n=t.slots).default)==null?void 0:a.call(n):null}}});He({name:"Content",props:{pageKey:{type:String,required:!1,default:""}},setup(e){const t=Zv(),r=xe(()=>ln[e.pageKey||t.value.key]);return()=>r.value?j(r.value):j("div","404 Not Found")}});He({name:"Vuepress",setup(){const e=Zv(),t=xe(()=>{let r;if(e.value.path){const n=e.value.frontmatter.layout;Ke(n)?r=n:r="Layout"}else r="404";return cn[r]||pt(r,!1)});return()=>j(t.value)}});var Eb=e=>e;const _b=JSON.parse(`{"sidebar":[{"text":"\u9996\u9875","link":"/README.md"},{"text":"\u516C\u5F0F\u652F\u6301","link":"/formula/modules.md"},{"text":"\u57FA\u7840\u7EC4\u4EF6","children":[{"text":"\u56FE\u6807","link":"/basic/grid-icon.md"},{"text":"Loading","link":"/basic/grid-loading.md"},{"text":"\u6309\u94AE","link":"/basic/grid-button.md"},{"text":"\u5355\u9009","link":"/basic/grid-radio.md"},{"text":"\u590D\u9009","link":"/basic/grid-checkbox.md"},{"text":"\u591A\u884C\u6587\u672C","link":"/basic/grid-textarea.md"},{"text":"\u8868\u683C","link":"/basic/grid.md"},{"text":"\u5355\u5143\u683C\u6C34\u5E73\u5782\u76F4\u4F4D\u7F6E","link":"/basic/grid-column-align.md"},{"text":"\u5217\u5BBD\u62D6\u52A8\u884C\u9AD8\u62D6\u52A8","link":"/basic/grid-resize-column-row.md"},{"text":"\u8868\u5934\u5206\u7EC4","link":"/basic/grid-column-header-group.md"},{"text":"\u5217\u540D\u52A9\u8BB0","link":"/basic/grid-column-helper.md"}]}],"locales":{"/":{"selectLanguageName":"English"}},"colorMode":"auto","colorModeSwitch":true,"navbar":[],"logo":null,"repo":null,"selectLanguageText":"Languages","selectLanguageAriaLabel":"Select language","sidebarDepth":2,"editLink":true,"editLinkText":"Edit this page","lastUpdated":true,"lastUpdatedText":"Last Updated","contributors":true,"contributorsText":"Contributors","notFound":["There's nothing here.","How did we get here?","That's a Four-Oh-Four.","Looks like we've got some broken links."],"backToHome":"Take me home","openInNewWindow":"open in new window","toggleColorMode":"toggle color mode","toggleSidebar":"toggle sidebar"}`),Jv=be(_b),bb=()=>Jv;Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updateThemeData=e=>{Jv.value=e});const eg=Symbol(""),Nb=()=>{const e=mt(eg);if(!e)throw new Error("useThemeLocaleData() is called without provider.");return e},Ab=(e,t)=>{var r;return{...e,...(r=e.locales)==null?void 0:r[t]}};var Cb=Eb({enhance({app:e}){const t=bb(),r=e._context.provides[mb],n=xe(()=>Ab(t.value,r.value));e.provide(eg,n),Object.defineProperties(e.config.globalProperties,{$theme:{get(){return t.value}},$themeLocale:{get(){return n.value}}})}}),tg=be(nn),rg=Ir({key:"",path:"",title:"",lang:"",frontmatter:{},excerpt:"",headers:[]}),rc=be(rg),us=()=>rc;Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updatePageData=e=>{tg.value[e.key]=()=>Promise.resolve(e),e.key===rc.value.key&&(rc.value=e)});var Tb=Symbol(""),Rb=()=>{const e=mt(Tb);if(!e)throw new Error("usePageFrontmatter() is called without provider.");return e},Ob=Symbol(""),Y5=()=>{const e=mt(Ob);if(!e)throw new Error("useRouteLocale() is called without provider.");return e},ng=be(on),wb=()=>ng;Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updateSiteData=e=>{ng.value=e});var Ib=Symbol(""),X5=()=>{const e=mt(Ib);if(!e)throw new Error("useSiteLocaleData() is called without provider.");return e};kt({resolvePageData:async e=>{const t=tg.value[e],r=await(t==null?void 0:t());return r!=null?r:rg},resolvePageFrontmatter:e=>e.frontmatter,resolvePageHead:(e,t,r)=>{const n=Ke(t.description)?t.description:r.description,a=[...Ve(t.head)?t.head:[],...r.head,["title",{},e],["meta",{name:"description",content:n}]];return Mn(a)},resolvePageHeadTitle:(e,t)=>`${e.title?`${e.title} | `:""}${t.title}`,resolvePageLang:e=>e.lang||"en",resolveRouteLocale:(e,t)=>sn(e,t),resolveSiteLocaleData:(e,t)=>({...e,...e.locales[t]})});var j5=He({name:"ClientOnly",setup(e,t){const r=be(!1);return Ut(()=>{r.value=!0}),()=>{var n,a;return r.value?(a=(n=t.slots).default)==null?void 0:a.call(n):null}}});He({name:"Content",props:{pageKey:{type:String,required:!1,default:""}},setup(e){const t=us(),r=xe(()=>ln[e.pageKey||t.value.key]);return()=>r.value?j(r.value):j("div","404 Not Found")}});He({name:"Vuepress",setup(){const e=us(),t=xe(()=>{let r;if(e.value.path){const n=e.value.frontmatter.layout;Ke(n)?r=n:r="Layout"}else r="404";return cn[r]||pt(r,!1)});return()=>j(t.value)}});var Q5=e=>vv(e)?e:`${wb().value.base}${mv(e)}`,Mb=e=>e,ag=(e,t)=>{const r=e.__vccOpts||e;for(const[n,a]of t)r[n]=a;return r};const Pb=He({__name:"Badge",props:{type:{type:String,required:!1,default:"tip"},text:{type:String,required:!1,default:""},vertical:{type:String,required:!1,default:void 0}},setup(e){return(t,r)=>(is(),sv("span",{class:Si(["badge",e.type]),style:Qo({verticalAlign:e.vertical})},[jp(t.$slots,"default",{},()=>[Hc(B0(e.text),1)])],6))}});var Sb=ag(Pb,[["__file","Badge.vue"]]);const Lb=He({name:"CodeGroup",setup(e,{slots:t}){const r=be(-1),n=be([]),a=(f=r.value)=>{f<n.value.length-1?r.value=f+1:r.value=0,n.value[r.value].focus()},i=(f=r.value)=>{f>0?r.value=f-1:r.value=n.value.length-1,n.value[r.value].focus()},s=(f,h)=>{f.key===" "||f.key==="Enter"?(f.preventDefault(),r.value=h):f.key==="ArrowRight"?(f.preventDefault(),a(h)):f.key==="ArrowLeft"&&(f.preventDefault(),i(h))};return()=>{var h;const f=(((h=t.default)==null?void 0:h.call(t))||[]).filter(c=>c.type.name==="CodeGroupItem").map(c=>(c.props===null&&(c.props={}),c));return f.length===0?null:(r.value<0||r.value>f.length-1?(r.value=f.findIndex(c=>c.props.active===""||c.props.active===!0),r.value===-1&&(r.value=0)):f.forEach((c,o)=>{c.props.active=o===r.value}),j("div",{class:"code-group"},[j("div",{class:"code-group__nav"},j("ul",{class:"code-group__ul"},f.map((c,o)=>{const l=o===r.value;return j("li",{class:"code-group__li"},j("button",{ref:u=>{u&&(n.value[o]=u)},class:{"code-group__nav-tab":!0,"code-group__nav-tab-active":l},ariaPressed:l,ariaExpanded:l,onClick:()=>r.value=o,onKeydown:u=>s(u,o)},c.props.title))}))),f]))}}}),$b=["aria-selected"],Db=He({name:"CodeGroupItem"}),xb=He({...Db,props:{title:{type:String,required:!0},active:{type:Boolean,required:!1,default:!1}},setup(e){return(t,r)=>(is(),sv("div",{class:Si(["code-group-item",{"code-group-item__active":e.active}]),"aria-selected":e.active},[jp(t.$slots,"default")],10,$b))}});var kb=ag(xb,[["__file","CodeGroupItem.vue"]]),Zf;const Ui=typeof window!="undefined",Ub=e=>typeof e=="string",ul=()=>{};Ui&&((Zf=window==null?void 0:window.navigator)==null?void 0:Zf.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function Fb(e,t){function r(...n){e(()=>t.apply(this,n),{fn:t,thisArg:this,args:n})}return r}const ig=e=>e();function Bb(e=ig){const t=be(!0);function r(){t.value=!1}function n(){t.value=!0}return{isActive:t,pause:r,resume:n,eventFilter:(...i)=>{t.value&&e(...i)}}}function og(e){return j0()?(Q0(e),!0):!1}function Vb(e,t=!0){zc()?Yp(e):t?e():ht(e)}function Z5(e=!1,t={}){const{truthyValue:r=!0,falsyValue:n=!1}=t,a=Vt(e),i=be(e);function s(f){return arguments.length?(i.value=f,i.value):(i.value=i.value===Or(r)?Or(n):Or(r),i.value)}return a?s:[i,s]}var Jf=Object.getOwnPropertySymbols,Gb=Object.prototype.hasOwnProperty,Hb=Object.prototype.propertyIsEnumerable,Wb=(e,t)=>{var r={};for(var n in e)Gb.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Jf)for(var n of Jf(e))t.indexOf(n)<0&&Hb.call(e,n)&&(r[n]=e[n]);return r};function zb(e,t,r={}){const n=r,{eventFilter:a=ig}=n,i=Wb(n,["eventFilter"]);return ar(e,Fb(a,t),i)}var Kb=Object.defineProperty,qb=Object.defineProperties,Yb=Object.getOwnPropertyDescriptors,Go=Object.getOwnPropertySymbols,sg=Object.prototype.hasOwnProperty,lg=Object.prototype.propertyIsEnumerable,ed=(e,t,r)=>t in e?Kb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Xb=(e,t)=>{for(var r in t||(t={}))sg.call(t,r)&&ed(e,r,t[r]);if(Go)for(var r of Go(t))lg.call(t,r)&&ed(e,r,t[r]);return e},jb=(e,t)=>qb(e,Yb(t)),Qb=(e,t)=>{var r={};for(var n in e)sg.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Go)for(var n of Go(e))t.indexOf(n)<0&&lg.call(e,n)&&(r[n]=e[n]);return r};function Zb(e,t,r={}){const n=r,{eventFilter:a}=n,i=Qb(n,["eventFilter"]),{eventFilter:s,pause:f,resume:h,isActive:c}=Bb(a);return{stop:zb(e,t,jb(Xb({},i),{eventFilter:s})),pause:f,resume:h,isActive:c}}function Jb(e){var t;const r=Or(e);return(t=r==null?void 0:r.$el)!=null?t:r}const Ho=Ui?window:void 0;Ui&&window.document;Ui&&window.navigator;Ui&&window.location;function eN(...e){let t,r,n,a;if(Ub(e[0])?([r,n,a]=e,t=Ho):[t,r,n,a]=e,!t)return ul;let i=ul;const s=ar(()=>Jb(t),h=>{i(),h&&(h.addEventListener(r,n,a),i=()=>{h.removeEventListener(r,n,a),i=ul})},{immediate:!0,flush:"post"}),f=()=>{s(),i()};return og(f),f}function tN(e,t={}){const{window:r=Ho}=t,n=Boolean(r&&"matchMedia"in r&&typeof r.matchMedia=="function");let a;const i=be(!1),s=()=>{!n||(a||(a=r.matchMedia(e)),i.value=a.matches)};return Vb(()=>{s(),a&&("addEventListener"in a?a.addEventListener("change",s):a.addListener(s),og(()=>{"removeEventListener"in a?a.removeEventListener("change",s):a.removeListener(s)}))}),i}const nc=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},ac="__vueuse_ssr_handlers__";nc[ac]=nc[ac]||{};const rN=nc[ac];function nN(e,t){return rN[e]||t}function aN(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"||Array.isArray(e)?"object":Number.isNaN(e)?"any":"number"}const iN={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}};function oN(e,t,r,n={}){var a;const{flush:i="pre",deep:s=!0,listenToStorageChanges:f=!0,writeDefaults:h=!0,shallow:c,window:o=Ho,eventFilter:l,onError:u=C=>{console.error(C)}}=n,d=(c?Lp:be)(t);if(!r)try{r=nN("getDefaultStorage",()=>{var C;return(C=Ho)==null?void 0:C.localStorage})()}catch(C){u(C)}if(!r)return d;const g=Or(t),v=aN(g),y=(a=n.serializer)!=null?a:iN[v],{pause:m,resume:b}=Zb(d,()=>E(d.value),{flush:i,deep:s,eventFilter:l});return o&&f&&eN(o,"storage",R),R(),d;function E(C){try{C==null?r.removeItem(e):r.setItem(e,y.write(C))}catch(O){u(O)}}function N(C){if(!(C&&C.key!==e)){m();try{const O=C?C.newValue:r.getItem(e);return O==null?(h&&g!==null&&r.setItem(e,y.write(g)),g):typeof O!="string"?O:y.read(O)}catch(O){u(O)}finally{b()}}}function R(C){C&&C.key!==e||(d.value=N(C))}}function sN(e){return tN("(prefers-color-scheme: dark)",e)}var td;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(td||(td={}));const cg=Symbol(""),J5=()=>{const e=mt(cg);if(!e)throw new Error("useDarkMode() is called without provider.");return e},lN=()=>{const e=hg(),t=sN(),r=oN("vuepress-color-scheme",e.value.colorMode),n=xe({get(){return e.value.colorModeSwitch?r.value==="auto"?t.value:r.value==="dark":e.value.colorMode==="dark"},set(a){a===t.value?r.value="auto":r.value=a?"dark":"light"}});Nt(cg,n),cN(n)},cN=e=>{const t=(r=e.value)=>{const n=window==null?void 0:window.document.querySelector("html");n==null||n.classList.toggle("dark",r)};Ut(()=>{ar(e,t,{immediate:!0})}),ki(()=>t())},ug=(...e)=>{const r=jc().resolve(...e),n=r.matched[r.matched.length-1];if(!(n!=null&&n.redirect))return r;const{redirect:a}=n,i=qe(a)?a(r):a,s=Ke(i)?{path:i}:i;return ug({hash:r.hash,query:r.query,params:r.params,...s})},uN=e=>{const t=ug(encodeURI(e));return{text:t.meta.title||e,link:t.name==="404"?e:t.fullPath}};let fl=null,ri=null;const fN={wait:()=>fl,pending:()=>{fl=new Promise(e=>ri=e)},resolve:()=>{ri==null||ri(),fl=null,ri=null}},dN=()=>fN,fg=Symbol("sidebarItems"),e8=()=>{const e=mt(fg);if(!e)throw new Error("useSidebarItems() is called without provider.");return e},hN=()=>{const e=hg(),t=Rb(),r=xe(()=>pN(t.value,e.value));Nt(fg,r)},pN=(e,t)=>{var a,i,s,f;const r=(i=(a=e.sidebar)!=null?a:t.sidebar)!=null?i:"auto",n=(f=(s=e.sidebarDepth)!=null?s:t.sidebarDepth)!=null?f:2;return e.home||r===!1?[]:r==="auto"?gN(n):Ve(r)?dg(r,n):gv(r)?mN(r,n):[]},vN=(e,t)=>({text:e.title,link:`#${e.slug}`,children:Jc(e.children,t)}),Jc=(e,t)=>t>0?e.map(r=>vN(r,t-1)):[],gN=e=>{const t=us();return[{text:t.value.title,children:Jc(t.value.headers,e)}]},dg=(e,t)=>{const r=Qc(),n=us(),a=i=>{var f;let s;if(Ke(i)?s=uN(i):s=i,s.children)return{...s,children:s.children.map(h=>a(h))};if(s.link===r.path){const h=((f=n.value.headers[0])==null?void 0:f.level)===1?n.value.headers[0].children:n.value.headers;return{...s,children:Jc(h,t)}}return s};return e.map(i=>a(i))},mN=(e,t)=>{var i;const r=Qc(),n=sn(e,r.path),a=(i=e[n])!=null?i:[];return dg(a,t)},hg=()=>Nb();var yN=Mb({enhance({app:e,router:t}){e.component("Badge",Sb),e.component("CodeGroup",Lb),e.component("CodeGroupItem",kb),e.component("AutoLinkExternalIcon",()=>{const n=e.component("ExternalLinkIcon");return n?j(n):null}),e.component("NavbarSearch",()=>{const n=e.component("Docsearch")||e.component("SearchBox");return n?j(n):null});const r=t.options.scrollBehavior;t.options.scrollBehavior=async(...n)=>(await dN().wait(),r(...n))},setup(){lN(),hN()}}),EN=([e,t,r])=>e==="meta"&&t.name?`${e}.${t.name}`:["title","base"].includes(e)?e:e==="template"&&t.id?`${e}.${t.id}`:JSON.stringify([e,t,r]),_N=e=>{const t=new Set,r=[];return e.forEach(n=>{const a=EN(n);t.has(a)||(t.add(a),r.push(n))}),r},bN=(e,t)=>{const r=Object.keys(e).sort((n,a)=>{const i=a.split("/").length-n.split("/").length;return i!==0?i:a.length-n.length});for(const n of r)if(t.startsWith(n))return n;return"/"},pg=be(nn),vg=Ir({key:"",path:"",title:"",lang:"",frontmatter:{},excerpt:"",headers:[]}),ic=be(vg),NN=()=>ic;Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updatePageData=e=>{pg.value[e.key]=()=>Promise.resolve(e),e.key===ic.value.key&&(ic.value=e)});var AN=be(on);Ft.webpackHot&&(__VUE_HMR_RUNTIME__.updateSiteData=e=>{AN.value=e});kt({resolvePageData:async e=>{const t=pg.value[e],r=await(t==null?void 0:t());return r!=null?r:vg},resolvePageFrontmatter:e=>e.frontmatter,resolvePageHead:(e,t,r)=>{const n=Ke(t.description)?t.description:r.description,a=[...Ve(t.head)?t.head:[],...r.head,["title",{},e],["meta",{name:"description",content:n}]];return _N(a)},resolvePageHeadTitle:(e,t)=>`${e.title?`${e.title} | `:""}${t.title}`,resolvePageLang:e=>e.lang||"en",resolveRouteLocale:(e,t)=>bN(e,t),resolveSiteLocaleData:(e,t)=>({...e,...e.locales[t]})});He({setup(e,t){const r=be(!1);return Ut(()=>{r.value=!0}),()=>{var n,a;return r.value?(a=(n=t.slots).default)==null?void 0:a.call(n):null}}});He({name:"Vuepress",setup(){const e=NN(),t=xe(()=>{let r;if(e.value.path){const n=e.value.frontmatter.layout;Ke(n)?r=n:r="Layout"}else r="404";return cn[r]||pt(r,!1)});return()=>j(t.value)}});var CN=e=>e;class TN{constructor(){le(this,"skeleton",{})}add(t,r){return this.skeleton[t]=r,this}forEach(t){if(this.skeleton)for(const r in this.skeleton)this.skeleton&&this.skeleton.hasOwnProperty&&t.call(null,this.skeleton[r],r,this.skeleton)}}const RN=new TN;class ON{constructor(){le(this,"version","3.7.4");le(this,"hooks",RN)}}const fs=new ON,It=class{constructor(t){le(this,"value");if(!t)throw new TypeError("Invalid argument; `value` has no value.");this.value=It.EMPTY,t&&It.isGuid(t)&&(this.value=t)}static isGuid(t){const r=t.toString();return t&&(t instanceof It||It.validator.test(r))}static create(){return new It([It.gen(2),It.gen(1),It.gen(1),It.gen(1),It.gen(3)].join("-"))}static createEmpty(){return new It("emptyguid")}static parse(t){return new It(t)}static raw(){return[It.gen(2),It.gen(1),It.gen(1),It.gen(1),It.gen(3)].join("-")}static gen(t){let r="";for(let n=0;n<t;n++)r+=((1+Math.random())*65536|0).toString(16).substring(1);return r}equals(t){return It.isGuid(t)&&this.value===t.toString()}isEmpty(){return this.value===It.EMPTY}toString(){return this.value}};let Ct=It;le(Ct,"validator",new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i")),le(Ct,"EMPTY","00000000-0000-0000-0000-000000000000");var rd=He({name:"VmaGridFoobar",props:{type:{type:String,default:"foo"}},setup(e,t){const r={uId:Ct.create().toString(),props:e,context:t},n=()=>j("div",{class:["vma-grid-foobar",e.type]});return r.renderVN=n,Nt("$vmaGridFoobar",r),r},render(){return this.renderVN()}});const wN={install(e){e.component(rd.name,rd)}};var nd=He({name:"VmaGridIcon",props:{type:{type:String,default:"default"},size:{type:String,default:"normal"},name:String,color:String,rotate:{type:Number,default:0},translateX:{type:Number,default:0},translateY:{type:Number,default:0},scaleX:{type:Number,default:1},scaleY:{type:Number,default:1}},setup(e,t){const r={uId:Ct.create().toString(),props:e,context:t},n=()=>{const{color:i,rotate:s,translateX:f,translateY:h,scaleX:c,scaleY:o}=e,l={};return i&&(l.color=i),l.transform=`rotate(${s}deg) translate(${f}px, ${h}px) scale(${c}, ${o})`,l},a=()=>j("i",{class:["vma-grid-iconfont",`vma-grid-icon-${e.name}`,"vma-grid-icon",e.size,e.type],style:n()});return r.renderVN=a,Nt("$vmaGridIcon",r),r},render(){return this.renderVN()}});const IN={install(e){e.component(nd.name,nd)}};var ad=He({name:"VmaGridLoading",props:{size:{type:String,default:"normal"},currentColor:{type:Boolean,default:!1},vertical:Boolean,type:{type:String,default:"default"},category:{type:String,default:"circle-fade"}},setup(e,t){const{slots:r}=t,n={uId:Ct.create().toString(),props:e,context:t},a=xe(()=>e.type),i=xe(()=>e.size),s=()=>{const c=r.default?r.default({}):()=>"";return j("span",{class:["text",a.value,i.value],style:{display:e.vertical?"block":"inline-block"}},c)},f=()=>{if(e.category==="plane")return gt();if(e.category==="chase"){const c=[];return c.push(j("div",{class:"chase-dot"})),c.push(j("div",{class:"chase-dot"})),c.push(j("div",{class:"chase-dot"})),c.push(j("div",{class:"chase-dot"})),c.push(j("div",{class:"chase-dot"})),c.push(j("div",{class:"chase-dot"})),c}if(e.category==="bounce"){const c=[];return c.push(j("div",{class:"bounce-dot"})),c.push(j("div",{class:"bounce-dot"})),c}if(e.category==="wave"){const c=[];return c.push(j("div",{class:"wave-rect"})),c.push(j("div",{class:"wave-rect"})),c.push(j("div",{class:"wave-rect"})),c.push(j("div",{class:"wave-rect"})),c.push(j("div",{class:"wave-rect"})),c}if(e.category==="pulse")return gt();if(e.category==="flow"){const c=[];return c.push(j("div",{class:"flow-dot"})),c.push(j("div",{class:"flow-dot"})),c.push(j("div",{class:"flow-dot"})),c}if(e.category==="swing"){const c=[];return c.push(j("div",{class:"swing-dot"})),c.push(j("div",{class:"swing-dot"})),c}if(e.category==="circle"){const c=[];return c.push(j("div",{class:"circle-dot"})),c.push(j("div",{class:"circle-dot"})),c.push(j("div",{class:"circle-dot"})),c.push(j("div",{class:"circle-dot"})),c.push(j("div",{class:"circle-dot"})),c.push(j("div",{class:"circle-dot"})),c.push(j("div",{class:"circle-dot"})),c.push(j("div",{class:"circle-dot"})),c.push(j("div",{class:"circle-dot"})),c.push(j("div",{class:"circle-dot"})),c.push(j("div",{class:"circle-dot"})),c.push(j("div",{class:"circle-dot"})),c}if(e.category==="circle-fade"){const c=[];return c.push(j("div",{class:"circle-fade-dot"})),c.push(j("div",{class:"circle-fade-dot"})),c.push(j("div",{class:"circle-fade-dot"})),c.push(j("div",{class:"circle-fade-dot"})),c.push(j("div",{class:"circle-fade-dot"})),c.push(j("div",{class:"circle-fade-dot"})),c.push(j("div",{class:"circle-fade-dot"})),c.push(j("div",{class:"circle-fade-dot"})),c.push(j("div",{class:"circle-fade-dot"})),c.push(j("div",{class:"circle-fade-dot"})),c.push(j("div",{class:"circle-fade-dot"})),c.push(j("div",{class:"circle-fade-dot"})),c}if(e.category==="fold"){const c=[];return c.push(j("div",{class:"fold-cube"})),c.push(j("div",{class:"fold-cube"})),c.push(j("div",{class:"fold-cube"})),c.push(j("div",{class:"fold-cube"})),c}return gt()},h=()=>j("div",{class:["vma-grid-loading",{vertical:e.vertical}]},[j("div",{class:[{plane:e.category==="plane",chase:e.category==="chase",bounce:e.category==="bounce",wave:e.category==="wave",pulse:e.category==="pulse",flow:e.category==="flow",swing:e.category==="swing",circle:e.category==="circle","circle-fade":e.category==="circle-fade",fold:e.category==="fold",currentColor:e.currentColor},a.value,i.value]},f()),s()]);return n.renderVN=h,Nt("$vmaGridLoading",n),n},render(){return this.renderVN()}});const MN={install(e){e.component(ad.name,ad)}};var id=He({name:"VmaGridButton",props:{text:String,icon:String,color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,disabled:Boolean,iconPrefix:String,loadingText:String,loadingCategory:String,type:{type:String,default:"default"},size:{type:String,default:"normal"},iconPosition:{type:String,default:"left"}},emits:["click"],setup(e,t){const{slots:r,emit:n}=t,a={uId:Ct.create().toString(),props:e,context:t},i=pt("VmaGridLoading"),s=pt("VmaGridIcon"),f=()=>{let g;return e.loading?g=e.loadingText:g=r.default?r.default({}):()=>e.text,g?j("span",{class:["text"]},g):j("span",{class:["text"]})},h=()=>r.loading?r.loading():j(i,{size:e.size,type:e.type,category:e.loadingCategory,style:{display:"inline-block"},currentColor:!0}),c=()=>e.loading?h():e.icon?j(s,{name:e.icon,size:e.size,type:e.type,color:"currentColor"}):gt(),o=()=>{const{color:g,plain:v}=e;if(g){const y={};return y.color=v?g:"white",v||(y.background=g),g.indexOf("gradient")!==-1?y.border=0:y.borderColor=g,y}return{}},l=g=>{!e.loading&&!e.disabled&&n("click",g)},u=xe(()=>{const g=["vma-grid-button",e.size,e.type];return e.plain&&g.push("plain"),e.block&&g.push("block"),e.round&&g.push("round"),e.square&&g.push("square"),e.loading&&g.push("loading"),e.disabled&&g.push("disabled"),g}),d=()=>j("button",{class:u.value,style:o(),disabled:e.disabled,onClick:l},[j("div",{class:["content"]},[e.iconPosition==="left"&&c(),f(),e.iconPosition==="right"&&c()])]);return a.renderVN=d,Nt("$vmaGridButton",a),a},render(){return this.renderVN()}});const PN={install(e){e.component(id.name,id)}};var od=He({name:"VmaGridRadio",props:{size:{type:String,default:"normal"},type:{type:String,default:"default"},modelValue:Boolean,label:{type:[String,Number],default:null},indeterminate:Boolean,title:[String,Number],content:[String,Number],disabled:Boolean},emits:["update:modelValue","change"],setup(e,t){const{slots:r,emit:n}=t,a={uId:Ct.create().toString(),props:e,context:t},i=pt("VmaGridIcon"),s=mt("$vmaGridRadioGroup",null),f=xe(()=>e.disabled||s&&s.props.disabled),h=xe(()=>s?s.props.modelValue===e.label:e.modelValue),c=xe(()=>s&&s.props.type?s.props.type:e.type),o=xe(()=>s&&s.props.size?s.props.size:e.size),l=d=>{f.value||(s?s.handleChecked({label:e.label},d):(n("update:modelValue",e.label),n("change",{label:e.label},d)))},u=()=>{const d=f.value;return j("label",{class:["vma-grid-radio",o.value],title:e.title},[j("input",{class:"input",type:"radio",disabled:d,checked:h.value,onChange:l}),j("span",{class:["icon",`icon--${c.value}`,{"icon--checked":h.value},{[`icon--checked--${c.value}`]:h.value},{"icon--disabled":d}]},[j(i,{name:"check",size:o.value,translateY:-1})]),j("span",{class:["label",`label--${c.value}`,{"label--checked":h.value},{[`label--checked--${c.value}`]:h.value},{"label--disabled":d}]},r.default?r.default({}):e.content)])};return a.renderVN=u,Nt("$vmaGridRadio",a),a},render(){return this.renderVN()}}),sd=He({name:"VmaGridRadioGroup",props:{modelValue:{type:[String,Number,Boolean]},disabled:Boolean,size:{type:String},type:{type:String}},emits:["update:modelValue","change"],setup(e,t){const{slots:r,emit:n}=t,a={uId:Ct.create().toString(),props:e,context:t};return Object.assign(a,{handleChecked(s,f){const{label:h}=s;n("update:modelValue",h),n("change",s,f)}}),Nt("$vmaGridRadioGroup",a),()=>j("div",{class:"vma-radio-group"},r.default?r.default({}):[])}});const SN={install(e){e.component(od.name,od),e.component(sd.name,sd)}};var ld=He({name:"VmaGridCheckbox",props:{size:{type:String,default:"normal"},type:{type:String,default:"default"},modelValue:Boolean,label:{type:[String,Number],default:null},indeterminate:Boolean,title:[String,Number],content:[String,Number],disabled:Boolean},emits:["update:modelValue","change"],setup(e,t){const{slots:r,emit:n}=t,a={uId:Ct.create().toString(),props:e,context:t},i=pt("VmaGridIcon"),s=mt("$vmaGridCheckboxGroup",null),f=xe(()=>e.disabled||s&&s.props.disabled),h=xe(()=>{var g;return s?(g=s.props.modelValue)==null?void 0:g.includes(e.label):e.modelValue}),c=xe(()=>s&&s.props.type?s.props.type:e.type),o=xe(()=>s&&s.props.size?s.props.size:e.size),l=["vma-grid-checkbox",o.value],u=g=>{if(!f.value){const{checked:y}=g.target;s?s.handleChecked({checked:y,label:e.label},g):(n("update:modelValue",y),n("change",{checked:y,label:e.label},g))}},d=()=>{const g=f.value;return j("label",{class:l,title:e.title},[j("input",{class:"input",type:"checkbox",disabled:g,checked:h.value,onChange:u}),j("span",{class:["icon",`icon--${c.value}`,{"icon--checked":h.value},{[`icon--checked--${c.value}`]:h.value},{"icon--disabled":g}]},[j(i,{name:"check",size:o.value,translateY:-1})]),j("span",{class:["label",`label--${c.value}`,{"label--checked":h.value},{[`label--checked--${c.value}`]:h.value},{"label--disabled":g}]},r.default?r.default({}):e.content)])};return a.renderVN=d,Nt("$vmaGridRadio",a),a},render(){return this.renderVN()}}),cd=He({name:"VmaGridCheckboxGroup",props:{modelValue:{type:Array,default:()=>[]},disabled:Boolean,size:{type:String},type:{type:String}},emits:["update:modelValue","change"],setup(e,t){const{slots:r,emit:n}=t,a={uId:Ct.create().toString(),props:e,context:t};return Object.assign(a,{handleChecked(s,f){const{checked:h,label:c}=s,o=e.modelValue||[],l=o.indexOf(c);h?l===-1&&o.push(c):o.splice(l,1),n("update:modelValue",o),n("change",{checkedValues:o,...s},f)}}),Nt("$vmaGridCheckboxGroup",a),()=>j("div",{class:"vma-checkbox-group"},r.default?r.default({}):[])}});const LN={install(e){e.component(ld.name,ld),e.component(cd.name,cd)}};var ud=He({name:"VmaGridTextarea",props:{type:{type:String,default:"default"},modelValue:[String,Number],immediate:{type:Boolean,default:!0},name:String,readonly:Boolean,disabled:Boolean,placeholder:String,maxlength:[String,Number],size:{type:String,default:"normal"},rows:{type:[String,Number],default:2},wrap:{type:Boolean,default:!0},autofocus:{type:Boolean,default:!1}},emits:["update:modelValue","input","change","focus","blur","keydown","keyup"],setup(e,t){const{emit:r}=t,n=be(),a=be(),i=be(),s=be(),f=be(),h={refElem:n,refTextarea:f,refLinesDiv:a,refCountHelperDiv:i,refCountTargetHelperDiv:s},c=kt({initiated:!1,isActivated:!1,inputValue:e.modelValue}),o={uId:Ct.create().toString(),props:e,context:t,reactiveData:c,getRefs:()=>h};ar(()=>e.modelValue,A=>{c.inputValue=A});const l=xe(()=>{const{placeholder:A}=e;return A||""}),u=xe(()=>{const{immediate:A}=e;return A});let d={};d={dispatchEvent(A,L,G){r(A,{$input:o,$event:G,...L})},focus(){const A=f.value;return c.isActivated=!0,A.focus(),ht()},blur(){return f.value.blur(),c.isActivated=!1,ht()}},Object.assign(o,d);const g=(A,L)=>{c.inputValue=A,d.dispatchEvent("input",{value:A},L),r("update:modelValue",A),d.dispatchEvent("change",{value:A},L)},v=A=>{const{inputValue:L}=c;d.dispatchEvent(A.type,{value:L},A)},y=A=>{u.value?v(A):g(c.inputValue,A)},m=A=>{c.isActivated=!0,v(A)},b=A=>{A&&A.target},E=A=>{const{inputValue:L}=c;u.value||g(L,A),c.isActivated=!1,d.dispatchEvent("blur",{value:L},A)},N=(A,L)=>{const G=u.value;c.inputValue=A,G?g(A,L):d.dispatchEvent("input",{value:A},L)},R=A=>{const L=A.target,{value:G}=L;N(G,A)},C=A=>{v(A)},O=A=>{v(A)},T=()=>{const{inputValue:A,isActivated:L}=c,{disabled:G,readonly:H,rows:Y,wrap:K,autofocus:ce}=e,V=l.value;return j("div",{ref:n,class:["vma-grid-textarea",e.size,e.type,{"is--active":L,"is--disabled":G}]},[j("textarea",{ref:f,class:["inner-textarea",{"inner-textarea--wrap":K,"inner-textarea--nowrap":!K}],value:A,placeholder:V,disabled:G,readonly:H,rows:Y,autofocus:ce,onKeydown:C,onKeyup:O,onInput:R,onChange:y,onFocus:m,onBlur:E,onScroll:b,style:{resize:"both"}})])};return o.renderVN=T,o},render(){return this.renderVN()}});const $N={install(e){e.component(ud.name,ud)}};var fd=He({name:"VmaGridCtxMenu",props:{value:String},emits:["change"],setup(e,t){const r=mt("$vmaCalcGrid",{}),n=pt("VmaGridIcon"),a=pt("VmaGridColorPicker"),{reactiveData:i}=r,{refGridCtxMenu:s}=r.getRefs(),{ctxMenuStore:f}=i,h={},c={uId:Ct.create().toString(),props:e,context:t,getRefs:()=>h},o=(u,d)=>u==="colorPicker"?j(a,{readonly:!1,value:d.code==="cellFrontColor"?r.getCell(d.code,d.param.row,d.param.col)||"#000000":r.getCell(d.code,d.param.row,d.param.col),defaultColor:d.code==="cellFrontColor"?"#000000":null,onChange:(g,v)=>{r.updateCell(d.code,d.param.row,d.param.col,d.param.eRow,d.param.eCol,v)}}):gt(),l=()=>j(Ay,{to:"body",disabled:!1},[j("div",{ref:s,class:["vma-grid-context-menu",{"is--visible":f.visible}],style:f.style},f.list.map((u,d)=>j("ul",{class:"group-wrapper",key:d},u.map((g,v)=>{const y=g.children&&g.children.length;return g.visible?j("li",{class:[{"link--disabled":g.disabled,"link--active":g===f.selected}],key:`${d}_${v}`},[j("a",{class:"link",onClick(m){r.ctxMenuLinkEvent(m,g)},onMouseover(m){r.ctxMenuMouseoverEvent(m,g)},onMouseout(m){r.ctxMenuMouseoutEvent(m,g)}},[j("i",{class:["link-prefix",g.prefixIcon]},g.prefixIcon?j(n,{name:g.prefixIcon,size:"mini",translateY:1}):gt()),j("span",{class:"link-content"},g.name),j("i",{class:["link-suffix",y?g.suffixIcon||"angle-right":g.suffixIcon]},[g.suffixComp?o(g.suffixComp,g):gt(),y?j(n,{name:g.suffixIcon||"angle-right",size:"mini",translateY:1}):g.suffixIcon?j(n,{name:g.suffixIcon,size:"mini",translateY:1}):gt()])]),y?j("ul",{class:["sub-group-wrapper",{"is--show":g===f.selected}]},g.children.map((m,b)=>m.visible?j("li",{class:[{"link--disabled":m.disabled,"link--active":m===f.selectChild}],key:`${d}_${v}_${b}`},j("a",{class:"link",onClick(E){r.ctxMenuLinkEvent(E,m)},onMouseover(E){r.ctxMenuMouseoverEvent(E,g,m)},onMouseout(E){r.ctxMenuMouseoutEvent(E,g)}},[j("i",{class:["link-prefix",m.prefixIcon]},m.prefixIcon?j(n,{name:m.prefixIcon,size:"mini",translateY:1}):gt()),j("span",{class:"link-content",style:{fontFamily:m.item}},m.name),j("i",{class:["link-suffix",g.suffixIcon]})])):null)):null]):null}))))]);return c.renderVN=l,c},render(){return this.renderVN()}});const DN=typeof window!="undefined",Gt=DN&&window.navigator.userAgent.toLowerCase(),xN=Gt&&/; msie|trident/i.test(Gt)&&!/ucbrowser/i.test(Gt),kN=Gt&&/edg/i.test(Gt),UN=Gt&&/chrome|crios/i.test(Gt)&&!/opr|opera|chromium|edg|ucbrowser|googlebot/i.test(Gt),FN=Gt&&/chromium/i.test(Gt),BN=Gt&&/safari/i.test(Gt)&&!/chromium|edg|ucbrowser|chrome|crios|opr|opera|fxios|firefox/i.test(Gt),VN=Gt&&/firefox|fxios/i.test(Gt)&&!/seamonkey/i.test(Gt),GN=Gt&&/opr|opera/i.test(Gt),HN=typeof document=="undefined"?0:document?document.querySelector("html"):0,WN=typeof document=="undefined"?0:document,zN=typeof window=="undefined"?0:window;function gg(e,t,r){if(e){const n=e.parentNode;if(r.top+=e.offsetTop,r.left+=e.offsetLeft,n&&n!==HN&&n!==document.body&&(r.top-=n.scrollTop,r.left-=n.scrollLeft),!(t&&(e===t||e.offsetParent===t))&&e.offsetParent)return gg(e.offsetParent,t,r)}return r}const dl={};function KN(e){return dl[e]||(dl[e]=new RegExp(`(?:^|\\s)${e}(?!\\S)`,"g")),dl[e]}function dd(e,t){return e&&e.className&&e.className.match&&e.className.match(KN(t))}function oc(){const e=document.documentElement,t=document.body;return{scrollTop:e.scrollTop||t.scrollTop,scrollLeft:e.scrollLeft||t.scrollLeft,visibleHeight:e.clientHeight||t.clientHeight,visibleWidth:e.clientWidth||t.clientWidth}}const er={isIE:xN,isEdge:kN,isChrome:UN,isChromium:FN,isSafari:BN,isFirefox:VN,isOpera:GN,getOffsetPos(e,t){return gg(e,t,{left:0,top:0})},getDomNode:oc,hasClass:dd,getAbsolutePos(e){const t=e.getBoundingClientRect(),r=t.top,n=t.left,{scrollTop:a,scrollLeft:i,visibleHeight:s,visibleWidth:f}=oc();return{boundingTop:r,top:a+r,boundingLeft:n,left:i+n,visibleHeight:s,visibleWidth:f}},getEventTargetNode(e,t,r,n){let a,i=e.target;for(;i&&i.nodeType&&i!==document;){if(r&&dd(i,r)&&(!n||n(i)))return a=i,{flag:r?!!a:!0,container:t,targetElem:a};if(i===t)return{flag:r?!!a:!0,container:t,targetElem:a};i=i.parentNode}return{flag:!1}},isPx(e){return e&&/^\d+(px)?$/.test(e)},isScale(e){return e&&/^\d+%$/.test(e)}};function sc(e){const t=e.getBoundingClientRect(),r=t.top,n=t.left,{scrollTop:a,scrollLeft:i,visibleHeight:s,visibleWidth:f}=oc();return{boundingTop:r,top:a+r,boundingLeft:n,left:i+n,visibleHeight:s,visibleWidth:f}}const qN={setupGrid(e){const{uId:t,reactiveData:r}=e,{refGrid:n,refGridCtxMenu:a,refStylePlugin:i,refBorderPlugin:s,refAlignPlugin:f}=e.getRefs();let h={},c={};h={closeMenu(){return Object.assign(r.ctxMenuStore,{visible:!1,selected:null,selectChild:null,showChild:!1}),ht()}};const o=(l,u,d)=>{const g=[];if(u==="grid-corner"){let E=[];E.push({name:"\u63D2\u5165\u9996\u884C",code:"insertFirstRow",disabled:!1,visible:!0}),E.push({name:"\u63D2\u5165\u9996\u5217",code:"insertFirstColumn",disabled:!1,visible:!0}),g.push(E),E=[],E.push({name:"\u663E\u793A\u6240\u6709\u884C",code:"showAllRows",disabled:!1,visible:!0,param:d}),E.push({name:"\u663E\u793A\u6240\u6709\u5217",code:"showAllColumns",disabled:!1,visible:!0,param:d}),g.push(E)}if(u==="column-indicator"){let E=[];E.push({name:"\u5411\u524D\u63D2\u5165\u4E00\u5217",code:"insertColumnBefore",disabled:!1,visible:!0,param:d}),E.push({name:"\u5411\u540E\u63D2\u5165\u4E00\u5217",code:"insertColumnAfter",disabled:!1,visible:!0,param:d}),g.push(E),E=[],E.push({name:"\u5220\u9664\u5217",code:"deleteColumn",disabled:!1,visible:!0,param:d}),g.push(E),E=[],E.push({name:"\u9690\u85CF\u5217",code:"hideColumn",disabled:!1,visible:!0,param:d}),E.push({name:"\u663E\u793A\u6240\u6709\u5217",code:"showAllColumns",disabled:!1,visible:!0,param:d}),g.push(E)}if(u==="row-indicator"){let E=[];E.push({name:"\u5411\u4E0A\u63D2\u5165\u4E00\u884C",code:"insertRowBefore",disabled:!1,visible:!0,param:d}),E.push({name:"\u5411\u4E0B\u63D2\u5165\u4E00\u884C",code:"insertRowAfter",disabled:!1,visible:!0,param:d}),g.push(E),E=[],E.push({name:"\u5220\u9664\u884C",code:"deleteRow",disabled:!1,visible:!0,param:d}),g.push(E),E=[],E.push({name:"\u9690\u85CF\u884C",code:"hideRow",disabled:!1,visible:!0,param:d}),E.push({name:"\u663E\u793A\u6240\u6709\u884C",code:"showAllRows",disabled:!1,visible:!0,param:d}),g.push(E)}if(u==="cell"){let E=[],N=[];E=[],N=[],N.push({name:"\u5E38\u89C4",code:"cellFormat",disabled:!1,visible:!0,item:"general",param:d}),N.push({name:"\u65E5\u671F",code:"cellFormat",disabled:!1,visible:!0,item:"date",param:d}),N.push({name:"\u65F6\u95F4",code:"cellFormat",disabled:!1,visible:!0,item:"time",param:d}),N.push({name:"\u767E\u5206\u6BD4",code:"cellFormat",disabled:!1,visible:!0,item:"percent",param:d}),N.push({name:"\u5206\u6570",code:"cellFormat",disabled:!1,visible:!0,item:"fraction",param:d}),N.push({name:"\u79D1\u5B66\u8BA1\u6570",code:"cellFormat",disabled:!1,visible:!0,item:"scientific-notation",param:d}),N.push({name:"\u6570\u5B57",code:"cellFormat",disabled:!1,visible:!0,item:"number",param:d}),N.push({name:"\u6587\u672C",code:"cellFormat",disabled:!1,visible:!0,item:"string",param:d}),E.push({name:"\u683C\u5F0F",prefixIcon:"info-circle",code:"cellFormat",disabled:!1,visible:!0,children:N,param:d}),N=[],N.push({name:"\u5343\u5206\u4F4D",code:"cellFastFormat",disabled:!1,visible:!0,item:"thousandths",param:d}),N.push({name:"\u589E\u52A0\u5C0F\u6570\u4F4D",code:"cellFastFormat",disabled:!1,visible:!0,item:"decimal-places-add",param:d}),N.push({name:"\u51CF\u5C11\u5C0F\u6570\u4F4D",code:"cellFastFormat",disabled:!1,visible:!0,item:"decimal-places-reduce",param:d}),E.push({name:"\u683C\u5F0F\u8BBE\u7F6E",prefixIcon:"info",code:"cellFastFormat",disabled:!1,visible:!0,children:N,param:d}),g.push(E),E=[],N=[],f.value&&(Object.keys(f.value.vertical()).map(R=>(r.currentSheetData[Number(d.row)][Number(d.col)-1],N.push({name:f.value.vertical()[R],code:"cellAlignDetail",disabled:!1,visible:!0,item:R,param:d}),null)),Object.keys(f.value.horizontal()).map(R=>(r.currentSheetData[Number(d.row)][Number(d.col)-1],N.push({name:f.value.horizontal()[R],code:"cellAlignDetail",disabled:!1,visible:!0,item:R,param:d}),null)),E.push({name:"\u5BF9\u9F50\u65B9\u5F0F",code:"cellAlign",disabled:!1,visible:!0,children:N,param:d})),N=[],s.value&&(N.push({name:s.value.top(),code:"cellBorderDetail",disabled:!1,visible:!0,item:"top",param:d}),N.push({name:s.value.bottom(),code:"cellBorderDetail",disabled:!1,visible:!0,item:"bottom",param:d}),N.push({name:s.value.left(),code:"cellBorderDetail",disabled:!1,visible:!0,item:"left",param:d}),N.push({name:s.value.right(),code:"cellBorderDetail",disabled:!1,visible:!0,item:"right",param:d}),N.push({name:s.value.none(),code:"cellBorderDetail",disabled:!1,visible:!0,item:"none",param:d}),N.push({name:s.value.all(),code:"cellBorderDetail",disabled:!1,visible:!0,item:"all",param:d}),N.push({name:s.value.out(),code:"cellBorderDetail",disabled:!1,visible:!0,item:"out",param:d}),N.push({name:s.value.inner(),code:"cellBorderDetail",disabled:!1,visible:!0,item:"inner",param:d}),E.push({name:"\u8FB9\u6846",code:"cellBorder",disabled:!1,visible:!0,children:N,param:d})),N=[],i.value&&(i.value.fontFamily().map((R,C)=>(N.push({name:R,code:"cellFontFamilyDetail",disabled:!1,visible:!0,item:R,prefixIcon:r.currentSheetData[Number(d.row)][Number(d.col)-1].ff===R?"check":null,param:d}),null)),E.push({name:"\u5B57\u4F53",code:"cellFont",disabled:!1,visible:!0,children:N,param:d})),N=[],i.value&&(i.value.fontSize().map((R,C)=>(N.push({name:R,code:"cellFontSizeDetail",disabled:!1,visible:!0,item:R,prefixIcon:r.currentSheetData[Number(d.row)][Number(d.col)-1].fs===Number(R)?"check":null,param:d}),null)),E.push({name:"\u5B57\u53F7",code:"cellFontSize",disabled:!1,visible:!0,children:N,param:d})),N=[],i.value&&(Object.keys(i.value.fontStyle()).map(R=>{const C=r.currentSheetData[Number(d.row)][Number(d.col)-1];return N.push({name:i.value.fontStyle()[R],code:"cellFontStyleDetail",disabled:!1,visible:!0,item:R,prefixIcon:C[`${R}`]===!0?"check":null,param:d}),null}),E.push({name:"\u98CE\u683C",code:"cellFontStyle",disabled:!1,visible:!0,children:N,param:d})),E.push({name:"\u989C\u8272",code:"cellFrontColor",disabled:!1,visible:!0,suffixComp:"colorPicker",param:d}),E.push({name:"\u586B\u5145",code:"cellBackColor",disabled:!1,visible:!0,suffixComp:"colorPicker",param:d}),g.push(E)}l.preventDefault();const{scrollTop:v,scrollLeft:y}=er.getDomNode(),m=l.clientY+v,b=l.clientX+y;Object.assign(r.ctxMenuStore,{visible:!0,selected:null,list:g,selectChild:null,showChild:!1,style:{top:`${m}px`,left:`${b}px`}}),ht(()=>{const{scrollTop:E,scrollLeft:N,visibleHeight:R,visibleWidth:C}=er.getDomNode(),O=l.clientY+E,T=l.clientX+N,A=a.value,L=A.clientHeight,G=A.clientWidth,{boundingTop:H,boundingLeft:Y}=sc(A),K=H+L-R,ce=Y+G-C;K>-10&&(r.ctxMenuStore.style.top=`${Math.max(E+2,O-L-2)}px`),ce>-10&&(r.ctxMenuStore.style.left=`${Math.max(N+2,T-G-2)}px`)})};return c={ctxMenuLinkEvent(l,u){u&&!u.disabled&&(u.code==="insertColumnBefore"?e.updateColumn("insertColumnBefore",u.param.row,u.param.col):u.code==="insertColumnAfter"?e.updateColumn("insertColumnAfter",u.param.row,u.param.col):u.code==="deleteColumn"?e.updateColumn("deleteColumn",u.param.row,u.param.col):u.code==="hideColumn"?e.updateColumn("hideColumn",u.param.row,u.param.col):u.code==="showAllColumns"?e.updateColumn("showAllColumns",u.param.row,u.param.col):u.code==="fixColumn"||u.code==="unfixColumn"||(u.code==="hideRow"?e.updateRow("hideRow",u.param.row,u.param.col):u.code==="showAllRows"?e.updateRow("showAllRows",u.param.row,u.param.col):u.code==="insertRowBefore"?e.updateRow("insertRowBefore",u.param.row,u.param.col):u.code==="insertRowAfter"?e.updateRow("insertRowAfter",u.param.row,u.param.col):u.code==="deleteRow"?e.updateRow("deleteRow",u.param.row,u.param.col):u.code==="insertFirstColumn"?e.updateColumn("insertFirstColumn",0,0):u.code==="insertFirstRow"?e.updateRow("insertFirstRow",0,0):u.code==="cellFontSizeDetail"?e.updateCell("updateCellFontSize",u.param.row,u.param.col,u.param.eRow,u.param.eCol,u.item):u.code==="cellFontFamilyDetail"?e.updateCell("updateCellFontFamily",u.param.row,u.param.col,u.param.eRow,u.param.eCol,u.item):u.code==="cellFontStyleDetail"?e.updateCell("updateCellFontStyle",u.param.row,u.param.col,u.param.eRow,u.param.eCol,u.item):u.code==="cellBorderDetail"?e.updateCell("updateCellBorder",u.param.row,u.param.col,u.param.eRow,u.param.eCol,u.item):u.code==="cellAlignDetail"?e.updateCell("updateCellAlign",u.param.row,u.param.col,u.param.eRow,u.param.eCol,u.item):u.code==="cellFormat"?e.updateCell("updateCellFormat",u.param.row,u.param.col,u.param.eRow,u.param.eCol,u.item):u.code==="cellFastFormat"&&e.updateCell("updateCellFastFormat",u.param.row,u.param.col,u.param.eRow,u.param.eCol,u.item))),h.closeMenu&&h.closeMenu()},ctxMenuMouseoutEvent(l,u){const{ctxMenuStore:d}=r;u.children||(d.selected=null),d.selectChild=null},ctxMenuMouseoverEvent(l,u,d){const g=l.currentTarget,{ctxMenuStore:v}=r;l.preventDefault(),l.stopPropagation(),v.selected=u,v.selectChild=d,d||(v.showChild=u&&u.children&&u.children.length>0,v.showChild&&ht(()=>{const y=g.nextElementSibling;if(y){const{boundingTop:m,boundingLeft:b,visibleHeight:E,visibleWidth:N}=sc(g),R=m+g.offsetHeight,C=b+g.offsetWidth;let O="",T="";C+y.offsetWidth>N-10&&(O="auto",T=`${g.offsetWidth}px`);let A="",L="";R+y.offsetHeight>E-10&&(A="auto",L="0"),y.style.left=O,y.style.right=T,y.style.top=A,y.style.bottom=L}}))},handleContextmenuEvent:l=>{r.currentCellEditorActive=!1;const u=n.value,d=er.getEventTargetNode(l,u,"column-indicator",m=>{const b=m.parentNode.parentNode.parentNode.parentNode;return b!==document&&b.getAttribute("uid")===t}),g=er.getEventTargetNode(l,u,"row-indicator",m=>{const b=m.parentNode.parentNode.parentNode.parentNode.parentNode;return b!==document&&b.getAttribute("uid")===t}),v=er.getEventTargetNode(l,u,"grid-corner",m=>{const b=m.parentNode.parentNode.parentNode.parentNode;return b!==document&&b.getAttribute("uid")===t}),y=er.getEventTargetNode(l,u,"normal",m=>{const b=m.parentNode.parentNode.parentNode.parentNode;return b!==document&&b.getAttribute("uid")===t});if(v.flag&&o(l,"grid-corner",{row:v.targetElem.getAttribute("row"),col:v.targetElem.getAttribute("col")}),y.flag&&r.currentArea&&Object.keys(r.currentArea).length>1){const m=r.currentArea.start.c>r.currentArea.end.c?r.currentArea.end.c:r.currentArea.start.c,b=r.currentArea.end.c<r.currentArea.start.c?r.currentArea.start.c:r.currentArea.end.c,E=r.currentArea.start.r>r.currentArea.end.r?r.currentArea.end.r:r.currentArea.start.r,N=r.currentArea.end.r<r.currentArea.start.r?r.currentArea.start.r:r.currentArea.end.r;o(l,"cell",{row:E,col:m+1,eRow:N,eCol:b+1})}d.flag&&o(l,"column-indicator",{row:d.targetElem.getAttribute("row"),col:d.targetElem.getAttribute("col")}),g.flag&&o(l,"row-indicator",{row:g.targetElem.getAttribute("row"),col:g.targetElem.getAttribute("col")})}},{...h,...c}}},YN={install(e){fs.hooks.add("VmaGridCtxMenu",qN),e.component(fd.name,fd)}};var hd=He({name:"VmaGridColorPicker",props:{readonly:{type:Boolean,default:!1},defaultColor:{type:String,default:"#000000"},value:String},emits:["change"],setup(e,t){const{slots:r,emit:n}=t,a=pt("VmaGridButton"),i=be(),s={refColorPickerPallet:i},f={uId:Ct.create().toString(),props:e,context:t,getRefs:()=>s},h=be(""),c=be(!1),o=["#000000","#ffffff","#eeece1","#1e497b","#4e81bb","#e2534d","#9aba60","#8165a0","#47acc5","#f9974c"],l=["#c21401","#ff1e02","#ffc12a","#ffff3a","#90cf5b","#00af57","#00afee","#0071be","#00215f","#72349d"],u=[["#7f7f7f","#f2f2f2"],["#0d0d0d","#808080"],["#1c1a10","#ddd8c3"],["#0e243d","#c6d9f0"],["#233f5e","#dae5f0"],["#632623","#f2dbdb"],["#4d602c","#eaf1de"],["#3f3150","#e6e0ec"],["#1e5867","#d9eef3"],["#99490f","#fee9da"]],d=W=>W.length===4?`#${W[1]}${W[1]}${W[2]}${W[2]}${W[3]}${W[3]}`:W,g=(W,Q,ie)=>{const de=(W<<16|Q<<8|ie).toString(16);return`#${new Array(Math.abs(de.length-7)).join("0")}${de}`},v=W=>{const Q=d(W),ie=[];for(let de=1;de<7;de+=2)ie.push(parseInt(`0x${Q.slice(de,de+2)}`,16));return ie},y=(W,Q,ie)=>{const de=v(W),me=v(Q),Oe=(me[0]-de[0])/ie,we=(me[1]-de[1])/ie,Se=(me[2]-de[2])/ie,J=[];for(let $=0;$<ie;$++)J.push(g(Oe*$+de[0],we*$+de[1],Se*$+de[2]));return J},m=xe(()=>{const W=[];for(const Q of u)W.push(y(Q[1],Q[0],5));return W}),b=xe(()=>e.value!==""?e.value:e.defaultColor),E=xe(()=>h.value!==""?h.value:b.value),N=()=>{c.value=!1},R=W=>{e.readonly||(c.value=!0,ht(()=>{const Q=W.currentTarget,ie=Q.nextElementSibling;if(ie){const{boundingTop:de,boundingLeft:me,visibleHeight:Oe,visibleWidth:we}=sc(Q),Se=de+Q.offsetHeight,J=me+Q.offsetWidth;let $="",P="";J+ie.offsetWidth>we-10&&($="auto",P=`${Q.offsetWidth}px`);let k="",ge="";Se+ie.offsetHeight>Oe-10&&(k="auto",ge="0"),ie.style.left=$,ie.style.right=P,ie.style.top=k,ie.style.bottom=ge}}))},C=["vma-grid-color-picker--color-button"];e.readonly&&C.push("vma-grid-color-picker--color-button--readonly");const O=(W,Q)=>{n("change",W,Q),c.value=!1},T=W=>{n("change",W,e.defaultColor),c.value=!1},A=W=>{n("change",W,E.value),c.value=!1},L=()=>j("div",{class:["vma-grid-color-picker--color-pallet--default"]},[j("div",{class:["vma-grid-color-picker--color-pallet--default-color-view"],style:`background-color: ${E.value}`,onClick(Q){A(Q)}}),j("div",{class:["vma-grid-color-picker--color-pallet--default-default-color"]},[j(a,{onMouseDown:T},()=>"\u9ED8\u8BA4\u989C\u8272")])]),G=(W,Q)=>{h.value=Q},H=()=>{h.value=""},Y=()=>{const W=[],Q=[];return o.forEach(ie=>{W.push(j("li",{style:`background-color:${ie}`,onMouseOver(de){G(de,ie)},onMouseOut:H,onClick(de){O(de,ie)}}))}),m.value.forEach(ie=>{const de=[];ie.forEach(me=>{de.push(j("li",{style:`background-color:${me}`,onMouseOver(Oe){G(Oe,me)},onMouseOut:H,onClick(Oe){O(Oe,me)}}))}),Q.push(j("li",{},j("ul",{},de)))}),j("div",{},[j("h3",{},"\u4E3B\u9898\u989C\u8272"),j("ul",{class:["vma-grid-color-picker--color-pallet--theme"]},W),j("ul",{class:["vma-grid-color-picker--color-pallet--gradient"]},Q)])},K=()=>{const W=[];return l.forEach(Q=>{W.push(j("li",{style:`background-color:${Q}`,onMouseOver(ie){G(ie,Q)},onMouseOut:H,onClick(ie){O(ie,Q)}}))}),j("div",{},[j("h3",{},"\u6807\u51C6\u989C\u8272"),j("ul",{class:["vma-grid-color-picker--color-pallet--theme"]},W)])},ce=()=>j("div",{ref:i,class:["vma-grid-color-picker--color-pallet",c.value?"vma-grid-color-picker--color-pallet--open":""]},[L(),Y(),K()]),V=()=>j("div",{class:["vma-grid-color-picker"],tabIndex:-1,onClick(W){W.stopPropagation()},onBlur:N},[j("div",{class:C,style:`background-color:${b.value}`,onClick:R}),ce()]);return f.renderVN=V,Nt("$vmaGridColorPicker",f),f},render(){return this.renderVN()}});const XN={install(e){e.component(hd.name,hd)}};function Pr(e){return typeof e=="number"||/^\d+(\.\d+)?$/.test(e)}var Te=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function jN(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var lc={exports:{}};(function(e,t){const r="\u0E28\u0E39\u0E19\u0E22\u0E4C\u0E1A\u0E32\u0E17\u0E16\u0E49\u0E27\u0E19",n=["","\u0E2B\u0E19\u0E36\u0E48\u0E07","\u0E2A\u0E2D\u0E07","\u0E2A\u0E32\u0E21","\u0E2A\u0E35\u0E48","\u0E2B\u0E49\u0E32","\u0E2B\u0E01","\u0E40\u0E08\u0E47\u0E14","\u0E41\u0E1B\u0E14","\u0E40\u0E01\u0E49\u0E32"],a=["","\u0E2A\u0E34\u0E1A","\u0E23\u0E49\u0E2D\u0E22","\u0E1E\u0E31\u0E19","\u0E2B\u0E21\u0E37\u0E48\u0E19","\u0E41\u0E2A\u0E19","\u0E25\u0E49\u0E32\u0E19"];function i(c){let o="";const l=c.length,u=7;if(l>u){const d=l-u+1,g=c.slice(0,d),v=c.slice(d);return i(g)+"\u0E25\u0E49\u0E32\u0E19"+i(v)}else for(let d=0;d<l;d++){const g=c[d];g>0&&(o+=n[g]+a[l-d-1])}return o}function s(c){let o=c;return o=o.replace(/หนึ่งสิบ/g,"\u0E2A\u0E34\u0E1A"),o=o.replace(/สองสิบ/g,"\u0E22\u0E35\u0E48\u0E2A\u0E34\u0E1A"),o=o.replace(/สิบหนึ่ง/g,"\u0E2A\u0E34\u0E1A\u0E40\u0E2D\u0E47\u0E14"),o}function f(c,o){let l="";return c===""&&o===""?l=r:c!==""&&o===""?l=c+"\u0E1A\u0E32\u0E17\u0E16\u0E49\u0E27\u0E19":c===""&&o!==""?l=o+"\u0E2A\u0E15\u0E32\u0E07\u0E04\u0E4C":l=c+"\u0E1A\u0E32\u0E17"+o+"\u0E2A\u0E15\u0E32\u0E07\u0E04\u0E4C",l}function h(c){if(!c||typeof c=="boolean"||isNaN(Number(c))||c<Number.MIN_SAFE_INTEGER||c>Number.MAX_SAFE_INTEGER)return r;const o=Math.abs(c),l=Math.floor(o).toString(),u=(o%1*100).toFixed(2).split(".")[0],d=Array.from(l).map(Number),g=Array.from(u).map(Number);let v=i(d),y=i(g);v=s(v),y=s(y);const m=f(v,y);return c>=0?m:"\u0E25\u0E1A"+m}e.exports!=null&&(e.exports={bahttext:h},t.default={bahttext:h})})(lc,lc.exports);class Yn{constructor(t,r){le(this,"_data");le(this,"_refs");if(t==null&&r==null)this._data=[],this._refs=[];else{if(t.length!==r.length)throw Error("Collection: data length should match references length.");this._data=t,this._refs=r}}get data(){return this._data}get refs(){return this._refs}get length(){return this._data.length}add(t,r){this._data.push(t),this._refs.push(r)}}const w={NUMBER:0,ARRAY:1,BOOLEAN:2,STRING:3,RANGE_REF:4,CELL_REF:5,COLLECTIONS:6,NUMBER_NO_BOOLEAN:10},mg=[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,121645100408832e3,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8,15511210043330986e9,40329146112660565e10,10888869450418352e12,30488834461171387e13,8841761993739702e15,26525285981219107e16,8222838654177922e18,2631308369336935e20,8683317618811886e21,29523279903960416e22,10333147966386145e24,37199332678990125e25,13763753091226346e27,5230226174666011e29,20397882081197444e30,8159152832478977e32,3345252661316381e34,140500611775288e37,6041526306337383e37,2658271574788449e39,11962222086548019e40,5502622159812089e42,25862324151116818e43,12413915592536073e45,6082818640342675e47,30414093201713376e48,15511187532873822e50,8065817517094388e52,42748832840600255e53,2308436973392414e56,12696403353658276e57,7109985878048635e59,40526919504877214e60,23505613312828785e62,13868311854568984e64,832098711274139e67,5075802138772248e68,3146997326038794e70,198260831540444e73,12688693218588417e73,8247650592082472e75,5443449390774431e77,3647111091818868e79,24800355424368305e80,1711224524281413e83,11978571669969892e84,8504785885678623e86,61234458376886085e87,44701154615126844e89,3307885441519386e92,248091408113954e95,18854947016660504e95,14518309202828587e97,11324281178206297e99,8946182130782976e101,7156945704626381e103,5797126020747368e105,4753643337012842e107,3945523969720659e109,3314240134565353e111,281710411438055e114,24227095383672734e114,2107757298379528e117,18548264225739844e118,1650795516090846e121,14857159644817615e122,1352001527678403e125,12438414054641308e126,11567725070816416e128,1087366156656743e131,1032997848823906e133,9916779348709496e134,9619275968248212e136,9426890448883248e138,9332621544394415e140,9332621544394415e142],QN={};Object.keys(w).forEach(e=>{QN[w[e]]=e});const Xn={isRangeRef:e=>e.ref&&e.ref.from,isCellRef:e=>e.ref&&!e.ref.from,columnNumberToName:e=>{let t=e,r="",n=0;for(;t>0;)n=(t-1)%26,r=String.fromCharCode("A".charCodeAt(0)+n)+r,t=Math.floor((t-n)/26);return r},columnNameToNumber:e=>{e=e.toUpperCase();const t=e.length;let r=0;for(let n=0;n<t;n++){const a=e.charCodeAt(n);isNaN(a)||(r+=(a-64)*26**(t-n-1))}return r},extend:(e,t)=>{if(t==null)return e;let r,n;if(Xn.isCellRef(e))r=0,n=0;else if(Xn.isRangeRef(e))r=e.ref.to.row-e.ref.from.row,n=e.ref.to.col-e.ref.from.col;else throw Error("Address.extend should not reach here.");return Xn.isCellRef(t)?(r>0||n>0)&&(t={ref:{from:{col:t.ref.col,row:t.ref.row},to:{row:t.ref.row+r,col:t.ref.col+n}}}):(t.ref.to.row=t.ref.from.row+r,t.ref.to.col=t.ref.from.col+n),t}};class ZN{constructor(){le(this,"_Types");le(this,"type2Number");le(this,"checkFunctionResult",t=>{if(typeof t==="number"){if(isNaN(t))return S.VALUE;if(!isFinite(t))return S.NUM}return t==null?S.NULL:t});le(this,"isRangeRef",t=>t.ref&&t.ref.from);le(this,"isCellRef",t=>t.ref&&!t.ref.from);le(this,"retrieveArg",(t,r)=>{if(r===null)return{value:0,isArray:!1,omitted:!0};const n=t.utils.extractRefValue(r);return{value:n.val,isArray:n.isArray,ref:r.ref}});this._Types=w,this.type2Number={number:w.NUMBER,boolean:w.BOOLEAN,string:w.STRING,object:-1}}get Types(){return this._Types}set Types(t){this._Types=t}flattenDeep(t){return t.reduce((r,n)=>Array.isArray(n)?r.concat(this.flattenDeep(n)):r.concat(n),[])}acceptNumber(t,r=!0,n=!0){if(t instanceof S)return t;let a;if(typeof t=="number")a=t;else if(typeof t=="boolean")if(n)a=Number(t);else throw S.VALUE;else if(typeof t=="string"){if(t.length===0||(a=Number(t),a!==a))throw S.VALUE}else if(Array.isArray(t))if(r)a=this.acceptNumber(t[0][0]);else if(t[0].length===1)a=this.acceptNumber(t[0][0]);else throw S.VALUE;else throw Error("Unknown type in FormulaHelpers.acceptNumber");return a}flattenParams(t,r,n,a,i=null,s=1){if(t.length<s)throw S.ARG_MISSING([r]);i==null&&(i=r===w.NUMBER?0:r==null?null:""),t.forEach(f=>{const{isCellRef:h,isRangeRef:c,isArray:o}=f,l=f.value instanceof Yn,u=!h&&!c&&!o&&!l,d={isLiteral:u,isCellRef:h,isRangeRef:c,isArray:o,isUnion:l};if(u)f.omitted?f=i:f=this.accept(f,r,i),a(f,d);else if(h)a(f.value,d);else if(l){if(!n)throw S.VALUE;f=f.value.data,f=this.flattenDeep(f),f.forEach(g=>{a(g,d)})}else(c||o)&&(f=this.flattenDeep(f.value),f.forEach(g=>{a(g,d)}))})}accept(t,r=null,n,a=!0,i=!1){if(Array.isArray(r)&&(r=r[0]),t==null&&n===void 0)throw S.ARG_MISSING([r]);if(t==null)return n;if(typeof t!="object"||Array.isArray(t))return t;const s=t.isArray;if(t.value!=null&&(t=t.value),r==null)return t;if(t instanceof S)throw t;if(r===w.ARRAY){if(Array.isArray(t))return a?this.flattenDeep(t):t;if(t instanceof Yn)throw S.VALUE;if(i)return a?[t]:[[t]];throw S.VALUE}else if(r===w.COLLECTIONS)return t;s&&(t=t[0][0]);const f=this.type(t);if(r===w.STRING)f===w.BOOLEAN?t=t?"TRUE":"FALSE":t=`${t}`;else if(r===w.BOOLEAN){if(f===w.STRING)throw S.VALUE;f===w.NUMBER&&(t=Boolean(t))}else if(r===w.NUMBER)t=this.acceptNumber(t,!1);else if(r===w.NUMBER_NO_BOOLEAN)t=this.acceptNumber(t,!1,!1);else throw S.VALUE;return t}type(t){let r=this.type2Number[typeof t];return r===-1&&(Array.isArray(t)?r=w.ARRAY:t.ref?t.ref.from?r=w.RANGE_REF:r=w.CELL_REF:t instanceof Yn&&(r=w.COLLECTIONS)),r}retrieveRanges(t,r,n){return n=Xn.extend(r,n),r=this.retrieveArg(t,r),r=this.accept(r,w.ARRAY,void 0,!1,!0),n!==r?(n=this.retrieveArg(t,n),n=this.accept(n,w.ARRAY,void 0,!1,!0)):n=r,[r,n]}}const bt=new ZN,$r={isWildCard:e=>typeof e=="string"?/[*?]/.test(e):!1,toRegex:(e,t)=>RegExp(e.replace(/[.+^${}()|[\]\\]/g,"\\$&").replace(/([^~]??)[?]/g,"$1.").replace(/([^~]??)[*]/g,"$1.*").replace(/~([?*])/g,"$1"),t)},cc={parse:e=>{const t=typeof e;if(t==="string"){const r=e.toUpperCase();if(r==="TRUE"||r==="FALSE")return{op:"=",value:r==="TRUE"};const n=e.match(/(<>|>=|<=|>|<|=)(.*)/);if(n){const a=n[1];let i;if(isNaN(n[2])){const s=n[2].toUpperCase();if(s==="TRUE"||s==="FALSE")i=s==="TRUE";else if(/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A|#REF!/.test(n[2]))i=new S(n[2]);else if(i=n[2],$r.isWildCard(i))return{op:"wc",value:$r.toRegex(i),match:a==="="}}else i=Number(n[2]);return{op:a,value:i}}return $r.isWildCard(e)?{op:"wc",value:$r.toRegex(e),match:!0}:{op:"=",value:e}}if(t==="boolean"||t==="number"||Array.isArray(e)||e instanceof S)return{op:"=",value:e};throw Error(`Criteria.parse: type ${typeof e} not support`)}},ma=class extends Error{constructor(r,n,a){super(n);le(this,"_error");le(this,"_details");if(n==null&&a==null&&ma.errorMap.has(r))return ma.errorMap.get(r);n==null&&a==null?(this._error=r,ma.errorMap.set(r,this)):this._error=r,this._details=a}get details(){return this._details}set details(r){this._details=r}get error(){return this._error}get name(){return this._error}equals(r){return r instanceof ma&&r._error===this._error}toString(){return this._error}};let S=ma;le(S,"errorMap",new Map),le(S,"DIV0"),le(S,"NA"),le(S,"NAME"),le(S,"NULL"),le(S,"NUM"),le(S,"REF"),le(S,"VALUE"),le(S,"NOT_IMPLEMENTED"),le(S,"TOO_MANY_ARGS"),le(S,"ARG_MISSING"),le(S,"ERROR");S.errorMap=new Map;S.DIV0=new S("#DIV/0!");S.NA=new S("#N/A");S.NAME=new S("#NAME?");S.NULL=new S("#NULL!");S.NUM=new S("#NUM!");S.REF=new S("#REF!");S.VALUE=new S("#VALUE!");S.NOT_IMPLEMENTED=e=>new S("#NAME?",`Function ${e} is not implemented.`);S.TOO_MANY_ARGS=e=>new S("#N/A",`Function ${e} has too many arguments.`);S.ARG_MISSING=e=>new S("#N/A",`Argument type ${e.map(t=>w[t]).join(", ")} is missing.`);S.ERROR=(e,t)=>new S("#ERROR!",e,t);var Aa={},JN=function(t){t.version="0.11.2";function r($){for(var P="",k=$.length-1;k>=0;)P+=$.charAt(k--);return P}function n($,P){for(var k="";k.length<P;)k+=$;return k}function a($,P){var k=""+$;return k.length>=P?k:n("0",P-k.length)+k}function i($,P){var k=""+$;return k.length>=P?k:n(" ",P-k.length)+k}function s($,P){var k=""+$;return k.length>=P?k:k+n(" ",P-k.length)}function f($,P){var k=""+Math.round($);return k.length>=P?k:n("0",P-k.length)+k}function h($,P){var k=""+$;return k.length>=P?k:n("0",P-k.length)+k}var c=Math.pow(2,32);function o($,P){if($>c||$<-c)return f($,P);var k=Math.round($);return h(k,P)}function l($,P){return P=P||0,$.length>=7+P&&($.charCodeAt(P)|32)===103&&($.charCodeAt(P+1)|32)===101&&($.charCodeAt(P+2)|32)===110&&($.charCodeAt(P+3)|32)===101&&($.charCodeAt(P+4)|32)===114&&($.charCodeAt(P+5)|32)===97&&($.charCodeAt(P+6)|32)===108}var u=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],d=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function g($){$[0]="General",$[1]="0",$[2]="0.00",$[3]="#,##0",$[4]="#,##0.00",$[9]="0%",$[10]="0.00%",$[11]="0.00E+00",$[12]="# ?/?",$[13]="# ??/??",$[14]="m/d/yy",$[15]="d-mmm-yy",$[16]="d-mmm",$[17]="mmm-yy",$[18]="h:mm AM/PM",$[19]="h:mm:ss AM/PM",$[20]="h:mm",$[21]="h:mm:ss",$[22]="m/d/yy h:mm",$[37]="#,##0 ;(#,##0)",$[38]="#,##0 ;[Red](#,##0)",$[39]="#,##0.00;(#,##0.00)",$[40]="#,##0.00;[Red](#,##0.00)",$[45]="mm:ss",$[46]="[h]:mm:ss",$[47]="mmss.0",$[48]="##0.0E+0",$[49]="@",$[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'}var v={};g(v);var y=[],m=0;for(m=5;m<=8;++m)y[m]=32+m;for(m=23;m<=26;++m)y[m]=0;for(m=27;m<=31;++m)y[m]=14;for(m=50;m<=58;++m)y[m]=14;for(m=59;m<=62;++m)y[m]=m-58;for(m=67;m<=68;++m)y[m]=m-58;for(m=72;m<=75;++m)y[m]=m-58;for(m=67;m<=68;++m)y[m]=m-57;for(m=76;m<=78;++m)y[m]=m-56;for(m=79;m<=81;++m)y[m]=m-34;var b=[];b[5]=b[63]='"$"#,##0_);\\("$"#,##0\\)',b[6]=b[64]='"$"#,##0_);[Red]\\("$"#,##0\\)',b[7]=b[65]='"$"#,##0.00_);\\("$"#,##0.00\\)',b[8]=b[66]='"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',b[41]='_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',b[42]='_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',b[43]='_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',b[44]='_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)';function E($,P,k){for(var ge=$<0?-1:1,q=$*ge,ye=0,X=1,M=0,B=1,z=0,re=0,ne=Math.floor(q);z<P&&(ne=Math.floor(q),M=ne*X+ye,re=ne*z+B,!(q-ne<5e-8));)q=1/(q-ne),ye=X,X=M,B=z,z=re;if(re>P&&(z>P?(re=B,M=ye):(re=z,M=X)),!k)return[0,ge*M,re];var p=Math.floor(ge*M/re);return[p,ge*M-p*re,re]}function N($,P,k){if($>2958465||$<0)return null;var ge=$|0,q=Math.floor(86400*($-ge)),ye=0,X=[],M={D:ge,T:q,u:86400*($-ge)-q,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(M.u)<1e-6&&(M.u=0),P&&P.date1904&&(ge+=1462),M.u>.9999&&(M.u=0,++q==86400&&(M.T=q=0,++ge,++M.D)),ge===60)X=k?[1317,10,29]:[1900,2,29],ye=3;else if(ge===0)X=k?[1317,8,29]:[1900,1,0],ye=6;else{ge>60&&--ge;var B=new Date(1900,0,1);B.setDate(B.getDate()+ge-1),X=[B.getFullYear(),B.getMonth()+1,B.getDate()],ye=B.getDay(),ge<60&&(ye=(ye+6)%7),k&&(ye=H(B,X))}return M.y=X[0],M.m=X[1],M.d=X[2],M.S=q%60,q=Math.floor(q/60),M.M=q%60,q=Math.floor(q/60),M.H=q,M.q=ye,M}t.parse_date_code=N;var R=new Date(1899,11,31,0,0,0),C=R.getTime(),O=new Date(1900,2,1,0,0,0);function T($,P){var k=$.getTime();return P?k-=1461*24*60*60*1e3:$>=O&&(k+=24*60*60*1e3),(k-(C+($.getTimezoneOffset()-R.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function A($){return $.toString(10)}t._general_int=A;var L=function(){var P=/(?:\.0*|(\.\d*[1-9])0+)$/;function k(z){return z.indexOf(".")==-1?z:z.replace(P,"$1")}var ge=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,q=/(E[+-])(\d)$/;function ye(z){return z.indexOf("E")==-1?z:z.replace(ge,"$1E").replace(q,"$10$2")}function X(z){var re=z<0?12:11,ne=k(z.toFixed(12));return ne.length<=re||(ne=z.toPrecision(10),ne.length<=re)?ne:z.toExponential(5)}function M(z){var re=k(z.toFixed(11));return re.length>(z<0?12:11)||re==="0"||re==="-0"?z.toPrecision(6):re}function B(z){var re=Math.floor(Math.log(Math.abs(z))*Math.LOG10E),ne;return re>=-4&&re<=-1?ne=z.toPrecision(10+re):Math.abs(re)<=9?ne=X(z):re===10?ne=z.toFixed(10).substr(0,12):ne=M(z),k(ye(ne.toUpperCase()))}return B}();t._general_num=L;function G($,P){switch(typeof $){case"string":return $;case"boolean":return $?"TRUE":"FALSE";case"number":return($|0)===$?$.toString(10):L($);case"undefined":return"";case"object":if($==null)return"";if($ instanceof Date)return Se(14,T($,P&&P.date1904),P)}throw new Error("unsupported value in General format: "+$)}t._general=G;function H($,P){P[0]-=581;var k=$.getDay();return $<60&&(k=(k+6)%7),k}function Y($,P,k,ge){var q="",ye=0,X=0,M=k.y,B,z=0;switch($){case 98:M=k.y+543;case 121:switch(P.length){case 1:case 2:B=M%100,z=2;break;default:B=M%1e4,z=4;break}break;case 109:switch(P.length){case 1:case 2:B=k.m,z=P.length;break;case 3:return d[k.m-1][1];case 5:return d[k.m-1][0];default:return d[k.m-1][2]}break;case 100:switch(P.length){case 1:case 2:B=k.d,z=P.length;break;case 3:return u[k.q][0];default:return u[k.q][1]}break;case 104:switch(P.length){case 1:case 2:B=1+(k.H+11)%12,z=P.length;break;default:throw"bad hour format: "+P}break;case 72:switch(P.length){case 1:case 2:B=k.H,z=P.length;break;default:throw"bad hour format: "+P}break;case 77:switch(P.length){case 1:case 2:B=k.M,z=P.length;break;default:throw"bad minute format: "+P}break;case 115:if(P!="s"&&P!="ss"&&P!=".0"&&P!=".00"&&P!=".000")throw"bad second format: "+P;return k.u===0&&(P=="s"||P=="ss")?a(k.S,P.length):(ge>=2?X=ge===3?1e3:100:X=ge===1?10:1,ye=Math.round(X*(k.S+k.u)),ye>=60*X&&(ye=0),P==="s"?ye===0?"0":""+ye/X:(q=a(ye,2+ge),P==="ss"?q.substr(0,2):"."+q.substr(2,P.length-1)));case 90:switch(P){case"[h]":case"[hh]":B=k.D*24+k.H;break;case"[m]":case"[mm]":B=(k.D*24+k.H)*60+k.M;break;case"[s]":case"[ss]":B=((k.D*24+k.H)*60+k.M)*60+Math.round(k.S+k.u);break;default:throw"bad abstime format: "+P}z=P.length===3?1:2;break;case 101:B=M,z=1;break}var re=z>0?a(B,z):"";return re}function K($){var P=3;if($.length<=P)return $;for(var k=$.length%P,ge=$.substr(0,k);k!=$.length;k+=P)ge+=(ge.length>0?",":"")+$.substr(k,P);return ge}var ce=function(){var P=/%/g;function k(fe,D,U){var ae=D.replace(P,""),Z=D.length-ae.length;return ce(fe,ae,U*Math.pow(10,2*Z))+n("%",Z)}function ge(fe,D,U){for(var ae=D.length-1;D.charCodeAt(ae-1)===44;)--ae;return ce(fe,D.substr(0,ae),U/Math.pow(10,3*(D.length-ae)))}function q(fe,D){var U,ae=fe.indexOf("E")-fe.indexOf(".")-1;if(fe.match(/^#+0.0E\+0$/)){if(D==0)return"0.0E+0";if(D<0)return"-"+q(fe,-D);var Z=fe.indexOf(".");Z===-1&&(Z=fe.indexOf("E"));var ee=Math.floor(Math.log(D)*Math.LOG10E)%Z;if(ee<0&&(ee+=Z),U=(D/Math.pow(10,ee)).toPrecision(ae+1+(Z+ee)%Z),U.indexOf("e")===-1){var Ne=Math.floor(Math.log(D)*Math.LOG10E);for(U.indexOf(".")===-1?U=U.charAt(0)+"."+U.substr(1)+"E+"+(Ne-U.length+ee):U+="E+"+(Ne-ee);U.substr(0,2)==="0.";)U=U.charAt(0)+U.substr(2,Z)+"."+U.substr(2+Z),U=U.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");U=U.replace(/\+-/,"-")}U=U.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(De,Ge,ke,Ue){return Ge+ke+Ue.substr(0,(Z+ee)%Z)+"."+Ue.substr(ee)+"E"})}else U=D.toExponential(ae);return fe.match(/E\+00$/)&&U.match(/e[+-]\d$/)&&(U=U.substr(0,U.length-1)+"0"+U.charAt(U.length-1)),fe.match(/E\-/)&&U.match(/e\+/)&&(U=U.replace(/e\+/,"e")),U.replace("e","E")}var ye=/# (\?+)( ?)\/( ?)(\d+)/;function X(fe,D,U){var ae=parseInt(fe[4],10),Z=Math.round(D*ae),ee=Math.floor(Z/ae),Ne=Z-ee*ae,De=ae;return U+(ee===0?"":""+ee)+" "+(Ne===0?n(" ",fe[1].length+1+fe[4].length):i(Ne,fe[1].length)+fe[2]+"/"+fe[3]+a(De,fe[4].length))}function M(fe,D,U){return U+(D===0?"":""+D)+n(" ",fe[1].length+2+fe[4].length)}var B=/^#*0*\.([0#]+)/,z=/\).*[0#]/,re=/\(###\) ###\\?-####/;function ne(fe){for(var D="",U,ae=0;ae!=fe.length;++ae)switch(U=fe.charCodeAt(ae)){case 35:break;case 63:D+=" ";break;case 48:D+="0";break;default:D+=String.fromCharCode(U)}return D}function p(fe,D){var U=Math.pow(10,D);return""+Math.round(fe*U)/U}function Ee(fe,D){var U=fe-Math.floor(fe),ae=Math.pow(10,D);return D<(""+Math.round(U*ae)).length?0:Math.round(U*ae)}function x(fe,D){return D<(""+Math.round((fe-Math.floor(fe))*Math.pow(10,D))).length?1:0}function pe(fe){return fe<2147483647&&fe>-2147483648?""+(fe>=0?fe|0:fe-1|0):""+Math.floor(fe)}function ue(fe,D,U){if(fe.charCodeAt(0)===40&&!D.match(z)){var ae=D.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return U>=0?ue("n",ae,U):"("+ue("n",ae,-U)+")"}if(D.charCodeAt(D.length-1)===44)return ge(fe,D,U);if(D.indexOf("%")!==-1)return k(fe,D,U);if(D.indexOf("E")!==-1)return q(D,U);if(D.charCodeAt(0)===36)return"$"+ue(fe,D.substr(D.charAt(1)==" "?2:1),U);var Z,ee,Ne,De,Ge=Math.abs(U),ke=U<0?"-":"";if(D.match(/^00+$/))return ke+o(Ge,D.length);if(D.match(/^[#?]+$/))return Z=o(U,0),Z==="0"&&(Z=""),Z.length>D.length?Z:ne(D.substr(0,D.length-Z.length))+Z;if(ee=D.match(ye))return X(ee,Ge,ke);if(D.match(/^#+0+$/))return ke+o(Ge,D.length-D.indexOf("0"));if(ee=D.match(B))return Z=p(U,ee[1].length).replace(/^([^\.]+)$/,"$1."+ne(ee[1])).replace(/\.$/,"."+ne(ee[1])).replace(/\.(\d*)$/,function(_e,oe){return"."+oe+n("0",ne(ee[1]).length-oe.length)}),D.indexOf("0.")!==-1?Z:Z.replace(/^0\./,".");if(D=D.replace(/^#+([0.])/,"$1"),ee=D.match(/^(0*)\.(#*)$/))return ke+p(Ge,ee[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,ee[1].length?"0.":".");if(ee=D.match(/^#{1,3},##0(\.?)$/))return ke+K(o(Ge,0));if(ee=D.match(/^#,##0\.([#0]*0)$/))return U<0?"-"+ue(fe,D,-U):K(""+(Math.floor(U)+x(U,ee[1].length)))+"."+a(Ee(U,ee[1].length),ee[1].length);if(ee=D.match(/^#,#*,#0/))return ue(fe,D.replace(/^#,#*,/,""),U);if(ee=D.match(/^([0#]+)(\\?-([0#]+))+$/))return Z=r(ue(fe,D.replace(/[\\-]/g,""),U)),Ne=0,r(r(D.replace(/\\/g,"")).replace(/[0#]/g,function(_e){return Ne<Z.length?Z.charAt(Ne++):_e==="0"?"0":""}));if(D.match(re))return Z=ue(fe,"##########",U),"("+Z.substr(0,3)+") "+Z.substr(3,3)+"-"+Z.substr(6);var Ue="";if(ee=D.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return Ne=Math.min(ee[4].length,7),De=E(Ge,Math.pow(10,Ne)-1,!1),Z=""+ke,Ue=ce("n",ee[1],De[1]),Ue.charAt(Ue.length-1)==" "&&(Ue=Ue.substr(0,Ue.length-1)+"0"),Z+=Ue+ee[2]+"/"+ee[3],Ue=s(De[2],Ne),Ue.length<ee[4].length&&(Ue=ne(ee[4].substr(ee[4].length-Ue.length))+Ue),Z+=Ue,Z;if(ee=D.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return Ne=Math.min(Math.max(ee[1].length,ee[4].length),7),De=E(Ge,Math.pow(10,Ne)-1,!0),ke+(De[0]||(De[1]?"":"0"))+" "+(De[1]?i(De[1],Ne)+ee[2]+"/"+ee[3]+s(De[2],Ne):n(" ",2*Ne+1+ee[2].length+ee[3].length));if(ee=D.match(/^[#0?]+$/))return Z=o(U,0),D.length<=Z.length?Z:ne(D.substr(0,D.length-Z.length))+Z;if(ee=D.match(/^([#0?]+)\.([#0]+)$/)){Z=""+U.toFixed(Math.min(ee[2].length,10)).replace(/([^0])0+$/,"$1"),Ne=Z.indexOf(".");var Rt=D.indexOf(".")-Ne,Wt=D.length-Z.length-Rt;return ne(D.substr(0,Rt)+Z+D.substr(D.length-Wt))}if(ee=D.match(/^00,000\.([#0]*0)$/))return Ne=Ee(U,ee[1].length),U<0?"-"+ue(fe,D,-U):K(pe(U)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_e){return"00,"+(_e.length<3?a(0,3-_e.length):"")+_e})+"."+a(Ne,ee[1].length);switch(D){case"###,##0.00":return ue(fe,"#,##0.00",U);case"###,###":case"##,###":case"#,###":var or=K(o(Ge,0));return or!=="0"?ke+or:"";case"###,###.00":return ue(fe,"###,##0.00",U).replace(/^0\./,".");case"#,###.00":return ue(fe,"#,##0.00",U).replace(/^0\./,".")}throw new Error("unsupported format |"+D+"|")}function Me(fe,D,U){for(var ae=D.length-1;D.charCodeAt(ae-1)===44;)--ae;return ce(fe,D.substr(0,ae),U/Math.pow(10,3*(D.length-ae)))}function Ce(fe,D,U){var ae=D.replace(P,""),Z=D.length-ae.length;return ce(fe,ae,U*Math.pow(10,2*Z))+n("%",Z)}function Pe(fe,D){var U,ae=fe.indexOf("E")-fe.indexOf(".")-1;if(fe.match(/^#+0.0E\+0$/)){if(D==0)return"0.0E+0";if(D<0)return"-"+Pe(fe,-D);var Z=fe.indexOf(".");Z===-1&&(Z=fe.indexOf("E"));var ee=Math.floor(Math.log(D)*Math.LOG10E)%Z;if(ee<0&&(ee+=Z),U=(D/Math.pow(10,ee)).toPrecision(ae+1+(Z+ee)%Z),!U.match(/[Ee]/)){var Ne=Math.floor(Math.log(D)*Math.LOG10E);U.indexOf(".")===-1?U=U.charAt(0)+"."+U.substr(1)+"E+"+(Ne-U.length+ee):U+="E+"+(Ne-ee),U=U.replace(/\+-/,"-")}U=U.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(De,Ge,ke,Ue){return Ge+ke+Ue.substr(0,(Z+ee)%Z)+"."+Ue.substr(ee)+"E"})}else U=D.toExponential(ae);return fe.match(/E\+00$/)&&U.match(/e[+-]\d$/)&&(U=U.substr(0,U.length-1)+"0"+U.charAt(U.length-1)),fe.match(/E\-/)&&U.match(/e\+/)&&(U=U.replace(/e\+/,"e")),U.replace("e","E")}function Ae(fe,D,U){if(fe.charCodeAt(0)===40&&!D.match(z)){var ae=D.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return U>=0?Ae("n",ae,U):"("+Ae("n",ae,-U)+")"}if(D.charCodeAt(D.length-1)===44)return Me(fe,D,U);if(D.indexOf("%")!==-1)return Ce(fe,D,U);if(D.indexOf("E")!==-1)return Pe(D,U);if(D.charCodeAt(0)===36)return"$"+Ae(fe,D.substr(D.charAt(1)==" "?2:1),U);var Z,ee,Ne,De,Ge=Math.abs(U),ke=U<0?"-":"";if(D.match(/^00+$/))return ke+a(Ge,D.length);if(D.match(/^[#?]+$/))return Z=""+U,U===0&&(Z=""),Z.length>D.length?Z:ne(D.substr(0,D.length-Z.length))+Z;if(ee=D.match(ye))return M(ee,Ge,ke);if(D.match(/^#+0+$/))return ke+a(Ge,D.length-D.indexOf("0"));if(ee=D.match(B))return Z=(""+U).replace(/^([^\.]+)$/,"$1."+ne(ee[1])).replace(/\.$/,"."+ne(ee[1])),Z=Z.replace(/\.(\d*)$/,function(_e,oe){return"."+oe+n("0",ne(ee[1]).length-oe.length)}),D.indexOf("0.")!==-1?Z:Z.replace(/^0\./,".");if(D=D.replace(/^#+([0.])/,"$1"),ee=D.match(/^(0*)\.(#*)$/))return ke+(""+Ge).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,ee[1].length?"0.":".");if(ee=D.match(/^#{1,3},##0(\.?)$/))return ke+K(""+Ge);if(ee=D.match(/^#,##0\.([#0]*0)$/))return U<0?"-"+Ae(fe,D,-U):K(""+U)+"."+n("0",ee[1].length);if(ee=D.match(/^#,#*,#0/))return Ae(fe,D.replace(/^#,#*,/,""),U);if(ee=D.match(/^([0#]+)(\\?-([0#]+))+$/))return Z=r(Ae(fe,D.replace(/[\\-]/g,""),U)),Ne=0,r(r(D.replace(/\\/g,"")).replace(/[0#]/g,function(_e){return Ne<Z.length?Z.charAt(Ne++):_e==="0"?"0":""}));if(D.match(re))return Z=Ae(fe,"##########",U),"("+Z.substr(0,3)+") "+Z.substr(3,3)+"-"+Z.substr(6);var Ue="";if(ee=D.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return Ne=Math.min(ee[4].length,7),De=E(Ge,Math.pow(10,Ne)-1,!1),Z=""+ke,Ue=ce("n",ee[1],De[1]),Ue.charAt(Ue.length-1)==" "&&(Ue=Ue.substr(0,Ue.length-1)+"0"),Z+=Ue+ee[2]+"/"+ee[3],Ue=s(De[2],Ne),Ue.length<ee[4].length&&(Ue=ne(ee[4].substr(ee[4].length-Ue.length))+Ue),Z+=Ue,Z;if(ee=D.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return Ne=Math.min(Math.max(ee[1].length,ee[4].length),7),De=E(Ge,Math.pow(10,Ne)-1,!0),ke+(De[0]||(De[1]?"":"0"))+" "+(De[1]?i(De[1],Ne)+ee[2]+"/"+ee[3]+s(De[2],Ne):n(" ",2*Ne+1+ee[2].length+ee[3].length));if(ee=D.match(/^[#0?]+$/))return Z=""+U,D.length<=Z.length?Z:ne(D.substr(0,D.length-Z.length))+Z;if(ee=D.match(/^([#0]+)\.([#0]+)$/)){Z=""+U.toFixed(Math.min(ee[2].length,10)).replace(/([^0])0+$/,"$1"),Ne=Z.indexOf(".");var Rt=D.indexOf(".")-Ne,Wt=D.length-Z.length-Rt;return ne(D.substr(0,Rt)+Z+D.substr(D.length-Wt))}if(ee=D.match(/^00,000\.([#0]*0)$/))return U<0?"-"+Ae(fe,D,-U):K(""+U).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_e){return"00,"+(_e.length<3?a(0,3-_e.length):"")+_e})+"."+a(0,ee[1].length);switch(D){case"###,###":case"##,###":case"#,###":var or=K(""+Ge);return or!=="0"?ke+or:"";default:if(D.match(/\.[0#?]*$/))return Ae(fe,D.slice(0,D.lastIndexOf(".")),U)+ne(D.slice(D.lastIndexOf(".")))}throw new Error("unsupported format |"+D+"|")}return function(D,U,ae){return(ae|0)===ae?Ae(D,U,ae):ue(D,U,ae)}}();function V($){for(var P=[],k=!1,ge=0,q=0;ge<$.length;++ge)switch($.charCodeAt(ge)){case 34:k=!k;break;case 95:case 42:case 92:++ge;break;case 59:P[P.length]=$.substr(q,ge-q),q=ge+1}if(P[P.length]=$.substr(q),k===!0)throw new Error("Format |"+$+"| unterminated string ");return P}t._split=V;var W=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Q($){for(var P=0,k="",ge="";P<$.length;)switch(k=$.charAt(P)){case"G":l($,P)&&(P+=6),P++;break;case'"':for(;$.charCodeAt(++P)!==34&&P<$.length;);++P;break;case"\\":P+=2;break;case"_":P+=2;break;case"@":++P;break;case"B":case"b":if($.charAt(P+1)==="1"||$.charAt(P+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if($.substr(P,3).toUpperCase()==="A/P"||$.substr(P,5).toUpperCase()==="AM/PM"||$.substr(P,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++P;break;case"[":for(ge=k;$.charAt(P++)!=="]"&&P<$.length;)ge+=$.charAt(P);if(ge.match(W))return!0;break;case".":case"0":case"#":for(;P<$.length&&("0#?.,E+-%".indexOf(k=$.charAt(++P))>-1||k=="\\"&&$.charAt(P+1)=="-"&&"0#".indexOf($.charAt(P+2))>-1););break;case"?":for(;$.charAt(++P)===k;);break;case"*":++P,($.charAt(P)==" "||$.charAt(P)=="*")&&++P;break;case"(":case")":++P;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;P<$.length&&"0123456789".indexOf($.charAt(++P))>-1;);break;case" ":++P;break;default:++P;break}return!1}t.is_date=Q;function ie($,P,k,ge){for(var q=[],ye="",X=0,M="",B="t",z,re,ne,p="H";X<$.length;)switch(M=$.charAt(X)){case"G":if(!l($,X))throw new Error("unrecognized character "+M+" in "+$);q[q.length]={t:"G",v:"General"},X+=7;break;case'"':for(ye="";(ne=$.charCodeAt(++X))!==34&&X<$.length;)ye+=String.fromCharCode(ne);q[q.length]={t:"t",v:ye},++X;break;case"\\":var Ee=$.charAt(++X),x=Ee==="("||Ee===")"?Ee:"t";q[q.length]={t:x,v:Ee},++X;break;case"_":q[q.length]={t:"t",v:" "},X+=2;break;case"@":q[q.length]={t:"T",v:P},++X;break;case"B":case"b":if($.charAt(X+1)==="1"||$.charAt(X+1)==="2"){if(z==null&&(z=N(P,k,$.charAt(X+1)==="2"),z==null))return"";q[q.length]={t:"X",v:$.substr(X,2)},B=M,X+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":M=M.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(P<0||z==null&&(z=N(P,k),z==null))return"";for(ye=M;++X<$.length&&$.charAt(X).toLowerCase()===M;)ye+=M;M==="m"&&B.toLowerCase()==="h"&&(M="M"),M==="h"&&(M=p),q[q.length]={t:M,v:ye},B=M;break;case"A":case"a":case"\u4E0A":var pe={t:M,v:M};if(z==null&&(z=N(P,k)),$.substr(X,3).toUpperCase()==="A/P"?(z!=null&&(pe.v=z.H>=12?"P":"A"),pe.t="T",p="h",X+=3):$.substr(X,5).toUpperCase()==="AM/PM"?(z!=null&&(pe.v=z.H>=12?"PM":"AM"),pe.t="T",X+=5,p="h"):$.substr(X,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(z!=null&&(pe.v=z.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),pe.t="T",X+=5,p="h"):(pe.t="t",++X),z==null&&pe.t==="T")return"";q[q.length]=pe,B=M;break;case"[":for(ye=M;$.charAt(X++)!=="]"&&X<$.length;)ye+=$.charAt(X);if(ye.slice(-1)!=="]")throw'unterminated "[" block: |'+ye+"|";if(ye.match(W)){if(z==null&&(z=N(P,k),z==null))return"";q[q.length]={t:"Z",v:ye.toLowerCase()},B=ye.charAt(1)}else ye.indexOf("$")>-1&&(ye=(ye.match(/\$([^-\[\]]*)/)||[])[1]||"$",Q($)||(q[q.length]={t:"t",v:ye}));break;case".":if(z!=null){for(ye=M;++X<$.length&&(M=$.charAt(X))==="0";)ye+=M;q[q.length]={t:"s",v:ye};break}case"0":case"#":for(ye=M;++X<$.length&&"0#?.,E+-%".indexOf(M=$.charAt(X))>-1;)ye+=M;q[q.length]={t:"n",v:ye};break;case"?":for(ye=M;$.charAt(++X)===M;)ye+=M;q[q.length]={t:M,v:ye},B=M;break;case"*":++X,($.charAt(X)==" "||$.charAt(X)=="*")&&++X;break;case"(":case")":q[q.length]={t:ge===1?"t":M,v:M},++X;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(ye=M;X<$.length&&"0123456789".indexOf($.charAt(++X))>-1;)ye+=$.charAt(X);q[q.length]={t:"D",v:ye};break;case" ":q[q.length]={t:M,v:M},++X;break;case"$":q[q.length]={t:"t",v:"$"},++X;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(M)===-1)throw new Error("unrecognized character "+M+" in "+$);q[q.length]={t:"t",v:M},++X;break}var ue=0,Me=0,Ce;for(X=q.length-1,B="t";X>=0;--X)switch(q[X].t){case"h":case"H":q[X].t=p,B="h",ue<1&&(ue=1);break;case"s":(Ce=q[X].v.match(/\.0+$/))&&(Me=Math.max(Me,Ce[0].length-1)),ue<3&&(ue=3);case"d":case"y":case"M":case"e":B=q[X].t;break;case"m":B==="s"&&(q[X].t="M",ue<2&&(ue=2));break;case"X":break;case"Z":ue<1&&q[X].v.match(/[Hh]/)&&(ue=1),ue<2&&q[X].v.match(/[Mm]/)&&(ue=2),ue<3&&q[X].v.match(/[Ss]/)&&(ue=3)}switch(ue){case 0:break;case 1:z.u>=.5&&(z.u=0,++z.S),z.S>=60&&(z.S=0,++z.M),z.M>=60&&(z.M=0,++z.H);break;case 2:z.u>=.5&&(z.u=0,++z.S),z.S>=60&&(z.S=0,++z.M);break}var Pe="",Ae;for(X=0;X<q.length;++X)switch(q[X].t){case"t":case"T":case" ":case"D":break;case"X":q[X].v="",q[X].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":q[X].v=Y(q[X].t.charCodeAt(0),q[X].v,z,Me),q[X].t="t";break;case"n":case"?":for(Ae=X+1;q[Ae]!=null&&((M=q[Ae].t)==="?"||M==="D"||(M===" "||M==="t")&&q[Ae+1]!=null&&(q[Ae+1].t==="?"||q[Ae+1].t==="t"&&q[Ae+1].v==="/")||q[X].t==="("&&(M===" "||M==="n"||M===")")||M==="t"&&(q[Ae].v==="/"||q[Ae].v===" "&&q[Ae+1]!=null&&q[Ae+1].t=="?"));)q[X].v+=q[Ae].v,q[Ae]={v:"",t:";"},++Ae;Pe+=q[X].v,X=Ae-1;break;case"G":q[X].t="t",q[X].v=G(P,k);break}var fe="",D,U;if(Pe.length>0){Pe.charCodeAt(0)==40?(D=P<0&&Pe.charCodeAt(0)===45?-P:P,U=ce("n",Pe,D)):(D=P<0&&ge>1?-P:P,U=ce("n",Pe,D),D<0&&q[0]&&q[0].t=="t"&&(U=U.substr(1),q[0].v="-"+q[0].v)),Ae=U.length-1;var ae=q.length;for(X=0;X<q.length;++X)if(q[X]!=null&&q[X].t!="t"&&q[X].v.indexOf(".")>-1){ae=X;break}var Z=q.length;if(ae===q.length&&U.indexOf("E")===-1){for(X=q.length-1;X>=0;--X)q[X]==null||"n?".indexOf(q[X].t)===-1||(Ae>=q[X].v.length-1?(Ae-=q[X].v.length,q[X].v=U.substr(Ae+1,q[X].v.length)):Ae<0?q[X].v="":(q[X].v=U.substr(0,Ae+1),Ae=-1),q[X].t="t",Z=X);Ae>=0&&Z<q.length&&(q[Z].v=U.substr(0,Ae+1)+q[Z].v)}else if(ae!==q.length&&U.indexOf("E")===-1){for(Ae=U.indexOf(".")-1,X=ae;X>=0;--X)if(!(q[X]==null||"n?".indexOf(q[X].t)===-1)){for(re=q[X].v.indexOf(".")>-1&&X===ae?q[X].v.indexOf(".")-1:q[X].v.length-1,fe=q[X].v.substr(re+1);re>=0;--re)Ae>=0&&(q[X].v.charAt(re)==="0"||q[X].v.charAt(re)==="#")&&(fe=U.charAt(Ae--)+fe);q[X].v=fe,q[X].t="t",Z=X}for(Ae>=0&&Z<q.length&&(q[Z].v=U.substr(0,Ae+1)+q[Z].v),Ae=U.indexOf(".")+1,X=ae;X<q.length;++X)if(!(q[X]==null||"n?(".indexOf(q[X].t)===-1&&X!==ae)){for(re=q[X].v.indexOf(".")>-1&&X===ae?q[X].v.indexOf(".")+1:0,fe=q[X].v.substr(0,re);re<q[X].v.length;++re)Ae<U.length&&(fe+=U.charAt(Ae++));q[X].v=fe,q[X].t="t",Z=X}}}for(X=0;X<q.length;++X)q[X]!=null&&"n?".indexOf(q[X].t)>-1&&(D=ge>1&&P<0&&X>0&&q[X-1].v==="-"?-P:P,q[X].v=ce(q[X].t,q[X].v,D),q[X].t="t");var ee="";for(X=0;X!==q.length;++X)q[X]!=null&&(ee+=q[X].v);return ee}t._eval=ie;var de=/\[[=<>]/,me=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Oe($,P){if(P==null)return!1;var k=parseFloat(P[2]);switch(P[1]){case"=":if($==k)return!0;break;case">":if($>k)return!0;break;case"<":if($<k)return!0;break;case"<>":if($!=k)return!0;break;case">=":if($>=k)return!0;break;case"<=":if($<=k)return!0;break}return!1}function we($,P){var k=V($),ge=k.length,q=k[ge-1].indexOf("@");if(ge<4&&q>-1&&--ge,k.length>4)throw new Error("cannot find right format for |"+k.join("|")+"|");if(typeof P!="number")return[4,k.length===4||q>-1?k[k.length-1]:"@"];switch(k.length){case 1:k=q>-1?["General","General","General",k[0]]:[k[0],k[0],k[0],"@"];break;case 2:k=q>-1?[k[0],k[0],k[0],k[1]]:[k[0],k[1],k[0],"@"];break;case 3:k=q>-1?[k[0],k[1],k[0],k[2]]:[k[0],k[1],k[2],"@"];break}var ye=P>0?k[0]:P<0?k[1]:k[2];if(k[0].indexOf("[")===-1&&k[1].indexOf("[")===-1)return[ge,ye];if(k[0].match(de)!=null||k[1].match(de)!=null){var X=k[0].match(me),M=k[1].match(me);return Oe(P,X)?[ge,k[0]]:Oe(P,M)?[ge,k[1]]:[ge,k[X!=null&&M!=null?2:1]]}return[ge,ye]}function Se($,P,k){k==null&&(k={});var ge="";switch(typeof $){case"string":$=="m/d/yy"&&k.dateNF?ge=k.dateNF:ge=$;break;case"number":$==14&&k.dateNF?ge=k.dateNF:ge=(k.table!=null?k.table:v)[$],ge==null&&(ge=k.table&&k.table[y[$]]||v[y[$]]),ge==null&&(ge=b[$]||"General");break}if(l(ge,0))return G(P,k);P instanceof Date&&(P=T(P,k.date1904));var q=we(ge,P);if(l(q[1]))return G(P,k);if(P===!0)P="TRUE";else if(P===!1)P="FALSE";else if(P===""||P==null)return"";return ie(q[1],P,k,q[0])}function J($,P){if(typeof P!="number"){P=+P||-1;for(var k=0;k<392;++k){if(v[k]==null){P<0&&(P=k);continue}if(v[k]==$){P=k;break}}P<0&&(P=391)}return v[P]=$,P}t.load=J,t._table=v,t.get_table=function(){return v},t.load_table=function(P){for(var k=0;k!=392;++k)P[k]!==void 0&&J(P[k],k)},t.init_table=g,t.format=Se};JN(Aa);const ze=bt,pd={latin:{halfRE:/[!-~]/g,fullRE:/[！-～]/g,delta:65248},hangul1:{halfRE:/[ﾡ-ﾾ]/g,fullRE:/[ᆨ-ᇂ]/g,delta:-60921},hangul2:{halfRE:/[ￂ-ￜ]/g,fullRE:/[ᅡ-ᅵ]/g,delta:-61025},kana:{delta:0,half:"\uFF61\uFF62\uFF63\uFF64\uFF65\uFF66\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\uFF71\uFF72\uFF73\uFF74\uFF75\uFF76\uFF77\uFF78\uFF79\uFF7A\uFF7B\uFF7C\uFF7D\uFF7E\uFF7F\uFF80\uFF81\uFF82\uFF83\uFF84\uFF85\uFF86\uFF87\uFF88\uFF89\uFF8A\uFF8B\uFF8C\uFF8D\uFF8E\uFF8F\uFF90\uFF91\uFF92\uFF93\uFF94\uFF95\uFF96\uFF97\uFF98\uFF99\uFF9A\uFF9B\uFF9C\uFF9D\uFF9E\uFF9F",full:"\u3002\u300C\u300D\u3001\u30FB\u30F2\u30A1\u30A3\u30A5\u30A7\u30A9\u30E3\u30E5\u30E7\u30C3\u30FC\u30A2\u30A4\u30A6\u30A8\u30AA\u30AB\u30AD\u30AF\u30B1\u30B3\u30B5\u30B7\u30B9\u30BB\u30BD\u30BF\u30C1\u30C4\u30C6\u30C8\u30CA\u30CB\u30CC\u30CD\u30CE\u30CF\u30D2\u30D5\u30D8\u30DB\u30DE\u30DF\u30E0\u30E1\u30E2\u30E4\u30E6\u30E8\u30E9\u30EA\u30EB\u30EC\u30ED\u30EF\u30F3\u309B\u309C"},extras:{delta:0,half:"\xA2\xA3\xAC\xAF\xA6\xA5\u20A9 |\u2190\u2191\u2192\u2193\u25A0\xB0",full:"\uFFE0\uFFE1\uFFE2\uFFE3\uFFE4\uFFE5\uFFE6\u3000\uFFE8\uFFE9\uFFEA\uFFEB\uFFEC\uFFED\uFFEE"}},eA=e=>t=>e.delta?String.fromCharCode(t.charCodeAt(0)+e.delta):[...e.full][[...e.half].indexOf(t)],tA=e=>t=>e.delta?String.fromCharCode(t.charCodeAt(0)-e.delta):[...e.half][[...e.full].indexOf(t)],yg=(e,t)=>e[`${t}RE`]||new RegExp(`[${e[t]}]`,"g"),Eg=Object.keys(pd).map(e=>pd[e]),rA=e=>Eg.reduce((t,r)=>t.replace(yg(r,"half"),eA(r)),e),nA=e=>Eg.reduce((t,r)=>t.replace(yg(r,"full"),tA(r)),e),Lt={ASC:e=>(e=ze.accept(e,w.STRING),nA(e)),BAHTTEXT:e=>{e=ze.accept(e,w.NUMBER);try{return lc.exports.bahttext(e)}catch(t){throw Error(`Error in https://github.com/jojoee/bahttext 
${t.toString()}`)}},CHAR:e=>{if(e=ze.accept(e,w.NUMBER),e>255||e<1)throw S.VALUE;return String.fromCharCode(e)},CLEAN:e=>(e=ze.accept(e,w.STRING),e.replace(/[\x00-\x1F]/g,"")),CODE:e=>{if(e=ze.accept(e,w.STRING),e.length===0)throw S.VALUE;return e.charCodeAt(0)},CONCAT:(...e)=>{let t="";return ze.flattenParams(e,w.STRING,!1,r=>{r=ze.accept(r,w.STRING),t+=r}),t},CONCATENATE:(...e)=>{let t="";if(e.length===0)throw Error("CONCATENATE need at least one argument.");return e.forEach(r=>{r=ze.accept(r,w.STRING),t+=r}),t},DBCS:e=>(e=ze.accept(e,w.STRING),rA(e)),DOLLAR:(e,t)=>{e=ze.accept(e,w.NUMBER),t=ze.accept(t,w.NUMBER,2);const r=Array(t).fill("0").join("");return Aa.format(`$#,##0.${r}_);($#,##0.${r})`,e).trim()},EXACT:(e,t)=>(e=ze.accept(e,[w.STRING]),t=ze.accept(t,[w.STRING]),e===t),FIND:(e,t,r)=>{if(e=ze.accept(e,w.STRING),t=ze.accept(t,w.STRING),r=ze.accept(r,w.NUMBER,1),r<1||r>t.length)throw S.VALUE;const n=t.indexOf(e,r-1);if(n===-1)throw S.VALUE;return n+1},FINDB:(e,t,r)=>Lt.FIND(e,t,r),FIXED:(e,t,r)=>{e=ze.accept(e,w.NUMBER),t=ze.accept(t,w.NUMBER,2),r=ze.accept(r,w.BOOLEAN,!1);const n=Array(t).fill("0").join(""),a=r?"":"#,";return Aa.format(`${a}##0.${n}_);(${a}##0.${n})`,e).trim()},LEFT:(e,t)=>{if(e=ze.accept(e,w.STRING),t=ze.accept(t,w.NUMBER,1),t<0)throw S.VALUE;return t>e.length?e:e.slice(0,t)},LEFTB:(e,t)=>Lt.LEFT(e,t),LEN:e=>(e=ze.accept(e,w.STRING),e.length),LENB:e=>Lt.LEN(e),LOWER:e=>(e=ze.accept(e,w.STRING),e.toLowerCase()),MID:(e,t,r)=>{if(e=ze.accept(e,w.STRING),t=ze.accept(t,w.NUMBER),r=ze.accept(r,w.NUMBER),t>e.length)return"";if(t<1||r<1)throw S.VALUE;return e.slice(t-1,t+r-1)},MIDB:(e,t,r)=>Lt.MID(e,t,r),NUMBERVALUE:(e,t,r)=>{if(e=ze.accept(e,w.STRING),t=ze.accept(t,w.STRING,"."),r=ze.accept(r,w.STRING,","),e.length===0)return 0;if(t.length===0||r.length===0||(t=t[0],r=r[0],t===r||e.indexOf(t)<e.lastIndexOf(r)))throw S.VALUE;const n=e.replace(r,"").replace(t,".").replace(/[^\-0-9.%()]/g,"").match(/([(-]*)([0-9]*[.]*[0-9]+)([)]?)([%]*)/);if(!n)throw S.VALUE;const a=n[1].length,i=n[3].length,s=n[4].length;let f=Number(n[2]);if(a>1||a&&!i||!a&&i||isNaN(f))throw S.VALUE;return f/=100**s,a?-f:f},PHONETIC:()=>{},PROPER:e=>(e=ze.accept(e,[w.STRING]),e=e.toLowerCase(),e=e.charAt(0).toUpperCase()+e.slice(1),e.replace(/(?:[^a-zA-Z])([a-zA-Z])/g,t=>t.toUpperCase())),REPLACE:(e,t,r,n)=>{e=ze.accept(e,[w.STRING]),t=ze.accept(t,[w.NUMBER]),r=ze.accept(r,[w.NUMBER]),n=ze.accept(n,[w.STRING]);const a=e.split("");return a.splice(t-1,r,n),a.join("")},REPLACEB:(e,t,r,n)=>Lt.REPLACE(e,t,r,n),REPT:(e,t)=>{e=ze.accept(e,w.STRING),t=ze.accept(t,w.NUMBER);let r="";for(let n=0;n<t;n++)r+=e;return r},RIGHT:(e,t)=>{if(e=ze.accept(e,w.STRING),t=ze.accept(t,w.NUMBER,1),t<0)throw S.VALUE;const r=e.length;return t>r?e:e.slice(r-t)},RIGHTB:(e,t)=>Lt.RIGHT(e,t),SEARCH:(e,t,r)=>{if(e=ze.accept(e,w.STRING),t=ze.accept(t,w.STRING),r=ze.accept(r,w.NUMBER,1),r<1||r>t.length)throw S.VALUE;const n=$r.isWildCard(e)?$r.toRegex(e,"i"):e,a=t.slice(r-1).search(n);if(a===-1)throw S.VALUE;return a+r},SEARCHB:(e,t,r)=>Lt.SEARCH(e,t,r),SUBSTITUTE:(...e)=>{throw S.NOT_IMPLEMENTED("SUBSTITUTE")},T:e=>(e=ze.accept(e),typeof e=="string"?e:""),TEXT:(e,t)=>{e=ze.accept(e,w.NUMBER),t=ze.accept(t,w.STRING);try{return Aa.format(t,e)}catch(r){throw console.error(r),S.VALUE}},TEXTJOIN:(...e)=>{},TRIM:e=>(e=ze.accept(e,[w.STRING]),e.replace(/^\s+|\s+$/g,"")),UNICHAR:e=>{if(e=ze.accept(e,[w.NUMBER]),e<=0)throw S.VALUE;return String.fromCharCode(e)},UNICODE:e=>Lt.CODE(e)},wt=bt,go=1e3*60*60*24,uc=new Date(Date.UTC(1900,0,1)),aA=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],iA=[void 0,[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],void 0,void 0,void 0,void 0,void 0,void 0,void 0,[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],vd=[void 0,[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]],oA=/^\s*(\d\d?)\s*(:\s*\d\d?)?\s*(:\s*\d\d?)?\s*(pm|am)?\s*$/i,sA=/^\s*((\d\d?)\s*([-/])\s*(\d\d?))([\d:.apm\s]*)$/i,lA=/^\s*((\d\d?)\s*([-/])\s*(jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*))([\d:.apm\s]*)$/i,cA=/^\s*((jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*)\s*([-/])\s*(\d\d?))([\d:.apm\s]*)$/i;function uA(e){const t=e.match(sA),r=e.match(lA),n=e.match(cA);return t?e=t[1]+t[3]+new Date().getFullYear()+t[5]:r?e=r[1]+r[3]+new Date().getFullYear()+r[5]:n&&(e=n[1]+n[3]+new Date().getFullYear()+n[5]),new Date(Date.parse(`${e} UTC`))}function fA(e){const t=e.match(oA);if(!t)return null;const r=t[2]?t[2]:":00",n=t[3]?t[3]:":00",a=t[4]?` ${t[4]}`:"",i=new Date(Date.parse(`1/1/1900 ${t[1]+r+n+a} UTC`));let s=new Date;return s=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds())),new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds(),i.getUTCMilliseconds()))}function xn(e){const t=e>-22038912e5?2:1;return Math.floor((e-uc.getTime())/864e5)+t}function dA(e){if(e<0)throw S.VALUE;return e<=60?new Date(uc.getTime()+(e-1)*864e5):new Date(uc.getTime()+(e-2)*864e5)}function _g(e){if(e instanceof Date)return{date:e};e=wt.accept(e);let t=!0,r;return isNaN(e)?(r=fA(e),r?t=!1:r=uA(e)):(e=Number(e),r=dA(e)),{date:r,isDateGiven:t}}function lt(e){return _g(e).date}function hl(e,t){return e.getUTCFullYear()===t.getUTCFullYear()&&e.getUTCMonth()===t.getUTCMonth()&&e.getUTCDate()===t.getUTCDate()}function hA(e){return e===1900?!0:new Date(e,1,29).getMonth()===1}const An={DATE:(e,t,r)=>{if(e=wt.accept(e,w.NUMBER),t=wt.accept(t,w.NUMBER),r=wt.accept(r,w.NUMBER),e<0||e>=1e4)throw S.NUM;return e<1900&&(e+=1900),xn(Date.UTC(e,t-1,r))},DATEDIF:(e,t,r)=>{if(e=lt(e),t=lt(t),r=wt.accept(r,w.STRING).toLowerCase(),e>t)throw S.NUM;const n=t.getUTCFullYear()-e.getUTCFullYear(),a=t.getUTCMonth()-e.getUTCMonth(),i=t.getUTCDate()-e.getUTCDate();let s;switch(r){case"y":return s=a<0||a===0&&i<0?-1:0,s+n;case"m":return s=i<0?-1:0,n*12+a+s;case"d":return Math.floor(t-e)/go;case"md":return e.setUTCFullYear(t.getUTCFullYear()),i<0?e.setUTCMonth(t.getUTCMonth()-1):e.setUTCMonth(t.getUTCMonth()),Math.floor(t-e)/go;case"ym":return s=i<0?-1:0,(s+n*12+a)%12;case"yd":return a<0||a===0&&i<0?e.setUTCFullYear(t.getUTCFullYear()-1):e.setUTCFullYear(t.getUTCFullYear()),Math.floor(t-e)/go}},DATEVALUE:e=>{e=wt.accept(e,w.STRING);const{date:t,isDateGiven:r}=_g(e);if(!r)return 0;const n=xn(t);if(n<0||n>2958465)throw S.VALUE;return n},DAY:e=>lt(e).getUTCDate(),DAYS:(e,t)=>{e=lt(e),t=lt(t);let r=0;return t<-22038912e5&&e>-22038912e5&&(r=1),Math.floor(e-t)/go+r},DAYS360:(e,t,r)=>{e=lt(e),t=lt(t),r=wt.accept(r,w.BOOLEAN,!1),e.getUTCDate()===31&&e.setUTCDate(30),!r&&e.getUTCDate()<30&&t.getUTCDate()>30?t.setUTCMonth(t.getUTCMonth()+1,1):t.getUTCDate()===31&&t.setUTCDate(30);const n=t.getUTCFullYear()-e.getUTCFullYear(),a=t.getUTCMonth()-e.getUTCMonth(),i=t.getUTCDate()-e.getUTCDate();return a*30+i+n*12*30},EDATE:(e,t)=>(e=lt(e),t=wt.accept(t,w.NUMBER),e.setUTCMonth(e.getUTCMonth()+t),xn(e)),EOMONTH:(e,t)=>(e=lt(e),t=wt.accept(t,w.NUMBER),e.setUTCMonth(e.getUTCMonth()+t+1,0),xn(e)),HOUR:e=>lt(e).getUTCHours(),ISOWEEKNUM:e=>{const t=lt(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),n=r.getUTCDay();r.setUTCDate(r.getUTCDate()+4-n);const a=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r.getTime()-a.getTime())/864e5+1)/7)},MINUTE:e=>lt(e).getUTCMinutes(),MONTH:e=>lt(e).getUTCMonth()+1,NETWORKDAYS:(e,t,r)=>{e=lt(e),t=lt(t);let n=1;if(e>t){n=-1;const s=e;e=t,t=s}const a=[];r!=null&&wt.flattenParams([r],w.NUMBER,!1,s=>{a.push(lt(s))});let i=0;for(;e<=t;){if(e.getUTCDay()!==0&&e.getUTCDay()!==6){let s=!1;for(let f=0;f<a.length;f++)if(hl(e,a[f])){s=!0;break}s||i++}e.setUTCDate(e.getUTCDate()+1)}return n*i},"NETWORKDAYS.INTL":(e,t,r,n)=>{e=lt(e),t=lt(t);let a=1;if(e>t){a=-1;const f=e;e=t,t=f}if(r=wt.accept(r,null,1),r==="1111111")return 0;if(typeof r=="string"&&Number(r).toString()!==r){if(r.length!==7)throw S.VALUE;r=r.charAt(6)+r.slice(0,6);const f=[];for(let h=0;h<r.length;h++)r.charAt(h)==="1"&&f.push(h);r=f}else{if(typeof r!="number")throw S.VALUE;r=vd[r]}const i=[];n!=null&&wt.flattenParams([n],w.NUMBER,!1,f=>{i.push(lt(f))});let s=0;for(;e<=t;){let f=!1;for(let h=0;h<r.length;h++)if(r[h]===e.getUTCDay()){f=!0;break}if(!f){let h=!1;for(let c=0;c<i.length;c++)if(hl(e,i[c])){h=!0;break}h||s++}e.setUTCDate(e.getUTCDate()+1)}return a*s},NOW:()=>{const e=new Date;return xn(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))+(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},SECOND:e=>lt(e).getUTCSeconds(),TIME:(e,t,r)=>{if(e=wt.accept(e,w.NUMBER),t=wt.accept(t,w.NUMBER),r=wt.accept(r,w.NUMBER),e<0||e>32767||t<0||t>32767||r<0||r>32767)throw S.NUM;return(3600*e+60*t+r)/86400},TIMEVALUE:e=>(e=lt(e),(3600*e.getUTCHours()+60*e.getUTCMinutes()+e.getUTCSeconds())/86400),TODAY:()=>{const e=new Date;return xn(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))},WEEKDAY:(e,t)=>{const r=lt(e);t=wt.accept(t,w.NUMBER,1);const n=r.getUTCDay(),a=iA[t];if(!a)throw S.NUM;return a[n]},WEEKNUM:(e,t)=>{const r=lt(e);if(t=wt.accept(t,w.NUMBER,1),t===21)return An.ISOWEEKNUM(e);const n=aA[t],a=new Date(Date.UTC(r.getUTCFullYear(),0,1)),i=a.getUTCDay()<n?1:0;return Math.ceil(((r-a.getTime())/864e5+1)/7)+i},WORKDAY:(e,t,r)=>An["WORKDAY.INTL"](e,t,1,r),"WORKDAY.INTL":(e,t,r,n)=>{if(e=lt(e),t=wt.accept(t,w.NUMBER),r=wt.accept(r,null,1),r==="1111111")throw S.VALUE;if(typeof r=="string"&&Number(r).toString()!==r){if(r.length!==7)throw S.VALUE;r=r.charAt(6)+r.slice(0,6);const s=[];for(let f=0;f<r.length;f++)r.charAt(f)==="1"&&s.push(f);r=s}else{if(typeof r!="number")throw S.VALUE;if(r=vd[r],r==null)throw S.NUM}const a=[];n!=null&&wt.flattenParams([n],w.NUMBER,!1,s=>{a.push(lt(s))}),e.setUTCDate(e.getUTCDate()+1);let i=0;for(;i<t;){let s=!1;for(let f=0;f<r.length;f++)if(r[f]===e.getUTCDay()){s=!0;break}if(!s){let f=!1;for(let h=0;h<a.length;h++)if(hl(e,a[h])){f=!0;break}f||i++}e.setUTCDate(e.getUTCDate()+1)}return xn(e)-1},YEAR:e=>lt(e).getUTCFullYear(),YEARFRAC:(e,t,r)=>{if(e=lt(e),t=lt(t),e>t){const c=e;e=t,t=c}if(r=wt.accept(r,w.NUMBER,0),r=Math.trunc(r),r<0||r>4)throw S.VALUE;let n=e.getUTCDate();const a=e.getUTCMonth()+1,i=e.getUTCFullYear();let s=t.getUTCDate();const f=t.getUTCMonth()+1,h=t.getUTCFullYear();switch(r){case 0:return n===31&&s===31?(n=30,s=30):n===31?n=30:n===30&&s===31&&(s=30),Math.abs(s+f*30+h*360-(n+a*30+i*360))/360;case 1:if(h-i<2){const u=hA(i)&&i!==1900?366:365;return An.DAYS(t,e)/u}const c=h-i+1,l=(new Date(h+1,0,1).getTime()-new Date(i,0,1).getTime())/1e3/60/60/24/c;return An.DAYS(t,e)/l;case 2:return Math.abs(An.DAYS(t,e)/360);case 3:return Math.abs(An.DAYS(t,e)/365);case 4:return Math.abs(s+f*30+h*360-(n+a*30+i*360))/360}throw S.VALUE}},pA={unaryOp:(e,t,r)=>{let n=1;if(e.forEach(a=>{if(a!=="+")if(a==="-")n=-n;else throw new Error(`Unrecognized prefix: ${a}`)}),t==null&&(t=0),n===1)return t;try{t=bt.acceptNumber(t,r)}catch(a){if(a instanceof S)Array.isArray(t)&&(t=t[0][0]);else throw a}return typeof t=="number"&&isNaN(t)?S.VALUE:-t}},vA={percentOp:(e,t,r)=>{try{e=bt.acceptNumber(e,r)}catch(n){if(n instanceof S)return n;throw n}if(t==="%")return e/100;throw new Error(`Unrecognized postfix: ${t}`)}},En={boolean:3,string:2,number:1},Ca={compareOp:(e,t,r,n,a)=>{e==null&&(e=0),r==null&&(r=0),n&&(e=e[0][0]),a&&(r=r[0][0]);const i=typeof e,s=typeof r;if(i===s)switch(t){case"=":return e===r;case">":return e>r;case"<":return e<r;case"<>":return e!==r;case"<=":return e<=r;case">=":return e>=r}else switch(t){case"=":return!1;case">":return En[i]>En[s];case"<":return En[i]<En[s];case"<>":return!0;case"<=":return En[i]<=En[s];case">=":return En[i]>=En[s]}throw Error("Infix.compareOp: Should not reach here.")},concatOp:(e,t,r,n,a)=>{e==null&&(e=""),r==null&&(r=""),n&&(e=e[0][0]),a&&(r=r[0][0]);const i=typeof e,s=typeof r;return i==="boolean"&&(e=e?"TRUE":"FALSE"),s==="boolean"&&(r=r?"TRUE":"FALSE"),`${e}${r}`},mathOp:(e,t,r,n,a)=>{e==null&&(e=0),r==null&&(r=0);try{e=bt.acceptNumber(e,n),r=bt.acceptNumber(r,a)}catch(i){if(i instanceof S)return i;throw i}switch(t){case"+":return e+r;case"-":return e-r;case"*":return e*r;case"/":return r===0?S.DIV0:e/r;case"^":return e**r}throw Error("Infix.mathOp: Should not reach here.")}},pl={compareOp:["<",">","=","<>","<=",">="],concatOp:["&"],mathOp:["+","-","*","/","^"]},Ie=bt,vl=[],gl=[];function wo(e){return e<=100?mg[e]:vl[e]>0?vl[e]:vl[e]=wo(e-1)*e}function bg(e){return e===1||e===0?1:e===2?2:gl[e]>0?gl[e]:gl[e]=bg(e-2)*e}const Dt={ABS:e=>(e=Ie.accept(e,w.NUMBER),Math.abs(e)),AGGREGATE:(e,t,r,...n)=>{},ARABIC:e=>{if(e=Ie.accept(e,w.STRING).toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))throw new S("#VALUE!","Invalid roman numeral in ARABIC evaluation.");let t=0;const r={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,n=>{t+=r[n]}),t},BASE:(e,t,r)=>{if(e=Ie.accept(e,w.NUMBER),e<0||e>=2**53||(t=Ie.accept(t,w.NUMBER),t<2||t>36)||(r=Ie.accept(r,w.NUMBER,0),r<0))throw S.NUM;const n=e.toString(t).toUpperCase();return new Array(Math.max(r+1-n.length,0)).join("0")+n},CEILING:(e,t)=>{if(e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER),t===0)return 0;if(e/t%1===0)return e;const r=Math.abs(t),n=Math.floor(Math.abs(e)/r);return e<0?t<0?-r*(n+1):-r*n:(n+1)*r},"CEILING.MATH":(e,t,r)=>{if(e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER,e>0?1:-1),r=Ie.accept(r,w.NUMBER,0),e>=0)return Dt.CEILING(e,t);const n=r?t:0;return Dt.CEILING(e,t)-n},"CEILING.PRECISE":(e,t)=>(e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER,1),Dt.CEILING(e,Math.abs(t))),COMBIN:(e,t)=>{if(e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER),e<0||t<0||e<t)throw S.NUM;const r=Dt.FACT(e),n=Dt.FACT(t);return r/n/Dt.FACT(e-t)},COMBINA:(e,t)=>{if(e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER),(e===0||e===1)&&t===0)return 1;if(e<0||t<0)throw S.NUM;return Dt.COMBIN(e+t-1,e-1)},DECIMAL:(e,t)=>{if(e=Ie.accept(e,w.STRING),t=Ie.accept(t,w.NUMBER),t=Math.trunc(t),t<2||t>36)throw S.NUM;const r=parseInt(e,t);if(isNaN(r))throw S.NUM;return r},DEGREES:e=>(e=Ie.accept(e,w.NUMBER),e*(180/Math.PI)),EVEN:e=>Dt.CEILING(e,-2),EXP:e=>(e=Ie.accept(e,w.NUMBER),Math.exp(e)),FACT:e=>{if(e=Ie.accept(e,w.NUMBER),e=Math.trunc(e),e>170||e<0)throw S.NUM;return e<=100?mg[e]:wo(e)},FACTDOUBLE:e=>{if(e=Ie.accept(e,w.NUMBER),e=Math.trunc(e),e<-1)throw S.NUM;return e===-1?1:bg(e)},FLOOR:(e,t)=>{if(e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER),t===0)return 0;if(e>0&&t<0)throw S.NUM;if(e/t%1===0)return e;const r=Math.abs(t),n=Math.floor(Math.abs(e)/r);return e<0?t<0?-r*n:-r*(n+1):n*r},"FLOOR.MATH":(e,t,r)=>(e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER,e>0?1:-1),r=Ie.accept(r,w.NUMBER,0),r===0||e>=0?Dt.FLOOR(e,Math.abs(t)):Dt.FLOOR(e,t)+t),"FLOOR.PRECISE":(e,t)=>(e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER,1),Dt.FLOOR(e,Math.abs(t))),GCD:(...e)=>{const t=[];Ie.flattenParams(e,null,!1,s=>{if(s=typeof s=="boolean"?NaN:Number(s),isNaN(s))throw S.VALUE;if(s<0||s>9007199254740990)throw S.NUM;t.push(Math.trunc(s))},0);let r,n;const a=e.length;let i=Math.abs(t[0]);for(r=1;r<a;r++){for(n=Math.abs(t[r]);i&&n;)i>n?i%=n:n%=i;i+=n}return i},INT:e=>(e=Ie.accept(e,w.NUMBER),Math.floor(e)),"ISO.CEILING":(e,t)=>Dt["CEILING.PRECISE"](e,t),LCM:(...e)=>{const t=[];Ie.flattenParams(e,null,!1,a=>{if(a=typeof a=="boolean"?NaN:Number(a),isNaN(a))throw S.VALUE;if(a<0||a>9007199254740990)throw S.NUM;t.push(Math.trunc(a))},1);const r=t.length;let n=Math.abs(t[0]);for(let a=1;a<r;a++){let i=Math.abs(t[a]);const s=n;for(;n&&i;)n>i?n%=i:i%=n;n=Math.abs(s*t[a])/(n+i)}return n},LN:e=>(e=Ie.accept(e,w.NUMBER),Math.log(e)),LOG:(e,t)=>(e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER,10),Math.log(e)/Math.log(t)),LOG10:e=>(e=Ie.accept(e,w.NUMBER),Math.log10(e)),MDETERM:e=>{if(e=Ie.accept(e,w.ARRAY,void 0,!1,!0),e[0].length!==e.length)throw S.VALUE;const t=e.length,r=e[0].length;let n=0,a,i;if(t===1)return e[0][0];if(t===2)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(let s=0;s<r;s++){a=e[0][s],i=e[0][s];for(let f=1;f<t;f++)i*=e[f][((s+f)%r+r)%r],a*=e[f][((s-f)%r+r)%r];n+=i-a}return n},MINVERSE:e=>{},MMULT:(e,t)=>{e=Ie.accept(e,w.ARRAY,void 0,!1,!0),t=Ie.accept(t,w.ARRAY,void 0,!1,!0);const r=e.length,n=e[0].length,a=t.length,i=t[0].length,s=new Array(r);if(n!==a)throw S.VALUE;for(let f=0;f<r;f++){s[f]=new Array(i);for(let h=0;h<i;h++){s[f][h]=0;for(let c=0;c<n;c++){const o=e[f][c],l=t[c][h];if(typeof o!="number"||typeof l!="number")throw S.VALUE;s[f][h]+=e[f][c]*t[c][h]}}}return s},MOD:(e,t)=>{if(e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER),t===0)throw S.DIV0;return e-t*Dt.INT(e/t)},MROUND:(e,t)=>{if(e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER),t===0)return 0;if(e>0&&t<0||e<0&&t>0)throw S.NUM;return e/t%1===0?e:Math.round(e/t)*t},MULTINOMIAL:(...e)=>{let t=0,r=1;return Ie.flattenParams(e,w.NUMBER,!1,n=>{if(n<0)throw S.NUM;t+=n,r*=wo(n)}),wo(t)/r},MUNIT:e=>{e=Ie.accept(e,w.NUMBER);const t=[];for(let r=0;r<e;r++){const n=[];for(let a=0;a<e;a++)r===a?n.push(1):n.push(0);t.push(n)}return t},ODD:e=>{if(e=Ie.accept(e,w.NUMBER),e===0)return 1;let t=Math.ceil(Math.abs(e));return t=t&1?t:t+1,e>0?t:-t},PI:()=>Math.PI,POWER:(e,t)=>(e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER),e**t),PRODUCT:(...e)=>{let t=1;return Ie.flattenParams(e,null,!0,(r,n)=>{const a=Number(r);n.isLiteral&&!isNaN(a)?t*=a:typeof r=="number"&&(t*=r)},1),t},QUOTIENT:(e,t)=>(e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER),Math.trunc(e/t)),RADIANS:e=>(e=Ie.accept(e,w.NUMBER),e/180*Math.PI),RAND:()=>Math.random(),RANDBETWEEN:(e,t)=>(e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER),Math.floor(Math.random()*(t-e+1)+e)),ROMAN:(e,t)=>{if(e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER,0),t!==0)throw Error("ROMAN: only allows form=0 (classic form).");const r=String(e).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let a="",i=3;for(;i--;)a=(n[+r.pop()+i*10]||"")+a;return new Array(+r.join("")+1).join("M")+a},ROUND:(e,t)=>{e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER);const r=10**Math.abs(t),n=e>0?1:-1;return t>0?n*Math.round(Math.abs(e)*r)/r:t===0?n*Math.round(Math.abs(e)):n*Math.round(Math.abs(e)/r)*r},ROUNDDOWN:(e,t)=>{e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER);const r=10**Math.abs(t),n=e>0?1:-1;if(t>0){const i=1/r*.5;return n*Math.round((Math.abs(e)-i)*r)/r}if(t===0)return n*Math.round(Math.abs(e)-.5);const a=r*.5;return n*Math.round((Math.abs(e)-a)/r)*r},ROUNDUP:(e,t)=>{e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER);const r=10**Math.abs(t),n=e>0?1:-1;if(t>0){const i=1/r*.5;return n*Math.round((Math.abs(e)+i)*r)/r}if(t===0)return n*Math.round(Math.abs(e)+.5);const a=r*.5;return n*Math.round((Math.abs(e)+a)/r)*r},SERIESSUM:(e,t,r,n)=>{e=Ie.accept(e,w.NUMBER),t=Ie.accept(t,w.NUMBER),r=Ie.accept(r,w.NUMBER);let a=0,i;return Ie.flattenParams([n],w.NUMBER,!1,s=>{if(typeof s!="number")throw S.VALUE;a===0?i=s*e**t:i+=s*e**(t+a*r),a++}),i},SIGN:e=>(e=Ie.accept(e,w.NUMBER),e>0?1:e===0?0:-1),SQRT:e=>{if(e=Ie.accept(e,w.NUMBER),e<0)throw S.NUM;return Math.sqrt(e)},SQRTPI:e=>{if(e=Ie.accept(e,w.NUMBER),e<0)throw S.NUM;return Math.sqrt(e*Math.PI)},SUBTOTAL:()=>{},SUM:(...e)=>{let t=0;return Ie.flattenParams(e,w.NUMBER,!0,(r,n)=>{n.isLiteral||typeof r=="number"?t+=r:Pr(r)&&(t+=Number(r))}),t},SUMIF:(e,t,r,n)=>{const a=Ie.retrieveRanges(e,t,n);t=a[0],n=a[1],r=Ie.retrieveArg(e,r);const i=r.isArray;r=cc.parse(Ie.accept(r));let s=0;return t.forEach((f,h)=>{f.forEach((c,o)=>{const l=n[h][o];typeof l=="number"&&(r.op==="wc"?r.match===r.value.test(c)&&(s+=l):Ca.compareOp(c,r.op,r.value,Array.isArray(c),i)&&(s+=l))})}),s},SUMIFS:()=>{},SUMPRODUCT:(e,...t)=>{e=Ie.accept(e,w.ARRAY,void 0,!1,!0),t.forEach(n=>{if(n=Ie.accept(n,w.ARRAY,void 0,!1,!0),e[0].length!==n[0].length||e.length!==n.length)throw S.VALUE;for(let a=0;a<e.length;a++)for(let i=0;i<e[0].length;i++)typeof e[a][i]!="number"&&(e[a][i]=0),typeof n[a][i]!="number"&&(n[a][i]=0),e[a][i]*=n[a][i]});let r=0;return e.forEach(n=>{n.forEach(a=>{r+=a})}),r},SUMSQ:(...e)=>{let t=0;return Ie.flattenParams(e,w.NUMBER,!0,(r,n)=>{(n.isLiteral||typeof r=="number")&&(t+=r**2)}),t},SUMX2MY2:(e,t)=>{const r=[],n=[];let a=0;if(Ie.flattenParams([e],null,!1,(i,s)=>{r.push(i)}),Ie.flattenParams([t],null,!1,(i,s)=>{n.push(i)}),r.length!==n.length)throw S.NA;for(let i=0;i<r.length;i++)typeof r[i]=="number"&&typeof n[i]=="number"&&(a+=r[i]**2-n[i]**2);return a},SUMX2PY2:(e,t)=>{const r=[],n=[];let a=0;if(Ie.flattenParams([e],null,!1,(i,s)=>{r.push(i)}),Ie.flattenParams([t],null,!1,(i,s)=>{n.push(i)}),r.length!==n.length)throw S.NA;for(let i=0;i<r.length;i++)typeof r[i]=="number"&&typeof n[i]=="number"&&(a+=r[i]**2+n[i]**2);return a},SUMXMY2:(e,t)=>{const r=[],n=[];let a=0;if(Ie.flattenParams([e],null,!1,(i,s)=>{r.push(i)}),Ie.flattenParams([t],null,!1,(i,s)=>{n.push(i)}),r.length!==n.length)throw S.NA;for(let i=0;i<r.length;i++)typeof r[i]=="number"&&typeof n[i]=="number"&&(a+=(r[i]-n[i])**2);return a},TRUNC:e=>(e=Ie.accept(e,w.NUMBER),Math.trunc(e))},Tt=bt,ca=2**27-1,gd={ACOS:e=>{if(e=Tt.accept(e,w.NUMBER),e>1||e<-1)throw S.NUM;return Math.acos(e)},ACOSH:e=>{if(e=Tt.accept(e,w.NUMBER),e<1)throw S.NUM;return Math.acosh(e)},ACOT:e=>(e=Tt.accept(e,w.NUMBER),Math.PI/2-Math.atan(e)),ACOTH:e=>{if(e=Tt.accept(e,w.NUMBER),Math.abs(e)<=1)throw S.NUM;return Math.atanh(1/e)},ASIN:e=>{if(e=Tt.accept(e,w.NUMBER),e>1||e<-1)throw S.NUM;return Math.asin(e)},ASINH:e=>(e=Tt.accept(e,w.NUMBER),Math.asinh(e)),ATAN:e=>(e=Tt.accept(e,w.NUMBER),Math.atan(e)),ATAN2:(e,t)=>{if(e=Tt.accept(e,w.NUMBER),t=Tt.accept(t,w.NUMBER),t===0&&e===0)throw S.DIV0;return Math.atan2(t,e)},ATANH:e=>{if(e=Tt.accept(e,w.NUMBER),Math.abs(e)>1)throw S.NUM;return Math.atanh(e)},COS:e=>{if(e=Tt.accept(e,w.NUMBER),Math.abs(e)>ca)throw S.NUM;return Math.cos(e)},COSH:e=>(e=Tt.accept(e,w.NUMBER),Math.cosh(e)),COT:e=>{if(e=Tt.accept(e,w.NUMBER),Math.abs(e)>ca)throw S.NUM;if(e===0)throw S.DIV0;return 1/Math.tan(e)},COTH:e=>{if(e=Tt.accept(e,w.NUMBER),e===0)throw S.DIV0;return 1/Math.tanh(e)},CSC:e=>{if(e=Tt.accept(e,w.NUMBER),Math.abs(e)>ca)throw S.NUM;return 1/Math.sin(e)},CSCH:e=>{if(e=Tt.accept(e,w.NUMBER),e===0)throw S.DIV0;return 1/Math.sinh(e)},SEC:e=>{if(e=Tt.accept(e,w.NUMBER),Math.abs(e)>ca)throw S.NUM;return 1/Math.cos(e)},SECH:e=>(e=Tt.accept(e,w.NUMBER),1/Math.cosh(e)),SIN:e=>{if(e=Tt.accept(e,w.NUMBER),Math.abs(e)>ca)throw S.NUM;return Math.sin(e)},SINH:e=>(e=Tt.accept(e,w.NUMBER),Math.sinh(e)),TAN:e=>{if(e=Tt.accept(e,w.NUMBER),Math.abs(e)>ca)throw S.NUM;return Math.tan(e)},TANH:e=>(e=Tt.accept(e,w.NUMBER),Math.tanh(e))},_r=bt;function ml(e){let t=0,r=0;return _r.flattenParams(e,null,!0,n=>{const a=typeof n;a==="string"?n==="TRUE"?n=!0:n==="FALSE"&&(n=!1):a==="number"&&(n=Boolean(n)),typeof n=="boolean"&&(n===!0?t++:r++)}),[t,r]}const md={AND:(...e)=>{const[t,r]=ml(e);return t===0&&r===0?S.VALUE:t>0&&r===0},FALSE:()=>!1,IF:(e,t,r,n)=>(t=_r.accept(t,w.BOOLEAN),r=_r.accept(r),n=_r.accept(n,null,!1),t?r:n),IFERROR:(e,t)=>e.value instanceof S?_r.accept(t):_r.accept(e),IFNA(e,t){if(arguments.length>2)throw S.TOO_MANY_ARGS("IFNA");return S.NA.equals(e.value)?_r.accept(t):_r.accept(e)},IFS:(...e)=>{if(e.length%2!==0)return new S("#N/A","IFS expects all arguments after position 0 to be in pairs.");for(let t=0;t<e.length/2;t++){const r=_r.accept(e[t*2],w.BOOLEAN),n=_r.accept(e[t*2+1]);if(r)return n}return S.NA},NOT:e=>(e=_r.accept(e,w.BOOLEAN),!e),OR:(...e)=>{const[t,r]=ml(e);return t===0&&r===0?S.VALUE:t>0},SWITCH:(...e)=>{},TRUE:()=>!0,XOR:(...e)=>{const[t,r]=ml(e);return t===0&&r===0?S.VALUE:t%2===1}};var fi={};(function(e){(function(t){t(typeof DO_NOT_EXPORT_BESSEL=="undefined"?e:{})})(function(t){t.version="1.0.2";var r=Math;function n(o,l){for(var u=0,d=0;u<o.length;++u)d=l*d+o[u];return d}function a(o,l,u,d,g){if(l===0)return u;if(l===1)return d;for(var v=2/o,y=d,m=1;m<l;++m)y=d*m*v+g*u,u=d,d=y;return y}function i(o,l,u,d,g){return function(y,m){if(d){if(y===0)return d==1?-1/0:1/0;if(y<0)return NaN}if(m===0)return o(y);if(m===1)return l(y);if(m<0)return NaN;m|=0;var b=o(y),E=l(y);return a(y,m,b,E,g)}}var s=function(){var o=.636619772,l=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),u=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),d=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),g=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function v(R){var C=0,O=0,T=0,A=R*R;if(R<8)O=n(l,A),T=n(u,A),C=O/T;else{var L=R-.785398164;A=64/A,O=n(d,A),T=n(g,A),C=r.sqrt(o/R)*(r.cos(L)*O-r.sin(L)*T*8/R)}return C}var y=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),m=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),b=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),E=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function N(R){var C=0,O=0,T=0,A=R*R,L=r.abs(R)-2.356194491;return Math.abs(R)<8?(O=R*n(y,A),T=n(m,A),C=O/T):(A=64/A,O=n(b,A),T=n(E,A),C=r.sqrt(o/r.abs(R))*(r.cos(L)*O-r.sin(L)*T*8/r.abs(R)),R<0&&(C=-C)),C}return function R(C,O){if(O=Math.round(O),!isFinite(C))return isNaN(C)?C:0;if(O<0)return(O%2?-1:1)*R(C,-O);if(C<0)return(O%2?-1:1)*R(-C,O);if(O===0)return v(C);if(O===1)return N(C);if(C===0)return 0;var T=0;if(C>O)T=a(C,O,v(C),N(C),-1);else{for(var A=2*r.floor((O+r.floor(r.sqrt(40*O)))/2),L=!1,G=0,H=0,Y=1,K=0,ce=2/C,V=A;V>0;V--)K=V*ce*Y-G,G=Y,Y=K,r.abs(Y)>1e10&&(Y*=1e-10,G*=1e-10,T*=1e-10,H*=1e-10),L&&(H+=Y),L=!L,V==O&&(T=G);H=2*H-Y,T/=H}return T}}(),f=function(){var o=.636619772,l=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),u=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),d=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),g=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function v(R){var C=0,O=0,T=0,A=R*R,L=R-.785398164;return R<8?(O=n(l,A),T=n(u,A),C=O/T+o*s(R,0)*r.log(R)):(A=64/A,O=n(d,A),T=n(g,A),C=r.sqrt(o/R)*(r.sin(L)*O+r.cos(L)*T*8/R)),C}var y=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),m=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),b=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),E=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function N(R){var C=0,O=0,T=0,A=R*R,L=R-2.356194491;return R<8?(O=R*n(y,A),T=n(m,A),C=O/T+o*(s(R,1)*r.log(R)-1/R)):(A=64/A,O=n(b,A),T=n(E,A),C=r.sqrt(o/R)*(r.sin(L)*O+r.cos(L)*T*8/R)),C}return i(v,N,"BESSELY",1,-1)}(),h=function(){var o=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),l=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function u(y){return y<=3.75?n(o,y*y/(3.75*3.75)):r.exp(r.abs(y))/r.sqrt(r.abs(y))*n(l,3.75/r.abs(y))}var d=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),g=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function v(y){return y<3.75?y*n(d,y*y/(3.75*3.75)):(y<0?-1:1)*r.exp(r.abs(y))/r.sqrt(r.abs(y))*n(g,3.75/r.abs(y))}return function y(m,b){if(b=Math.round(b),b===0)return u(m);if(b===1)return v(m);if(b<0)return NaN;if(r.abs(m)===0)return 0;if(m==1/0)return 1/0;var E=0,N,R=2/r.abs(m),C=0,O=1,T=0,A=2*r.round((b+r.round(r.sqrt(40*b)))/2);for(N=A;N>0;N--)T=N*R*O+C,C=O,O=T,r.abs(O)>1e10&&(O*=1e-10,C*=1e-10,E*=1e-10),N==b&&(E=C);return E*=y(m,0)/O,m<0&&b%2?-E:E}}(),c=function(){var o=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),l=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function u(y){return y<=2?-r.log(y/2)*h(y,0)+n(o,y*y/4):r.exp(-y)/r.sqrt(y)*n(l,2/y)}var d=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),g=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function v(y){return y<=2?r.log(y/2)*h(y,1)+1/y*n(d,y*y/4):r.exp(-y)/r.sqrt(y)*n(g,2/y)}return i(u,v,"BESSELK",2,1)}();t.besselj=s,t.bessely=f,t.besseli=h,t.besselk=c})})(fi);var Ng={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Te,function(){var r=function(n,a){var i=Array.prototype.concat,s=Array.prototype.slice,f=Object.prototype.toString;function h(b,E){var N=b>E?b:E;return n.pow(10,17-~~(n.log(N>0?N:-N)*n.LOG10E))}var c=Array.isArray||function(E){return f.call(E)==="[object Array]"};function o(b){return f.call(b)==="[object Function]"}function l(b){return typeof b=="number"?b-b===0:!1}function u(b){return i.apply([],b)}function d(){return new d._init(arguments)}d.fn=d.prototype,d._init=function(E){if(c(E[0]))if(c(E[0][0])){o(E[1])&&(E[0]=d.map(E[0],E[1]));for(var N=0;N<E[0].length;N++)this[N]=E[0][N];this.length=E[0].length}else this[0]=o(E[1])?d.map(E[0],E[1]):E[0],this.length=1;else if(l(E[0]))this[0]=d.seq.apply(null,E),this.length=1;else{if(E[0]instanceof d)return d(E[0].toArray());this[0]=[],this.length=1}return this},d._init.prototype=d.prototype,d._init.constructor=d,d.utils={calcRdx:h,isArray:c,isFunction:o,isNumber:l,toVector:u},d._random_fn=n.random,d.setRandom=function(E){if(typeof E!="function")throw new TypeError("fn is not a function");d._random_fn=E},d.extend=function(E){var N,R;if(arguments.length===1){for(R in E)d[R]=E[R];return this}for(N=1;N<arguments.length;N++)for(R in arguments[N])E[R]=arguments[N][R];return E},d.rows=function(E){return E.length||1},d.cols=function(E){return E[0].length||1},d.dimensions=function(E){return{rows:d.rows(E),cols:d.cols(E)}},d.row=function(E,N){return c(N)?N.map(function(R){return d.row(E,R)}):E[N]},d.rowa=function(E,N){return d.row(E,N)},d.col=function(E,N){if(c(N)){var R=d.arange(E.length).map(function(){return new Array(N.length)});return N.forEach(function(T,A){d.arange(E.length).forEach(function(L){R[L][A]=E[L][T]})}),R}for(var C=new Array(E.length),O=0;O<E.length;O++)C[O]=[E[O][N]];return C},d.cola=function(E,N){return d.col(E,N).map(function(R){return R[0]})},d.diag=function(E){for(var N=d.rows(E),R=new Array(N),C=0;C<N;C++)R[C]=[E[C][C]];return R},d.antidiag=function(E){for(var N=d.rows(E)-1,R=new Array(N),C=0;N>=0;N--,C++)R[C]=[E[C][N]];return R},d.transpose=function(E){var N=[],R,C,O,T,A;for(c(E[0])||(E=[E]),C=E.length,O=E[0].length,A=0;A<O;A++){for(R=new Array(C),T=0;T<C;T++)R[T]=E[T][A];N.push(R)}return N.length===1?N[0]:N},d.map=function(E,N,R){var C,O,T,A,L;for(c(E[0])||(E=[E]),O=E.length,T=E[0].length,A=R?E:new Array(O),C=0;C<O;C++)for(A[C]||(A[C]=new Array(T)),L=0;L<T;L++)A[C][L]=N(E[C][L],C,L);return A.length===1?A[0]:A},d.cumreduce=function(E,N,R){var C,O,T,A,L;for(c(E[0])||(E=[E]),O=E.length,T=E[0].length,A=R?E:new Array(O),C=0;C<O;C++)for(A[C]||(A[C]=new Array(T)),T>0&&(A[C][0]=E[C][0]),L=1;L<T;L++)A[C][L]=N(A[C][L-1],E[C][L]);return A.length===1?A[0]:A},d.alter=function(E,N){return d.map(E,N,!0)},d.create=function(E,N,R){var C=new Array(E),O,T;for(o(N)&&(R=N,N=E),O=0;O<E;O++)for(C[O]=new Array(N),T=0;T<N;T++)C[O][T]=R(O,T);return C};function g(){return 0}d.zeros=function(E,N){return l(N)||(N=E),d.create(E,N,g)};function v(){return 1}d.ones=function(E,N){return l(N)||(N=E),d.create(E,N,v)},d.rand=function(E,N){return l(N)||(N=E),d.create(E,N,d._random_fn)};function y(b,E){return b===E?1:0}d.identity=function(E,N){return l(N)||(N=E),d.create(E,N,y)},d.symmetric=function(E){var N=E.length,R,C;if(E.length!==E[0].length)return!1;for(R=0;R<N;R++)for(C=0;C<N;C++)if(E[C][R]!==E[R][C])return!1;return!0},d.clear=function(E){return d.alter(E,g)},d.seq=function(E,N,R,C){o(C)||(C=!1);var O=[],T=h(E,N),A=(N*T-E*T)/((R-1)*T),L=E,G;for(G=0;L<=N&&G<R;G++,L=(E*T+A*T*G)/T)O.push(C?C(L,G):L);return O},d.arange=function(E,N,R){var C=[],O;if(R=R||1,N===a&&(N=E,E=0),E===N||R===0)return[];if(E<N&&R<0)return[];if(E>N&&R>0)return[];if(R>0)for(O=E;O<N;O+=R)C.push(O);else for(O=E;O>N;O+=R)C.push(O);return C},d.slice=function(){function b(N,R,C,O){var T,A=[],L=N.length;if(R===a&&C===a&&O===a)return d.copy(N);if(R=R||0,C=C||N.length,R=R>=0?R:L+R,C=C>=0?C:L+C,O=O||1,R===C||O===0)return[];if(R<C&&O<0)return[];if(R>C&&O>0)return[];if(O>0)for(T=R;T<C;T+=O)A.push(N[T]);else for(T=R;T>C;T+=O)A.push(N[T]);return A}function E(N,R){var C,O;if(R=R||{},l(R.row)){if(l(R.col))return N[R.row][R.col];var T=d.rowa(N,R.row);return C=R.col||{},b(T,C.start,C.end,C.step)}if(l(R.col)){var A=d.cola(N,R.col);return O=R.row||{},b(A,O.start,O.end,O.step)}O=R.row||{},C=R.col||{};var L=b(N,O.start,O.end,O.step);return L.map(function(G){return b(G,C.start,C.end,C.step)})}return E}(),d.sliceAssign=function(E,N,R){var C,O;if(l(N.row)){if(l(N.col))return E[N.row][N.col]=R;N.col=N.col||{},N.col.start=N.col.start||0,N.col.end=N.col.end||E[0].length,N.col.step=N.col.step||1,C=d.arange(N.col.start,n.min(E.length,N.col.end),N.col.step);var T=N.row;return C.forEach(function(L,G){E[T][L]=R[G]}),E}if(l(N.col)){N.row=N.row||{},N.row.start=N.row.start||0,N.row.end=N.row.end||E.length,N.row.step=N.row.step||1,O=d.arange(N.row.start,n.min(E[0].length,N.row.end),N.row.step);var A=N.col;return O.forEach(function(L,G){E[L][A]=R[G]}),E}return R[0].length===a&&(R=[R]),N.row.start=N.row.start||0,N.row.end=N.row.end||E.length,N.row.step=N.row.step||1,N.col.start=N.col.start||0,N.col.end=N.col.end||E[0].length,N.col.step=N.col.step||1,O=d.arange(N.row.start,n.min(E.length,N.row.end),N.row.step),C=d.arange(N.col.start,n.min(E[0].length,N.col.end),N.col.step),O.forEach(function(L,G){C.forEach(function(H,Y){E[L][H]=R[G][Y]})}),E},d.diagonal=function(E){var N=d.zeros(E.length,E.length);return E.forEach(function(R,C){N[C][C]=R}),N},d.copy=function(E){return E.map(function(N){return l(N)?N:N.map(function(R){return R})})};var m=d.prototype;return m.length=0,m.push=Array.prototype.push,m.sort=Array.prototype.sort,m.splice=Array.prototype.splice,m.slice=Array.prototype.slice,m.toArray=function(){return this.length>1?s.call(this):s.call(this)[0]},m.map=function(E,N){return d(d.map(this,E,N))},m.cumreduce=function(E,N){return d(d.cumreduce(this,E,N))},m.alter=function(E){return d.alter(this,E),this},function(b){for(var E=0;E<b.length;E++)(function(N){m[N]=function(R){var C=this,O;return R?(setTimeout(function(){R.call(C,m[N].call(C))}),this):(O=d[N](this),c(O)?d(O):O)}})(b[E])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(b){for(var E=0;E<b.length;E++)(function(N){m[N]=function(R,C){var O=this;return C?(setTimeout(function(){C.call(O,m[N].call(O,R))}),this):d(d[N](this,R))}})(b[E])}("row col".split(" ")),function(b){for(var E=0;E<b.length;E++)(function(N){m[N]=function(){return d(d[N].apply(null,arguments))}})(b[E])}("create zeros ones rand identity".split(" ")),d}(Math);return function(n,a){var i=n.utils.isFunction;function s(c,o){return c-o}function f(c,o,l){return a.max(o,a.min(c,l))}n.sum=function(o){for(var l=0,u=o.length;--u>=0;)l+=o[u];return l},n.sumsqrd=function(o){for(var l=0,u=o.length;--u>=0;)l+=o[u]*o[u];return l},n.sumsqerr=function(o){for(var l=n.mean(o),u=0,d=o.length,g;--d>=0;)g=o[d]-l,u+=g*g;return u},n.sumrow=function(o){for(var l=0,u=o.length;--u>=0;)l+=o[u];return l},n.product=function(o){for(var l=1,u=o.length;--u>=0;)l*=o[u];return l},n.min=function(o){for(var l=o[0],u=0;++u<o.length;)o[u]<l&&(l=o[u]);return l},n.max=function(o){for(var l=o[0],u=0;++u<o.length;)o[u]>l&&(l=o[u]);return l},n.unique=function(o){for(var l={},u=[],d=0;d<o.length;d++)l[o[d]]||(l[o[d]]=!0,u.push(o[d]));return u},n.mean=function(o){return n.sum(o)/o.length},n.meansqerr=function(o){return n.sumsqerr(o)/o.length},n.geomean=function(o){return a.pow(n.product(o),1/o.length)},n.median=function(o){var l=o.length,u=o.slice().sort(s);return l&1?u[l/2|0]:(u[l/2-1]+u[l/2])/2},n.cumsum=function(o){return n.cumreduce(o,function(l,u){return l+u})},n.cumprod=function(o){return n.cumreduce(o,function(l,u){return l*u})},n.diff=function(o){var l=[],u=o.length,d;for(d=1;d<u;d++)l.push(o[d]-o[d-1]);return l},n.rank=function(c){var o,l=[],u={};for(o=0;o<c.length;o++){var d=c[o];u[d]?u[d]++:(u[d]=1,l.push(d))}var g=l.sort(s),v={},y=1;for(o=0;o<g.length;o++){var d=g[o],m=u[d],b=y,E=y+m-1,N=(b+E)/2;v[d]=N,y+=m}return c.map(function(R){return v[R]})},n.mode=function(o){var l=o.length,u=o.slice().sort(s),d=1,g=0,v=0,y=[],m;for(m=0;m<l;m++)u[m]===u[m+1]?d++:(d>g?(y=[u[m]],g=d,v=0):d===g&&(y.push(u[m]),v++),d=1);return v===0?y[0]:y},n.range=function(o){return n.max(o)-n.min(o)},n.variance=function(o,l){return n.sumsqerr(o)/(o.length-(l?1:0))},n.pooledvariance=function(o){var l=o.reduce(function(d,g){return d+n.sumsqerr(g)},0),u=o.reduce(function(d,g){return d+g.length},0);return l/(u-o.length)},n.deviation=function(c){for(var o=n.mean(c),l=c.length,u=new Array(l),d=0;d<l;d++)u[d]=c[d]-o;return u},n.stdev=function(o,l){return a.sqrt(n.variance(o,l))},n.pooledstdev=function(o){return a.sqrt(n.pooledvariance(o))},n.meandev=function(o){for(var l=n.mean(o),u=[],d=o.length-1;d>=0;d--)u.push(a.abs(o[d]-l));return n.mean(u)},n.meddev=function(o){for(var l=n.median(o),u=[],d=o.length-1;d>=0;d--)u.push(a.abs(o[d]-l));return n.median(u)},n.coeffvar=function(o){return n.stdev(o)/n.mean(o)},n.quartiles=function(o){var l=o.length,u=o.slice().sort(s);return[u[a.round(l/4)-1],u[a.round(l/2)-1],u[a.round(l*3/4)-1]]},n.quantiles=function(o,l,u,d){var g=o.slice().sort(s),v=[l.length],y=o.length,m,b,E,N,R,C;for(typeof u=="undefined"&&(u=3/8),typeof d=="undefined"&&(d=3/8),m=0;m<l.length;m++)b=l[m],E=u+b*(1-u-d),N=y*b+E,R=a.floor(f(N,1,y-1)),C=f(N-R,0,1),v[m]=(1-C)*g[R-1]+C*g[R];return v},n.percentile=function(o,l,u){var d=o.slice().sort(s),g=l*(d.length+(u?1:-1))+(u?0:1),v=parseInt(g),y=g-v;return v+1<d.length?d[v-1]+y*(d[v]-d[v-1]):d[v-1]},n.percentileOfScore=function(o,l,u){var d=0,g=o.length,v=!1,y,m;for(u==="strict"&&(v=!0),m=0;m<g;m++)y=o[m],(v&&y<l||!v&&y<=l)&&d++;return d/g},n.histogram=function(o,l){l=l||4;var u=n.min(o),d=(n.max(o)-u)/l,g=o.length,v=[],y;for(y=0;y<l;y++)v[y]=0;for(y=0;y<g;y++)v[a.min(a.floor((o[y]-u)/d),l-1)]+=1;return v},n.covariance=function(o,l){var u=n.mean(o),d=n.mean(l),g=o.length,v=new Array(g),y;for(y=0;y<g;y++)v[y]=(o[y]-u)*(l[y]-d);return n.sum(v)/(g-1)},n.corrcoeff=function(o,l){return n.covariance(o,l)/n.stdev(o,1)/n.stdev(l,1)},n.spearmancoeff=function(c,o){return c=n.rank(c),o=n.rank(o),n.corrcoeff(c,o)},n.stanMoment=function(o,l){for(var u=n.mean(o),d=n.stdev(o),g=o.length,v=0,y=0;y<g;y++)v+=a.pow((o[y]-u)/d,l);return v/o.length},n.skewness=function(o){return n.stanMoment(o,3)},n.kurtosis=function(o){return n.stanMoment(o,4)-3};var h=n.prototype;(function(c){for(var o=0;o<c.length;o++)(function(l){h[l]=function(u,d){var g=[],v=0,y=this;if(i(u)&&(d=u,u=!1),d)return setTimeout(function(){d.call(y,h[l].call(y,u))}),this;if(this.length>1){for(y=u===!0?this:this.transpose();v<y.length;v++)g[v]=n[l](y[v]);return g}return n[l](this[0],u)}})(c[o])})("cumsum cumprod".split(" ")),function(c){for(var o=0;o<c.length;o++)(function(l){h[l]=function(u,d){var g=[],v=0,y=this;if(i(u)&&(d=u,u=!1),d)return setTimeout(function(){d.call(y,h[l].call(y,u))}),this;if(this.length>1){for(l!=="sumrow"&&(y=u===!0?this:this.transpose());v<y.length;v++)g[v]=n[l](y[v]);return u===!0?n[l](n.utils.toVector(g)):g}return n[l](this[0],u)}})(c[o])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(c){for(var o=0;o<c.length;o++)(function(l){h[l]=function(){var u=[],d=0,g=this,v=Array.prototype.slice.call(arguments),y;if(i(v[v.length-1])){y=v[v.length-1];var m=v.slice(0,v.length-1);return setTimeout(function(){y.call(g,h[l].apply(g,m))}),this}else{y=void 0;var b=function(N){return n[l].apply(g,[N].concat(v))}}if(this.length>1){for(g=g.transpose();d<g.length;d++)u[d]=b(g[d]);return u}return b(this[0])}})(c[o])}("quantiles percentileOfScore".split(" "))}(r,Math),function(n,a){n.gammaln=function(s){var f=0,h=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],c=1.000000000190015,o,l,u;for(u=(l=o=s)+5.5,u-=(o+.5)*a.log(u);f<6;f++)c+=h[f]/++l;return a.log(2.5066282746310007*c/o)-u},n.loggam=function(s){var f,h,c,o,l,u,d,g=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(f=s,d=0,s==1||s==2)return 0;for(s<=7&&(d=a.floor(7-s),f=s+d),h=1/(f*f),c=2*a.PI,l=g[9],u=8;u>=0;u--)l*=h,l+=g[u];if(o=l/f+.5*a.log(c)+(f-.5)*a.log(f)-f,s<=7)for(u=1;u<=d;u++)o-=a.log(f-1),f-=1;return o},n.gammafn=function(s){var f=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],h=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],c=!1,o=0,l=0,u=0,d=s,g,v,y,m;if(s>171.6243769536076)return 1/0;if(d<=0)if(m=d%1+36e-17,m)c=(d&1?-1:1)*a.PI/a.sin(a.PI*m),d=1-d;else return 1/0;for(y=d,d<1?v=d++:v=(d-=o=(d|0)-1)-1,g=0;g<8;++g)u=(u+f[g])*v,l=l*v+h[g];if(m=u/l+1,y<d)m/=y;else if(y>d)for(g=0;g<o;++g)m*=d,d++;return c&&(m=c/m),m},n.gammap=function(s,f){return n.lowRegGamma(s,f)*n.gammafn(s)},n.lowRegGamma=function(s,f){var h=n.gammaln(s),c=s,o=1/s,l=o,u=f+1-s,d=1/1e-30,g=1/u,v=g,y=1,m=-~(a.log(s>=1?s:1/s)*8.5+s*.4+17),b;if(f<0||s<=0)return NaN;if(f<s+1){for(;y<=m;y++)o+=l*=f/++c;return o*a.exp(-f+s*a.log(f)-h)}for(;y<=m;y++)b=-y*(y-s),u+=2,g=b*g+u,d=u+b/d,g=1/g,v*=g*d;return 1-v*a.exp(-f+s*a.log(f)-h)},n.factorialln=function(s){return s<0?NaN:n.gammaln(s+1)},n.factorial=function(s){return s<0?NaN:n.gammafn(s+1)},n.combination=function(s,f){return s>170||f>170?a.exp(n.combinationln(s,f)):n.factorial(s)/n.factorial(f)/n.factorial(s-f)},n.combinationln=function(s,f){return n.factorialln(s)-n.factorialln(f)-n.factorialln(s-f)},n.permutation=function(s,f){return n.factorial(s)/n.factorial(s-f)},n.betafn=function(s,f){if(!(s<=0||f<=0))return s+f>170?a.exp(n.betaln(s,f)):n.gammafn(s)*n.gammafn(f)/n.gammafn(s+f)},n.betaln=function(s,f){return n.gammaln(s)+n.gammaln(f)-n.gammaln(s+f)},n.betacf=function(s,f,h){var c=1e-30,o=1,l=f+h,u=f+1,d=f-1,g=1,v=1-l*s/u,y,m,b,E;for(a.abs(v)<c&&(v=c),v=1/v,E=v;o<=100&&(y=2*o,m=o*(h-o)*s/((d+y)*(f+y)),v=1+m*v,a.abs(v)<c&&(v=c),g=1+m/g,a.abs(g)<c&&(g=c),v=1/v,E*=v*g,m=-(f+o)*(l+o)*s/((f+y)*(u+y)),v=1+m*v,a.abs(v)<c&&(v=c),g=1+m/g,a.abs(g)<c&&(g=c),v=1/v,b=v*g,E*=b,!(a.abs(b-1)<3e-7));o++);return E},n.gammapinv=function(s,f){var h=0,c=f-1,o=1e-8,l=n.gammaln(f),u,d,g,v,y,m,b;if(s>=1)return a.max(100,f+100*a.sqrt(f));if(s<=0)return 0;for(f>1?(m=a.log(c),b=a.exp(c*(m-1)-l),y=s<.5?s:1-s,g=a.sqrt(-2*a.log(y)),u=(2.30753+g*.27061)/(1+g*(.99229+g*.04481))-g,s<.5&&(u=-u),u=a.max(.001,f*a.pow(1-1/(9*f)-u/(3*a.sqrt(f)),3))):(g=1-f*(.253+f*.12),s<g?u=a.pow(s/g,1/f):u=1-a.log(1-(s-g)/(1-g)));h<12;h++){if(u<=0)return 0;if(d=n.lowRegGamma(f,u)-s,f>1?g=b*a.exp(-(u-c)+c*(a.log(u)-m)):g=a.exp(-u+c*a.log(u)-l),v=d/g,u-=g=v/(1-.5*a.min(1,v*((f-1)/u-1))),u<=0&&(u=.5*(u+g)),a.abs(g)<o*u)break}return u},n.erf=function(s){var f=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],h=f.length-1,c=!1,o=0,l=0,u,d,g,v;for(s<0&&(s=-s,c=!0),u=2/(2+s),d=4*u-2;h>0;h--)g=o,o=d*o-l+f[h],l=g;return v=u*a.exp(-s*s+.5*(f[0]+d*o)-l),c?v-1:1-v},n.erfc=function(s){return 1-n.erf(s)},n.erfcinv=function(s){var f=0,h,c,o,l;if(s>=2)return-100;if(s<=0)return 100;for(l=s<1?s:2-s,o=a.sqrt(-2*a.log(l/2)),h=-.70711*((2.30753+o*.27061)/(1+o*(.99229+o*.04481))-o);f<2;f++)c=n.erfc(h)-l,h+=c/(1.1283791670955126*a.exp(-h*h)-h*c);return s<1?h:-h},n.ibetainv=function(s,f,h){var c=1e-8,o=f-1,l=h-1,u=0,d,g,v,y,m,b,E,N,R,C,O;if(s<=0)return 0;if(s>=1)return 1;for(f>=1&&h>=1?(v=s<.5?s:1-s,y=a.sqrt(-2*a.log(v)),E=(2.30753+y*.27061)/(1+y*(.99229+y*.04481))-y,s<.5&&(E=-E),N=(E*E-3)/6,R=2/(1/(2*f-1)+1/(2*h-1)),C=E*a.sqrt(N+R)/R-(1/(2*h-1)-1/(2*f-1))*(N+5/6-2/(3*R)),E=f/(f+h*a.exp(2*C))):(d=a.log(f/(f+h)),g=a.log(h/(f+h)),y=a.exp(f*d)/f,m=a.exp(h*g)/h,C=y+m,s<y/C?E=a.pow(f*C*s,1/f):E=1-a.pow(h*C*(1-s),1/h)),O=-n.gammaln(f)-n.gammaln(h)+n.gammaln(f+h);u<10;u++){if(E===0||E===1)return E;if(b=n.ibeta(E,f,h)-s,y=a.exp(o*a.log(E)+l*a.log(1-E)+O),m=b/y,E-=y=m/(1-.5*a.min(1,m*(o/E-l/(1-E)))),E<=0&&(E=.5*(E+y)),E>=1&&(E=.5*(E+y+1)),a.abs(y)<c*E&&u>0)break}return E},n.ibeta=function(s,f,h){var c=s===0||s===1?0:a.exp(n.gammaln(f+h)-n.gammaln(f)-n.gammaln(h)+f*a.log(s)+h*a.log(1-s));return s<0||s>1?!1:s<(f+1)/(f+h+2)?c*n.betacf(s,f,h)/f:1-c*n.betacf(1-s,h,f)/h},n.randn=function(s,f){var h,c,o,l,u;if(f||(f=s),s)return n.create(s,f,function(){return n.randn()});do h=n._random_fn(),c=1.7156*(n._random_fn()-.5),o=h-.449871,l=a.abs(c)+.386595,u=o*o+l*(.196*l-.25472*o);while(u>.27597&&(u>.27846||c*c>-4*a.log(h)*h*h));return c/h},n.randg=function(s,f,h){var c=s,o,l,u,d,g,v;if(h||(h=f),s||(s=1),f)return v=n.zeros(f,h),v.alter(function(){return n.randg(s)}),v;s<1&&(s+=1),o=s-1/3,l=1/a.sqrt(9*o);do{do g=n.randn(),d=1+l*g;while(d<=0);d=d*d*d,u=n._random_fn()}while(u>1-.331*a.pow(g,4)&&a.log(u)>.5*g*g+o*(1-d+a.log(d)));if(s==c)return o*d;do u=n._random_fn();while(u===0);return a.pow(u,1/c)*o*d},function(i){for(var s=0;s<i.length;s++)(function(f){n.fn[f]=function(){return n(n.map(this,function(h){return n[f](h)}))}})(i[s])}("gammaln gammafn factorial factorialln".split(" ")),function(i){for(var s=0;s<i.length;s++)(function(f){n.fn[f]=function(){return n(n[f].apply(null,arguments))}})(i[s])}("randn".split(" "))}(r,Math),function(n,a){(function(c){for(var o=0;o<c.length;o++)(function(l){n[l]=function u(d,g,v){return this instanceof u?(this._a=d,this._b=g,this._c=v,this):new u(d,g,v)},n.fn[l]=function(u,d,g){var v=n[l](u,d,g);return v.data=this,v},n[l].prototype.sample=function(u){var d=this._a,g=this._b,v=this._c;return u?n.alter(u,function(){return n[l].sample(d,g,v)}):n[l].sample(d,g,v)},function(u){for(var d=0;d<u.length;d++)(function(g){n[l].prototype[g]=function(v){var y=this._a,m=this._b,b=this._c;return!v&&v!==0&&(v=this.data),typeof v!="number"?n.fn.map.call(v,function(E){return n[l][g](E,y,m,b)}):n[l][g](v,y,m,b)}})(u[d])}("pdf cdf inv".split(" ")),function(u){for(var d=0;d<u.length;d++)(function(g){n[l].prototype[g]=function(){return n[l][g](this._a,this._b,this._c)}})(u[d])}("mean median mode variance".split(" "))})(c[o])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),n.extend(n.beta,{pdf:function(o,l,u){return o>1||o<0?0:l==1&&u==1?1:l<512&&u<512?a.pow(o,l-1)*a.pow(1-o,u-1)/n.betafn(l,u):a.exp((l-1)*a.log(o)+(u-1)*a.log(1-o)-n.betaln(l,u))},cdf:function(o,l,u){return o>1||o<0?(o>1)*1:n.ibeta(o,l,u)},inv:function(o,l,u){return n.ibetainv(o,l,u)},mean:function(o,l){return o/(o+l)},median:function(o,l){return n.ibetainv(.5,o,l)},mode:function(o,l){return(o-1)/(o+l-2)},sample:function(o,l){var u=n.randg(o);return u/(u+n.randg(l))},variance:function(o,l){return o*l/(a.pow(o+l,2)*(o+l+1))}}),n.extend(n.centralF,{pdf:function(o,l,u){var d,g,v;return o<0?0:l<=2?o===0&&l<2?1/0:o===0&&l===2?1:1/n.betafn(l/2,u/2)*a.pow(l/u,l/2)*a.pow(o,l/2-1)*a.pow(1+l/u*o,-(l+u)/2):(d=l*o/(u+o*l),g=u/(u+o*l),v=l*g/2,v*n.binomial.pdf((l-2)/2,(l+u-2)/2,d))},cdf:function(o,l,u){return o<0?0:n.ibeta(l*o/(l*o+u),l/2,u/2)},inv:function(o,l,u){return u/(l*(1/n.ibetainv(o,l/2,u/2)-1))},mean:function(o,l){return l>2?l/(l-2):void 0},mode:function(o,l){return o>2?l*(o-2)/(o*(l+2)):void 0},sample:function(o,l){var u=n.randg(o/2)*2,d=n.randg(l/2)*2;return u/o/(d/l)},variance:function(o,l){if(!(l<=4))return 2*l*l*(o+l-2)/(o*(l-2)*(l-2)*(l-4))}}),n.extend(n.cauchy,{pdf:function(o,l,u){return u<0?0:u/(a.pow(o-l,2)+a.pow(u,2))/a.PI},cdf:function(o,l,u){return a.atan((o-l)/u)/a.PI+.5},inv:function(c,o,l){return o+l*a.tan(a.PI*(c-.5))},median:function(o){return o},mode:function(o){return o},sample:function(o,l){return n.randn()*a.sqrt(1/(2*n.randg(.5)))*l+o}}),n.extend(n.chisquare,{pdf:function(o,l){return o<0?0:o===0&&l===2?.5:a.exp((l/2-1)*a.log(o)-o/2-l/2*a.log(2)-n.gammaln(l/2))},cdf:function(o,l){return o<0?0:n.lowRegGamma(l/2,o/2)},inv:function(c,o){return 2*n.gammapinv(c,.5*o)},mean:function(c){return c},median:function(o){return o*a.pow(1-2/(9*o),3)},mode:function(o){return o-2>0?o-2:0},sample:function(o){return n.randg(o/2)*2},variance:function(o){return 2*o}}),n.extend(n.exponential,{pdf:function(o,l){return o<0?0:l*a.exp(-l*o)},cdf:function(o,l){return o<0?0:1-a.exp(-l*o)},inv:function(c,o){return-a.log(1-c)/o},mean:function(c){return 1/c},median:function(c){return 1/c*a.log(2)},mode:function(){return 0},sample:function(o){return-1/o*a.log(n._random_fn())},variance:function(c){return a.pow(c,-2)}}),n.extend(n.gamma,{pdf:function(o,l,u){return o<0?0:o===0&&l===1?1/u:a.exp((l-1)*a.log(o)-o/u-n.gammaln(l)-l*a.log(u))},cdf:function(o,l,u){return o<0?0:n.lowRegGamma(l,o/u)},inv:function(c,o,l){return n.gammapinv(c,o)*l},mean:function(c,o){return c*o},mode:function(o,l){if(o>1)return(o-1)*l},sample:function(o,l){return n.randg(o)*l},variance:function(o,l){return o*l*l}}),n.extend(n.invgamma,{pdf:function(o,l,u){return o<=0?0:a.exp(-(l+1)*a.log(o)-u/o-n.gammaln(l)+l*a.log(u))},cdf:function(o,l,u){return o<=0?0:1-n.lowRegGamma(l,u/o)},inv:function(c,o,l){return l/n.gammapinv(1-c,o)},mean:function(c,o){return c>1?o/(c-1):void 0},mode:function(o,l){return l/(o+1)},sample:function(o,l){return l/n.randg(o)},variance:function(o,l){if(!(o<=2))return l*l/((o-1)*(o-1)*(o-2))}}),n.extend(n.kumaraswamy,{pdf:function(o,l,u){return o===0&&l===1?u:o===1&&u===1?l:a.exp(a.log(l)+a.log(u)+(l-1)*a.log(o)+(u-1)*a.log(1-a.pow(o,l)))},cdf:function(o,l,u){return o<0?0:o>1?1:1-a.pow(1-a.pow(o,l),u)},inv:function(o,l,u){return a.pow(1-a.pow(1-o,1/u),1/l)},mean:function(c,o){return o*n.gammafn(1+1/c)*n.gammafn(o)/n.gammafn(1+1/c+o)},median:function(o,l){return a.pow(1-a.pow(2,-1/l),1/o)},mode:function(o,l){if(o>=1&&l>=1&&o!==1&&l!==1)return a.pow((o-1)/(o*l-1),1/o)},variance:function(){throw new Error("variance not yet implemented")}}),n.extend(n.lognormal,{pdf:function(o,l,u){return o<=0?0:a.exp(-a.log(o)-.5*a.log(2*a.PI)-a.log(u)-a.pow(a.log(o)-l,2)/(2*u*u))},cdf:function(o,l,u){return o<0?0:.5+.5*n.erf((a.log(o)-l)/a.sqrt(2*u*u))},inv:function(c,o,l){return a.exp(-1.4142135623730951*l*n.erfcinv(2*c)+o)},mean:function(o,l){return a.exp(o+l*l/2)},median:function(o){return a.exp(o)},mode:function(o,l){return a.exp(o-l*l)},sample:function(o,l){return a.exp(n.randn()*l+o)},variance:function(o,l){return(a.exp(l*l)-1)*a.exp(2*o+l*l)}}),n.extend(n.noncentralt,{pdf:function(o,l,u){var d=1e-14;return a.abs(u)<d?n.studentt.pdf(o,l):a.abs(o)<d?a.exp(n.gammaln((l+1)/2)-u*u/2-.5*a.log(a.PI*l)-n.gammaln(l/2)):l/o*(n.noncentralt.cdf(o*a.sqrt(1+2/l),l+2,u)-n.noncentralt.cdf(o,l,u))},cdf:function(o,l,u){var d=1e-14,g=200;if(a.abs(u)<d)return n.studentt.cdf(o,l);var v=!1;o<0&&(v=!0,u=-u);for(var y=n.normal.cdf(-u,0,1),m=d+1,b=m,E=o*o/(o*o+l),N=0,R=a.exp(-u*u/2),C=a.exp(-u*u/2-.5*a.log(2)-n.gammaln(3/2))*u;N<g||b>d||m>d;)b=m,N>0&&(R*=u*u/(2*N),C*=u*u/(2*(N+1/2))),m=R*n.beta.cdf(E,N+.5,l/2)+C*n.beta.cdf(E,N+1,l/2),y+=.5*m,N++;return v?1-y:y}}),n.extend(n.normal,{pdf:function(o,l,u){return a.exp(-.5*a.log(2*a.PI)-a.log(u)-a.pow(o-l,2)/(2*u*u))},cdf:function(o,l,u){return .5*(1+n.erf((o-l)/a.sqrt(2*u*u)))},inv:function(c,o,l){return-1.4142135623730951*l*n.erfcinv(2*c)+o},mean:function(c){return c},median:function(o){return o},mode:function(c){return c},sample:function(o,l){return n.randn()*l+o},variance:function(c,o){return o*o}}),n.extend(n.pareto,{pdf:function(o,l,u){return o<l?0:u*a.pow(l,u)/a.pow(o,u+1)},cdf:function(o,l,u){return o<l?0:1-a.pow(l/o,u)},inv:function(o,l,u){return l/a.pow(1-o,1/u)},mean:function(o,l){if(!(l<=1))return l*a.pow(o,l)/(l-1)},median:function(o,l){return o*(l*a.SQRT2)},mode:function(o){return o},variance:function(c,o){if(!(o<=2))return c*c*o/(a.pow(o-1,2)*(o-2))}}),n.extend(n.studentt,{pdf:function(o,l){return l=l>1e100?1e100:l,1/(a.sqrt(l)*n.betafn(.5,l/2))*a.pow(1+o*o/l,-((l+1)/2))},cdf:function(o,l){var u=l/2;return n.ibeta((o+a.sqrt(o*o+l))/(2*a.sqrt(o*o+l)),u,u)},inv:function(c,o){var l=n.ibetainv(2*a.min(c,1-c),.5*o,.5);return l=a.sqrt(o*(1-l)/l),c>.5?l:-l},mean:function(o){return o>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(o){return n.randn()*a.sqrt(o/(2*n.randg(o/2)))},variance:function(o){return o>2?o/(o-2):o>1?1/0:void 0}}),n.extend(n.weibull,{pdf:function(o,l,u){return o<0||l<0||u<0?0:u/l*a.pow(o/l,u-1)*a.exp(-a.pow(o/l,u))},cdf:function(o,l,u){return o<0?0:1-a.exp(-a.pow(o/l,u))},inv:function(c,o,l){return o*a.pow(-a.log(1-c),1/l)},mean:function(c,o){return c*n.gammafn(1+1/o)},median:function(o,l){return o*a.pow(a.log(2),1/l)},mode:function(o,l){return l<=1?0:o*a.pow((l-1)/l,1/l)},sample:function(o,l){return o*a.pow(-a.log(n._random_fn()),1/l)},variance:function(o,l){return o*o*n.gammafn(1+2/l)-a.pow(n.weibull.mean(o,l),2)}}),n.extend(n.uniform,{pdf:function(o,l,u){return o<l||o>u?0:1/(u-l)},cdf:function(o,l,u){return o<l?0:o<u?(o-l)/(u-l):1},inv:function(c,o,l){return o+c*(l-o)},mean:function(o,l){return .5*(o+l)},median:function(o,l){return n.mean(o,l)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,l){return o/2+l/2+(l/2-o/2)*(2*n._random_fn()-1)},variance:function(o,l){return a.pow(l-o,2)/12}});function i(c,o,l,u){for(var d=0,g=1,v=1,y=1,m=0,b=0,E;a.abs((v-b)/v)>u;)b=v,E=-(o+m)*(o+l+m)*c/(o+2*m)/(o+2*m+1),d=v+E*d,g=y+E*g,m=m+1,E=m*(l-m)*c/(o+2*m-1)/(o+2*m),v=d+E*v,y=g+E*y,d=d/y,g=g/y,v=v/y,y=1;return v/o}n.extend(n.binomial,{pdf:function(o,l,u){return u===0||u===1?l*u===o?1:0:n.combination(l,o)*a.pow(u,o)*a.pow(1-u,l-o)},cdf:function(o,l,u){var d,g=1e-10;if(o<0)return 0;if(o>=l)return 1;if(u<0||u>1||l<=0)return NaN;o=a.floor(o);var v=u,y=o+1,m=l-o,b=y+m,E=a.exp(n.gammaln(b)-n.gammaln(m)-n.gammaln(y)+y*a.log(v)+m*a.log(1-v));return v<(y+1)/(b+2)?d=E*i(v,y,m,g):d=1-E*i(1-v,m,y,g),a.round((1-d)*(1/g))/(1/g)}}),n.extend(n.negbin,{pdf:function(o,l,u){return o!==o>>>0?!1:o<0?0:n.combination(o+l-1,l-1)*a.pow(1-u,o)*a.pow(u,l)},cdf:function(o,l,u){var d=0,g=0;if(o<0)return 0;for(;g<=o;g++)d+=n.negbin.pdf(g,l,u);return d}}),n.extend(n.hypgeom,{pdf:function(o,l,u,d){if(o!==o|0)return!1;if(o<0||o<u-(l-d))return 0;if(o>d||o>u)return 0;if(u*2>l)return d*2>l?n.hypgeom.pdf(l-u-d+o,l,l-u,l-d):n.hypgeom.pdf(d-o,l,l-u,d);if(d*2>l)return n.hypgeom.pdf(u-o,l,u,l-d);if(u<d)return n.hypgeom.pdf(o,l,d,u);for(var g=1,v=0,y=0;y<o;y++){for(;g>1&&v<d;)g*=1-u/(l-v),v++;g*=(d-y)*(u-y)/((y+1)*(l-u-d+y+1))}for(;v<d;v++)g*=1-u/(l-v);return a.min(1,a.max(0,g))},cdf:function(o,l,u,d){if(o<0||o<u-(l-d))return 0;if(o>=d||o>=u)return 1;if(u*2>l)return d*2>l?n.hypgeom.cdf(l-u-d+o,l,l-u,l-d):1-n.hypgeom.cdf(d-o-1,l,l-u,d);if(d*2>l)return 1-n.hypgeom.cdf(u-o-1,l,u,l-d);if(u<d)return n.hypgeom.cdf(o,l,d,u);for(var g=1,v=1,y=0,m=0;m<o;m++){for(;g>1&&y<d;){var b=1-u/(l-y);v*=b,g*=b,y++}v*=(d-m)*(u-m)/((m+1)*(l-u-d+m+1)),g+=v}for(;y<d;y++)g*=1-u/(l-y);return a.min(1,a.max(0,g))}}),n.extend(n.poisson,{pdf:function(o,l){return l<0||o%1!==0||o<0?0:a.pow(l,o)*a.exp(-l)/n.factorial(o)},cdf:function(o,l){var u=[],d=0;if(o<0)return 0;for(;d<=o;d++)u.push(n.poisson.pdf(d,l));return n.sum(u)},mean:function(c){return c},variance:function(c){return c},sampleSmall:function(o){var l=1,u=0,d=a.exp(-o);do u++,l*=n._random_fn();while(l>d);return u-1},sampleLarge:function(o){var l=o,u,d,g,v,y,m,b,E,N,R;for(v=a.sqrt(l),y=a.log(l),b=.931+2.53*v,m=-.059+.02483*b,E=1.1239+1.1328/(b-3.4),N=.9277-3.6224/(b-2);;){if(d=a.random()-.5,g=a.random(),R=.5-a.abs(d),u=a.floor((2*m/R+b)*d+l+.43),R>=.07&&g<=N)return u;if(!(u<0||R<.013&&g>R)&&a.log(g)+a.log(E)-a.log(m/(R*R)+b)<=-l+u*y-n.loggam(u+1))return u}},sample:function(o){return o<10?this.sampleSmall(o):this.sampleLarge(o)}}),n.extend(n.triangular,{pdf:function(o,l,u,d){return u<=l||d<l||d>u?NaN:o<l||o>u?0:o<d?2*(o-l)/((u-l)*(d-l)):o===d?2/(u-l):2*(u-o)/((u-l)*(u-d))},cdf:function(o,l,u,d){return u<=l||d<l||d>u?NaN:o<=l?0:o>=u?1:o<=d?a.pow(o-l,2)/((u-l)*(d-l)):1-a.pow(u-o,2)/((u-l)*(u-d))},inv:function(o,l,u,d){return u<=l||d<l||d>u?NaN:o<=(d-l)/(u-l)?l+(u-l)*a.sqrt(o*((d-l)/(u-l))):l+(u-l)*(1-a.sqrt((1-o)*(1-(d-l)/(u-l))))},mean:function(o,l,u){return(o+l+u)/3},median:function(o,l,u){if(u<=(o+l)/2)return l-a.sqrt((l-o)*(l-u))/a.sqrt(2);if(u>(o+l)/2)return o+a.sqrt((l-o)*(u-o))/a.sqrt(2)},mode:function(o,l,u){return u},sample:function(o,l,u){var d=n._random_fn();return d<(u-o)/(l-o)?o+a.sqrt(d*(l-o)*(u-o)):l-a.sqrt((1-d)*(l-o)*(l-u))},variance:function(o,l,u){return(o*o+l*l+u*u-o*l-o*u-l*u)/18}}),n.extend(n.arcsine,{pdf:function(o,l,u){return u<=l?NaN:o<=l||o>=u?0:2/a.PI*a.pow(a.pow(u-l,2)-a.pow(2*o-l-u,2),-.5)},cdf:function(o,l,u){return o<l?0:o<u?2/a.PI*a.asin(a.sqrt((o-l)/(u-l))):1},inv:function(c,o,l){return o+(.5-.5*a.cos(a.PI*c))*(l-o)},mean:function(o,l){return l<=o?NaN:(o+l)/2},median:function(o,l){return l<=o?NaN:(o+l)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,l){return(o+l)/2+(l-o)/2*a.sin(2*a.PI*n.uniform.sample(0,1))},variance:function(o,l){return l<=o?NaN:a.pow(l-o,2)/8}});function s(c){return c/a.abs(c)}n.extend(n.laplace,{pdf:function(o,l,u){return u<=0?0:a.exp(-a.abs(o-l)/u)/(2*u)},cdf:function(o,l,u){return u<=0?0:o<l?.5*a.exp((o-l)/u):1-.5*a.exp(-(o-l)/u)},mean:function(c){return c},median:function(c){return c},mode:function(c){return c},variance:function(c,o){return 2*o*o},sample:function(o,l){var u=n._random_fn()-.5;return o-l*s(u)*a.log(1-2*a.abs(u))}});function f(c,o,l){var u=12,d=6,g=-30,v=-50,y=60,m=8,b=3,E=2,N=3,R=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],C=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],O=c*.5;if(O>=m)return 1;var T=2*n.normal.cdf(O,0,1,1,0)-1;T>=a.exp(v/l)?T=a.pow(T,l):T=0;var A;c>b?A=E:A=N;for(var L=O,G=(m-O)/A,H=L+G,Y=0,K=l-1,ce=1;ce<=A;ce++){for(var V=0,W=.5*(H+L),Q=.5*(H-L),ie=1;ie<=u;ie++){var de,me;d<ie?(de=u-ie+1,me=R[de-1]):(de=ie,me=-R[de-1]);var Oe=Q*me,we=W+Oe,Se=we*we;if(Se>y)break;var J=2*n.normal.cdf(we,0,1,1,0),$=2*n.normal.cdf(we,c,1,1,0),P=J*.5-$*.5;P>=a.exp(g/K)&&(P=C[de-1]*a.exp(-(.5*Se))*a.pow(P,K),V+=P)}V*=2*Q*l/a.sqrt(2*a.PI),Y+=V,L=H,H+=G}return T+=Y,T<=a.exp(g/o)?0:(T=a.pow(T,o),T>=1?1:T)}function h(c,o,l){var u=.322232421088,d=.099348462606,g=-1,v=.588581570495,y=-.342242088547,m=.531103462366,b=-.204231210125,E=.10353775285,N=-453642210148e-16,R=.0038560700634,C=.8832,O=.2368,T=1.214,A=1.208,L=1.4142,G=120,H=.5-.5*c,Y=a.sqrt(a.log(1/(H*H))),K=Y+((((Y*N+b)*Y+y)*Y+g)*Y+u)/((((Y*R+E)*Y+m)*Y+v)*Y+d);l<G&&(K+=(K*K*K+K)/l/4);var ce=C-O*K;return l<G&&(ce+=-T/l+A*K/l),K*(ce*a.log(o-1)+L)}n.extend(n.tukey,{cdf:function(o,l,u){var d=1,g=l,v=16,y=8,m=-30,b=1e-14,E=100,N=800,R=5e3,C=25e3,O=1,T=.5,A=.25,L=.125,G=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],H=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(o<=0)return 0;if(u<2||d<1||g<2)return NaN;if(!Number.isFinite(o))return 1;if(u>C)return f(o,d,g);var Y=u*.5,K=Y*a.log(u)-u*a.log(2)-n.gammaln(Y),ce=Y-1,V=u*.25,W;u<=E?W=O:u<=N?W=T:u<=R?W=A:W=L,K+=a.log(W);for(var Q=0,ie=1;ie<=50;ie++){for(var de=0,me=(2*ie-1)*W,Oe=1;Oe<=v;Oe++){var we,Se;y<Oe?(we=Oe-y-1,Se=K+ce*a.log(me+G[we]*W)-(G[we]*W+me)*V):(we=Oe-1,Se=K+ce*a.log(me-G[we]*W)+(G[we]*W-me)*V);var J;if(Se>=m){y<Oe?J=o*a.sqrt((G[we]*W+me)*.5):J=o*a.sqrt((-(G[we]*W)+me)*.5);var $=f(J,d,g),P=$*H[we]*a.exp(Se);de+=P}}if(ie*W>=1&&de<=b)break;Q+=de}if(de>b)throw new Error("tukey.cdf failed to converge");return Q>1&&(Q=1),Q},inv:function(c,o,l){var u=1,d=o,g=1e-4,v=50;if(l<2||u<1||d<2)return NaN;if(c<0||c>1)return NaN;if(c===0)return 0;if(c===1)return 1/0;var y=h(c,d,l),m=n.tukey.cdf(y,o,l)-c,b;m>0?b=a.max(0,y-1):b=y+1;for(var E=n.tukey.cdf(b,o,l)-c,N,R=1;R<v;R++){N=b-E*(b-y)/(E-m),m=E,y=b,N<0&&(N=0,E=-c),E=n.tukey.cdf(N,o,l)-c,b=N;var C=a.abs(b-y);if(C<g)return N}throw new Error("tukey.inv failed to converge")}})}(r,Math),function(n,a){var i=Array.prototype.push,s=n.utils.isArray;function f(h){return s(h)||h instanceof n}n.extend({add:function(c,o){return f(o)?(f(o[0])||(o=[o]),n.map(c,function(l,u,d){return l+o[u][d]})):n.map(c,function(l){return l+o})},subtract:function(c,o){return f(o)?(f(o[0])||(o=[o]),n.map(c,function(l,u,d){return l-o[u][d]||0})):n.map(c,function(l){return l-o})},divide:function(c,o){return f(o)?(f(o[0])||(o=[o]),n.multiply(c,n.inv(o))):n.map(c,function(l){return l/o})},multiply:function(c,o){var l,u,d,g,v,y,m,b;if(c.length===void 0&&o.length===void 0)return c*o;if(v=c.length,y=c[0].length,m=n.zeros(v,d=f(o)?o[0].length:y),b=0,f(o)){for(;b<d;b++)for(l=0;l<v;l++){for(g=0,u=0;u<y;u++)g+=c[l][u]*o[u][b];m[l][b]=g}return v===1&&b===1?m[0][0]:m}return n.map(c,function(E){return E*o})},outer:function(c,o){return n.multiply(c.map(function(l){return[l]}),[o])},dot:function(c,o){f(c[0])||(c=[c]),f(o[0])||(o=[o]);for(var l=c[0].length===1&&c.length!==1?n.transpose(c):c,u=o[0].length===1&&o.length!==1?n.transpose(o):o,d=[],g=0,v=l.length,y=l[0].length,m,b;g<v;g++){for(d[g]=[],m=0,b=0;b<y;b++)m+=l[g][b]*u[g][b];d[g]=m}return d.length===1?d[0]:d},pow:function(c,o){return n.map(c,function(l){return a.pow(l,o)})},exp:function(c){return n.map(c,function(o){return a.exp(o)})},log:function(c){return n.map(c,function(o){return a.log(o)})},abs:function(c){return n.map(c,function(o){return a.abs(o)})},norm:function(c,o){var l=0,u=0;for(isNaN(o)&&(o=2),f(c[0])&&(c=c[0]);u<c.length;u++)l+=a.pow(a.abs(c[u]),o);return a.pow(l,1/o)},angle:function(c,o){return a.acos(n.dot(c,o)/(n.norm(c)*n.norm(o)))},aug:function(c,o){var l=[],u;for(u=0;u<c.length;u++)l.push(c[u].slice());for(u=0;u<l.length;u++)i.apply(l[u],o[u]);return l},inv:function(c){for(var o=c.length,l=c[0].length,u=n.identity(o,l),d=n.gauss_jordan(c,u),g=[],v=0,y;v<o;v++)for(g[v]=[],y=l;y<d[0].length;y++)g[v][y-l]=d[v][y];return g},det:function(c){var o=c.length,l=o*2,u=new Array(l),d=o-1,g=l-1,v=d-o+1,y=g,m=0,b=0,E;if(o===2)return c[0][0]*c[1][1]-c[0][1]*c[1][0];for(;m<l;m++)u[m]=1;for(m=0;m<o;m++){for(E=0;E<o;E++)u[v<0?v+o:v]*=c[m][E],u[y<o?y+o:y]*=c[m][E],v++,y--;v=--d-o+1,y=--g}for(m=0;m<o;m++)b+=u[m];for(;m<l;m++)b-=u[m];return b},gauss_elimination:function(c,o){var l=0,u=0,d=c.length,g=c[0].length,v=1,y=0,m=[],b,E,N,R;for(c=n.aug(c,o),b=c[0].length,l=0;l<d;l++){for(E=c[l][l],u=l,R=l+1;R<g;R++)E<a.abs(c[R][l])&&(E=c[R][l],u=R);if(u!=l)for(R=0;R<b;R++)N=c[l][R],c[l][R]=c[u][R],c[u][R]=N;for(u=l+1;u<d;u++)for(v=c[u][l]/c[l][l],R=l;R<b;R++)c[u][R]=c[u][R]-v*c[l][R]}for(l=d-1;l>=0;l--){for(y=0,u=l+1;u<=d-1;u++)y=y+m[u]*c[l][u];m[l]=(c[l][b-1]-y)/c[l][l]}return m},gauss_jordan:function(c,o){var l=n.aug(c,o),u=l.length,d=l[0].length,g=0,v,y,m;for(y=0;y<u;y++){var b=y;for(m=y+1;m<u;m++)a.abs(l[m][y])>a.abs(l[b][y])&&(b=m);var E=l[y];for(l[y]=l[b],l[b]=E,m=y+1;m<u;m++)for(g=l[m][y]/l[y][y],v=y;v<d;v++)l[m][v]-=l[y][v]*g}for(y=u-1;y>=0;y--){for(g=l[y][y],m=0;m<y;m++)for(v=d-1;v>y-1;v--)l[m][v]-=l[y][v]*l[m][y]/g;for(l[y][y]/=g,v=u;v<d;v++)l[y][v]/=g}return l},triaUpSolve:function(c,o){var l=c[0].length,u=n.zeros(1,l)[0],d,g=!1;return o[0].length!=null&&(o=o.map(function(v){return v[0]}),g=!0),n.arange(l-1,-1,-1).forEach(function(v){d=n.arange(v+1,l).map(function(y){return u[y]*c[v][y]}),u[v]=(o[v]-n.sum(d))/c[v][v]}),g?u.map(function(v){return[v]}):u},triaLowSolve:function(c,o){var l=c[0].length,u=n.zeros(1,l)[0],d,g=!1;return o[0].length!=null&&(o=o.map(function(v){return v[0]}),g=!0),n.arange(l).forEach(function(v){d=n.arange(v).map(function(y){return c[v][y]*u[y]}),u[v]=(o[v]-n.sum(d))/c[v][v]}),g?u.map(function(v){return[v]}):u},lu:function(c){var o=c.length,l=n.identity(o),u=n.zeros(c.length,c[0].length),d;return n.arange(o).forEach(function(g){u[0][g]=c[0][g]}),n.arange(1,o).forEach(function(g){n.arange(g).forEach(function(v){d=n.arange(v).map(function(y){return l[g][y]*u[y][v]}),l[g][v]=(c[g][v]-n.sum(d))/u[v][v]}),n.arange(g,o).forEach(function(v){d=n.arange(g).map(function(y){return l[g][y]*u[y][v]}),u[g][v]=c[d.length][v]-n.sum(d)})}),[l,u]},cholesky:function(c){var o=c.length,l=n.zeros(c.length,c[0].length),u;return n.arange(o).forEach(function(d){u=n.arange(d).map(function(g){return a.pow(l[d][g],2)}),l[d][d]=a.sqrt(c[d][d]-n.sum(u)),n.arange(d+1,o).forEach(function(g){u=n.arange(d).map(function(v){return l[d][v]*l[g][v]}),l[g][d]=(c[d][g]-n.sum(u))/l[d][d]})}),l},gauss_jacobi:function(c,o,l,u){for(var d=0,g=0,v=c.length,y=[],m=[],b=[],E,N,R,C;d<v;d++)for(y[d]=[],m[d]=[],b[d]=[],g=0;g<v;g++)d>g?(y[d][g]=c[d][g],m[d][g]=b[d][g]=0):d<g?(m[d][g]=c[d][g],y[d][g]=b[d][g]=0):(b[d][g]=c[d][g],y[d][g]=m[d][g]=0);for(R=n.multiply(n.multiply(n.inv(b),n.add(y,m)),-1),N=n.multiply(n.inv(b),o),E=l,C=n.add(n.multiply(R,l),N),d=2;a.abs(n.norm(n.subtract(C,E)))>u;)E=C,C=n.add(n.multiply(R,E),N),d++;return C},gauss_seidel:function(c,o,l,u){for(var d=0,g=c.length,v=[],y=[],m=[],b,E,N,R,C;d<g;d++)for(v[d]=[],y[d]=[],m[d]=[],b=0;b<g;b++)d>b?(v[d][b]=c[d][b],y[d][b]=m[d][b]=0):d<b?(y[d][b]=c[d][b],v[d][b]=m[d][b]=0):(m[d][b]=c[d][b],v[d][b]=y[d][b]=0);for(R=n.multiply(n.multiply(n.inv(n.add(m,v)),y),-1),N=n.multiply(n.inv(n.add(m,v)),o),E=l,C=n.add(n.multiply(R,l),N),d=2;a.abs(n.norm(n.subtract(C,E)))>u;)E=C,C=n.add(n.multiply(R,E),N),d=d+1;return C},SOR:function(c,o,l,u,d){for(var g=0,v=c.length,y=[],m=[],b=[],E,N,R,C,O;g<v;g++)for(y[g]=[],m[g]=[],b[g]=[],E=0;E<v;E++)g>E?(y[g][E]=c[g][E],m[g][E]=b[g][E]=0):g<E?(m[g][E]=c[g][E],y[g][E]=b[g][E]=0):(b[g][E]=c[g][E],y[g][E]=m[g][E]=0);for(C=n.multiply(n.inv(n.add(b,n.multiply(y,d))),n.subtract(n.multiply(b,1-d),n.multiply(m,d))),R=n.multiply(n.multiply(n.inv(n.add(b,n.multiply(y,d))),o),d),N=l,O=n.add(n.multiply(C,l),R),g=2;a.abs(n.norm(n.subtract(O,N)))>u;)N=O,O=n.add(n.multiply(C,N),R),g++;return O},householder:function(c){for(var o=c.length,l=c[0].length,u=0,d=[],g=[],v,y,m,b,E;u<o-1;u++){for(v=0,b=u+1;b<l;b++)v+=c[b][u]*c[b][u];for(E=c[u+1][u]>0?-1:1,v=E*a.sqrt(v),y=a.sqrt((v*v-c[u+1][u]*v)/2),d=n.zeros(o,1),d[u+1][0]=(c[u+1][u]-v)/(2*y),m=u+2;m<o;m++)d[m][0]=c[m][u]/(2*y);g=n.subtract(n.identity(o,l),n.multiply(n.multiply(d,n.transpose(d)),2)),c=n.multiply(g,n.multiply(c,g))}return c},QR:function(){var h=n.sum,c=n.arange;function o(l){var u=l.length,d=l[0].length,g=n.zeros(d,d);l=n.copy(l);var v,y,m;for(y=0;y<d;y++){for(g[y][y]=a.sqrt(h(c(u).map(function(b){return l[b][y]*l[b][y]}))),v=0;v<u;v++)l[v][y]=l[v][y]/g[y][y];for(m=y+1;m<d;m++)for(g[y][m]=h(c(u).map(function(b){return l[b][y]*l[b][m]})),v=0;v<u;v++)l[v][m]=l[v][m]-l[v][y]*g[y][m]}return[l,g]}return o}(),lstsq:function(){function h(o){o=n.copy(o);var l=o.length,u=n.identity(l);return n.arange(l-1,-1,-1).forEach(function(d){n.sliceAssign(u,{row:d},n.divide(n.slice(u,{row:d}),o[d][d])),n.sliceAssign(o,{row:d},n.divide(n.slice(o,{row:d}),o[d][d])),n.arange(d).forEach(function(g){var v=n.multiply(o[g][d],-1),y=n.slice(o,{row:g}),m=n.multiply(n.slice(o,{row:d}),v);n.sliceAssign(o,{row:g},n.add(y,m));var b=n.slice(u,{row:g}),E=n.multiply(n.slice(u,{row:d}),v);n.sliceAssign(u,{row:g},n.add(b,E))})}),u}function c(o,l){var u=!1;l[0].length===void 0&&(l=l.map(function(C){return[C]}),u=!0);var d=n.QR(o),g=d[0],v=d[1],y=o[0].length,m=n.slice(g,{col:{end:y}}),b=n.slice(v,{row:{end:y}}),E=h(b),N=n.transpose(m);N[0].length===void 0&&(N=[N]);var R=n.multiply(n.multiply(E,N),l);return R.length===void 0&&(R=[[R]]),u?R.map(function(C){return C[0]}):R}return c}(),jacobi:function(c){for(var o=1,l=c.length,u=n.identity(l,l),d=[],g,v,y,m,b,E,N,R;o===1;){for(E=c[0][1],m=0,b=1,v=0;v<l;v++)for(y=0;y<l;y++)v!=y&&E<a.abs(c[v][y])&&(E=a.abs(c[v][y]),m=v,b=y);for(c[m][m]===c[b][b]?N=c[m][b]>0?a.PI/4:-a.PI/4:N=a.atan(2*c[m][b]/(c[m][m]-c[b][b]))/2,R=n.identity(l,l),R[m][m]=a.cos(N),R[m][b]=-a.sin(N),R[b][m]=a.sin(N),R[b][b]=a.cos(N),u=n.multiply(u,R),g=n.multiply(n.multiply(n.inv(R),c),R),c=g,o=0,v=1;v<l;v++)for(y=1;y<l;y++)v!=y&&a.abs(c[v][y])>.001&&(o=1)}for(v=0;v<l;v++)d.push(c[v][v]);return[u,d]},rungekutta:function(c,o,l,u,d,g){var v,y,m,b,E;if(g===2)for(;u<=l;)v=o*c(u,d),y=o*c(u+o,d+v),m=d+(v+y)/2,d=m,u=u+o;if(g===4)for(;u<=l;)v=o*c(u,d),y=o*c(u+o/2,d+v/2),b=o*c(u+o/2,d+y/2),E=o*c(u+o,d+b),m=d+(v+2*y+2*b+E)/6,d=m,u=u+o;return d},romberg:function(c,o,l,u){for(var d=0,g=(l-o)/2,v=[],y=[],m=[],b,E,N,R,C;d<u/2;){for(C=c(o),N=o,R=0;N<=l;N=N+g,R++)v[R]=N;for(b=v.length,N=1;N<b-1;N++)C+=(N%2!==0?4:2)*c(v[N]);C=g/3*(C+c(l)),m[d]=C,g/=2,d++}for(E=m.length,b=1;E!==1;){for(N=0;N<E-1;N++)y[N]=(a.pow(4,b)*m[N+1]-m[N])/(a.pow(4,b)-1);E=y.length,m=y,y=[],b++}return m},richardson:function(c,o,l,u){function d(O,T){for(var A=0,L=O.length,G;A<L;A++)O[A]===T&&(G=A);return G}for(var g=a.abs(l-c[d(c,l)+1]),v=0,y=[],m=[],b,E,N,R,C;u>=g;)b=d(c,l+u),E=d(c,l),y[v]=(o[b]-2*o[E]+o[2*E-b])/(u*u),u/=2,v++;for(R=y.length,N=1;R!=1;){for(C=0;C<R-1;C++)m[C]=(a.pow(4,N)*y[C+1]-y[C])/(a.pow(4,N)-1);R=m.length,y=m,m=[],N++}return y},simpson:function(c,o,l,u){for(var d=(l-o)/u,g=c(o),v=[],y=o,m=0,b=1,E;y<=l;y=y+d,m++)v[m]=y;for(E=v.length;b<E-1;b++)g+=(b%2!==0?4:2)*c(v[b]);return d/3*(g+c(l))},hermite:function(c,o,l,u){for(var d=c.length,g=0,v=0,y=[],m=[],b=[],E=[],N;v<d;v++){for(y[v]=1,N=0;N<d;N++)v!=N&&(y[v]*=(u-c[N])/(c[v]-c[N]));for(m[v]=0,N=0;N<d;N++)v!=N&&(m[v]+=1/(c[v]-c[N]));b[v]=(1-2*(u-c[v])*m[v])*(y[v]*y[v]),E[v]=(u-c[v])*(y[v]*y[v]),g+=b[v]*o[v]+E[v]*l[v]}return g},lagrange:function(c,o,l){for(var u=0,d=0,g,v,y=c.length;d<y;d++){for(v=o[d],g=0;g<y;g++)d!=g&&(v*=(l-c[g])/(c[d]-c[g]));u+=v}return u},cubic_spline:function(c,o,l){for(var u=c.length,d=0,g,v=[],y=[],m=[],b=[],E=[],N=[],R=[];d<u-1;d++)E[d]=c[d+1]-c[d];for(m[0]=0,d=1;d<u-1;d++)m[d]=3/E[d]*(o[d+1]-o[d])-3/E[d-1]*(o[d]-o[d-1]);for(d=1;d<u-1;d++)v[d]=[],y[d]=[],v[d][d-1]=E[d-1],v[d][d]=2*(E[d-1]+E[d]),v[d][d+1]=E[d],y[d][0]=m[d];for(b=n.multiply(n.inv(v),y),g=0;g<u-1;g++)N[g]=(o[g+1]-o[g])/E[g]-E[g]*(b[g+1][0]+2*b[g][0])/3,R[g]=(b[g+1][0]-b[g][0])/(3*E[g]);for(g=0;g<u&&!(c[g]>l);g++);return g-=1,o[g]+(l-c[g])*N[g]+n.sq(l-c[g])*b[g]+(l-c[g])*n.sq(l-c[g])*R[g]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(c){var o=c.length,l=c[0].length,u=0,d,g,v=[],y=[],m=[],b=[],E=[],N=[],R=[],C=[],O=[],T=[];for(u=0;u<o;u++)v[u]=n.sum(c[u])/l;for(u=0;u<l;u++)for(R[u]=[],d=0;d<o;d++)R[u][d]=c[d][u]-v[d];for(R=n.transpose(R),u=0;u<o;u++)for(C[u]=[],d=0;d<o;d++)C[u][d]=n.dot([R[u]],[R[d]])/(l-1);for(m=n.jacobi(C),O=m[0],y=m[1],T=n.transpose(O),u=0;u<y.length;u++)for(d=u;d<y.length;d++)y[u]<y[d]&&(g=y[u],y[u]=y[d],y[d]=g,b=T[u],T[u]=T[d],T[d]=b);for(N=n.transpose(R),u=0;u<o;u++)for(E[u]=[],d=0;d<N.length;d++)E[u][d]=n.dot([T[u]],[N[d]]);return[c,y,T,E]}}),function(h){for(var c=0;c<h.length;c++)(function(o){n.fn[o]=function(l,u){var d=this;return u?(setTimeout(function(){u.call(d,n.fn[o].call(d,l))},15),this):typeof n[o](this,l)=="number"?n[o](this,l):n(n[o](this,l))}})(h[c])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(r,Math),function(n,a){var i=[].slice,s=n.utils.isNumber,f=n.utils.isArray;n.extend({zscore:function(){var o=i.call(arguments);return s(o[1])?(o[0]-o[1])/o[2]:(o[0]-n.mean(o[1]))/n.stdev(o[1],o[2])},ztest:function(){var o=i.call(arguments),l;return f(o[1])?(l=n.zscore(o[0],o[1],o[3]),o[2]===1?n.normal.cdf(-a.abs(l),0,1):n.normal.cdf(-a.abs(l),0,1)*2):o.length>2?(l=n.zscore(o[0],o[1],o[2]),o[3]===1?n.normal.cdf(-a.abs(l),0,1):n.normal.cdf(-a.abs(l),0,1)*2):(l=o[0],o[1]===1?n.normal.cdf(-a.abs(l),0,1):n.normal.cdf(-a.abs(l),0,1)*2)}}),n.extend(n.fn,{zscore:function(o,l){return(o-this.mean())/this.stdev(l)},ztest:function(o,l,u){var d=a.abs(this.zscore(o,u));return l===1?n.normal.cdf(-d,0,1):n.normal.cdf(-d,0,1)*2}}),n.extend({tscore:function(){var o=i.call(arguments);return o.length===4?(o[0]-o[1])/(o[2]/a.sqrt(o[3])):(o[0]-n.mean(o[1]))/(n.stdev(o[1],!0)/a.sqrt(o[1].length))},ttest:function(){var o=i.call(arguments),l;return o.length===5?(l=a.abs(n.tscore(o[0],o[1],o[2],o[3])),o[4]===1?n.studentt.cdf(-l,o[3]-1):n.studentt.cdf(-l,o[3]-1)*2):s(o[1])?(l=a.abs(o[0]),o[2]==1?n.studentt.cdf(-l,o[1]-1):n.studentt.cdf(-l,o[1]-1)*2):(l=a.abs(n.tscore(o[0],o[1])),o[2]==1?n.studentt.cdf(-l,o[1].length-1):n.studentt.cdf(-l,o[1].length-1)*2)}}),n.extend(n.fn,{tscore:function(o){return(o-this.mean())/(this.stdev(!0)/a.sqrt(this.cols()))},ttest:function(o,l){return l===1?1-n.studentt.cdf(a.abs(this.tscore(o)),this.cols()-1):n.studentt.cdf(-a.abs(this.tscore(o)),this.cols()-1)*2}}),n.extend({anovafscore:function(){var o=i.call(arguments),l,u,d,g,v,y,m,b;if(o.length===1){for(v=new Array(o[0].length),m=0;m<o[0].length;m++)v[m]=o[0][m];o=v}for(u=new Array,m=0;m<o.length;m++)u=u.concat(o[m]);for(d=n.mean(u),l=0,m=0;m<o.length;m++)l=l+o[m].length*a.pow(n.mean(o[m])-d,2);for(l/=o.length-1,y=0,m=0;m<o.length;m++)for(g=n.mean(o[m]),b=0;b<o[m].length;b++)y+=a.pow(o[m][b]-g,2);return y/=u.length-o.length,l/y},anovaftest:function(){var o=i.call(arguments),l,u,d,g;if(s(o[0]))return 1-n.centralF.cdf(o[0],o[1],o[2]);var v=n.anovafscore(o);for(l=o.length-1,d=0,g=0;g<o.length;g++)d=d+o[g].length;return u=d-l-1,1-n.centralF.cdf(v,l,u)},ftest:function(o,l,u){return 1-n.centralF.cdf(o,l,u)}}),n.extend(n.fn,{anovafscore:function(){return n.anovafscore(this.toArray())},anovaftes:function(){var o=0,l;for(l=0;l<this.length;l++)o=o+this[l].length;return n.ftest(this.anovafscore(),this.length-1,o-this.length)}}),n.extend({qscore:function(){var o=i.call(arguments),l,u,d,g,v;return s(o[0])?(l=o[0],u=o[1],d=o[2],g=o[3],v=o[4]):(l=n.mean(o[0]),u=n.mean(o[1]),d=o[0].length,g=o[1].length,v=o[2]),a.abs(l-u)/(v*a.sqrt((1/d+1/g)/2))},qtest:function(){var o=i.call(arguments),l;o.length===3?(l=o[0],o=o.slice(1)):o.length===7?(l=n.qscore(o[0],o[1],o[2],o[3],o[4]),o=o.slice(5)):(l=n.qscore(o[0],o[1],o[2]),o=o.slice(3));var u=o[0],d=o[1];return 1-n.tukey.cdf(l,d,u-d)},tukeyhsd:function(o){for(var l=n.pooledstdev(o),u=o.map(function(b){return n.mean(b)}),d=o.reduce(function(b,E){return b+E.length},0),g=[],v=0;v<o.length;++v)for(var y=v+1;y<o.length;++y){var m=n.qtest(u[v],u[y],o[v].length,o[y].length,l,d,o.length);g.push([[v,y],m])}return g}}),n.extend({normalci:function(){var o=i.call(arguments),l=new Array(2),u;return o.length===4?u=a.abs(n.normal.inv(o[1]/2,0,1)*o[2]/a.sqrt(o[3])):u=a.abs(n.normal.inv(o[1]/2,0,1)*n.stdev(o[2])/a.sqrt(o[2].length)),l[0]=o[0]-u,l[1]=o[0]+u,l},tci:function(){var o=i.call(arguments),l=new Array(2),u;return o.length===4?u=a.abs(n.studentt.inv(o[1]/2,o[3]-1)*o[2]/a.sqrt(o[3])):u=a.abs(n.studentt.inv(o[1]/2,o[2].length-1)*n.stdev(o[2],!0)/a.sqrt(o[2].length)),l[0]=o[0]-u,l[1]=o[0]+u,l},significant:function(o,l){return o<l}}),n.extend(n.fn,{normalci:function(o,l){return n.normalci(o,l,this.toArray())},tci:function(o,l){return n.tci(o,l,this.toArray())}});function h(c,o,l,u){if(c>1||l>1||c<=0||l<=0)throw new Error("Proportions should be greater than 0 and less than 1");var d=(c*o+l*u)/(o+u),g=a.sqrt(d*(1-d)*(1/o+1/u));return(c-l)/g}n.extend(n.fn,{oneSidedDifferenceOfProportions:function(o,l,u,d){var g=h(o,l,u,d);return n.ztest(g,1)},twoSidedDifferenceOfProportions:function(o,l,u,d){var g=h(o,l,u,d);return n.ztest(g,2)}})}(r,Math),r.models=function(){function n(h){var c=h[0].length,o=r.arange(c).map(function(l){var u=r.arange(c).filter(function(d){return d!==l});return a(r.col(h,l).map(function(d){return d[0]}),r.col(h,u))});return o}function a(h,c){var o=h.length,l=c[0].length-1,u=o-l-1,d=r.lstsq(c,h),g=r.multiply(c,d.map(function(R){return[R]})).map(function(R){return R[0]}),v=r.subtract(h,g),y=r.mean(h),m=r.sum(g.map(function(R){return Math.pow(R-y,2)})),b=r.sum(h.map(function(R,C){return Math.pow(R-g[C],2)})),E=m+b,N=m/E;return{exog:c,endog:h,nobs:o,df_model:l,df_resid:u,coef:d,predict:g,resid:v,ybar:y,SST:E,SSE:m,SSR:b,R2:N}}function i(h){var c=n(h.exog),o=Math.sqrt(h.SSR/h.df_resid),l=c.map(function(y){var m=y.SST,b=y.R2;return o/Math.sqrt(m*(1-b))}),u=h.coef.map(function(y,m){return(y-0)/l[m]}),d=u.map(function(y){var m=r.studentt.cdf(y,h.df_resid);return(m>.5?1-m:m)*2}),g=r.studentt.inv(.975,h.df_resid),v=h.coef.map(function(y,m){var b=g*l[m];return[y-b,y+b]});return{se:l,t:u,p:d,sigmaHat:o,interval95:v}}function s(h){var c=h.R2/h.df_model/((1-h.R2)/h.df_resid),o=function(u,d,g){return r.beta.cdf(u/(g/d+u),d/2,g/2)},l=1-o(c,h.df_model,h.df_resid);return{F_statistic:c,pvalue:l}}function f(h,c){var o=a(h,c),l=i(o),u=s(o),d=1-(1-o.R2)*((o.nobs-1)/o.df_resid);return o.t=l,o.f=u,o.adjust_R2=d,o}return{ols:f}}(),r.extend({buildxmatrix:function(){for(var a=new Array(arguments.length),i=0;i<arguments.length;i++){var s=[1];a[i]=s.concat(arguments[i])}return r(a)},builddxmatrix:function(){for(var a=new Array(arguments[0].length),i=0;i<arguments[0].length;i++){var s=[1];a[i]=s.concat(arguments[0][i])}return r(a)},buildjxmatrix:function(a){for(var i=new Array(a.length),s=0;s<a.length;s++)i[s]=a[s];return r.builddxmatrix(i)},buildymatrix:function(a){return r(a).transpose()},buildjymatrix:function(a){return a.transpose()},matrixmult:function(a,i){var s,f,h,c,o;if(a.cols()==i.rows()){if(i.rows()>1){for(c=[],s=0;s<a.rows();s++)for(c[s]=[],f=0;f<i.cols();f++){for(o=0,h=0;h<a.cols();h++)o+=a.toArray()[s][h]*i.toArray()[h][f];c[s][f]=o}return r(c)}for(c=[],s=0;s<a.rows();s++)for(c[s]=[],f=0;f<i.cols();f++){for(o=0,h=0;h<a.cols();h++)o+=a.toArray()[s][h]*i.toArray()[f];c[s][f]=o}return r(c)}},regress:function(a,i){var s=r.xtranspxinv(a),f=a.transpose(),h=r.matrixmult(r(s),f);return r.matrixmult(h,i)},regresst:function(a,i,s){var f=r.regress(a,i),h={};h.anova={};var c=r.jMatYBar(a,f);h.yBar=c;var o=i.mean();h.anova.residuals=r.residuals(i,c),h.anova.ssr=r.ssr(c,o),h.anova.msr=h.anova.ssr/(a[0].length-1),h.anova.sse=r.sse(i,c),h.anova.mse=h.anova.sse/(i.length-(a[0].length-1)-1),h.anova.sst=r.sst(i,o),h.anova.mst=h.anova.sst/(i.length-1),h.anova.r2=1-h.anova.sse/h.anova.sst,h.anova.r2<0&&(h.anova.r2=0),h.anova.fratio=h.anova.msr/h.anova.mse,h.anova.pvalue=r.anovaftest(h.anova.fratio,a[0].length-1,i.length-(a[0].length-1)-1),h.anova.rmse=Math.sqrt(h.anova.mse),h.anova.r2adj=1-h.anova.mse/h.anova.mst,h.anova.r2adj<0&&(h.anova.r2adj=0),h.stats=new Array(a[0].length);for(var l=r.xtranspxinv(a),u,d,g,v=0;v<f.length;v++)u=Math.sqrt(h.anova.mse*Math.abs(l[v][v])),d=Math.abs(f[v]/u),g=r.ttest(d,i.length-a[0].length-1,s),h.stats[v]=[f[v],u,d,g];return h.regress=f,h},xtranspx:function(a){return r.matrixmult(a.transpose(),a)},xtranspxinv:function(a){var i=r.matrixmult(a.transpose(),a),s=r.inv(i);return s},jMatYBar:function(a,i){var s=r.matrixmult(a,i);return new r(s)},residuals:function(a,i){return r.matrixsubtract(a,i)},ssr:function(a,i){for(var s=0,f=0;f<a.length;f++)s+=Math.pow(a[f]-i,2);return s},sse:function(a,i){for(var s=0,f=0;f<a.length;f++)s+=Math.pow(a[f]-i[f],2);return s},sst:function(a,i){for(var s=0,f=0;f<a.length;f++)s+=Math.pow(a[f]-i,2);return s},matrixsubtract:function(a,i){for(var s=new Array(a.length),f=0;f<a.length;f++){s[f]=new Array(a[f].length);for(var h=0;h<a[f].length;h++)s[f][h]=a[f][h]-i[f][h]}return r(s)}}),r.jStat=r,r})})(Ng);var Fe=Ng.exports;const Be=bt,gA=536870911,mA=-536870912,yl=511,mo=-512,yA=/^\s?[+-]?\s?[0-9]+[.]?[0-9]*([eE][+-][0-9]+)?\s?$/,EA=/^\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+-][0-9]+)?)?)\s?[ij]\s?$/,_A=/^\s?([+-]?\s?[0-9]+[.]?[0-9]*([eE][+-][0-9]+)?)\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+-][0-9]+)?)?)\s?[ij]\s?$/;function Et(e){e=Be.accept(e);let t=0,r=0,n="i";if(typeof e=="number")return{real:e,im:r,unit:n};if(typeof e=="boolean")throw S.VALUE;let a=e.match(yA);if(a)return t=Number(a[0]),{real:t,im:r,unit:n};if(a=e.match(EA),a)return r=Number(/^\s?[+-]?\s?$/.test(a[1])?`${a[1]}1`:a[1]),n=a[0].slice(-1),{real:t,im:r,unit:n};if(a=e.match(_A),a)return t=Number(a[1]),r=Number(/^\s?[+-]?\s?$/.test(a[3])?`${a[3]}1`:a[3]),n=a[0].slice(-1),{real:t,im:r,unit:n};throw S.NUM}const Ye={BESSELI:(e,t)=>{if(e=Be.accept(e,w.NUMBER_NO_BOOLEAN),t=Be.accept(t,w.NUMBER_NO_BOOLEAN),t=Math.trunc(t),t<0)throw S.NUM;return fi.besseli(e,t)},BESSELJ:(e,t)=>{if(e=Be.accept(e,w.NUMBER_NO_BOOLEAN),t=Be.accept(t,w.NUMBER_NO_BOOLEAN),t=Math.trunc(t),t<0)throw S.NUM;return fi.besselj(e,t)},BESSELK:(e,t)=>{if(e=Be.accept(e,w.NUMBER_NO_BOOLEAN),t=Be.accept(t,w.NUMBER_NO_BOOLEAN),t=Math.trunc(t),t<0)throw S.NUM;return fi.besselk(e,t)},BESSELY:(e,t)=>{if(e=Be.accept(e,w.NUMBER_NO_BOOLEAN),t=Be.accept(t,w.NUMBER_NO_BOOLEAN),t=Math.trunc(t),t<0)throw S.NUM;return fi.bessely(e,t)},BIN2DEC:e=>{e=Be.accept(e,w.NUMBER_NO_BOOLEAN);const t=e.toString();if(t.length>10)throw S.NUM;return t.length===10&&t.substring(0,1)==="1"?parseInt(t.substring(1),2)+mo:parseInt(t,2)},BIN2HEX:(e,t)=>{e=Be.accept(e,w.NUMBER_NO_BOOLEAN),t=Be.accept(t,w.NUMBER_NO_BOOLEAN,null);const r=e.toString();if(r.length>10)throw S.NUM;if(r.length===10&&r.substring(0,1)==="1")return(parseInt(r.substring(1),2)+0xfffffffe00).toString(16).toUpperCase();const n=parseInt(e,2).toString(16);if(t==null)return n.toUpperCase();if(t<0)throw S.NUM;if(t=Math.trunc(t),t>=n.length)return(Lt.REPT("0",t-n.length)+n).toUpperCase();throw S.NUM},BIN2OCT:(e,t)=>{e=Be.accept(e,w.NUMBER_NO_BOOLEAN),t=Be.accept(t,w.NUMBER,null);const r=e.toString();if(r.length>10)throw S.NUM;if(r.length===10&&r.substr(0,1)==="1")return(parseInt(r.substr(1),2)+1073741312).toString(8);const n=parseInt(e,2).toString(8);if(t==null)return n.toUpperCase();if(t<0)throw S.NUM;if(t=Math.trunc(t),t>=n.length)return Lt.REPT("0",t-n.length)+n;throw S.NUM},BITAND:(e,t)=>{if(e=Be.accept(e,w.NUMBER),t=Be.accept(t,w.NUMBER),e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff)throw S.NUM;return e&t},BITLSHIFT:(e,t)=>{if(e=Be.accept(e,w.NUMBER),t=Be.accept(t,w.NUMBER),t=Math.trunc(t),Math.abs(t)>53||e<0||Math.floor(e)!==e||e>0xffffffffffff)throw S.NUM;const r=t>=0?e*2**t:Math.trunc(e/2**-t);if(r>0xffffffffffff)throw S.NUM;return r},BITOR:(e,t)=>{if(e=Be.accept(e,w.NUMBER),t=Be.accept(t,w.NUMBER),e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff)throw S.NUM;return e|t},BITRSHIFT:(e,t)=>(e=Be.accept(e,w.NUMBER),t=Be.accept(t,w.NUMBER),Ye.BITLSHIFT(e,-t)),BITXOR:(e,t)=>{if(e=Be.accept(e,w.NUMBER),t=Be.accept(t,w.NUMBER),e<0||e>0xffffffffffff||Math.floor(e)!==e||t<0||t>0xffffffffffff||Math.floor(t)!==t)throw S.NUM;return e^t},COMPLEX:(e,t,r)=>{if(e=Be.accept(e,w.NUMBER_NO_BOOLEAN),t=Be.accept(t,w.NUMBER_NO_BOOLEAN),r=Be.accept(r,w.STRING,"i"),r!=="i"&&r!=="j")throw S.VALUE;if(e===0&&t===0)return 0;if(e===0)return t===1?r:t===-1?`-${r}`:t.toString()+r;if(t===0)return e.toString();const n=t>0?"+":"";return t===1?e.toString()+n+r:t===-1?`${e.toString()+n}-${r}`:e.toString()+n+t.toString()+r},DEC2BIN:(e,t)=>{if(e=Be.accept(e,w.NUMBER),t=Be.accept(t,w.NUMBER,null),e<mo||e>yl)throw S.NUM;if(e<0)return`1${Lt.REPT("0",9-(512+e).toString(2).length)}${(512+e).toString(2)}`;const r=parseInt(e,10).toString(2);if(t==null)return r;if(t=Math.trunc(t),t<=0||t<r.length)throw S.NUM;return Lt.REPT("0",t-r.length)+r},DEC2HEX:(e,t)=>{if(e=Be.accept(e,w.NUMBER),t=Be.accept(t,w.NUMBER,null),e<-549755813888||e>549755813888)throw S.NUM;if(e<0)return(1099511627776+e).toString(16).toUpperCase();const r=parseInt(e,10).toString(16);if(t==null)return r.toUpperCase();if(t=Math.trunc(t),t<=0||t<r.length)throw S.NUM;return Lt.REPT("0",t-r.length)+r.toUpperCase()},DEC2OCT:(e,t)=>{if(e=Be.accept(e,w.NUMBER),t=Be.accept(t,w.NUMBER,null),e<-536870912||e>536870912)throw S.NUM;if(e<0)return(e+1073741824).toString(8);const r=parseInt(e,10).toString(8);if(t==null)return r.toUpperCase();if(t=Math.trunc(t),t<=0||t<r.length)throw S.NUM;return Lt.REPT("0",t-r.length)+r},DELTA:(e,t)=>(e=Be.accept(e,w.NUMBER_NO_BOOLEAN),t=Be.accept(t,w.NUMBER_NO_BOOLEAN,0),e===t?1:0),ERF:(e,t)=>(e=Be.accept(e,w.NUMBER_NO_BOOLEAN),t=Be.accept(t,w.NUMBER_NO_BOOLEAN,0),Fe.erf(e)),ERFC:e=>(e=Be.accept(e,w.NUMBER_NO_BOOLEAN),Fe.erfc(e)),GESTEP:(e,t)=>(e=Be.accept(e,w.NUMBER_NO_BOOLEAN),t=Be.accept(t,w.NUMBER_NO_BOOLEAN,0),e>=t?1:0),HEX2BIN:(e,t)=>{if(e=Be.accept(e,w.STRING),t=Be.accept(t,w.NUMBER,null),e.length>10||!/^[0-9a-fA-F]*$/.test(e))throw S.NUM;const r=e.length===10&&e.substr(0,1).toLowerCase()==="f",n=r?parseInt(e,16)-1099511627776:parseInt(e,16);if(n<mo||n>yl)throw S.NUM;if(r)return`1${Lt.REPT("0",9-(n+512).toString(2).length)}${(n+512).toString(2)}`;const a=n.toString(2);if(t==null)return a;if(t=Math.trunc(t),t<=0||t<a.length)throw S.NUM;return Lt.REPT("0",t-a.length)+a},HEX2DEC:e=>{if(e=Be.accept(e,w.STRING),e.length>10||!/^[0-9a-fA-F]*$/.test(e))throw S.NUM;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},HEX2OCT:(e,t)=>{if(e=Be.accept(e,w.STRING),e.length>10||!/^[0-9a-fA-F]*$/.test(e))throw S.NUM;const r=Ye.HEX2DEC(e);if(r>gA||r<mA)throw S.NUM;return Ye.DEC2OCT(r,t)},IMABS:e=>{const{real:t,im:r}=Et(e);return Math.sqrt(t**2+r**2)},IMAGINARY:e=>Et(e).im,IMARGUMENT:e=>{const{real:t,im:r}=Et(e);if(t===0&&r===0)throw S.DIV0;return t===0&&r>0?Math.PI/2:t===0&&r<0?-Math.PI/2:t<0&&r===0?Math.PI:t>0&&r===0?0:t>0?Math.atan(r/t):t<0&&r>0?Math.atan(r/t)+Math.PI:Math.atan(r/t)-Math.PI},IMCONJUGATE:e=>{const{real:t,im:r,unit:n}=Et(e);return r!==0?Ye.COMPLEX(t,-r,n):`${t}`},IMCOS:e=>{const{real:t,im:r,unit:n}=Et(e),a=Math.cos(t)*(Math.exp(r)+Math.exp(-r))/2,i=-Math.sin(t)*(Math.exp(r)-Math.exp(-r))/2;return Ye.COMPLEX(a,i,n)},IMCOSH:e=>{const{real:t,im:r,unit:n}=Et(e),a=Math.cos(r)*(Math.exp(t)+Math.exp(-t))/2,i=-Math.sin(r)*(Math.exp(t)-Math.exp(-t))/2;return Ye.COMPLEX(a,-i,n)},IMCOT:e=>{e=Be.accept(e);const t=Ye.IMCOS(e),r=Ye.IMSIN(e);return Ye.IMDIV(t,r)},IMCSC:e=>(e=Be.accept(e),Ye.IMDIV("1",Ye.IMSIN(e))),IMCSCH:e=>(e=Be.accept(e),Ye.IMDIV("1",Ye.IMSINH(e))),IMDIV:(e,t)=>{const r=Et(e),n=r.real,a=r.im,i=r.unit,s=Et(t),f=s.real,h=s.im,c=s.unit;if(f===0&&h===0||i!==c)throw S.NUM;const o=i,l=f**2+h**2;return Ye.COMPLEX((n*f+a*h)/l,(a*f-n*h)/l,o)},IMEXP:e=>{const{real:t,im:r,unit:n}=Et(e),a=Math.exp(t);return Ye.COMPLEX(a*Math.cos(r),a*Math.sin(r),n)},IMLN:e=>{const{real:t,im:r,unit:n}=Et(e);return Ye.COMPLEX(Math.log(Math.sqrt(t**2+r**2)),Math.atan(r/t),n)},IMLOG10:e=>{const{real:t,im:r,unit:n}=Et(e),a=Math.log(Math.sqrt(t**2+r**2))/Math.log(10),i=Math.atan(r/t)/Math.log(10);return Ye.COMPLEX(a,i,n)},IMLOG2:e=>{const{real:t,im:r,unit:n}=Et(e),a=Math.log(Math.sqrt(t**2+r**2))/Math.log(2),i=Math.atan(r/t)/Math.log(2);return Ye.COMPLEX(a,i,n)},IMPOWER:(e,t)=>{const{unit:r}=Et(e);t=Be.accept(t,w.NUMBER_NO_BOOLEAN);const n=Ye.IMABS(e)**t,a=Ye.IMARGUMENT(e),i=n*Math.cos(t*a),s=n*Math.sin(t*a);return Ye.COMPLEX(i,s,r)},IMPRODUCT:(...e)=>{let t,r=0;return Be.flattenParams(e,null,!1,n=>{if(r===0)t=Be.accept(n),Et(t);else{const a=Et(t),i=a.real,s=a.im,f=a.unit,h=Et(n),c=h.real,o=h.im,l=h.unit;if(f!==l)throw S.VALUE;t=Ye.COMPLEX(i*c-s*o,i*o+s*c)}r++},1),t},IMREAL:e=>Et(e).real,IMSEC:e=>Ye.IMDIV("1",Ye.IMCOS(e)),IMSECH:e=>Ye.IMDIV("1",Ye.IMCOSH(e)),IMSIN:e=>{const{real:t,im:r,unit:n}=Et(e),a=Math.sin(t)*(Math.exp(r)+Math.exp(-r))/2,i=Math.cos(t)*(Math.exp(r)-Math.exp(-r))/2;return Ye.COMPLEX(a,i,n)},IMSINH:e=>{const{real:t,im:r,unit:n}=Et(e),a=Math.cos(r)*(Math.exp(t)-Math.exp(-t))/2,i=Math.sin(r)*(Math.exp(t)+Math.exp(-t))/2;return Ye.COMPLEX(a,i,n)},IMSQRT:e=>{const{unit:t}=Et(e),r=Math.sqrt(Ye.IMABS(e)),n=Ye.IMARGUMENT(e);return Ye.COMPLEX(r*Math.cos(n/2),r*Math.sin(n/2),t)},IMSUB:(e,t)=>{const r=Et(e),n=r.real,a=r.im,i=r.unit,s=Et(t),f=s.real,h=s.im,c=s.unit;if(i!==c)throw S.VALUE;return Ye.COMPLEX(n-f,a-h,i)},IMSUM:(...e)=>{let t=0,r=0,n;return Be.flattenParams(e,null,!1,a=>{const{real:i,im:s,unit:f}=Et(a);if(n||(n=f),n!==f)throw S.VALUE;t+=i,r+=s}),Ye.COMPLEX(t,r,n)},IMTAN:e=>(Et(e),Ye.IMDIV(Ye.IMSIN(e),Ye.IMCOS(e))),OCT2BIN:(e,t)=>{if(e=Be.accept(e,w.STRING),t=Be.accept(t,w.NUMBER,null),e.length>10||t>10||t!==null&&t<0)throw S.NUM;t=Math.trunc(t);const r=e.length===10&&e.substring(0,1)==="7",n=Ye.OCT2DEC(e);if(n<mo||n>yl)return S.NUM;if(r)return`1${Lt.REPT("0",9-(512+n).toString(2).length)}${(512+n).toString(2)}`;const a=n.toString(2);if(t===0)return a;if(t<a.length)throw S.NUM;return Lt.REPT("0",t-a.length)+a},OCT2DEC:e=>{if(e=Be.accept(e,w.STRING),e.length>10)throw S.NUM;for(const r of e)if(r<"0"||r>"7")throw S.NUM;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},OCT2HEX:(e,t)=>{if(e=Be.accept(e,w.STRING),t=Be.accept(t,w.NUMBER_NO_BOOLEAN,null),e.length>10)throw S.NUM;for(const a of e)if(a<"0"||a>"7")throw S.NUM;if(t=Math.trunc(t),t<0||t>10)throw S.NUM;const r=Ye.OCT2DEC(e),n=Ye.DEC2HEX(r);if(t===0)return n;if(t<n.length)throw S.NUM;return Lt.REPT("0",t-n.length)+n}},it=bt,yd={ADDRESS:(e,t,r,n,a)=>{if(e=it.accept(e,w.NUMBER),t=it.accept(t,w.NUMBER),r=it.accept(r,w.NUMBER,1),n=it.accept(n,w.BOOLEAN,!0),a=it.accept(a,w.STRING,""),e<1||t<1||r<1||r>4)throw S.VALUE;let i="";return a.length>0&&(/[^A-Za-z_.\d\u007F-\uFFFF]/.test(a)?i+=`'${a}'!`:i+=`${a}!`),n?(i+=r===1||r===3?"$":"",i+=Xn.columnNumberToName(t),i+=r===1||r===2?"$":"",i+=e):(i+="R",i+=r===4||r===3?`[${e}]`:e,i+="C",i+=r===4||r===2?`[${t}]`:t),i},AREAS:e=>(e=it.accept(e),e instanceof Yn?e.length:1),CHOOSE:(e,...t)=>{},COLUMN:(e,t)=>{if(t==null){if(e.position.col!=null)return e.position.col;throw Error("FormulaParser.parse is called without position parameter.")}else{if(typeof t!="object"||Array.isArray(t))throw S.VALUE;if(it.isCellRef(t))return t.ref.col;if(it.isRangeRef(t))return t.ref.from.col;throw Error("ReferenceFunctions.COLUMN should not reach here.")}},COLUMNS:(e,t)=>{if(t==null)throw Error("COLUMNS requires one argument");if(typeof t!="object"||Array.isArray(t))throw S.VALUE;if(it.isCellRef(t))return 1;if(it.isRangeRef(t))return Math.abs(t.ref.from.col-t.ref.to.col)+1;throw Error("ReferenceFunctions.COLUMNS should not reach here.")},HLOOKUP:(e,t,r,n)=>{e=it.accept(e);try{t=it.accept(t,w.ARRAY,void 0,!1)}catch(s){throw s instanceof S?S.NA:s}if(r=it.accept(r,w.NUMBER),n=it.accept(n,w.BOOLEAN,!0),r<1)throw S.VALUE;if(t[r-1]===void 0)throw S.REF;const a=typeof e;if(n){let s=a===typeof t[0][0]?t[0][0]:null;for(let f=1;f<t[0].length;f++){const h=t[0][f];if(typeof h===a){if(s>e&&h>e)throw S.NA;if(h===e)return t[r-1][f];if(s!=null&&h>e&&s<=e)return t[r-1][f-1];s=h}}if(s==null)throw S.NA;return t[0].length===1?t[r-1][0]:s}let i=-1;if($r.isWildCard(e)?i=t[0].findIndex(s=>$r.toRegex(e,"i").test(s)):i=t[0].findIndex(s=>s===e),i===-1)throw S.NA;return t[r-1][i]},INDEX:(e,t,r,n,a)=>{r=e.utils.extractRefValue(r),r={value:r.val,isArray:r.isArray},r=it.accept(r,w.NUMBER),r=Math.trunc(r),n==null?n=1:(n=e.utils.extractRefValue(n),n={value:n.val,isArray:n.isArray},n=it.accept(n,w.NUMBER,1),n=Math.trunc(n)),a==null?a=1:(a=e.utils.extractRefValue(a),a={value:a.val,isArray:a.isArray},a=it.accept(a,w.NUMBER,1),a=Math.trunc(a));let i=t;if(t instanceof Yn)i=t.refs[a-1];else if(a>1)throw S.REF;if(r===0&&n===0)return i;if(r===0){if(it.isRangeRef(i)){if(i.ref.to.col-i.ref.from.col<n-1)throw S.REF;return i.ref.from.col+=n-1,i.ref.to.col=i.ref.from.col,i}if(Array.isArray(i)){const s=[];return i.forEach(f=>s.push([f[n-1]])),s}}if(n===0){if(it.isRangeRef(i)){if(i.ref.to.row-i.ref.from.row<r-1)throw S.REF;return i.ref.from.row+=r-1,i.ref.to.row=i.ref.from.row,i}if(Array.isArray(i))return i[n-1]}if(r!==0&&n!==0){if(it.isRangeRef(i)){if(i=i.ref,i.to.row-i.from.row<r-1||i.to.col-i.from.col<n-1)throw S.REF;return{ref:{row:i.from.row+r-1,col:i.from.col+n-1}}}if(it.isCellRef(i)){if(i=i.ref,r>1||n>1)throw S.REF;return{ref:{row:i.row+r-1,col:i.col+n-1}}}if(Array.isArray(i)){if(i.length<r||i[0].length<n)throw S.REF;return i[r-1][n-1]}}},MATCH:()=>{},ROW:(e,t)=>{if(t==null){if(e.position.row!=null)return e.position.row;throw Error("FormulaParser.parse is called without position parameter.")}else{if(typeof t!="object"||Array.isArray(t))throw S.VALUE;if(it.isCellRef(t))return t.ref.row;if(it.isRangeRef(t))return t.ref.from.row;throw Error("ReferenceFunctions.ROW should not reach here.")}},ROWS:(e,t)=>{if(t==null)throw Error("ROWS requires one argument");if(typeof t!="object"||Array.isArray(t))throw S.VALUE;if(it.isCellRef(t))return 1;if(it.isRangeRef(t))return Math.abs(t.ref.from.row-t.ref.to.row)+1;throw Error("ReferenceFunctions.ROWS should not reach here.")},TRANSPOSE:e=>{e=it.accept(e,w.ARRAY,void 0,!1);const t=[];for(let r=0;r<e[0].length;r++){t[r]=[];for(let n=0;n<e.length;n++)t[r][n]=e[n][r]}return t},VLOOKUP:(e,t,r,n)=>{e=it.accept(e);try{t=it.accept(t,w.ARRAY,void 0,!1)}catch(s){throw s instanceof S?S.NA:s}if(r=it.accept(r,w.NUMBER),n=it.accept(n,w.BOOLEAN,!0),r<1)throw S.VALUE;if(t[0][r-1]===void 0)throw S.REF;const a=typeof e;if(n){let s=a===typeof t[0][0]?t[0][0]:null;for(let f=1;f<t.length;f++){const h=t[f],c=t[f][0];if(typeof c===a){if(s>e&&c>e)throw S.NA;if(c===e)return h[r-1];if(s!=null&&c>e&&s<=e)return t[f-1][r-1];s=c}}if(s==null)throw S.NA;return t.length===1?t[0][r-1]:s}let i=-1;if($r.isWildCard(e)?i=t.findIndex(s=>$r.toRegex(e,"i").test(s[0])):i=t.findIndex(s=>s[0]===e),i===-1)throw S.NA;return t[i][r-1]}},zt=bt,bA={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7},Ed={CELL:(e,t)=>{},"ERROR.TYPE":e=>{if(e=zt.accept(e),e instanceof S)return bA[e.toString()];throw S.NA},INFO:()=>{},ISBLANK:e=>e.ref?e.value==null||e.value==="":!1,ISERR:e=>(e=zt.accept(e),e instanceof S&&e.toString()!=="#N/A"),ISERROR:e=>(e=zt.accept(e),e instanceof S),ISEVEN:e=>(e=zt.accept(e,w.NUMBER),e=Math.trunc(e),e%2===0),ISLOGICAL:e=>(e=zt.accept(e),typeof e=="boolean"),ISNA:e=>(e=zt.accept(e),e instanceof S&&e.toString()==="#N/A"),ISNONTEXT:e=>(e=zt.accept(e),typeof e!="string"),ISNUMBER:e=>(e=zt.accept(e),typeof e=="number"),ISREF:e=>!e.ref||zt.isCellRef(e)&&(e.ref.row>1048576||e.ref.col>16384)||zt.isRangeRef(e)&&(e.ref.from.row>1048576||e.ref.from.col>16384||e.ref.to.row>1048576||e.ref.to.col>16384)?!1:(e=zt.accept(e),!(e instanceof S&&e.toString()==="#REF!")),ISTEXT:e=>(e=zt.accept(e),typeof e=="string"),N:e=>{e=zt.accept(e);const t=typeof e;if(t==="number")return e;if(t==="boolean")return Number(e);if(e instanceof S)throw e;return 0},NA:()=>{throw S.NA},TYPE:e=>{if(e.ref){if(zt.isRangeRef(e))return 16;if(zt.isCellRef(e)&&(e=zt.accept(e),typeof e=="string"&&e.length===0))return 1}e=zt.accept(e);const t=typeof e;if(t==="number")return 1;if(t==="string")return 2;if(t==="boolean")return 4;if(e instanceof S)return 16;if(Array.isArray(e))return 64;throw S.VALUE}},he=bt,NA=2.5066282746310002,Ag={"BETA.DIST":(e,t,r,n,a,i)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),n=he.accept(n,w.BOOLEAN),a=he.accept(a,w.NUMBER,0),i=he.accept(i,w.NUMBER,1),t<=0||r<=0||e<a||e>i||a===i)throw S.NUM;return e=(e-a)/(i-a),n?Fe.beta.cdf(e,t,r):Fe.beta.pdf(e,t,r)/(i-a)},"BETA.INV":(e,t,r,n,a)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),n=he.accept(n,w.NUMBER,0),a=he.accept(a,w.NUMBER,1),t<=0||r<=0||e<=0||e>1)throw S.NUM;return Fe.beta.inv(e,t,r)*(a-n)+n},"BINOM.DIST":(e,t,r,n)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),n=he.accept(n,w.BOOLEAN),t<0||r<0||r>1||e<0||e>t)throw S.NUM;return n?Fe.binomial.cdf(e,t,r):Fe.binomial.pdf(e,t,r)},"BINOM.DIST.RANGE":(e,t,r,n)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),n=he.accept(n,w.NUMBER,r),e<0||t<0||t>1||r<0||r>e||n<r||n>e)throw S.NUM;let a=0;for(let i=r;i<=n;i++)a+=Dt.COMBIN(e,i)*t**i*(1-t)**(e-i);return a},"BINOM.INV":(e,t,r)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),e<0||t<0||t>1||r<0||r>1)throw S.NUM;let n=0;for(;n<=e;){if(Fe.binomial.cdf(n,e,t)>=r)return n;n++}throw S.NUM},"CHISQ.DIST":(e,t,r)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),t=Math.trunc(t),e<0||t<1||t>10**10)throw S.NUM;return r?Fe.chisquare.cdf(e,t):Fe.chisquare.pdf(e,t)},"CHISQ.DIST.RT":(e,t)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),t=Math.trunc(t),e<0||t<1||t>10**10)throw S.NUM;return 1-Fe.chisquare.cdf(e,t)},"CHISQ.INV":(e,t)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),t=Math.trunc(t),e<0||e>1||t<1||t>10**10)throw S.NUM;return Fe.chisquare.inv(e,t)},"CHISQ.INV.RT":(e,t)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),t=Math.trunc(t),e<0||e>1||t<1||t>10**10)throw S.NUM;return Fe.chisquare.inv(1-e,t)},"CHISQ.TEST":(e,t)=>{const r=he.accept(e,w.ARRAY,void 0,!1,!1),n=he.accept(t,w.ARRAY,void 0,!1,!1);if(r.length!==n.length||r[0].length!==n[0].length||r.length===1&&r[0].length===1)throw S.NA;const a=r.length,i=r[0].length;let s=(a-1)*(i-1);a===1?s=i-1:s=a-1;let f=0;for(let u=0;u<a;u++)for(let d=0;d<i;d++)if(!(typeof r[u][d]!="number"||typeof n[u][d]!="number")){if(n[u][d]===0)throw S.DIV0;f+=(r[u][d]-n[u][d])**2/n[u][d]}let h=Math.exp(-.5*f);s%2===1&&(h*=Math.sqrt(2*f/Math.PI));let c=s;for(;c>=2;)h=h*f/c,c-=2;let o=h,l=s;for(;o>1e-15*h;)l+=2,o=o*f/l,h+=o;return 1-h},"CONFIDENCE.NORM":(e,t,r)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),r=Math.trunc(r),e<=0||e>=1||t<=0||r<1)throw S.NUM;return Fe.normalci(1,e,t,r)[1]-1},"CONFIDENCE.T":(e,t,r)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),r=Math.trunc(r),e<=0||e>=1||t<=0||r<1)throw S.NUM;if(r===1)throw S.DIV0;return Fe.tci(1,e,t,r)[1]-1},CORREL:(e,t)=>{if(e=he.accept(e,w.ARRAY,void 0,!0,!0),t=he.accept(t,w.ARRAY,void 0,!0,!0),e.length!==t.length)throw S.NA;const r=[],n=[];for(let a=0;a<e.length;a++)typeof e[a]!="number"||typeof t[a]!="number"||(r.push(e[a]),n.push(t[a]));if(r.length<=1)throw S.DIV0;return Fe.corrcoeff(r,n)},"COVARIANCE.P":(e,t)=>{if(e=he.accept(e,w.ARRAY,void 0,!0,!0),t=he.accept(t,w.ARRAY,void 0,!0,!0),e.length!==t.length)throw S.NA;const r=[],n=[];for(let f=0;f<e.length;f++)typeof e[f]!="number"||typeof t[f]!="number"||(r.push(e[f]),n.push(t[f]));const a=Fe.mean(r),i=Fe.mean(n);let s=0;for(let f=0;f<r.length;f++)s+=(r[f]-a)*(n[f]-i);return s/r.length},"COVARIANCE.S":(e,t)=>{if(e=he.accept(e,w.ARRAY,void 0,!0,!0),t=he.accept(t,w.ARRAY,void 0,!0,!0),e.length!==t.length)throw S.NA;const r=[],n=[];for(let a=0;a<e.length;a++)typeof e[a]!="number"||typeof t[a]!="number"||(r.push(e[a]),n.push(t[a]));if(r.length<=1)throw S.DIV0;return Fe.covariance(r,n)},DEVSQ:(...e)=>{let t=0;const r=[];he.flattenParams(e,w.NUMBER,!0,(a,i)=>{typeof a=="number"&&(t+=a,r.push(a))});const n=t/r.length;t=0;for(let a=0;a<r.length;a++)t+=(r[a]-n)**2;return t},"EXPON.DIST":(e,t,r)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.BOOLEAN),e<0||t<=0)throw S.NUM;return r?Fe.exponential.cdf(e,t):Fe.exponential.pdf(e,t)},"F.DIST":(e,t,r,n)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),n=he.accept(n,w.BOOLEAN),e<0||t<1||r<1)throw S.NUM;return t=Math.trunc(t),r=Math.trunc(r),n?Fe.centralF.cdf(e,t,r):Fe.centralF.pdf(e,t,r)},"F.DIST.RT":(e,t,r)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),e<0||t<1||r<1)throw S.NUM;return t=Math.trunc(t),r=Math.trunc(r),1-Fe.centralF.cdf(e,t,r)},"F.INV":(e,t,r)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),e<0||e>1||t<1||r<1)throw S.NUM;return t=Math.trunc(t),r=Math.trunc(r),Fe.centralF.inv(e,t,r)},"F.INV.RT":(e,t,r)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),e<0||e>1||t<1||t>=10**10||r<1||r>=10**10)throw S.NUM;return t=Math.trunc(t),r=Math.trunc(r),Fe.centralF.inv(1-e,t,r)},"F.TEST":(e,t)=>{e=he.accept(e,w.ARRAY,void 0,!0,!0),t=he.accept(t,w.ARRAY,void 0,!0,!0);const r=[],n=[];let a=0,i=0;for(let h=0;h<Math.max(e.length,t.length);h++)typeof e[h]=="number"&&(r.push(e[h]),a+=e[h]),typeof t[h]=="number"&&(n.push(t[h]),i+=t[h]);if(r.length<=1||n.length<=1)throw S.DIV0;a/=r.length,i/=n.length;let s=0,f=0;for(let h=0;h<r.length;h++)s+=(a-r[h])**2;s/=r.length-1;for(let h=0;h<n.length;h++)f+=(i-n[h])**2;return f/=n.length-1,Fe.centralF.cdf(s/f,r.length-1,n.length-1)*2},FISHER:e=>{if(e=he.accept(e,w.NUMBER),e<=-1||e>=1)throw S.NUM;return Math.log((1+e)/(1-e))/2},FISHERINV:e=>{e=he.accept(e,w.NUMBER);const t=Math.exp(2*e);return(t-1)/(t+1)},FORECAST:(e,t,r)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.ARRAY,void 0,!0,!0),r=he.accept(r,w.ARRAY,void 0,!0,!0),r.length!==t.length)throw S.NA;const n=[],a=[];let i=!0;for(let u=0;u<t.length;u++)typeof t[u]!="number"||typeof r[u]!="number"||(n.push(t[u]),a.push(r[u]),r[u]!==r[0]&&(i=!1));if(i)throw S.DIV0;const s=Fe.mean(n),f=Fe.mean(a);let h=0,c=0;for(let u=0;u<n.length;u++)h+=(a[u]-f)*(n[u]-s),c+=(a[u]-f)**2;const o=h/c;return s-o*f+o*e},"FORECAST.ETS":()=>{},"FORECAST.ETS.CONFINT":()=>{},"FORECAST.ETS.SEASONALITY":()=>{},"FORECAST.ETS.STAT":()=>{},"FORECAST.LINEAR":(e,t,r)=>Ag.FORECAST(e,t,r),FREQUENCY:(e,t)=>{e=he.accept(e,w.ARRAY,void 0,!0,!0),t=he.accept(t,w.ARRAY,void 0,!0,!0);const r=[];for(let a=0;a<t.length;a++)typeof t[a]=="number"&&r.push(t[a]);r.sort(),r.push(1/0);const n=[];for(let a=0;a<r.length;a++){n[a]=[],n[a][0]=0;for(let i=0;i<e.length;i++){if(typeof e[i]!="number")continue;e[i]<=r[a]&&(n[a][0]++,e[i]=null)}}return n},GAMMA:e=>{if(e=he.accept(e,w.NUMBER),e===0||e<0&&e===Math.trunc(e))throw S.NUM;return Fe.gammafn(e)},"GAMMA.DIST":(e,t,r,n)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),n=he.accept(n,w.BOOLEAN),e<0||t<=0||r<=0)throw S.NUM;return n?Fe.gamma.cdf(e,t,r,!0):Fe.gamma.pdf(e,t,r,!1)},"GAMMA.INV":(e,t,r)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),e<0||e>1||t<=0||r<=0)throw S.NUM;return Fe.gamma.inv(e,t,r)},GAMMALN:e=>{if(e=he.accept(e,w.NUMBER),e<=0)throw S.NUM;return Fe.gammaln(e)},"GAMMALN.PRECISE":e=>{if(e=he.accept(e,w.NUMBER),e<=0)throw S.NUM;return Fe.gammaln(e)},GAUSS:e=>(e=he.accept(e,w.NUMBER),Fe.normal.cdf(e,0,1)-.5),GEOMEAN:(...e)=>{const t=[];return he.flattenParams(e,w.NUMBER,!0,(r,n)=>{typeof r=="number"&&t.push(r)}),Fe.geomean(t)},GROWTH:(e,t,r,n)=>{e=he.accept(e,w.ARRAY,void 0,!0,!0);for(let d=0;d<e.length;d++)if(typeof e[d]!="number")throw S.VALUE;t=he.accept(t,w.ARRAY,null,!0,!0);const a=t==null;if(t==null){t=[];for(let d=1;d<=e.length;d++)t.push(d)}else{if(t.length!==e.length)throw S.REF;for(let d=0;d<t.length;d++)if(typeof t[d]!="number")throw S.VALUE}if(r=he.accept(r,w.ARRAY,null,!1,!0),r==null&&a){r=[];for(let d=1;d<=e.length;d++)r.push(d);r=[r]}else r==null&&(r=Array.isArray(t[0])?t:[t]);n=he.accept(n,w.BOOLEAN,!0);const i=e.length;let s=0,f=0,h=0,c=0;for(let d=0;d<i;d++){const g=t[d],v=Math.log(e[d]);s+=g,f+=v,h+=g*v,c+=g*g}s/=i,f/=i,h/=i,c/=i;let o,l;n?(o=(h-s*f)/(c-s*s),l=f-o*s):(o=h/c,l=0);const u=[];for(let d=0;d<r.length;d++){u[d]=[];for(let g=0;g<r[0].length;g++){if(typeof r[d][g]!="number")throw S.VALUE;u[d][g]=Math.exp(l+o*r[d][g])}}return u},HARMEAN:(...e)=>{let t=0,r=0;return he.flattenParams(e,w.NUMBER,!0,(n,a)=>{typeof n=="number"&&(r+=1/n,t++)}),t/r},"HYPGEOM.DIST":(e,t,r,n,a)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),n=he.accept(n,w.NUMBER),a=he.accept(a,w.BOOLEAN),e=Math.trunc(e),t=Math.trunc(t),r=Math.trunc(r),n=Math.trunc(n),n<=0||e<0||t<=0||r<=0||t>n||r>n||t<e||r<e||e<t-n+r)throw S.NUM;function i(f,h,c,o){return Dt.COMBIN(c,f)*Dt.COMBIN(o-c,h-f)/Dt.COMBIN(o,h)}function s(f,h,c,o){let l=0;for(let u=0;u<=f;u++)l+=i(u,h,c,o);return l}return a?s(e,t,r,n):i(e,t,r,n)},INTERCEPT:(e,t)=>{if(e=he.accept(e,w.ARRAY,void 0,!0,!0),t=he.accept(t,w.ARRAY,void 0,!0,!0),t.length!==e.length)throw S.NA;const r=[],n=[];for(let c=0;c<e.length;c++)typeof e[c]!="number"||typeof t[c]!="number"||(r.push(e[c]),n.push(t[c]));if(r.length<=1)throw S.DIV0;const a=Fe.mean(r),i=Fe.mean(n);let s=0,f=0;for(let c=0;c<r.length;c++)s+=(n[c]-i)*(r[c]-a),f+=(n[c]-i)**2;const h=s/f;return a-h*i},KURT:(...e)=>{let t=0;const r=[];he.flattenParams(e,w.NUMBER,!0,(i,s)=>{typeof i=="number"&&(t+=i,r.push(i))});const n=r.length;t/=n;let a=0;for(let i=0;i<n;i++)a+=(r[i]-t)**4;return a/=Fe.stdev(r,!0)**4,n*(n+1)/((n-1)*(n-2)*(n-3))*a-3*(n-1)*(n-1)/((n-2)*(n-3))},LINEST:()=>{},LOGEST:()=>{},"LOGNORM.DIST":(e,t,r,n)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),n=he.accept(n,w.BOOLEAN),e<=0||r<=0)throw S.NUM;return n?Fe.lognormal.cdf(e,t,r):Fe.lognormal.pdf(e,t,r)},"LOGNORM.INV":(e,t,r)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),e<=0||e>=1||r<=0)throw S.NUM;return Fe.lognormal.inv(e,t,r)},"MODE.MULT":()=>{},"MODE.SNGL":()=>{},"NEGBINOM.DIST":(e,t,r,n)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),n=he.accept(n,w.BOOLEAN),e=Math.trunc(e),t=Math.trunc(t),r<0||r>1||e<0||t<1)throw S.NUM;return n?Fe.negbin.cdf(e,t,r):Fe.negbin.pdf(e,t,r)},"NORM.DIST":(e,t,r,n)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),n=he.accept(n,w.BOOLEAN),r<=0)throw S.NUM;return n?Fe.normal.cdf(e,t,r):Fe.normal.pdf(e,t,r)},"NORM.INV":(e,t,r)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),e<=0||e>=1||r<=0)throw S.NUM;return Fe.normal.inv(e,t,r)},"NORM.S.DIST":(e,t)=>(e=he.accept(e,w.NUMBER),t=he.accept(t,w.BOOLEAN),t?Fe.normal.cdf(e,0,1):Fe.normal.pdf(e,0,1)),"NORM.S.INV":e=>{if(e=he.accept(e,w.NUMBER),e<=0||e>=1)throw S.NUM;return Fe.normal.inv(e,0,1)},PEARSON:()=>{},"PERCENTILE.EXC":()=>{},"PERCENTILE.INC":()=>{},"PERCENTRANK.EXC":()=>{},"PERCENTRANK.INC":()=>{},PERMUTATIONA:()=>{},PHI:e=>(e=he.accept(e,w.NUMBER),Math.exp(-.5*e*e)/NA),"POISSON.DIST":(e,t,r)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.BOOLEAN),e<0||t<0)throw S.NUM;return e=Math.trunc(e),r?Fe.poisson.cdf(e,t):Fe.poisson.pdf(e,t)},PROB:()=>{},"QUARTILE.EXC":()=>{},"QUARTILE.INC":()=>{},"RANK.AVG":()=>{},"RANK.EQ":()=>{},RSQ:()=>{},SKEW:()=>{},"SKEW.P":()=>{},SLOPE:()=>{},STANDARDIZE:(e,t,r)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),r<=0)throw S.NUM;return(e-t)/r},"STDEV.P":()=>{},"STDEV.S":()=>{},STDEVA:()=>{},STDEVPA:()=>{},STEYX:()=>{},"T.DIST":(e,t,r)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.BOOLEAN),t<1)throw S.NUM;return r?Fe.studentt.cdf(e,t):Fe.studentt.pdf(e,t)},"T.DIST.2T":(e,t)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),t<1||e<0)throw S.NUM;return(1-Fe.studentt.cdf(e,t))*2},"T.DIST.RT":(e,t)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),t<1)throw S.NUM;return 1-Fe.studentt.cdf(e,t)},"T.INV":(e,t)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),e<=0||e>1||t<1)throw S.NUM;return t=t%1===0?t:Math.trunc(t),Fe.studentt.inv(e,t)},"T.INV.2T":(e,t)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),e<=0||e>1||t<1)throw S.NUM;return t=t%1===0?t:Math.trunc(t),Math.abs(Fe.studentt.inv(e/2,t))},"T.TEST":()=>{},TREND:()=>{},TRIMMEAN:()=>{},"VAR.P":()=>{},"VAR.S":()=>{},VARA:()=>{},VARPA:()=>{},"WEIBULL.DIST":(e,t,r,n)=>{if(e=he.accept(e,w.NUMBER),t=he.accept(t,w.NUMBER),r=he.accept(r,w.NUMBER),n=he.accept(n,w.BOOLEAN),e<0||t<=0||r<=0)throw S.NUM;return n?1-Math.exp(-((e/r)**t)):e**(t-1)*Math.exp(-((e/r)**t))*t/r**t},"Z.TEST":()=>{}},jr=bt,fc={AVEDEV:(...e)=>{let t=0;const r=[];jr.flattenParams(e,w.NUMBER,!0,(a,i)=>{typeof a=="number"&&(t+=a,r.push(a))});const n=t/r.length;t=0;for(let a=0;a<r.length;a++)t+=Math.abs(r[a]-n);return t/r.length},AVERAGE:(...e)=>{let t=0,r=0;return jr.flattenParams(e,w.NUMBER,!0,(n,a)=>{typeof n=="number"&&(t+=n,r++)}),t/r},AVERAGEA:(...e)=>{let t=0,r=0;return jr.flattenParams(e,w.NUMBER,!0,(n,a)=>{const i=typeof n;i==="number"?(t+=n,r++):i==="string"&&r++}),t/r},AVERAGEIF:(e,t,r,n)=>{const a=jr.retrieveRanges(e,t,n);t=a[0],n=a[1],r=jr.retrieveArg(e,r);const i=r.isArray;r=cc.parse(jr.accept(r));let s=0,f=0;if(t.forEach((h,c)=>{h.forEach((o,l)=>{const u=n[c][l];typeof u=="number"&&(r.op==="wc"?r.match===r.value.test(o)&&(s+=u,f++):Ca.compareOp(o,r.op,r.value,Array.isArray(o),i)&&(s+=u,f++))})}),f===0)throw S.DIV0;return s/f},AVERAGEIFS:()=>{},COUNT:(...e)=>{let t=0;return jr.flattenParams(e,null,!0,(r,n)=>{(n.isLiteral&&!isNaN(r)||typeof r=="number")&&t++}),t},COUNTIF:(e,t)=>{e=jr.accept(e,w.ARRAY,void 0,!1,!0);const r=t.isArray;t=jr.accept(t);let n=0;return t=cc.parse(t),e.forEach(a=>{a.forEach(i=>{t.op==="wc"?t.match===t.value.test(i)&&n++:Ca.compareOp(i,t.op,t.value,Array.isArray(i),r)&&n++})}),n},LARGE:()=>{},MAX:()=>{},MAXA:()=>{},MAXIFS:()=>{},MEDIAN:()=>{},MIN:()=>{},MINA:()=>{},MINIFS:()=>{},PERMUT:()=>{},PERMUTATIONA:()=>{},SMALL:()=>{}};Object.assign(fc,Ag);const AA=bt,CA={ENCODEURL:e=>encodeURIComponent(AA.accept(e,w.STRING)),FILTERXML:()=>{},WEBSERVICE:(e,t)=>{throw S.ERROR("WEBSERVICE is not supported in sync mode.")}};var Cg={},Fi={};Object.defineProperty(Fi,"__esModule",{value:!0});Fi.VERSION=void 0;Fi.VERSION="10.1.2";var dr={},TA=Object.prototype;function RA(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||TA;return e===r}var Bi=RA;function OA(e,t){return function(r){return e(t(r))}}var Tg=OA,wA=Tg,IA=wA(Object.keys,Object),MA=IA,PA=Bi,SA=MA,LA=Object.prototype,$A=LA.hasOwnProperty;function DA(e){if(!PA(e))return SA(e);var t=[];for(var r in Object(e))$A.call(e,r)&&r!="constructor"&&t.push(r);return t}var Rg=DA,xA=typeof Te=="object"&&Te&&Te.Object===Object&&Te,Og=xA,kA=Og,UA=typeof self=="object"&&self&&self.Object===Object&&self,FA=kA||UA||Function("return this")(),Fr=FA,BA=Fr,VA=BA.Symbol,Ba=VA,_d=Ba,wg=Object.prototype,GA=wg.hasOwnProperty,HA=wg.toString,ni=_d?_d.toStringTag:void 0;function WA(e){var t=GA.call(e,ni),r=e[ni];try{e[ni]=void 0;var n=!0}catch{}var a=HA.call(e);return n&&(t?e[ni]=r:delete e[ni]),a}var zA=WA,KA=Object.prototype,qA=KA.toString;function YA(e){return qA.call(e)}var XA=YA,bd=Ba,jA=zA,QA=XA,ZA="[object Null]",JA="[object Undefined]",Nd=bd?bd.toStringTag:void 0;function eC(e){return e==null?e===void 0?JA:ZA:Nd&&Nd in Object(e)?jA(e):QA(e)}var Jn=eC;function tC(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Br=tC,rC=Jn,nC=Br,aC="[object AsyncFunction]",iC="[object Function]",oC="[object GeneratorFunction]",sC="[object Proxy]";function lC(e){if(!nC(e))return!1;var t=rC(e);return t==iC||t==oC||t==aC||t==sC}var Vi=lC,cC=Fr,uC=cC["__core-js_shared__"],fC=uC,El=fC,Ad=function(){var e=/[^.]+$/.exec(El&&El.keys&&El.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function dC(e){return!!Ad&&Ad in e}var hC=dC,pC=Function.prototype,vC=pC.toString;function gC(e){if(e!=null){try{return vC.call(e)}catch{}try{return e+""}catch{}}return""}var Ig=gC,mC=Vi,yC=hC,EC=Br,_C=Ig,bC=/[\\^$.*+?()[\]{}|]/g,NC=/^\[object .+?Constructor\]$/,AC=Function.prototype,CC=Object.prototype,TC=AC.toString,RC=CC.hasOwnProperty,OC=RegExp("^"+TC.call(RC).replace(bC,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function wC(e){if(!EC(e)||yC(e))return!1;var t=mC(e)?OC:NC;return t.test(_C(e))}var IC=wC;function MC(e,t){return e==null?void 0:e[t]}var PC=MC,SC=IC,LC=PC;function $C(e,t){var r=LC(e,t);return SC(r)?r:void 0}var ea=$C,DC=ea,xC=Fr,kC=DC(xC,"DataView"),UC=kC,FC=ea,BC=Fr,VC=FC(BC,"Map"),eu=VC,GC=ea,HC=Fr,WC=GC(HC,"Promise"),zC=WC,KC=ea,qC=Fr,YC=KC(qC,"Set"),Mg=YC,XC=ea,jC=Fr,QC=XC(jC,"WeakMap"),ZC=QC,dc=UC,hc=eu,pc=zC,vc=Mg,gc=ZC,Pg=Jn,Va=Ig,Cd="[object Map]",JC="[object Object]",Td="[object Promise]",Rd="[object Set]",Od="[object WeakMap]",wd="[object DataView]",eT=Va(dc),tT=Va(hc),rT=Va(pc),nT=Va(vc),aT=Va(gc),Gn=Pg;(dc&&Gn(new dc(new ArrayBuffer(1)))!=wd||hc&&Gn(new hc)!=Cd||pc&&Gn(pc.resolve())!=Td||vc&&Gn(new vc)!=Rd||gc&&Gn(new gc)!=Od)&&(Gn=function(e){var t=Pg(e),r=t==JC?e.constructor:void 0,n=r?Va(r):"";if(n)switch(n){case eT:return wd;case tT:return Cd;case rT:return Td;case nT:return Rd;case aT:return Od}return t});var Gi=Gn;function iT(e){return e!=null&&typeof e=="object"}var Vr=iT,oT=Jn,sT=Vr,lT="[object Arguments]";function cT(e){return sT(e)&&oT(e)==lT}var uT=cT,Id=uT,fT=Vr,Sg=Object.prototype,dT=Sg.hasOwnProperty,hT=Sg.propertyIsEnumerable,pT=Id(function(){return arguments}())?Id:function(e){return fT(e)&&dT.call(e,"callee")&&!hT.call(e,"callee")},ds=pT,vT=Array.isArray,ct=vT,gT=9007199254740991;function mT(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=gT}var tu=mT,yT=Vi,ET=tu;function _T(e){return e!=null&&ET(e.length)&&!yT(e)}var Gr=_T,Pa={exports:{}};function bT(){return!1}var NT=bT;(function(e,t){var r=Fr,n=NT,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===a,f=s?r.Buffer:void 0,h=f?f.isBuffer:void 0,c=h||n;e.exports=c})(Pa,Pa.exports);var AT=Jn,CT=tu,TT=Vr,RT="[object Arguments]",OT="[object Array]",wT="[object Boolean]",IT="[object Date]",MT="[object Error]",PT="[object Function]",ST="[object Map]",LT="[object Number]",$T="[object Object]",DT="[object RegExp]",xT="[object Set]",kT="[object String]",UT="[object WeakMap]",FT="[object ArrayBuffer]",BT="[object DataView]",VT="[object Float32Array]",GT="[object Float64Array]",HT="[object Int8Array]",WT="[object Int16Array]",zT="[object Int32Array]",KT="[object Uint8Array]",qT="[object Uint8ClampedArray]",YT="[object Uint16Array]",XT="[object Uint32Array]",vt={};vt[VT]=vt[GT]=vt[HT]=vt[WT]=vt[zT]=vt[KT]=vt[qT]=vt[YT]=vt[XT]=!0;vt[RT]=vt[OT]=vt[FT]=vt[wT]=vt[BT]=vt[IT]=vt[MT]=vt[PT]=vt[ST]=vt[LT]=vt[$T]=vt[DT]=vt[xT]=vt[kT]=vt[UT]=!1;function jT(e){return TT(e)&&CT(e.length)&&!!vt[AT(e)]}var QT=jT;function ZT(e){return function(t){return e(t)}}var Hi=ZT,Sa={exports:{}};(function(e,t){var r=Og,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,s=i&&r.process,f=function(){try{var h=a&&a.require&&a.require("util").types;return h||s&&s.binding&&s.binding("util")}catch{}}();e.exports=f})(Sa,Sa.exports);var JT=QT,eR=Hi,Md=Sa.exports,Pd=Md&&Md.isTypedArray,tR=Pd?eR(Pd):JT,ru=tR,rR=Rg,nR=Gi,aR=ds,iR=ct,oR=Gr,sR=Pa.exports,lR=Bi,cR=ru,uR="[object Map]",fR="[object Set]",dR=Object.prototype,hR=dR.hasOwnProperty;function pR(e){if(e==null)return!0;if(oR(e)&&(iR(e)||typeof e=="string"||typeof e.splice=="function"||sR(e)||cR(e)||aR(e)))return!e.length;var t=nR(e);if(t==uR||t==fR)return!e.size;if(lR(e))return!rR(e).length;for(var r in e)if(hR.call(e,r))return!1;return!0}var Hr=pR;function vR(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var Wi=vR;function gR(){this.__data__=[],this.size=0}var mR=gR;function yR(e,t){return e===t||e!==e&&t!==t}var zi=yR,ER=zi;function _R(e,t){for(var r=e.length;r--;)if(ER(e[r][0],t))return r;return-1}var hs=_R,bR=hs,NR=Array.prototype,AR=NR.splice;function CR(e){var t=this.__data__,r=bR(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():AR.call(t,r,1),--this.size,!0}var TR=CR,RR=hs;function OR(e){var t=this.__data__,r=RR(t,e);return r<0?void 0:t[r][1]}var wR=OR,IR=hs;function MR(e){return IR(this.__data__,e)>-1}var PR=MR,SR=hs;function LR(e,t){var r=this.__data__,n=SR(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var $R=LR,DR=mR,xR=TR,kR=wR,UR=PR,FR=$R;function Ga(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ga.prototype.clear=DR;Ga.prototype.delete=xR;Ga.prototype.get=kR;Ga.prototype.has=UR;Ga.prototype.set=FR;var ps=Ga,BR=ps;function VR(){this.__data__=new BR,this.size=0}var GR=VR;function HR(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var WR=HR;function zR(e){return this.__data__.get(e)}var KR=zR;function qR(e){return this.__data__.has(e)}var YR=qR,XR=ea,jR=XR(Object,"create"),vs=jR,Sd=vs;function QR(){this.__data__=Sd?Sd(null):{},this.size=0}var ZR=QR;function JR(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var eO=JR,tO=vs,rO="__lodash_hash_undefined__",nO=Object.prototype,aO=nO.hasOwnProperty;function iO(e){var t=this.__data__;if(tO){var r=t[e];return r===rO?void 0:r}return aO.call(t,e)?t[e]:void 0}var oO=iO,sO=vs,lO=Object.prototype,cO=lO.hasOwnProperty;function uO(e){var t=this.__data__;return sO?t[e]!==void 0:cO.call(t,e)}var fO=uO,dO=vs,hO="__lodash_hash_undefined__";function pO(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=dO&&t===void 0?hO:t,this}var vO=pO,gO=ZR,mO=eO,yO=oO,EO=fO,_O=vO;function Ha(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ha.prototype.clear=gO;Ha.prototype.delete=mO;Ha.prototype.get=yO;Ha.prototype.has=EO;Ha.prototype.set=_O;var bO=Ha,Ld=bO,NO=ps,AO=eu;function CO(){this.size=0,this.__data__={hash:new Ld,map:new(AO||NO),string:new Ld}}var TO=CO;function RO(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var OO=RO,wO=OO;function IO(e,t){var r=e.__data__;return wO(t)?r[typeof t=="string"?"string":"hash"]:r.map}var gs=IO,MO=gs;function PO(e){var t=MO(this,e).delete(e);return this.size-=t?1:0,t}var SO=PO,LO=gs;function $O(e){return LO(this,e).get(e)}var DO=$O,xO=gs;function kO(e){return xO(this,e).has(e)}var UO=kO,FO=gs;function BO(e,t){var r=FO(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var VO=BO,GO=TO,HO=SO,WO=DO,zO=UO,KO=VO;function Wa(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Wa.prototype.clear=GO;Wa.prototype.delete=HO;Wa.prototype.get=WO;Wa.prototype.has=zO;Wa.prototype.set=KO;var nu=Wa,qO=ps,YO=eu,XO=nu,jO=200;function QO(e,t){var r=this.__data__;if(r instanceof qO){var n=r.__data__;if(!YO||n.length<jO-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new XO(n)}return r.set(e,t),this.size=r.size,this}var ZO=QO,JO=ps,ew=GR,tw=WR,rw=KR,nw=YR,aw=ZO;function za(e){var t=this.__data__=new JO(e);this.size=t.size}za.prototype.clear=ew;za.prototype.delete=tw;za.prototype.get=rw;za.prototype.has=nw;za.prototype.set=aw;var au=za,iw="__lodash_hash_undefined__";function ow(e){return this.__data__.set(e,iw),this}var sw=ow;function lw(e){return this.__data__.has(e)}var cw=lw,uw=nu,fw=sw,dw=cw;function Wo(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new uw;++t<r;)this.add(e[t])}Wo.prototype.add=Wo.prototype.push=fw;Wo.prototype.has=dw;var iu=Wo;function hw(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var Lg=hw;function pw(e,t){return e.has(t)}var ou=pw,vw=iu,gw=Lg,mw=ou,yw=1,Ew=2;function _w(e,t,r,n,a,i){var s=r&yw,f=e.length,h=t.length;if(f!=h&&!(s&&h>f))return!1;var c=i.get(e),o=i.get(t);if(c&&o)return c==t&&o==e;var l=-1,u=!0,d=r&Ew?new vw:void 0;for(i.set(e,t),i.set(t,e);++l<f;){var g=e[l],v=t[l];if(n)var y=s?n(v,g,l,t,e,i):n(g,v,l,e,t,i);if(y!==void 0){if(y)continue;u=!1;break}if(d){if(!gw(t,function(m,b){if(!mw(d,b)&&(g===m||a(g,m,r,n,i)))return d.push(b)})){u=!1;break}}else if(!(g===v||a(g,v,r,n,i))){u=!1;break}}return i.delete(e),i.delete(t),u}var $g=_w,bw=Fr,Nw=bw.Uint8Array,Dg=Nw;function Aw(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var Cw=Aw;function Tw(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var su=Tw,$d=Ba,Dd=Dg,Rw=zi,Ow=$g,ww=Cw,Iw=su,Mw=1,Pw=2,Sw="[object Boolean]",Lw="[object Date]",$w="[object Error]",Dw="[object Map]",xw="[object Number]",kw="[object RegExp]",Uw="[object Set]",Fw="[object String]",Bw="[object Symbol]",Vw="[object ArrayBuffer]",Gw="[object DataView]",xd=$d?$d.prototype:void 0,_l=xd?xd.valueOf:void 0;function Hw(e,t,r,n,a,i,s){switch(r){case Gw:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Vw:return!(e.byteLength!=t.byteLength||!i(new Dd(e),new Dd(t)));case Sw:case Lw:case xw:return Rw(+e,+t);case $w:return e.name==t.name&&e.message==t.message;case kw:case Fw:return e==t+"";case Dw:var f=ww;case Uw:var h=n&Mw;if(f||(f=Iw),e.size!=t.size&&!h)return!1;var c=s.get(e);if(c)return c==t;n|=Pw,s.set(e,t);var o=Ow(f(e),f(t),n,a,i,s);return s.delete(e),o;case Bw:if(_l)return _l.call(e)==_l.call(t)}return!1}var Ww=Hw;function zw(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var lu=zw,Kw=lu,qw=ct;function Yw(e,t,r){var n=t(e);return qw(e)?n:Kw(n,r(e))}var xg=Yw;function Xw(e,t){for(var r=-1,n=e==null?0:e.length,a=0,i=[];++r<n;){var s=e[r];t(s,r,e)&&(i[a++]=s)}return i}var cu=Xw;function jw(){return[]}var kg=jw,Qw=cu,Zw=kg,Jw=Object.prototype,eI=Jw.propertyIsEnumerable,kd=Object.getOwnPropertySymbols,tI=kd?function(e){return e==null?[]:(e=Object(e),Qw(kd(e),function(t){return eI.call(e,t)}))}:Zw,uu=tI;function rI(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var nI=rI,aI=9007199254740991,iI=/^(?:0|[1-9]\d*)$/;function oI(e,t){var r=typeof e;return t=t==null?aI:t,!!t&&(r=="number"||r!="symbol"&&iI.test(e))&&e>-1&&e%1==0&&e<t}var ms=oI,sI=nI,lI=ds,cI=ct,uI=Pa.exports,fI=ms,dI=ru,hI=Object.prototype,pI=hI.hasOwnProperty;function vI(e,t){var r=cI(e),n=!r&&lI(e),a=!r&&!n&&uI(e),i=!r&&!n&&!a&&dI(e),s=r||n||a||i,f=s?sI(e.length,String):[],h=f.length;for(var c in e)(t||pI.call(e,c))&&!(s&&(c=="length"||a&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||fI(c,h)))&&f.push(c);return f}var Ug=vI,gI=Ug,mI=Rg,yI=Gr;function EI(e){return yI(e)?gI(e):mI(e)}var yr=EI,_I=xg,bI=uu,NI=yr;function AI(e){return _I(e,NI,bI)}var Fg=AI,Ud=Fg,CI=1,TI=Object.prototype,RI=TI.hasOwnProperty;function OI(e,t,r,n,a,i){var s=r&CI,f=Ud(e),h=f.length,c=Ud(t),o=c.length;if(h!=o&&!s)return!1;for(var l=h;l--;){var u=f[l];if(!(s?u in t:RI.call(t,u)))return!1}var d=i.get(e),g=i.get(t);if(d&&g)return d==t&&g==e;var v=!0;i.set(e,t),i.set(t,e);for(var y=s;++l<h;){u=f[l];var m=e[u],b=t[u];if(n)var E=s?n(b,m,u,t,e,i):n(m,b,u,e,t,i);if(!(E===void 0?m===b||a(m,b,r,n,i):E)){v=!1;break}y||(y=u=="constructor")}if(v&&!y){var N=e.constructor,R=t.constructor;N!=R&&"constructor"in e&&"constructor"in t&&!(typeof N=="function"&&N instanceof N&&typeof R=="function"&&R instanceof R)&&(v=!1)}return i.delete(e),i.delete(t),v}var wI=OI,bl=au,II=$g,MI=Ww,PI=wI,Fd=Gi,Bd=ct,Vd=Pa.exports,SI=ru,LI=1,Gd="[object Arguments]",Hd="[object Array]",yo="[object Object]",$I=Object.prototype,Wd=$I.hasOwnProperty;function DI(e,t,r,n,a,i){var s=Bd(e),f=Bd(t),h=s?Hd:Fd(e),c=f?Hd:Fd(t);h=h==Gd?yo:h,c=c==Gd?yo:c;var o=h==yo,l=c==yo,u=h==c;if(u&&Vd(e)){if(!Vd(t))return!1;s=!0,o=!1}if(u&&!o)return i||(i=new bl),s||SI(e)?II(e,t,r,n,a,i):MI(e,t,h,r,n,a,i);if(!(r&LI)){var d=o&&Wd.call(e,"__wrapped__"),g=l&&Wd.call(t,"__wrapped__");if(d||g){var v=d?e.value():e,y=g?t.value():t;return i||(i=new bl),a(v,y,r,n,i)}}return u?(i||(i=new bl),PI(e,t,r,n,a,i)):!1}var xI=DI,kI=xI,zd=Vr;function Bg(e,t,r,n,a){return e===t?!0:e==null||t==null||!zd(e)&&!zd(t)?e!==e&&t!==t:kI(e,t,r,n,Bg,a)}var Vg=Bg,UI=au,FI=Vg,BI=1,VI=2;function GI(e,t,r,n){var a=r.length,i=a,s=!n;if(e==null)return!i;for(e=Object(e);a--;){var f=r[a];if(s&&f[2]?f[1]!==e[f[0]]:!(f[0]in e))return!1}for(;++a<i;){f=r[a];var h=f[0],c=e[h],o=f[1];if(s&&f[2]){if(c===void 0&&!(h in e))return!1}else{var l=new UI;if(n)var u=n(c,o,h,e,t,l);if(!(u===void 0?FI(o,c,BI|VI,n,l):u))return!1}}return!0}var HI=GI,WI=Br;function zI(e){return e===e&&!WI(e)}var Gg=zI,KI=Gg,qI=yr;function YI(e){for(var t=qI(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,KI(a)]}return t}var XI=YI;function jI(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var Hg=jI,QI=HI,ZI=XI,JI=Hg;function eM(e){var t=ZI(e);return t.length==1&&t[0][2]?JI(t[0][0],t[0][1]):function(r){return r===e||QI(r,e,t)}}var tM=eM,rM=Jn,nM=Vr,aM="[object Symbol]";function iM(e){return typeof e=="symbol"||nM(e)&&rM(e)==aM}var ys=iM,oM=ct,sM=ys,lM=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,cM=/^\w*$/;function uM(e,t){if(oM(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||sM(e)?!0:cM.test(e)||!lM.test(e)||t!=null&&e in Object(t)}var fu=uM,Wg=nu,fM="Expected a function";function du(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(fM);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var s=e.apply(this,n);return r.cache=i.set(a,s)||i,s};return r.cache=new(du.Cache||Wg),r}du.Cache=Wg;var dM=du,hM=dM,pM=500;function vM(e){var t=hM(e,function(n){return r.size===pM&&r.clear(),n}),r=t.cache;return t}var gM=vM,mM=gM,yM=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,EM=/\\(\\)?/g,_M=mM(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(yM,function(r,n,a,i){t.push(a?i.replace(EM,"$1"):n||r)}),t}),bM=_M,Kd=Ba,NM=Wi,AM=ct,CM=ys,TM=1/0,qd=Kd?Kd.prototype:void 0,Yd=qd?qd.toString:void 0;function zg(e){if(typeof e=="string")return e;if(AM(e))return NM(e,zg)+"";if(CM(e))return Yd?Yd.call(e):"";var t=e+"";return t=="0"&&1/e==-TM?"-0":t}var RM=zg,OM=RM;function wM(e){return e==null?"":OM(e)}var Kg=wM,IM=ct,MM=fu,PM=bM,SM=Kg;function LM(e,t){return IM(e)?e:MM(e,t)?[e]:PM(SM(e))}var Es=LM,$M=ys,DM=1/0;function xM(e){if(typeof e=="string"||$M(e))return e;var t=e+"";return t=="0"&&1/e==-DM?"-0":t}var Ki=xM,kM=Es,UM=Ki;function FM(e,t){t=kM(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[UM(t[r++])];return r&&r==n?e:void 0}var hu=FM,BM=hu;function VM(e,t,r){var n=e==null?void 0:BM(e,t);return n===void 0?r:n}var GM=VM;function HM(e,t){return e!=null&&t in Object(e)}var WM=HM,zM=Es,KM=ds,qM=ct,YM=ms,XM=tu,jM=Ki;function QM(e,t,r){t=zM(t,e);for(var n=-1,a=t.length,i=!1;++n<a;){var s=jM(t[n]);if(!(i=e!=null&&r(e,s)))break;e=e[s]}return i||++n!=a?i:(a=e==null?0:e.length,!!a&&XM(a)&&YM(s,a)&&(qM(e)||KM(e)))}var qg=QM,ZM=WM,JM=qg;function eP(e,t){return e!=null&&JM(e,t,ZM)}var tP=eP,rP=Vg,nP=GM,aP=tP,iP=fu,oP=Gg,sP=Hg,lP=Ki,cP=1,uP=2;function fP(e,t){return iP(e)&&oP(t)?sP(lP(e),t):function(r){var n=nP(r,e);return n===void 0&&n===t?aP(r,e):rP(t,n,cP|uP)}}var dP=fP;function hP(e){return e}var qi=hP;function pP(e){return function(t){return t==null?void 0:t[e]}}var vP=pP,gP=hu;function mP(e){return function(t){return gP(t,e)}}var yP=mP,EP=vP,_P=yP,bP=fu,NP=Ki;function AP(e){return bP(e)?EP(NP(e)):_P(e)}var CP=AP,TP=tM,RP=dP,OP=qi,wP=ct,IP=CP;function MP(e){return typeof e=="function"?e:e==null?OP:typeof e=="object"?wP(e)?RP(e[0],e[1]):TP(e):IP(e)}var Wr=MP;function PP(e){return function(t,r,n){for(var a=-1,i=Object(t),s=n(t),f=s.length;f--;){var h=s[e?f:++a];if(r(i[h],h,i)===!1)break}return t}}var SP=PP,LP=SP,$P=LP(),DP=$P,xP=DP,kP=yr;function UP(e,t){return e&&xP(e,t,kP)}var FP=UP,BP=Gr;function VP(e,t){return function(r,n){if(r==null)return r;if(!BP(r))return e(r,n);for(var a=r.length,i=t?a:-1,s=Object(r);(t?i--:++i<a)&&n(s[i],i,s)!==!1;);return r}}var GP=VP,HP=FP,WP=GP,zP=WP(HP),ta=zP,KP=ta,qP=Gr;function YP(e,t){var r=-1,n=qP(e)?Array(e.length):[];return KP(e,function(a,i,s){n[++r]=t(a,i,s)}),n}var XP=YP,jP=Wi,QP=Wr,ZP=XP,JP=ct;function eS(e,t){var r=JP(e)?jP:ZP;return r(e,QP(t))}var ir=eS;function tS(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var Yg=tS,rS=qi;function nS(e){return typeof e=="function"?e:rS}var aS=nS,iS=Yg,oS=ta,sS=aS,lS=ct;function cS(e,t){var r=lS(e)?iS:oS;return r(e,sS(t))}var Xt=cS,uS=Wi;function fS(e,t){return uS(t,function(r){return e[r]})}var dS=fS,hS=dS,pS=yr;function vS(e){return e==null?[]:hS(e,pS(e))}var un=vS,gS=Object.prototype,mS=gS.hasOwnProperty;function yS(e,t){return e!=null&&mS.call(e,t)}var ES=yS,_S=ES,bS=qg;function NS(e,t){return e!=null&&bS(e,t,_S)}var Er=NS,AS=ea,CS=function(){try{var e=AS(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Xg=CS,Xd=Xg;function TS(e,t,r){t=="__proto__"&&Xd?Xd(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var pu=TS,RS=pu,OS=zi,wS=Object.prototype,IS=wS.hasOwnProperty;function MS(e,t,r){var n=e[t];(!(IS.call(e,t)&&OS(n,r))||r===void 0&&!(t in e))&&RS(e,t,r)}var _s=MS,PS=_s,SS=pu;function LS(e,t,r,n){var a=!r;r||(r={});for(var i=-1,s=t.length;++i<s;){var f=t[i],h=n?n(r[f],e[f],f,r,e):void 0;h===void 0&&(h=e[f]),a?SS(r,f,h):PS(r,f,h)}return r}var Yi=LS,$S=Yi,DS=yr;function xS(e,t){return e&&$S(t,DS(t),e)}var kS=xS;function US(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var FS=US,BS=Br,VS=Bi,GS=FS,HS=Object.prototype,WS=HS.hasOwnProperty;function zS(e){if(!BS(e))return GS(e);var t=VS(e),r=[];for(var n in e)n=="constructor"&&(t||!WS.call(e,n))||r.push(n);return r}var KS=zS,qS=Ug,YS=KS,XS=Gr;function jS(e){return XS(e)?qS(e,!0):YS(e)}var bs=jS,QS=Yi,ZS=bs;function JS(e,t){return e&&QS(t,ZS(t),e)}var eL=JS,mc={exports:{}};(function(e,t){var r=Fr,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,s=i?r.Buffer:void 0,f=s?s.allocUnsafe:void 0;function h(c,o){if(o)return c.slice();var l=c.length,u=f?f(l):new c.constructor(l);return c.copy(u),u}e.exports=h})(mc,mc.exports);function tL(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var rL=tL,nL=Yi,aL=uu;function iL(e,t){return nL(e,aL(e),t)}var oL=iL,sL=Tg,lL=sL(Object.getPrototypeOf,Object),jg=lL,cL=lu,uL=jg,fL=uu,dL=kg,hL=Object.getOwnPropertySymbols,pL=hL?function(e){for(var t=[];e;)cL(t,fL(e)),e=uL(e);return t}:dL,Qg=pL,vL=Yi,gL=Qg;function mL(e,t){return vL(e,gL(e),t)}var yL=mL,EL=xg,_L=Qg,bL=bs;function NL(e){return EL(e,bL,_L)}var Zg=NL,AL=Object.prototype,CL=AL.hasOwnProperty;function TL(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&CL.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var RL=TL,jd=Dg;function OL(e){var t=new e.constructor(e.byteLength);return new jd(t).set(new jd(e)),t}var vu=OL,wL=vu;function IL(e,t){var r=t?wL(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var ML=IL,PL=/\w*$/;function SL(e){var t=new e.constructor(e.source,PL.exec(e));return t.lastIndex=e.lastIndex,t}var LL=SL,Qd=Ba,Zd=Qd?Qd.prototype:void 0,Jd=Zd?Zd.valueOf:void 0;function $L(e){return Jd?Object(Jd.call(e)):{}}var DL=$L,xL=vu;function kL(e,t){var r=t?xL(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var UL=kL,FL=vu,BL=ML,VL=LL,GL=DL,HL=UL,WL="[object Boolean]",zL="[object Date]",KL="[object Map]",qL="[object Number]",YL="[object RegExp]",XL="[object Set]",jL="[object String]",QL="[object Symbol]",ZL="[object ArrayBuffer]",JL="[object DataView]",e$="[object Float32Array]",t$="[object Float64Array]",r$="[object Int8Array]",n$="[object Int16Array]",a$="[object Int32Array]",i$="[object Uint8Array]",o$="[object Uint8ClampedArray]",s$="[object Uint16Array]",l$="[object Uint32Array]";function c$(e,t,r){var n=e.constructor;switch(t){case ZL:return FL(e);case WL:case zL:return new n(+e);case JL:return BL(e,r);case e$:case t$:case r$:case n$:case a$:case i$:case o$:case s$:case l$:return HL(e,r);case KL:return new n;case qL:case jL:return new n(e);case YL:return VL(e);case XL:return new n;case QL:return GL(e)}}var u$=c$,f$=Br,eh=Object.create,d$=function(){function e(){}return function(t){if(!f$(t))return{};if(eh)return eh(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),h$=d$,p$=h$,v$=jg,g$=Bi;function m$(e){return typeof e.constructor=="function"&&!g$(e)?p$(v$(e)):{}}var y$=m$,E$=Gi,_$=Vr,b$="[object Map]";function N$(e){return _$(e)&&E$(e)==b$}var A$=N$,C$=A$,T$=Hi,th=Sa.exports,rh=th&&th.isMap,R$=rh?T$(rh):C$,O$=R$,w$=Gi,I$=Vr,M$="[object Set]";function P$(e){return I$(e)&&w$(e)==M$}var S$=P$,L$=S$,$$=Hi,nh=Sa.exports,ah=nh&&nh.isSet,D$=ah?$$(ah):L$,x$=D$,k$=au,U$=Yg,F$=_s,B$=kS,V$=eL,G$=mc.exports,H$=rL,W$=oL,z$=yL,K$=Fg,q$=Zg,Y$=Gi,X$=RL,j$=u$,Q$=y$,Z$=ct,J$=Pa.exports,e2=O$,t2=Br,r2=x$,n2=yr,a2=bs,i2=1,o2=2,s2=4,Jg="[object Arguments]",l2="[object Array]",c2="[object Boolean]",u2="[object Date]",f2="[object Error]",em="[object Function]",d2="[object GeneratorFunction]",h2="[object Map]",p2="[object Number]",tm="[object Object]",v2="[object RegExp]",g2="[object Set]",m2="[object String]",y2="[object Symbol]",E2="[object WeakMap]",_2="[object ArrayBuffer]",b2="[object DataView]",N2="[object Float32Array]",A2="[object Float64Array]",C2="[object Int8Array]",T2="[object Int16Array]",R2="[object Int32Array]",O2="[object Uint8Array]",w2="[object Uint8ClampedArray]",I2="[object Uint16Array]",M2="[object Uint32Array]",dt={};dt[Jg]=dt[l2]=dt[_2]=dt[b2]=dt[c2]=dt[u2]=dt[N2]=dt[A2]=dt[C2]=dt[T2]=dt[R2]=dt[h2]=dt[p2]=dt[tm]=dt[v2]=dt[g2]=dt[m2]=dt[y2]=dt[O2]=dt[w2]=dt[I2]=dt[M2]=!0;dt[f2]=dt[em]=dt[E2]=!1;function Io(e,t,r,n,a,i){var s,f=t&i2,h=t&o2,c=t&s2;if(r&&(s=a?r(e,n,a,i):r(e)),s!==void 0)return s;if(!t2(e))return e;var o=Z$(e);if(o){if(s=X$(e),!f)return H$(e,s)}else{var l=Y$(e),u=l==em||l==d2;if(J$(e))return G$(e,f);if(l==tm||l==Jg||u&&!a){if(s=h||u?{}:Q$(e),!f)return h?z$(e,V$(s,e)):W$(e,B$(s,e))}else{if(!dt[l])return a?e:{};s=j$(e,l,f)}}i||(i=new k$);var d=i.get(e);if(d)return d;i.set(e,s),r2(e)?e.forEach(function(y){s.add(Io(y,t,r,y,e,i))}):e2(e)&&e.forEach(function(y,m){s.set(m,Io(y,t,r,m,e,i))});var g=c?h?q$:K$:h?a2:n2,v=o?void 0:g(e);return U$(v||e,function(y,m){v&&(m=y,y=e[m]),F$(s,m,Io(y,t,r,m,e,i))}),s}var P2=Io,S2=P2,L2=4;function $2(e){return S2(e,L2)}var Pn=$2,Ka={},La={};Object.defineProperty(La,"__esModule",{value:!0});La.PRINT_WARNING=La.PRINT_ERROR=void 0;function D2(e){console&&console.error&&console.error("Error: ".concat(e))}La.PRINT_ERROR=D2;function x2(e){console&&console.warn&&console.warn("Warning: ".concat(e))}La.PRINT_WARNING=x2;var Ns={};Object.defineProperty(Ns,"__esModule",{value:!0});Ns.timer=void 0;function k2(e){var t=new Date().getTime(),r=e(),n=new Date().getTime(),a=n-t;return{time:a,value:r}}Ns.timer=k2;var As={};Object.defineProperty(As,"__esModule",{value:!0});As.toFastProperties=void 0;function U2(e){function t(){}t.prototype=e;var r=new t;function n(){return typeof r.bar}return n(),n(),e}As.toFastProperties=U2;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.toFastProperties=e.timer=e.PRINT_ERROR=e.PRINT_WARNING=void 0;var t=La;Object.defineProperty(e,"PRINT_WARNING",{enumerable:!0,get:function(){return t.PRINT_WARNING}}),Object.defineProperty(e,"PRINT_ERROR",{enumerable:!0,get:function(){return t.PRINT_ERROR}});var r=Ns;Object.defineProperty(e,"timer",{enumerable:!0,get:function(){return r.timer}});var n=As;Object.defineProperty(e,"toFastProperties",{enumerable:!0,get:function(){return n.toFastProperties}})})(Ka);var Dr={},qa={};function F2(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}var gu=F2,B2=/\s/;function V2(e){for(var t=e.length;t--&&B2.test(e.charAt(t)););return t}var G2=V2,H2=G2,W2=/^\s+/;function z2(e){return e&&e.slice(0,H2(e)+1).replace(W2,"")}var K2=z2,q2=K2,ih=Br,Y2=ys,oh=0/0,X2=/^[-+]0x[0-9a-f]+$/i,j2=/^0b[01]+$/i,Q2=/^0o[0-7]+$/i,Z2=parseInt;function J2(e){if(typeof e=="number")return e;if(Y2(e))return oh;if(ih(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ih(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=q2(e);var r=j2.test(e);return r||Q2.test(e)?Z2(e.slice(2),r?2:8):X2.test(e)?oh:+e}var eD=J2,tD=eD,sh=1/0,rD=17976931348623157e292;function nD(e){if(!e)return e===0?e:0;if(e=tD(e),e===sh||e===-sh){var t=e<0?-1:1;return t*rD}return e===e?e:0}var aD=nD,iD=aD;function oD(e){var t=iD(e),r=t%1;return t===t?r?t-r:t:0}var Xi=oD,sD=gu,lD=Xi;function cD(e,t,r){var n=e==null?0:e.length;return n?(t=r||t===void 0?1:lD(t),sD(e,t<0?0:t,n)):[]}var mu=cD,Pt={},ot={},uD=Jn,fD=ct,dD=Vr,hD="[object String]";function pD(e){return typeof e=="string"||!fD(e)&&dD(e)&&uD(e)==hD}var Cs=pD,vD=Jn,gD=Vr,mD="[object RegExp]";function yD(e){return gD(e)&&vD(e)==mD}var ED=yD,_D=ED,bD=Hi,lh=Sa.exports,ch=lh&&lh.isRegExp,ND=ch?bD(ch):_D,rm=ND,AD=_s,CD=Es,TD=ms,uh=Br,RD=Ki;function OD(e,t,r,n){if(!uh(e))return e;t=CD(t,e);for(var a=-1,i=t.length,s=i-1,f=e;f!=null&&++a<i;){var h=RD(t[a]),c=r;if(h==="__proto__"||h==="constructor"||h==="prototype")return e;if(a!=s){var o=f[h];c=n?n(o,h,f):void 0,c===void 0&&(c=uh(o)?o:TD(t[a+1])?[]:{})}AD(f,h,c),f=f[h]}return e}var wD=OD,ID=hu,MD=wD,PD=Es;function SD(e,t,r){for(var n=-1,a=t.length,i={};++n<a;){var s=t[n],f=ID(e,s);r(f,s)&&MD(i,PD(s,e),f)}return i}var LD=SD,$D=Wi,DD=Wr,xD=LD,kD=Zg;function UD(e,t){if(e==null)return{};var r=$D(kD(e),function(n){return[n]});return t=DD(t),xD(e,r,function(n,a){return t(n,a[0])})}var nm=UD;function FD(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var BD=FD,VD=BD,fh=Math.max;function GD(e,t,r){return t=fh(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=fh(n.length-t,0),s=Array(i);++a<i;)s[a]=n[t+a];a=-1;for(var f=Array(t+1);++a<t;)f[a]=n[a];return f[t]=r(s),VD(e,this,f)}}var HD=GD;function WD(e){return function(){return e}}var zD=WD,KD=zD,dh=Xg,qD=qi,YD=dh?function(e,t){return dh(e,"toString",{configurable:!0,enumerable:!1,value:KD(t),writable:!0})}:qD,XD=YD,jD=800,QD=16,ZD=Date.now;function JD(e){var t=0,r=0;return function(){var n=ZD(),a=QD-(n-r);if(r=n,a>0){if(++t>=jD)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var ex=JD,tx=XD,rx=ex,nx=rx(tx),ax=nx,ix=qi,ox=HD,sx=ax;function lx(e,t){return sx(ox(e,t,ix),e+"")}var yu=lx,cx=zi,ux=Gr,fx=ms,dx=Br;function hx(e,t,r){if(!dx(r))return!1;var n=typeof t;return(n=="number"?ux(r)&&fx(t,r.length):n=="string"&&t in r)?cx(r[t],e):!1}var Ts=hx,px=yu,vx=Ts;function gx(e){return px(function(t,r){var n=-1,a=r.length,i=a>1?r[a-1]:void 0,s=a>2?r[2]:void 0;for(i=e.length>3&&typeof i=="function"?(a--,i):void 0,s&&vx(r[0],r[1],s)&&(i=a<3?void 0:i,a=1),t=Object(t);++n<a;){var f=r[n];f&&e(t,f,n,i)}return t})}var mx=gx,yx=_s,Ex=Yi,_x=mx,bx=Gr,Nx=Bi,Ax=yr,Cx=Object.prototype,Tx=Cx.hasOwnProperty,Rx=_x(function(e,t){if(Nx(t)||bx(t)){Ex(t,Ax(t),e);return}for(var r in t)Tx.call(t,r)&&yx(e,r,t[r])}),Rs=Rx,fn=Te&&Te.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ya=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ot,"__esModule",{value:!0});ot.serializeProduction=ot.serializeGrammar=ot.Terminal=ot.Alternation=ot.RepetitionWithSeparator=ot.Repetition=ot.RepetitionMandatoryWithSeparator=ot.RepetitionMandatory=ot.Option=ot.Alternative=ot.Rule=ot.NonTerminal=ot.AbstractProduction=void 0;var am=Ya(ir),Ox=Ya(Xt),yc=Ya(Cs),wx=Ya(rm),zr=Ya(nm),Kr=Ya(Rs);function Ix(e){return Mx(e)?e.LABEL:e.name}function Mx(e){return(0,yc.default)(e.LABEL)&&e.LABEL!==""}var qr=function(){function e(t){this._definition=t}return Object.defineProperty(e.prototype,"definition",{get:function(){return this._definition},set:function(t){this._definition=t},enumerable:!1,configurable:!0}),e.prototype.accept=function(t){t.visit(this),(0,Ox.default)(this.definition,function(r){r.accept(t)})},e}();ot.AbstractProduction=qr;var im=function(e){fn(t,e);function t(r){var n=e.call(this,[])||this;return n.idx=1,(0,Kr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return Object.defineProperty(t.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(r){},enumerable:!1,configurable:!0}),t.prototype.accept=function(r){r.visit(this)},t}(qr);ot.NonTerminal=im;var om=function(e){fn(t,e);function t(r){var n=e.call(this,r.definition)||this;return n.orgText="",(0,Kr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return t}(qr);ot.Rule=om;var sm=function(e){fn(t,e);function t(r){var n=e.call(this,r.definition)||this;return n.ignoreAmbiguities=!1,(0,Kr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return t}(qr);ot.Alternative=sm;var lm=function(e){fn(t,e);function t(r){var n=e.call(this,r.definition)||this;return n.idx=1,(0,Kr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return t}(qr);ot.Option=lm;var cm=function(e){fn(t,e);function t(r){var n=e.call(this,r.definition)||this;return n.idx=1,(0,Kr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return t}(qr);ot.RepetitionMandatory=cm;var um=function(e){fn(t,e);function t(r){var n=e.call(this,r.definition)||this;return n.idx=1,(0,Kr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return t}(qr);ot.RepetitionMandatoryWithSeparator=um;var fm=function(e){fn(t,e);function t(r){var n=e.call(this,r.definition)||this;return n.idx=1,(0,Kr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return t}(qr);ot.Repetition=fm;var dm=function(e){fn(t,e);function t(r){var n=e.call(this,r.definition)||this;return n.idx=1,(0,Kr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return t}(qr);ot.RepetitionWithSeparator=dm;var hm=function(e){fn(t,e);function t(r){var n=e.call(this,r.definition)||this;return n.idx=1,n.ignoreAmbiguities=!1,n.hasPredicates=!1,(0,Kr.default)(n,(0,zr.default)(r,function(a){return a!==void 0})),n}return Object.defineProperty(t.prototype,"definition",{get:function(){return this._definition},set:function(r){this._definition=r},enumerable:!1,configurable:!0}),t}(qr);ot.Alternation=hm;var Mo=function(){function e(t){this.idx=1,(0,Kr.default)(this,(0,zr.default)(t,function(r){return r!==void 0}))}return e.prototype.accept=function(t){t.visit(this)},e}();ot.Terminal=Mo;function Px(e){return(0,am.default)(e,_i)}ot.serializeGrammar=Px;function _i(e){function t(i){return(0,am.default)(i,_i)}if(e instanceof im){var r={type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};return(0,yc.default)(e.label)&&(r.label=e.label),r}else{if(e instanceof sm)return{type:"Alternative",definition:t(e.definition)};if(e instanceof lm)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof cm)return{type:"RepetitionMandatory",idx:e.idx,definition:t(e.definition)};if(e instanceof um)return{type:"RepetitionMandatoryWithSeparator",idx:e.idx,separator:_i(new Mo({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof dm)return{type:"RepetitionWithSeparator",idx:e.idx,separator:_i(new Mo({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof fm)return{type:"Repetition",idx:e.idx,definition:t(e.definition)};if(e instanceof hm)return{type:"Alternation",idx:e.idx,definition:t(e.definition)};if(e instanceof Mo){var n={type:"Terminal",name:e.terminalType.name,label:Ix(e.terminalType),idx:e.idx};(0,yc.default)(e.label)&&(n.terminalLabel=e.label);var a=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(n.pattern=(0,wx.default)(a)?a.source:a),n}else{if(e instanceof om)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}}}ot.serializeProduction=_i;var Os={};Object.defineProperty(Os,"__esModule",{value:!0});Os.GAstVisitor=void 0;var Mr=ot,Sx=function(){function e(){}return e.prototype.visit=function(t){var r=t;switch(r.constructor){case Mr.NonTerminal:return this.visitNonTerminal(r);case Mr.Alternative:return this.visitAlternative(r);case Mr.Option:return this.visitOption(r);case Mr.RepetitionMandatory:return this.visitRepetitionMandatory(r);case Mr.RepetitionMandatoryWithSeparator:return this.visitRepetitionMandatoryWithSeparator(r);case Mr.RepetitionWithSeparator:return this.visitRepetitionWithSeparator(r);case Mr.Repetition:return this.visitRepetition(r);case Mr.Alternation:return this.visitAlternation(r);case Mr.Terminal:return this.visitTerminal(r);case Mr.Rule:return this.visitRule(r);default:throw Error("non exhaustive match")}},e.prototype.visitNonTerminal=function(t){},e.prototype.visitAlternative=function(t){},e.prototype.visitOption=function(t){},e.prototype.visitRepetition=function(t){},e.prototype.visitRepetitionMandatory=function(t){},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){},e.prototype.visitRepetitionWithSeparator=function(t){},e.prototype.visitAlternation=function(t){},e.prototype.visitTerminal=function(t){},e.prototype.visitRule=function(t){},e}();Os.GAstVisitor=Sx;var xr={},Lx=ta;function $x(e,t){var r;return Lx(e,function(n,a,i){return r=t(n,a,i),!r}),!!r}var Dx=$x,xx=Lg,kx=Wr,Ux=Dx,Fx=ct,Bx=Ts;function Vx(e,t,r){var n=Fx(e)?xx:Ux;return r&&Bx(e,t,r)&&(t=void 0),n(e,kx(t))}var Eu=Vx;function Gx(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var Hx=Gx,Wx=ta;function zx(e,t){var r=!0;return Wx(e,function(n,a,i){return r=!!t(n,a,i),r}),r}var Kx=zx,qx=Hx,Yx=Kx,Xx=Wr,jx=ct,Qx=Ts;function Zx(e,t,r){var n=jx(e)?qx:Yx;return r&&Qx(e,t,r)&&(t=void 0),n(e,Xx(t))}var ws=Zx;function Jx(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var pm=Jx;function ek(e){return e!==e}var tk=ek;function rk(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var nk=rk,ak=pm,ik=tk,ok=nk;function sk(e,t,r){return t===t?ok(e,t,r):ak(e,ik,r)}var _u=sk,lk=_u,ck=Gr,uk=Cs,fk=Xi,dk=un,hk=Math.max;function pk(e,t,r,n){e=ck(e)?e:dk(e),r=r&&!n?fk(r):0;var a=e.length;return r<0&&(r=hk(a+r,0)),uk(e)?r<=a&&e.indexOf(t,r)>-1:!!a&&lk(e,t,r)>-1}var dn=pk,bu=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(xr,"__esModule",{value:!0});xr.getProductionDslName=xr.isBranchingProd=xr.isOptionalProd=xr.isSequenceProd=void 0;var vk=bu(Eu),gk=bu(ws),mk=bu(dn),_t=ot;function yk(e){return e instanceof _t.Alternative||e instanceof _t.Option||e instanceof _t.Repetition||e instanceof _t.RepetitionMandatory||e instanceof _t.RepetitionMandatoryWithSeparator||e instanceof _t.RepetitionWithSeparator||e instanceof _t.Terminal||e instanceof _t.Rule}xr.isSequenceProd=yk;function Ec(e,t){t===void 0&&(t=[]);var r=e instanceof _t.Option||e instanceof _t.Repetition||e instanceof _t.RepetitionWithSeparator;return r?!0:e instanceof _t.Alternation?(0,vk.default)(e.definition,function(n){return Ec(n,t)}):e instanceof _t.NonTerminal&&(0,mk.default)(t,e)?!1:e instanceof _t.AbstractProduction?(e instanceof _t.NonTerminal&&t.push(e),(0,gk.default)(e.definition,function(n){return Ec(n,t)})):!1}xr.isOptionalProd=Ec;function Ek(e){return e instanceof _t.Alternation}xr.isBranchingProd=Ek;function _k(e){if(e instanceof _t.NonTerminal)return"SUBRULE";if(e instanceof _t.Option)return"OPTION";if(e instanceof _t.Alternation)return"OR";if(e instanceof _t.RepetitionMandatory)return"AT_LEAST_ONE";if(e instanceof _t.RepetitionMandatoryWithSeparator)return"AT_LEAST_ONE_SEP";if(e instanceof _t.RepetitionWithSeparator)return"MANY_SEP";if(e instanceof _t.Repetition)return"MANY";if(e instanceof _t.Terminal)return"CONSUME";throw Error("non exhaustive match")}xr.getProductionDslName=_k;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isSequenceProd=e.isBranchingProd=e.isOptionalProd=e.getProductionDslName=e.GAstVisitor=e.serializeProduction=e.serializeGrammar=e.Alternative=e.Alternation=e.RepetitionWithSeparator=e.RepetitionMandatoryWithSeparator=e.RepetitionMandatory=e.Repetition=e.Option=e.NonTerminal=e.Terminal=e.Rule=void 0;var t=ot;Object.defineProperty(e,"Rule",{enumerable:!0,get:function(){return t.Rule}}),Object.defineProperty(e,"Terminal",{enumerable:!0,get:function(){return t.Terminal}}),Object.defineProperty(e,"NonTerminal",{enumerable:!0,get:function(){return t.NonTerminal}}),Object.defineProperty(e,"Option",{enumerable:!0,get:function(){return t.Option}}),Object.defineProperty(e,"Repetition",{enumerable:!0,get:function(){return t.Repetition}}),Object.defineProperty(e,"RepetitionMandatory",{enumerable:!0,get:function(){return t.RepetitionMandatory}}),Object.defineProperty(e,"RepetitionMandatoryWithSeparator",{enumerable:!0,get:function(){return t.RepetitionMandatoryWithSeparator}}),Object.defineProperty(e,"RepetitionWithSeparator",{enumerable:!0,get:function(){return t.RepetitionWithSeparator}}),Object.defineProperty(e,"Alternation",{enumerable:!0,get:function(){return t.Alternation}}),Object.defineProperty(e,"Alternative",{enumerable:!0,get:function(){return t.Alternative}}),Object.defineProperty(e,"serializeGrammar",{enumerable:!0,get:function(){return t.serializeGrammar}}),Object.defineProperty(e,"serializeProduction",{enumerable:!0,get:function(){return t.serializeProduction}});var r=Os;Object.defineProperty(e,"GAstVisitor",{enumerable:!0,get:function(){return r.GAstVisitor}});var n=xr;Object.defineProperty(e,"getProductionDslName",{enumerable:!0,get:function(){return n.getProductionDslName}}),Object.defineProperty(e,"isOptionalProd",{enumerable:!0,get:function(){return n.isOptionalProd}}),Object.defineProperty(e,"isBranchingProd",{enumerable:!0,get:function(){return n.isBranchingProd}}),Object.defineProperty(e,"isSequenceProd",{enumerable:!0,get:function(){return n.isSequenceProd}})})(Pt);var vm=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qa,"__esModule",{value:!0});qa.RestWalker=void 0;var bk=vm(mu),hh=vm(Xt),rr=Pt,Nk=function(){function e(){}return e.prototype.walk=function(t,r){var n=this;r===void 0&&(r=[]),(0,hh.default)(t.definition,function(a,i){var s=(0,bk.default)(t.definition,i+1);if(a instanceof rr.NonTerminal)n.walkProdRef(a,s,r);else if(a instanceof rr.Terminal)n.walkTerminal(a,s,r);else if(a instanceof rr.Alternative)n.walkFlat(a,s,r);else if(a instanceof rr.Option)n.walkOption(a,s,r);else if(a instanceof rr.RepetitionMandatory)n.walkAtLeastOne(a,s,r);else if(a instanceof rr.RepetitionMandatoryWithSeparator)n.walkAtLeastOneSep(a,s,r);else if(a instanceof rr.RepetitionWithSeparator)n.walkManySep(a,s,r);else if(a instanceof rr.Repetition)n.walkMany(a,s,r);else if(a instanceof rr.Alternation)n.walkOr(a,s,r);else throw Error("non exhaustive match")})},e.prototype.walkTerminal=function(t,r,n){},e.prototype.walkProdRef=function(t,r,n){},e.prototype.walkFlat=function(t,r,n){var a=r.concat(n);this.walk(t,a)},e.prototype.walkOption=function(t,r,n){var a=r.concat(n);this.walk(t,a)},e.prototype.walkAtLeastOne=function(t,r,n){var a=[new rr.Option({definition:t.definition})].concat(r,n);this.walk(t,a)},e.prototype.walkAtLeastOneSep=function(t,r,n){var a=ph(t,r,n);this.walk(t,a)},e.prototype.walkMany=function(t,r,n){var a=[new rr.Option({definition:t.definition})].concat(r,n);this.walk(t,a)},e.prototype.walkManySep=function(t,r,n){var a=ph(t,r,n);this.walk(t,a)},e.prototype.walkOr=function(t,r,n){var a=this,i=r.concat(n);(0,hh.default)(t.definition,function(s){var f=new rr.Alternative({definition:[s]});a.walk(f,i)})},e}();qa.RestWalker=Nk;function ph(e,t,r){var n=[new rr.Option({definition:[new rr.Terminal({terminalType:e.separator})].concat(e.definition)})],a=n.concat(t,r);return a}var Tr={},vh=Ba,Ak=ds,Ck=ct,gh=vh?vh.isConcatSpreadable:void 0;function Tk(e){return Ck(e)||Ak(e)||!!(gh&&e&&e[gh])}var Rk=Tk,Ok=lu,wk=Rk;function gm(e,t,r,n,a){var i=-1,s=e.length;for(r||(r=wk),a||(a=[]);++i<s;){var f=e[i];t>0&&r(f)?t>1?gm(f,t-1,r,n,a):Ok(a,f):n||(a[a.length]=f)}return a}var Nu=gm,Ik=Nu;function Mk(e){var t=e==null?0:e.length;return t?Ik(e,1):[]}var hn=Mk,Pk=_u;function Sk(e,t){var r=e==null?0:e.length;return!!r&&Pk(e,t,0)>-1}var mm=Sk;function Lk(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var ym=Lk;function $k(){}var Au=$k,Nl=Mg,Dk=Au,xk=su,kk=1/0,Uk=Nl&&1/xk(new Nl([,-0]))[1]==kk?function(e){return new Nl(e)}:Dk,Fk=Uk,Bk=iu,Vk=mm,Gk=ym,Hk=ou,Wk=Fk,zk=su,Kk=200;function qk(e,t,r){var n=-1,a=Vk,i=e.length,s=!0,f=[],h=f;if(r)s=!1,a=Gk;else if(i>=Kk){var c=t?null:Wk(e);if(c)return zk(c);s=!1,a=Hk,h=new Bk}else h=t?[]:f;e:for(;++n<i;){var o=e[n],l=t?t(o):o;if(o=r||o!==0?o:0,s&&l===l){for(var u=h.length;u--;)if(h[u]===l)continue e;t&&h.push(l),f.push(o)}else a(h,l,r)||(h!==f&&h.push(l),f.push(o))}return f}var Yk=qk,Xk=Yk;function jk(e){return e&&e.length?Xk(e):[]}var Cu=jk,Tu=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Tr,"__esModule",{value:!0});Tr.firstForTerminal=Tr.firstForBranching=Tr.firstForSequence=Tr.first=void 0;var Qk=Tu(hn),Em=Tu(Cu),Zk=Tu(ir),mh=Pt,_c=Pt;function Is(e){if(e instanceof mh.NonTerminal)return Is(e.referencedRule);if(e instanceof mh.Terminal)return Nm(e);if((0,_c.isSequenceProd)(e))return _m(e);if((0,_c.isBranchingProd)(e))return bm(e);throw Error("non exhaustive match")}Tr.first=Is;function _m(e){for(var t=[],r=e.definition,n=0,a=r.length>n,i,s=!0;a&&s;)i=r[n],s=(0,_c.isOptionalProd)(i),t=t.concat(Is(i)),n=n+1,a=r.length>n;return(0,Em.default)(t)}Tr.firstForSequence=_m;function bm(e){var t=(0,Zk.default)(e.definition,function(r){return Is(r)});return(0,Em.default)((0,Qk.default)(t))}Tr.firstForBranching=bm;function Nm(e){return[e.terminalType]}Tr.firstForTerminal=Nm;var ji={};Object.defineProperty(ji,"__esModule",{value:!0});ji.IN=void 0;ji.IN="_~IN~_";var Jk=Te&&Te.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Am=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Dr,"__esModule",{value:!0});Dr.buildInProdFollowPrefix=Dr.buildBetweenProdsFollowPrefix=Dr.computeAllProdsFollows=Dr.ResyncFollowsWalker=void 0;var eU=qa,tU=Tr,rU=Am(Xt),nU=Am(Rs),Cm=ji,aU=Pt,Tm=function(e){Jk(t,e);function t(r){var n=e.call(this)||this;return n.topProd=r,n.follows={},n}return t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(r,n,a){},t.prototype.walkProdRef=function(r,n,a){var i=Rm(r.referencedRule,r.idx)+this.topProd.name,s=n.concat(a),f=new aU.Alternative({definition:s}),h=(0,tU.first)(f);this.follows[i]=h},t}(eU.RestWalker);Dr.ResyncFollowsWalker=Tm;function iU(e){var t={};return(0,rU.default)(e,function(r){var n=new Tm(r).startWalking();(0,nU.default)(t,n)}),t}Dr.computeAllProdsFollows=iU;function Rm(e,t){return e.name+t+Cm.IN}Dr.buildBetweenProdsFollowPrefix=Rm;function oU(e){var t=e.terminalType.name;return t+e.idx+Cm.IN}Dr.buildInProdFollowPrefix=oU;var ra={};function sU(e){return e===void 0}var Xa=sU,Qi={},Ru={},Ms={exports:{}};(function(e){(function(t,r){e.exports?e.exports=r():t.regexpToAst=r()})(typeof self!="undefined"?self:Te,function(){function t(){}t.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},t.prototype.restoreState=function(v){this.idx=v.idx,this.input=v.input,this.groupIdx=v.groupIdx},t.prototype.pattern=function(v){this.idx=0,this.input=v,this.groupIdx=0,this.consumeChar("/");var y=this.disjunction();this.consumeChar("/");for(var m={type:"Flags",loc:{begin:this.idx,end:v.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":f(m,"global");break;case"i":f(m,"ignoreCase");break;case"m":f(m,"multiLine");break;case"u":f(m,"unicode");break;case"y":f(m,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:m,value:y,loc:this.loc(0)}},t.prototype.disjunction=function(){var v=[],y=this.idx;for(v.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),v.push(this.alternative());return{type:"Disjunction",value:v,loc:this.loc(y)}},t.prototype.alternative=function(){for(var v=[],y=this.idx;this.isTerm();)v.push(this.term());return{type:"Alternative",value:v,loc:this.loc(y)}},t.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},t.prototype.assertion=function(){var v=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(v)};case"$":return{type:"EndAnchor",loc:this.loc(v)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(v)};case"B":return{type:"NonWordBoundary",loc:this.loc(v)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var y;switch(this.popChar()){case"=":y="Lookahead";break;case"!":y="NegativeLookahead";break}h(y);var m=this.disjunction();return this.consumeChar(")"),{type:y,value:m,loc:this.loc(v)}}c()},t.prototype.quantifier=function(v){var y,m=this.idx;switch(this.popChar()){case"*":y={atLeast:0,atMost:1/0};break;case"+":y={atLeast:1,atMost:1/0};break;case"?":y={atLeast:0,atMost:1};break;case"{":var b=this.integerIncludingZero();switch(this.popChar()){case"}":y={atLeast:b,atMost:b};break;case",":var E;this.isDigit()?(E=this.integerIncludingZero(),y={atLeast:b,atMost:E}):y={atLeast:b,atMost:1/0},this.consumeChar("}");break}if(v===!0&&y===void 0)return;h(y);break}if(!(v===!0&&y===void 0))return h(y),this.peekChar(0)==="?"?(this.consumeChar("?"),y.greedy=!1):y.greedy=!0,y.type="Quantifier",y.loc=this.loc(m),y},t.prototype.atom=function(){var v,y=this.idx;switch(this.peekChar()){case".":v=this.dotAll();break;case"\\":v=this.atomEscape();break;case"[":v=this.characterClass();break;case"(":v=this.group();break}return v===void 0&&this.isPatternCharacter()&&(v=this.patternCharacter()),h(v),v.loc=this.loc(y),this.isQuantifier()&&(v.quantifier=this.quantifier()),v},t.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[i(`
`),i("\r"),i("\u2028"),i("\u2029")]}},t.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.decimalEscapeAtom=function(){var v=this.positiveInteger();return{type:"GroupBackReference",value:v}},t.prototype.characterClassEscape=function(){var v,y=!1;switch(this.popChar()){case"d":v=l;break;case"D":v=l,y=!0;break;case"s":v=d;break;case"S":v=d,y=!0;break;case"w":v=u;break;case"W":v=u,y=!0;break}return h(v),{type:"Set",value:v,complement:y}},t.prototype.controlEscapeAtom=function(){var v;switch(this.popChar()){case"f":v=i("\f");break;case"n":v=i(`
`);break;case"r":v=i("\r");break;case"t":v=i("	");break;case"v":v=i("\v");break}return h(v),{type:"Character",value:v}},t.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var v=this.popChar();if(/[a-zA-Z]/.test(v)===!1)throw Error("Invalid ");var y=v.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:y}},t.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:i("\0")}},t.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},t.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},t.prototype.identityEscapeAtom=function(){var v=this.popChar();return{type:"Character",value:i(v)}},t.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var v=this.popChar();return{type:"Character",value:i(v)}}},t.prototype.characterClass=function(){var v=[],y=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),y=!0);this.isClassAtom();){var m=this.classAtom(),b=m.type==="Character";if(b&&this.isRangeDash()){this.consumeChar("-");var E=this.classAtom(),N=E.type==="Character";if(N){if(E.value<m.value)throw Error("Range out of order in character class");v.push({from:m.value,to:E.value})}else s(m.value,v),v.push(i("-")),s(E.value,v)}else s(m.value,v)}return this.consumeChar("]"),{type:"Set",complement:y,value:v}},t.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},t.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:i("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.group=function(){var v=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),v=!1;break;default:this.groupIdx++;break}var y=this.disjunction();this.consumeChar(")");var m={type:"Group",capturing:v,value:y};return v&&(m.idx=this.groupIdx),m},t.prototype.positiveInteger=function(){var v=this.popChar();if(a.test(v)===!1)throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)v+=this.popChar();return parseInt(v,10)},t.prototype.integerIncludingZero=function(){var v=this.popChar();if(n.test(v)===!1)throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)v+=this.popChar();return parseInt(v,10)},t.prototype.patternCharacter=function(){var v=this.popChar();switch(v){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:i(v)}}},t.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},t.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},t.prototype.isDigit=function(){return n.test(this.peekChar(0))},t.prototype.isClassAtom=function(v){switch(v===void 0&&(v=0),this.peekChar(v)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},t.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},t.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},t.prototype.isQuantifier=function(){var v=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(v)}},t.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.parseHexDigits=function(v){for(var y="",m=0;m<v;m++){var b=this.popChar();if(r.test(b)===!1)throw Error("Expecting a HexDecimal digits");y+=b}var E=parseInt(y,16);return{type:"Character",value:E}},t.prototype.peekChar=function(v){return v===void 0&&(v=0),this.input[this.idx+v]},t.prototype.popChar=function(){var v=this.peekChar(0);return this.consumeChar(),v},t.prototype.consumeChar=function(v){if(v!==void 0&&this.input[this.idx]!==v)throw Error("Expected: '"+v+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++},t.prototype.loc=function(v){return{begin:v,end:this.idx}};var r=/[0-9a-fA-F]/,n=/[0-9]/,a=/[1-9]/;function i(v){return v.charCodeAt(0)}function s(v,y){v.length!==void 0?v.forEach(function(m){y.push(m)}):y.push(v)}function f(v,y){if(v[y]===!0)throw"duplicate flag "+y;v[y]=!0}function h(v){if(v===void 0)throw Error("Internal Error - Should never get here!")}function c(){throw Error("Internal Error - Should never get here!")}var o,l=[];for(o=i("0");o<=i("9");o++)l.push(o);var u=[i("_")].concat(l);for(o=i("a");o<=i("z");o++)u.push(o);for(o=i("A");o<=i("Z");o++)u.push(o);var d=[i(" "),i("\f"),i(`
`),i("\r"),i("	"),i("\v"),i("	"),i("\xA0"),i("\u1680"),i("\u2000"),i("\u2001"),i("\u2002"),i("\u2003"),i("\u2004"),i("\u2005"),i("\u2006"),i("\u2007"),i("\u2008"),i("\u2009"),i("\u200A"),i("\u2028"),i("\u2029"),i("\u202F"),i("\u205F"),i("\u3000"),i("\uFEFF")];function g(){}return g.prototype.visitChildren=function(v){for(var y in v){var m=v[y];v.hasOwnProperty(y)&&(m.type!==void 0?this.visit(m):Array.isArray(m)&&m.forEach(function(b){this.visit(b)},this))}},g.prototype.visit=function(v){switch(v.type){case"Pattern":this.visitPattern(v);break;case"Flags":this.visitFlags(v);break;case"Disjunction":this.visitDisjunction(v);break;case"Alternative":this.visitAlternative(v);break;case"StartAnchor":this.visitStartAnchor(v);break;case"EndAnchor":this.visitEndAnchor(v);break;case"WordBoundary":this.visitWordBoundary(v);break;case"NonWordBoundary":this.visitNonWordBoundary(v);break;case"Lookahead":this.visitLookahead(v);break;case"NegativeLookahead":this.visitNegativeLookahead(v);break;case"Character":this.visitCharacter(v);break;case"Set":this.visitSet(v);break;case"Group":this.visitGroup(v);break;case"GroupBackReference":this.visitGroupBackReference(v);break;case"Quantifier":this.visitQuantifier(v);break}this.visitChildren(v)},g.prototype.visitPattern=function(v){},g.prototype.visitFlags=function(v){},g.prototype.visitDisjunction=function(v){},g.prototype.visitAlternative=function(v){},g.prototype.visitStartAnchor=function(v){},g.prototype.visitEndAnchor=function(v){},g.prototype.visitWordBoundary=function(v){},g.prototype.visitNonWordBoundary=function(v){},g.prototype.visitLookahead=function(v){},g.prototype.visitNegativeLookahead=function(v){},g.prototype.visitCharacter=function(v){},g.prototype.visitSet=function(v){},g.prototype.visitGroup=function(v){},g.prototype.visitGroupBackReference=function(v){},g.prototype.visitQuantifier=function(v){},{RegExpParser:t,BaseRegExpVisitor:g,VERSION:"0.5.0"}})})(Ms);function lU(e){return e&&e.length?e[0]:void 0}var cU=lU,Zi=cU;function uU(e){for(var t=-1,r=e==null?0:e.length,n=0,a=[];++t<r;){var i=e[t];i&&(a[n++]=i)}return a}var Ps=uU,fU=ta;function dU(e,t){var r=[];return fU(e,function(n,a,i){t(n,a,i)&&r.push(n)}),r}var Om=dU,hU="Expected a function";function pU(e){if(typeof e!="function")throw new TypeError(hU);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}var vU=pU,gU=cu,mU=Om,yU=Wr,EU=ct,_U=vU;function bU(e,t){var r=EU(e)?gU:mU;return r(e,_U(yU(t)))}var Ou=bU,NU=iu,AU=mm,CU=ym,TU=Wi,RU=Hi,OU=ou,wU=200;function IU(e,t,r,n){var a=-1,i=AU,s=!0,f=e.length,h=[],c=t.length;if(!f)return h;r&&(t=TU(t,RU(r))),n?(i=CU,s=!1):t.length>=wU&&(i=OU,s=!1,t=new NU(t));e:for(;++a<f;){var o=e[a],l=r==null?o:r(o);if(o=n||o!==0?o:0,s&&l===l){for(var u=c;u--;)if(t[u]===l)continue e;h.push(o)}else i(t,l,n)||h.push(o)}return h}var MU=IU,PU=Gr,SU=Vr;function LU(e){return SU(e)&&PU(e)}var $U=LU,DU=MU,xU=Nu,kU=yu,yh=$U,UU=kU(function(e,t){return yh(e)?DU(e,xU(t,1,yh,!0)):[]}),wu=UU,FU=_u,BU=Xi,VU=Math.max;function GU(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:BU(r);return a<0&&(a=VU(n+a,0)),FU(e,t,a)}var HU=GU,WU=Wr,zU=Gr,KU=yr;function qU(e){return function(t,r,n){var a=Object(t);if(!zU(t)){var i=WU(r);t=KU(t),r=function(f){return i(a[f],f,a)}}var s=e(t,r,n);return s>-1?a[i?t[s]:s]:void 0}}var YU=qU,XU=pm,jU=Wr,QU=Xi,ZU=Math.max;function JU(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:QU(r);return a<0&&(a=ZU(n+a,0)),XU(e,jU(t),a)}var eF=JU,tF=YU,rF=eF,nF=tF(rF),Iu=nF,aF=cu,iF=Om,oF=Wr,sF=ct;function lF(e,t){var r=sF(e)?aF:iF;return r(e,oF(t))}var Mu=lF,cF=yu,uF=zi,fF=Ts,dF=bs,wm=Object.prototype,hF=wm.hasOwnProperty,pF=cF(function(e,t){e=Object(e);var r=-1,n=t.length,a=n>2?t[2]:void 0;for(a&&fF(t[0],t[1],a)&&(n=1);++r<n;)for(var i=t[r],s=dF(i),f=-1,h=s.length;++f<h;){var c=s[f],o=e[c];(o===void 0||uF(o,wm[c])&&!hF.call(e,c))&&(e[c]=i[c])}return e}),Im=pF;function vF(e,t,r,n){var a=-1,i=e==null?0:e.length;for(n&&i&&(r=e[++a]);++a<i;)r=t(r,e[a],a,e);return r}var gF=vF;function mF(e,t,r,n,a){return a(e,function(i,s,f){r=n?(n=!1,i):t(r,i,s,f)}),r}var yF=mF,EF=gF,_F=ta,bF=Wr,NF=yF,AF=ct;function CF(e,t,r){var n=AF(e)?EF:NF,a=arguments.length<3;return n(e,bF(t),r,a,_F)}var na=CF,Mm={},In={};Object.defineProperty(In,"__esModule",{value:!0});In.clearRegExpParserCache=In.getRegExpAst=void 0;var TF=Ms.exports,Po={},RF=new TF.RegExpParser;function OF(e){var t=e.toString();if(Po.hasOwnProperty(t))return Po[t];var r=RF.pattern(t);return Po[t]=r,r}In.getRegExpAst=OF;function wF(){Po={}}In.clearRegExpParserCache=wF;(function(e){var t=Te&&Te.__extends||function(){var C=function(O,T){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,L){A.__proto__=L}||function(A,L){for(var G in L)Object.prototype.hasOwnProperty.call(L,G)&&(A[G]=L[G])},C(O,T)};return function(O,T){if(typeof T!="function"&&T!==null)throw new TypeError("Class extends value "+String(T)+" is not a constructor or null");C(O,T);function A(){this.constructor=O}O.prototype=T===null?Object.create(T):(A.prototype=T.prototype,new A)}}(),r=Te&&Te.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};Object.defineProperty(e,"__esModule",{value:!0}),e.canMatchCharCode=e.firstCharOptimizedIndices=e.getOptimizedStartCodesIndices=e.failedOptimizationPrefixMsg=void 0;var n=Ms.exports,a=r(ct),i=r(ws),s=r(Xt),f=r(Iu),h=r(un),c=r(dn),o=Ka,l=In,u=Ru,d="Complement Sets are not supported for first char optimization";e.failedOptimizationPrefixMsg=`Unable to use "first char" lexer optimizations:
`;function g(C,O){O===void 0&&(O=!1);try{var T=(0,l.getRegExpAst)(C),A=v(T.value,{},T.flags.ignoreCase);return A}catch(G){if(G.message===d)O&&(0,o.PRINT_WARNING)("".concat(e.failedOptimizationPrefixMsg)+"	Unable to optimize: < ".concat(C.toString(),` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var L="";O&&(L=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),(0,o.PRINT_ERROR)("".concat(e.failedOptimizationPrefixMsg,`
`)+"	Failed parsing: < ".concat(C.toString(),` >
`)+"	Using the regexp-to-ast library version: ".concat(n.VERSION,`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+L)}}return[]}e.getOptimizedStartCodesIndices=g;function v(C,O,T){switch(C.type){case"Disjunction":for(var A=0;A<C.value.length;A++)v(C.value[A],O,T);break;case"Alternative":for(var L=C.value,A=0;A<L.length;A++){var G=L[A];switch(G.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var H=G;switch(H.type){case"Character":y(H.value,O,T);break;case"Set":if(H.complement===!0)throw Error(d);(0,s.default)(H.value,function(ce){if(typeof ce=="number")y(ce,O,T);else{var V=ce;if(T===!0)for(var W=V.from;W<=V.to;W++)y(W,O,T);else{for(var W=V.from;W<=V.to&&W<u.minOptimizationVal;W++)y(W,O,T);if(V.to>=u.minOptimizationVal)for(var Q=V.from>=u.minOptimizationVal?V.from:u.minOptimizationVal,ie=V.to,de=(0,u.charCodeToOptimizedIndex)(Q),me=(0,u.charCodeToOptimizedIndex)(ie),Oe=de;Oe<=me;Oe++)O[Oe]=Oe}}});break;case"Group":v(H.value,O,T);break;default:throw Error("Non Exhaustive Match")}var Y=H.quantifier!==void 0&&H.quantifier.atLeast===0;if(H.type==="Group"&&E(H)===!1||H.type!=="Group"&&Y===!1)break}break;default:throw Error("non exhaustive match!")}return(0,h.default)(O)}e.firstCharOptimizedIndices=v;function y(C,O,T){var A=(0,u.charCodeToOptimizedIndex)(C);O[A]=A,T===!0&&m(C,O)}function m(C,O){var T=String.fromCharCode(C),A=T.toUpperCase();if(A!==T){var L=(0,u.charCodeToOptimizedIndex)(A.charCodeAt(0));O[L]=L}else{var G=T.toLowerCase();if(G!==T){var L=(0,u.charCodeToOptimizedIndex)(G.charCodeAt(0));O[L]=L}}}function b(C,O){return(0,f.default)(C.value,function(T){if(typeof T=="number")return(0,c.default)(O,T);var A=T;return(0,f.default)(O,function(L){return A.from<=L&&L<=A.to})!==void 0})}function E(C){var O=C.quantifier;return O&&O.atLeast===0?!0:C.value?(0,a.default)(C.value)?(0,i.default)(C.value,E):E(C.value):!1}var N=function(C){t(O,C);function O(T){var A=C.call(this)||this;return A.targetCharCodes=T,A.found=!1,A}return O.prototype.visitChildren=function(T){if(this.found!==!0){switch(T.type){case"Lookahead":this.visitLookahead(T);return;case"NegativeLookahead":this.visitNegativeLookahead(T);return}C.prototype.visitChildren.call(this,T)}},O.prototype.visitCharacter=function(T){(0,c.default)(this.targetCharCodes,T.value)&&(this.found=!0)},O.prototype.visitSet=function(T){T.complement?b(T,this.targetCharCodes)===void 0&&(this.found=!0):b(T,this.targetCharCodes)!==void 0&&(this.found=!0)},O}(n.BaseRegExpVisitor);function R(C,O){if(O instanceof RegExp){var T=(0,l.getRegExpAst)(O),A=new N(C);return A.visit(T),A.found}else return(0,f.default)(O,function(L){return(0,c.default)(C,L.charCodeAt(0))})!==void 0}e.canMatchCharCode=R})(Mm);(function(e){var t=Te&&Te.__extends||function(){var D=function(U,ae){return D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Z,ee){Z.__proto__=ee}||function(Z,ee){for(var Ne in ee)Object.prototype.hasOwnProperty.call(ee,Ne)&&(Z[Ne]=ee[Ne])},D(U,ae)};return function(U,ae){if(typeof ae!="function"&&ae!==null)throw new TypeError("Class extends value "+String(ae)+" is not a constructor or null");D(U,ae);function Z(){this.constructor=U}U.prototype=ae===null?Object.create(ae):(Z.prototype=ae.prototype,new Z)}}(),r=Te&&Te.__importDefault||function(D){return D&&D.__esModule?D:{default:D}};Object.defineProperty(e,"__esModule",{value:!0}),e.charCodeToOptimizedIndex=e.minOptimizationVal=e.buildLineBreakIssueMessage=e.LineTerminatorOptimizedTester=e.isShortPattern=e.isCustomPattern=e.cloneEmptyGroups=e.performWarningRuntimeChecks=e.performRuntimeChecks=e.addStickyFlag=e.addStartOfInput=e.findUnreachablePatterns=e.findModesThatDoNotExist=e.findInvalidGroupType=e.findDuplicatePatterns=e.findUnsupportedFlags=e.findStartOfInputAnchor=e.findEmptyMatchRegExps=e.findEndOfInputAnchor=e.findInvalidPatterns=e.findMissingPatterns=e.validatePatterns=e.analyzeTokenTypes=e.enableSticky=e.disableSticky=e.SUPPORT_STICKY=e.MODES=e.DEFAULT_MODE=void 0;var n=Ms.exports,a=Qi,i=r(Zi),s=r(Hr),f=r(Ps),h=r(ct),c=r(un),o=r(hn),l=r(Ou),u=r(wu),d=r(HU),g=r(ir),v=r(Xt),y=r(Cs),m=r(Vi),b=r(Xa),E=r(Iu),N=r(Er),R=r(yr),C=r(rm),O=r(Mu),T=r(Im),A=r(na),L=r(dn),G=Ka,H=Mm,Y=In,K="PATTERN";e.DEFAULT_MODE="defaultMode",e.MODES="modes",e.SUPPORT_STICKY=typeof new RegExp("(?:)").sticky=="boolean";function ce(){e.SUPPORT_STICKY=!1}e.disableSticky=ce;function V(){e.SUPPORT_STICKY=!0}e.enableSticky=V;function W(D,U){U=(0,T.default)(U,{useSticky:e.SUPPORT_STICKY,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(F,_){return _()}});var ae=U.tracer;ae("initCharCodeToOptimizedIndexMap",function(){fe()});var Z;ae("Reject Lexer.NA",function(){Z=(0,l.default)(D,function(F){return F[K]===a.Lexer.NA})});var ee=!1,Ne;ae("Transform Patterns",function(){ee=!1,Ne=(0,g.default)(Z,function(F){var _=F[K];if((0,C.default)(_)){var I=_.source;return I.length===1&&I!=="^"&&I!=="$"&&I!=="."&&!_.ignoreCase?I:I.length===2&&I[0]==="\\"&&!(0,L.default)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],I[1])?I[1]:U.useSticky?z(_):B(_)}else{if((0,m.default)(_))return ee=!0,{exec:_};if(typeof _=="object")return ee=!0,_;if(typeof _=="string"){if(_.length===1)return _;var Re=_.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),We=new RegExp(Re);return U.useSticky?z(We):B(We)}else throw Error("non exhaustive match")}})});var De,Ge,ke,Ue,Rt;ae("misc mapping",function(){De=(0,g.default)(Z,function(F){return F.tokenTypeIdx}),Ge=(0,g.default)(Z,function(F){var _=F.GROUP;if(_!==a.Lexer.SKIPPED){if((0,y.default)(_))return _;if((0,b.default)(_))return!1;throw Error("non exhaustive match")}}),ke=(0,g.default)(Z,function(F){var _=F.LONGER_ALT;if(_){var I=(0,h.default)(_)?(0,g.default)(_,function(Re){return(0,d.default)(Z,Re)}):[(0,d.default)(Z,_)];return I}}),Ue=(0,g.default)(Z,function(F){return F.PUSH_MODE}),Rt=(0,g.default)(Z,function(F){return(0,N.default)(F,"POP_MODE")})});var Wt;ae("Line Terminator Handling",function(){var F=Me(U.lineTerminatorCharacters);Wt=(0,g.default)(Z,function(_){return!1}),U.positionTracking!=="onlyOffset"&&(Wt=(0,g.default)(Z,function(_){return(0,N.default)(_,"LINE_BREAKS")?!!_.LINE_BREAKS:pe(_,F)===!1&&(0,H.canMatchCharCode)(F,_.PATTERN)}))});var or,_e,oe,ve;ae("Misc Mapping #2",function(){or=(0,g.default)(Z,Ee),_e=(0,g.default)(Ne,x),oe=(0,A.default)(Z,function(F,_){var I=_.GROUP;return(0,y.default)(I)&&I!==a.Lexer.SKIPPED&&(F[I]=[]),F},{}),ve=(0,g.default)(Ne,function(F,_){return{pattern:Ne[_],longerAlt:ke[_],canLineTerminator:Wt[_],isCustom:or[_],short:_e[_],group:Ge[_],push:Ue[_],pop:Rt[_],tokenTypeIdx:De[_],tokenType:Z[_]}})});var te=!0,se=[];return U.safeMode||ae("First Char Optimization",function(){se=(0,A.default)(Z,function(F,_,I){if(typeof _.PATTERN=="string"){var Re=_.PATTERN.charCodeAt(0),We=Ae(Re);Ce(F,We,ve[I])}else if((0,h.default)(_.START_CHARS_HINT)){var rt;(0,v.default)(_.START_CHARS_HINT,function(Le){var $e=typeof Le=="string"?Le.charCodeAt(0):Le,Ze=Ae($e);rt!==Ze&&(rt=Ze,Ce(F,Ze,ve[I]))})}else if((0,C.default)(_.PATTERN))if(_.PATTERN.unicode)te=!1,U.ensureOptimizations&&(0,G.PRINT_ERROR)("".concat(H.failedOptimizationPrefixMsg)+"	Unable to analyze < ".concat(_.PATTERN.toString(),` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var nt=(0,H.getOptimizedStartCodesIndices)(_.PATTERN,U.ensureOptimizations);(0,s.default)(nt)&&(te=!1),(0,v.default)(nt,function(Le){Ce(F,Le,ve[I])})}else U.ensureOptimizations&&(0,G.PRINT_ERROR)("".concat(H.failedOptimizationPrefixMsg)+"	TokenType: <".concat(_.name,`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),te=!1;return F},[])}),{emptyGroups:oe,patternIdxToConfig:ve,charCodeToPatternIdxToConfig:se,hasCustom:ee,canBeOptimized:te}}e.analyzeTokenTypes=W;function Q(D,U){var ae=[],Z=de(D);ae=ae.concat(Z.errors);var ee=me(Z.valid),Ne=ee.valid;return ae=ae.concat(ee.errors),ae=ae.concat(ie(Ne)),ae=ae.concat(ge(Ne)),ae=ae.concat(q(Ne,U)),ae=ae.concat(ye(Ne)),ae}e.validatePatterns=Q;function ie(D){var U=[],ae=(0,O.default)(D,function(Z){return(0,C.default)(Z[K])});return U=U.concat(we(ae)),U=U.concat($(ae)),U=U.concat(P(ae)),U=U.concat(k(ae)),U=U.concat(Se(ae)),U}function de(D){var U=(0,O.default)(D,function(ee){return!(0,N.default)(ee,K)}),ae=(0,g.default)(U,function(ee){return{message:"Token Type: ->"+ee.name+"<- missing static 'PATTERN' property",type:a.LexerDefinitionErrorType.MISSING_PATTERN,tokenTypes:[ee]}}),Z=(0,u.default)(D,U);return{errors:ae,valid:Z}}e.findMissingPatterns=de;function me(D){var U=(0,O.default)(D,function(ee){var Ne=ee[K];return!(0,C.default)(Ne)&&!(0,m.default)(Ne)&&!(0,N.default)(Ne,"exec")&&!(0,y.default)(Ne)}),ae=(0,g.default)(U,function(ee){return{message:"Token Type: ->"+ee.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:a.LexerDefinitionErrorType.INVALID_PATTERN,tokenTypes:[ee]}}),Z=(0,u.default)(D,U);return{errors:ae,valid:Z}}e.findInvalidPatterns=me;var Oe=/[^\\][$]/;function we(D){var U=function(ee){t(Ne,ee);function Ne(){var De=ee!==null&&ee.apply(this,arguments)||this;return De.found=!1,De}return Ne.prototype.visitEndAnchor=function(De){this.found=!0},Ne}(n.BaseRegExpVisitor),ae=(0,O.default)(D,function(ee){var Ne=ee.PATTERN;try{var De=(0,Y.getRegExpAst)(Ne),Ge=new U;return Ge.visit(De),Ge.found}catch{return Oe.test(Ne.source)}}),Z=(0,g.default)(ae,function(ee){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+ee.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:a.LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenTypes:[ee]}});return Z}e.findEndOfInputAnchor=we;function Se(D){var U=(0,O.default)(D,function(Z){var ee=Z.PATTERN;return ee.test("")}),ae=(0,g.default)(U,function(Z){return{message:"Token Type: ->"+Z.name+"<- static 'PATTERN' must not match an empty string",type:a.LexerDefinitionErrorType.EMPTY_MATCH_PATTERN,tokenTypes:[Z]}});return ae}e.findEmptyMatchRegExps=Se;var J=/[^\\[][\^]|^\^/;function $(D){var U=function(ee){t(Ne,ee);function Ne(){var De=ee!==null&&ee.apply(this,arguments)||this;return De.found=!1,De}return Ne.prototype.visitStartAnchor=function(De){this.found=!0},Ne}(n.BaseRegExpVisitor),ae=(0,O.default)(D,function(ee){var Ne=ee.PATTERN;try{var De=(0,Y.getRegExpAst)(Ne),Ge=new U;return Ge.visit(De),Ge.found}catch{return J.test(Ne.source)}}),Z=(0,g.default)(ae,function(ee){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+ee.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:a.LexerDefinitionErrorType.SOI_ANCHOR_FOUND,tokenTypes:[ee]}});return Z}e.findStartOfInputAnchor=$;function P(D){var U=(0,O.default)(D,function(Z){var ee=Z[K];return ee instanceof RegExp&&(ee.multiline||ee.global)}),ae=(0,g.default)(U,function(Z){return{message:"Token Type: ->"+Z.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:a.LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[Z]}});return ae}e.findUnsupportedFlags=P;function k(D){var U=[],ae=(0,g.default)(D,function(Ne){return(0,A.default)(D,function(De,Ge){return Ne.PATTERN.source===Ge.PATTERN.source&&!(0,L.default)(U,Ge)&&Ge.PATTERN!==a.Lexer.NA&&(U.push(Ge),De.push(Ge)),De},[])});ae=(0,f.default)(ae);var Z=(0,O.default)(ae,function(Ne){return Ne.length>1}),ee=(0,g.default)(Z,function(Ne){var De=(0,g.default)(Ne,function(ke){return ke.name}),Ge=(0,i.default)(Ne).PATTERN;return{message:"The same RegExp pattern ->".concat(Ge,"<-")+"has been used in all of the following Token Types: ".concat(De.join(", ")," <-"),type:a.LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenTypes:Ne}});return ee}e.findDuplicatePatterns=k;function ge(D){var U=(0,O.default)(D,function(Z){if(!(0,N.default)(Z,"GROUP"))return!1;var ee=Z.GROUP;return ee!==a.Lexer.SKIPPED&&ee!==a.Lexer.NA&&!(0,y.default)(ee)}),ae=(0,g.default)(U,function(Z){return{message:"Token Type: ->"+Z.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:a.LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenTypes:[Z]}});return ae}e.findInvalidGroupType=ge;function q(D,U){var ae=(0,O.default)(D,function(ee){return ee.PUSH_MODE!==void 0&&!(0,L.default)(U,ee.PUSH_MODE)}),Z=(0,g.default)(ae,function(ee){var Ne="Token Type: ->".concat(ee.name,"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->").concat(ee.PUSH_MODE,"<-")+"which does not exist";return{message:Ne,type:a.LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[ee]}});return Z}e.findModesThatDoNotExist=q;function ye(D){var U=[],ae=(0,A.default)(D,function(Z,ee,Ne){var De=ee.PATTERN;return De===a.Lexer.NA||((0,y.default)(De)?Z.push({str:De,idx:Ne,tokenType:ee}):(0,C.default)(De)&&M(De)&&Z.push({str:De.source,idx:Ne,tokenType:ee})),Z},[]);return(0,v.default)(D,function(Z,ee){(0,v.default)(ae,function(Ne){var De=Ne.str,Ge=Ne.idx,ke=Ne.tokenType;if(ee<Ge&&X(De,Z.PATTERN)){var Ue="Token: ->".concat(ke.name,`<- can never be matched.
`)+"Because it appears AFTER the Token Type ->".concat(Z.name,"<-")+`in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;U.push({message:Ue,type:a.LexerDefinitionErrorType.UNREACHABLE_PATTERN,tokenTypes:[Z,ke]})}})}),U}e.findUnreachablePatterns=ye;function X(D,U){if((0,C.default)(U)){var ae=U.exec(D);return ae!==null&&ae.index===0}else{if((0,m.default)(U))return U(D,0,[],{});if((0,N.default)(U,"exec"))return U.exec(D,0,[],{});if(typeof U=="string")return U===D;throw Error("non exhaustive match")}}function M(D){var U=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return(0,E.default)(U,function(ae){return D.source.indexOf(ae)!==-1})===void 0}function B(D){var U=D.ignoreCase?"i":"";return new RegExp("^(?:".concat(D.source,")"),U)}e.addStartOfInput=B;function z(D){var U=D.ignoreCase?"iy":"y";return new RegExp("".concat(D.source),U)}e.addStickyFlag=z;function re(D,U,ae){var Z=[];return(0,N.default)(D,e.DEFAULT_MODE)||Z.push({message:"A MultiMode Lexer cannot be initialized without a <"+e.DEFAULT_MODE+`> property in its definition
`,type:a.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),(0,N.default)(D,e.MODES)||Z.push({message:"A MultiMode Lexer cannot be initialized without a <"+e.MODES+`> property in its definition
`,type:a.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),(0,N.default)(D,e.MODES)&&(0,N.default)(D,e.DEFAULT_MODE)&&!(0,N.default)(D.modes,D.defaultMode)&&Z.push({message:"A MultiMode Lexer cannot be initialized with a ".concat(e.DEFAULT_MODE,": <").concat(D.defaultMode,">")+`which does not exist
`,type:a.LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),(0,N.default)(D,e.MODES)&&(0,v.default)(D.modes,function(ee,Ne){(0,v.default)(ee,function(De,Ge){(0,b.default)(De)&&Z.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+"<".concat(Ne,"> at index: <").concat(Ge,`>
`),type:a.LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),Z}e.performRuntimeChecks=re;function ne(D,U,ae){var Z=[],ee=!1,Ne=(0,f.default)((0,o.default)((0,c.default)(D.modes))),De=(0,l.default)(Ne,function(ke){return ke[K]===a.Lexer.NA}),Ge=Me(ae);return U&&(0,v.default)(De,function(ke){var Ue=pe(ke,Ge);if(Ue!==!1){var Rt=ue(ke,Ue),Wt={message:Rt,type:Ue.issue,tokenType:ke};Z.push(Wt)}else(0,N.default)(ke,"LINE_BREAKS")?ke.LINE_BREAKS===!0&&(ee=!0):(0,H.canMatchCharCode)(Ge,ke.PATTERN)&&(ee=!0)}),U&&!ee&&Z.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:a.LexerDefinitionErrorType.NO_LINE_BREAKS_FLAGS}),Z}e.performWarningRuntimeChecks=ne;function p(D){var U={},ae=(0,R.default)(D);return(0,v.default)(ae,function(Z){var ee=D[Z];if((0,h.default)(ee))U[Z]=[];else throw Error("non exhaustive match")}),U}e.cloneEmptyGroups=p;function Ee(D){var U=D.PATTERN;if((0,C.default)(U))return!1;if((0,m.default)(U))return!0;if((0,N.default)(U,"exec"))return!0;if((0,y.default)(U))return!1;throw Error("non exhaustive match")}e.isCustomPattern=Ee;function x(D){return(0,y.default)(D)&&D.length===1?D.charCodeAt(0):!1}e.isShortPattern=x,e.LineTerminatorOptimizedTester={test:function(D){for(var U=D.length,ae=this.lastIndex;ae<U;ae++){var Z=D.charCodeAt(ae);if(Z===10)return this.lastIndex=ae+1,!0;if(Z===13)return D.charCodeAt(ae+1)===10?this.lastIndex=ae+2:this.lastIndex=ae+1,!0}return!1},lastIndex:0};function pe(D,U){if((0,N.default)(D,"LINE_BREAKS"))return!1;if((0,C.default)(D.PATTERN)){try{(0,H.canMatchCharCode)(U,D.PATTERN)}catch(ae){return{issue:a.LexerDefinitionErrorType.IDENTIFY_TERMINATOR,errMsg:ae.message}}return!1}else{if((0,y.default)(D.PATTERN))return!1;if(Ee(D))return{issue:a.LexerDefinitionErrorType.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function ue(D,U){if(U.issue===a.LexerDefinitionErrorType.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+"	The problem is in the <".concat(D.name,`> Token Type
`)+"	 Root cause: ".concat(U.errMsg,`.
`)+"	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(U.issue===a.LexerDefinitionErrorType.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+"	The problem is in the <".concat(D.name,`> Token Type
`)+"	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}e.buildLineBreakIssueMessage=ue;function Me(D){var U=(0,g.default)(D,function(ae){return(0,y.default)(ae)?ae.charCodeAt(0):ae});return U}function Ce(D,U,ae){D[U]===void 0?D[U]=[ae]:D[U].push(ae)}e.minOptimizationVal=256;var Pe=[];function Ae(D){return D<e.minOptimizationVal?D:Pe[D]}e.charCodeToOptimizedIndex=Ae;function fe(){if((0,s.default)(Pe)){Pe=new Array(65536);for(var D=0;D<65536;D++)Pe[D]=D>255?255+~~(D/255):D}}})(Ru);function IF(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var Pu=IF,aa={};(function(e){var t=Te&&Te.__importDefault||function(A){return A&&A.__esModule?A:{default:A}};Object.defineProperty(e,"__esModule",{value:!0}),e.isTokenType=e.hasExtendingTokensTypesMapProperty=e.hasExtendingTokensTypesProperty=e.hasCategoriesProperty=e.hasShortKeyProperty=e.singleAssignCategoriesToksMap=e.assignCategoriesMapProp=e.assignCategoriesTokensProp=e.assignTokenDefaultProps=e.expandCategories=e.augmentTokenTypes=e.tokenIdxToClass=e.tokenShortNameIdx=e.tokenStructuredMatcherNoCategories=e.tokenStructuredMatcher=void 0;var r=t(Hr),n=t(Ps),a=t(ct),i=t(hn),s=t(wu),f=t(ir),h=t(Xt),c=t(Er),o=t(dn),l=t(Pn);function u(A,L){var G=A.tokenTypeIdx;return G===L.tokenTypeIdx?!0:L.isParent===!0&&L.categoryMatchesMap[G]===!0}e.tokenStructuredMatcher=u;function d(A,L){return A.tokenTypeIdx===L.tokenTypeIdx}e.tokenStructuredMatcherNoCategories=d,e.tokenShortNameIdx=1,e.tokenIdxToClass={};function g(A){var L=v(A);y(L),b(L),m(L),(0,h.default)(L,function(G){G.isParent=G.categoryMatches.length>0})}e.augmentTokenTypes=g;function v(A){for(var L=(0,l.default)(A),G=A,H=!0;H;){G=(0,n.default)((0,i.default)((0,f.default)(G,function(K){return K.CATEGORIES})));var Y=(0,s.default)(G,L);L=L.concat(Y),(0,r.default)(Y)?H=!1:G=Y}return L}e.expandCategories=v;function y(A){(0,h.default)(A,function(L){N(L)||(e.tokenIdxToClass[e.tokenShortNameIdx]=L,L.tokenTypeIdx=e.tokenShortNameIdx++),R(L)&&!(0,a.default)(L.CATEGORIES)&&(L.CATEGORIES=[L.CATEGORIES]),R(L)||(L.CATEGORIES=[]),C(L)||(L.categoryMatches=[]),O(L)||(L.categoryMatchesMap={})})}e.assignTokenDefaultProps=y;function m(A){(0,h.default)(A,function(L){L.categoryMatches=[],(0,h.default)(L.categoryMatchesMap,function(G,H){L.categoryMatches.push(e.tokenIdxToClass[H].tokenTypeIdx)})})}e.assignCategoriesTokensProp=m;function b(A){(0,h.default)(A,function(L){E([],L)})}e.assignCategoriesMapProp=b;function E(A,L){(0,h.default)(A,function(G){L.categoryMatchesMap[G.tokenTypeIdx]=!0}),(0,h.default)(L.CATEGORIES,function(G){var H=A.concat(L);(0,o.default)(H,G)||E(H,G)})}e.singleAssignCategoriesToksMap=E;function N(A){return(0,c.default)(A,"tokenTypeIdx")}e.hasShortKeyProperty=N;function R(A){return(0,c.default)(A,"CATEGORIES")}e.hasCategoriesProperty=R;function C(A){return(0,c.default)(A,"categoryMatches")}e.hasExtendingTokensTypesProperty=C;function O(A){return(0,c.default)(A,"categoryMatchesMap")}e.hasExtendingTokensTypesMapProperty=O;function T(A){return(0,c.default)(A,"tokenTypeIdx")}e.isTokenType=T})(aa);var Ji={};Object.defineProperty(Ji,"__esModule",{value:!0});Ji.defaultLexerErrorProvider=void 0;Ji.defaultLexerErrorProvider={buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->".concat(e.image,"<- The Mode Stack is empty")},buildUnexpectedCharactersMessage:function(e,t,r,n,a){return"unexpected character: ->".concat(e.charAt(t),"<- at offset: ").concat(t,",")+" skipped ".concat(r," characters.")}};(function(e){var t=Te&&Te.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};Object.defineProperty(e,"__esModule",{value:!0}),e.Lexer=e.LexerDefinitionErrorType=void 0;var r=Ru,n=t(Au),a=t(Hr),i=t(ct),s=t(Pu),f=t(Ou),h=t(ir),c=t(Xt),o=t(yr),l=t(Xa),u=t(qi),d=t(Rs),g=t(na),v=t(Pn),y=Ka,m=aa,b=Ji,E=In;(function(C){C[C.MISSING_PATTERN=0]="MISSING_PATTERN",C[C.INVALID_PATTERN=1]="INVALID_PATTERN",C[C.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",C[C.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",C[C.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",C[C.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",C[C.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",C[C.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",C[C.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",C[C.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",C[C.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",C[C.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",C[C.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",C[C.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",C[C.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",C[C.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",C[C.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(e.LexerDefinitionErrorType||(e.LexerDefinitionErrorType={}));var N={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:b.defaultLexerErrorProvider,traceInitPerf:!1,skipValidations:!1};Object.freeze(N);var R=function(){function C(O,T){T===void 0&&(T=N);var A=this;if(this.lexerDefinition=O,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=function(G,H){if(A.traceInitPerf===!0){A.traceInitIndent++;var Y=new Array(A.traceInitIndent+1).join("	");A.traceInitIndent<A.traceInitMaxIdent&&console.log("".concat(Y,"--> <").concat(G,">"));var K=(0,y.timer)(H),ce=K.time,V=K.value,W=ce>10?console.warn:console.log;return A.traceInitIndent<A.traceInitMaxIdent&&W("".concat(Y,"<-- <").concat(G,"> time: ").concat(ce,"ms")),A.traceInitIndent--,V}else return H()},typeof T=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=(0,d.default)({},N,T);var L=this.config.traceInitPerf;L===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof L=="number"&&(this.traceInitMaxIdent=L,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var G,H=!0;A.TRACE_INIT("Lexer Config handling",function(){if(A.config.lineTerminatorsPattern===N.lineTerminatorsPattern)A.config.lineTerminatorsPattern=r.LineTerminatorOptimizedTester;else if(A.config.lineTerminatorCharacters===N.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(T.safeMode&&T.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');A.trackStartLines=/full|onlyStart/i.test(A.config.positionTracking),A.trackEndLines=/full/i.test(A.config.positionTracking),(0,i.default)(O)?G={modes:{defaultMode:(0,v.default)(O)},defaultMode:r.DEFAULT_MODE}:(H=!1,G=(0,v.default)(O))}),A.config.skipValidations===!1&&(A.TRACE_INIT("performRuntimeChecks",function(){A.lexerDefinitionErrors=A.lexerDefinitionErrors.concat((0,r.performRuntimeChecks)(G,A.trackStartLines,A.config.lineTerminatorCharacters))}),A.TRACE_INIT("performWarningRuntimeChecks",function(){A.lexerDefinitionWarning=A.lexerDefinitionWarning.concat((0,r.performWarningRuntimeChecks)(G,A.trackStartLines,A.config.lineTerminatorCharacters))})),G.modes=G.modes?G.modes:{},(0,c.default)(G.modes,function(V,W){G.modes[W]=(0,f.default)(V,function(Q){return(0,l.default)(Q)})});var Y=(0,o.default)(G.modes);if((0,c.default)(G.modes,function(V,W){A.TRACE_INIT("Mode: <".concat(W,"> processing"),function(){if(A.modes.push(W),A.config.skipValidations===!1&&A.TRACE_INIT("validatePatterns",function(){A.lexerDefinitionErrors=A.lexerDefinitionErrors.concat((0,r.validatePatterns)(V,Y))}),(0,a.default)(A.lexerDefinitionErrors)){(0,m.augmentTokenTypes)(V);var Q;A.TRACE_INIT("analyzeTokenTypes",function(){Q=(0,r.analyzeTokenTypes)(V,{lineTerminatorCharacters:A.config.lineTerminatorCharacters,positionTracking:T.positionTracking,ensureOptimizations:T.ensureOptimizations,safeMode:T.safeMode,tracer:A.TRACE_INIT})}),A.patternIdxToConfig[W]=Q.patternIdxToConfig,A.charCodeToPatternIdxToConfig[W]=Q.charCodeToPatternIdxToConfig,A.emptyGroups=(0,d.default)({},A.emptyGroups,Q.emptyGroups),A.hasCustom=Q.hasCustom||A.hasCustom,A.canModeBeOptimized[W]=Q.canBeOptimized}})}),A.defaultMode=G.defaultMode,!(0,a.default)(A.lexerDefinitionErrors)&&!A.config.deferDefinitionErrorsHandling){var K=(0,h.default)(A.lexerDefinitionErrors,function(V){return V.message}),ce=K.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+ce)}(0,c.default)(A.lexerDefinitionWarning,function(V){(0,y.PRINT_WARNING)(V.message)}),A.TRACE_INIT("Choosing sub-methods implementations",function(){if(r.SUPPORT_STICKY?(A.chopInput=u.default,A.match=A.matchWithTest):(A.updateLastIndex=n.default,A.match=A.matchWithExec),H&&(A.handleModes=n.default),A.trackStartLines===!1&&(A.computeNewColumn=u.default),A.trackEndLines===!1&&(A.updateTokenEndLineColumnLocation=n.default),/full/i.test(A.config.positionTracking))A.createTokenInstance=A.createFullToken;else if(/onlyStart/i.test(A.config.positionTracking))A.createTokenInstance=A.createStartOnlyToken;else if(/onlyOffset/i.test(A.config.positionTracking))A.createTokenInstance=A.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'.concat(A.config.positionTracking,'"'));A.hasCustom?(A.addToken=A.addTokenUsingPush,A.handlePayload=A.handlePayloadWithCustom):(A.addToken=A.addTokenUsingMemberAccess,A.handlePayload=A.handlePayloadNoCustom)}),A.TRACE_INIT("Failed Optimization Warnings",function(){var V=(0,g.default)(A.canModeBeOptimized,function(W,Q,ie){return Q===!1&&W.push(ie),W},[]);if(T.ensureOptimizations&&!(0,a.default)(V))throw Error("Lexer Modes: < ".concat(V.join(", "),` > cannot be optimized.
`)+`	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),A.TRACE_INIT("clearRegExpParserCache",function(){(0,E.clearRegExpParserCache)()}),A.TRACE_INIT("toFastProperties",function(){(0,y.toFastProperties)(A)})})}return C.prototype.tokenize=function(O,T){if(T===void 0&&(T=this.defaultMode),!(0,a.default)(this.lexerDefinitionErrors)){var A=(0,h.default)(this.lexerDefinitionErrors,function(G){return G.message}),L=A.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+L)}return this.tokenizeInternal(O,T)},C.prototype.tokenizeInternal=function(O,T){var A=this,L,G,H,Y,K,ce,V,W,Q,ie,de,me,Oe,we,Se,J=O,$=J.length,P=0,k=0,ge=this.hasCustom?0:Math.floor(O.length/10),q=new Array(ge),ye=[],X=this.trackStartLines?1:void 0,M=this.trackStartLines?1:void 0,B=(0,r.cloneEmptyGroups)(this.emptyGroups),z=this.trackStartLines,re=this.config.lineTerminatorsPattern,ne=0,p=[],Ee=[],x=[],pe=[];Object.freeze(pe);var ue;function Me(){return p}function Ce(te){var se=(0,r.charCodeToOptimizedIndex)(te),F=Ee[se];return F===void 0?pe:F}var Pe=function(te){if(x.length===1&&te.tokenType.PUSH_MODE===void 0){var se=A.config.errorMessageProvider.buildUnableToPopLexerModeMessage(te);ye.push({offset:te.startOffset,line:te.startLine,column:te.startColumn,length:te.image.length,message:se})}else{x.pop();var F=(0,s.default)(x);p=A.patternIdxToConfig[F],Ee=A.charCodeToPatternIdxToConfig[F],ne=p.length;var _=A.canModeBeOptimized[F]&&A.config.safeMode===!1;Ee&&_?ue=Ce:ue=Me}};function Ae(te){x.push(te),Ee=this.charCodeToPatternIdxToConfig[te],p=this.patternIdxToConfig[te],ne=p.length,ne=p.length;var se=this.canModeBeOptimized[te]&&this.config.safeMode===!1;Ee&&se?ue=Ce:ue=Me}Ae.call(this,T);for(var fe;P<$;){ce=null;var D=J.charCodeAt(P),U=ue(D),ae=U.length;for(L=0;L<ae;L++){fe=U[L];var Z=fe.pattern;V=null;var ee=fe.short;if(ee!==!1?D===ee&&(ce=Z):fe.isCustom===!0?(Se=Z.exec(J,P,q,B),Se!==null?(ce=Se[0],Se.payload!==void 0&&(V=Se.payload)):ce=null):(this.updateLastIndex(Z,P),ce=this.match(Z,O,P)),ce!==null){if(K=fe.longerAlt,K!==void 0){var Ne=K.length;for(H=0;H<Ne;H++){var De=p[K[H]],Ge=De.pattern;if(W=null,De.isCustom===!0?(Se=Ge.exec(J,P,q,B),Se!==null?(Y=Se[0],Se.payload!==void 0&&(W=Se.payload)):Y=null):(this.updateLastIndex(Ge,P),Y=this.match(Ge,O,P)),Y&&Y.length>ce.length){ce=Y,V=W,fe=De;break}}}break}}if(ce!==null){if(Q=ce.length,ie=fe.group,ie!==void 0&&(de=fe.tokenTypeIdx,me=this.createTokenInstance(ce,P,de,fe.tokenType,X,M,Q),this.handlePayload(me,V),ie===!1?k=this.addToken(q,k,me):B[ie].push(me)),O=this.chopInput(O,Q),P=P+Q,M=this.computeNewColumn(M,Q),z===!0&&fe.canLineTerminator===!0){var ke=0,Ue=void 0,Rt=void 0;re.lastIndex=0;do Ue=re.test(ce),Ue===!0&&(Rt=re.lastIndex-1,ke++);while(Ue===!0);ke!==0&&(X=X+ke,M=Q-Rt,this.updateTokenEndLineColumnLocation(me,ie,Rt,ke,X,M,Q))}this.handleModes(fe,Pe,Ae,me)}else{for(var Wt=P,or=X,_e=M,oe=!1;!oe&&P<$;)for(J.charCodeAt(P),O=this.chopInput(O,1),P++,G=0;G<ne;G++){var ve=p[G],Z=ve.pattern,ee=ve.short;if(ee!==!1?J.charCodeAt(P)===ee&&(oe=!0):ve.isCustom===!0?oe=Z.exec(J,P,q,B)!==null:(this.updateLastIndex(Z,P),oe=Z.exec(O)!==null),oe===!0)break}Oe=P-Wt,we=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(J,Wt,Oe,or,_e),ye.push({offset:Wt,line:or,column:_e,length:Oe,message:we})}}return this.hasCustom||(q.length=k),{tokens:q,groups:B,errors:ye}},C.prototype.handleModes=function(O,T,A,L){if(O.pop===!0){var G=O.push;T(L),G!==void 0&&A.call(this,G)}else O.push!==void 0&&A.call(this,O.push)},C.prototype.chopInput=function(O,T){return O.substring(T)},C.prototype.updateLastIndex=function(O,T){O.lastIndex=T},C.prototype.updateTokenEndLineColumnLocation=function(O,T,A,L,G,H,Y){var K,ce;T!==void 0&&(K=A===Y-1,ce=K?-1:0,L===1&&K===!0||(O.endLine=G+ce,O.endColumn=H-1+-ce))},C.prototype.computeNewColumn=function(O,T){return O+T},C.prototype.createOffsetOnlyToken=function(O,T,A,L){return{image:O,startOffset:T,tokenTypeIdx:A,tokenType:L}},C.prototype.createStartOnlyToken=function(O,T,A,L,G,H){return{image:O,startOffset:T,startLine:G,startColumn:H,tokenTypeIdx:A,tokenType:L}},C.prototype.createFullToken=function(O,T,A,L,G,H,Y){return{image:O,startOffset:T,endOffset:T+Y-1,startLine:G,endLine:G,startColumn:H,endColumn:H+Y-1,tokenTypeIdx:A,tokenType:L}},C.prototype.addTokenUsingPush=function(O,T,A){return O.push(A),T},C.prototype.addTokenUsingMemberAccess=function(O,T,A){return O[T]=A,T++,T},C.prototype.handlePayloadNoCustom=function(O,T){},C.prototype.handlePayloadWithCustom=function(O,T){T!==null&&(O.payload=T)},C.prototype.matchWithTest=function(O,T,A){var L=O.test(T);return L===!0?T.substring(A,O.lastIndex):null},C.prototype.matchWithExec=function(O,T){var A=O.exec(T);return A!==null?A[0]:null},C.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",C.NA=/NOT_APPLICABLE/,C}();e.Lexer=R})(Qi);(function(e){var t=Te&&Te.__importDefault||function(O){return O&&O.__esModule?O:{default:O}};Object.defineProperty(e,"__esModule",{value:!0}),e.tokenMatcher=e.createTokenInstance=e.EOF=e.createToken=e.hasTokenLabel=e.tokenName=e.tokenLabel=void 0;var r=t(Cs),n=t(Er),a=t(Xa),i=Qi,s=aa;function f(O){return c(O)?O.LABEL:O.name}e.tokenLabel=f;function h(O){return O.name}e.tokenName=h;function c(O){return(0,r.default)(O.LABEL)&&O.LABEL!==""}e.hasTokenLabel=c;var o="parent",l="categories",u="label",d="group",g="push_mode",v="pop_mode",y="longer_alt",m="line_breaks",b="start_chars_hint";function E(O){return N(O)}e.createToken=E;function N(O){var T=O.pattern,A={};if(A.name=O.name,(0,a.default)(T)||(A.PATTERN=T),(0,n.default)(O,o))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return(0,n.default)(O,l)&&(A.CATEGORIES=O[l]),(0,s.augmentTokenTypes)([A]),(0,n.default)(O,u)&&(A.LABEL=O[u]),(0,n.default)(O,d)&&(A.GROUP=O[d]),(0,n.default)(O,v)&&(A.POP_MODE=O[v]),(0,n.default)(O,g)&&(A.PUSH_MODE=O[g]),(0,n.default)(O,y)&&(A.LONGER_ALT=O[y]),(0,n.default)(O,m)&&(A.LINE_BREAKS=O[m]),(0,n.default)(O,b)&&(A.START_CHARS_HINT=O[b]),A}e.EOF=E({name:"EOF",pattern:i.Lexer.NA}),(0,s.augmentTokenTypes)([e.EOF]);function R(O,T,A,L,G,H,Y,K){return{image:T,startOffset:A,endOffset:L,startLine:G,endLine:H,startColumn:Y,endColumn:K,tokenTypeIdx:O.tokenTypeIdx,tokenType:O}}e.createTokenInstance=R;function C(O,T){return(0,s.tokenStructuredMatcher)(O,T)}e.tokenMatcher=C})(ra);var eo={};(function(e){var t=Te&&Te.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(e,"__esModule",{value:!0}),e.defaultGrammarValidatorErrorProvider=e.defaultGrammarResolverErrorProvider=e.defaultParserErrorProvider=void 0;var r=ra,n=t(Zi),a=t(ir),i=t(na),s=Pt,f=Pt;e.defaultParserErrorProvider={buildMismatchTokenMessage:function(h){var c=h.expected,o=h.actual;h.previous,h.ruleName;var l=(0,r.hasTokenLabel)(c),u=l?"--> ".concat((0,r.tokenLabel)(c)," <--"):"token of type --> ".concat(c.name," <--"),d="Expecting ".concat(u," but found --> '").concat(o.image,"' <--");return d},buildNotAllInputParsedMessage:function(h){var c=h.firstRedundant;return h.ruleName,"Redundant input, expecting EOF but found: "+c.image},buildNoViableAltMessage:function(h){var c=h.expectedPathsPerAlt,o=h.actual;h.previous;var l=h.customUserDescription;h.ruleName;var u="Expecting: ",d=(0,n.default)(o).image,g=`
but found: '`+d+"'";if(l)return u+l+g;var v=(0,i.default)(c,function(E,N){return E.concat(N)},[]),y=(0,a.default)(v,function(E){return"[".concat((0,a.default)(E,function(N){return(0,r.tokenLabel)(N)}).join(", "),"]")}),m=(0,a.default)(y,function(E,N){return"  ".concat(N+1,". ").concat(E)}),b=`one of these possible Token sequences:
`.concat(m.join(`
`));return u+b+g},buildEarlyExitMessage:function(h){var c=h.expectedIterationPaths,o=h.actual,l=h.customUserDescription;h.ruleName;var u="Expecting: ",d=(0,n.default)(o).image,g=`
but found: '`+d+"'";if(l)return u+l+g;var v=(0,a.default)(c,function(m){return"[".concat((0,a.default)(m,function(b){return(0,r.tokenLabel)(b)}).join(","),"]")}),y=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+"<".concat(v.join(" ,"),">");return u+y+g}},Object.freeze(e.defaultParserErrorProvider),e.defaultGrammarResolverErrorProvider={buildRuleNotFoundError:function(h,c){var o="Invalid grammar, reference to a rule which is not defined: ->"+c.nonTerminalName+`<-
inside top level rule: ->`+h.name+"<-";return o}},e.defaultGrammarValidatorErrorProvider={buildDuplicateFoundError:function(h,c){function o(b){return b instanceof s.Terminal?b.terminalType.name:b instanceof s.NonTerminal?b.nonTerminalName:""}var l=h.name,u=(0,n.default)(c),d=u.idx,g=(0,f.getProductionDslName)(u),v=o(u),y=d>0,m="->".concat(g).concat(y?d:"","<- ").concat(v?"with argument: ->".concat(v,"<-"):"",`
                  appears more than once (`).concat(c.length," times) in the top level rule: ->").concat(l,`<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `);return m=m.replace(/[ \t]+/g," "),m=m.replace(/\s\s+/g,`
`),m},buildNamespaceConflictError:function(h){var c=`Namespace conflict found in grammar.
`+"The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <".concat(h.name,`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return c},buildAlternationPrefixAmbiguityError:function(h){var c=(0,a.default)(h.prefixPath,function(u){return(0,r.tokenLabel)(u)}).join(", "),o=h.alternation.idx===0?"":h.alternation.idx,l="Ambiguous alternatives: <".concat(h.ambiguityIndices.join(" ,"),`> due to common lookahead prefix
`)+"in <OR".concat(o,"> inside <").concat(h.topLevelRule.name,`> Rule,
`)+"<".concat(c,`> may appears as a prefix path in all these alternatives.
`)+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return l},buildAlternationAmbiguityError:function(h){var c=(0,a.default)(h.prefixPath,function(u){return(0,r.tokenLabel)(u)}).join(", "),o=h.alternation.idx===0?"":h.alternation.idx,l="Ambiguous Alternatives Detected: <".concat(h.ambiguityIndices.join(" ,"),"> in <OR").concat(o,">")+" inside <".concat(h.topLevelRule.name,`> Rule,
`)+"<".concat(c,`> may appears as a prefix path in all these alternatives.
`);return l=l+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,l},buildEmptyRepetitionError:function(h){var c=(0,f.getProductionDslName)(h.repetition);h.repetition.idx!==0&&(c+=h.repetition.idx);var o="The repetition <".concat(c,"> within Rule <").concat(h.topLevelRule.name,`> can never consume any tokens.
`)+"This could lead to an infinite loop.";return o},buildTokenNameError:function(h){return"deprecated"},buildEmptyAlternationError:function(h){var c="Ambiguous empty alternative: <".concat(h.emptyChoiceIdx+1,">")+" in <OR".concat(h.alternation.idx,"> inside <").concat(h.topLevelRule.name,`> Rule.
`)+"Only the last alternative may be an empty alternative.";return c},buildTooManyAlternativesError:function(h){var c=`An Alternation cannot have more than 256 alternatives:
`+"<OR".concat(h.alternation.idx,"> inside <").concat(h.topLevelRule.name,`> Rule.
 has `).concat(h.alternation.definition.length+1," alternatives.");return c},buildLeftRecursionError:function(h){var c=h.topLevelRule.name,o=(0,a.default)(h.leftRecursionPath,function(d){return d.name}),l="".concat(c," --> ").concat(o.concat([c]).join(" --> ")),u=`Left Recursion found in grammar.
`+"rule: <".concat(c,`> can be invoked from itself (directly or indirectly)
`)+`without consuming any Tokens. The grammar path that causes this is: 
 `.concat(l,`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`;return u},buildInvalidRuleNameError:function(h){return"deprecated"},buildDuplicateRuleNameError:function(h){var c;h.topLevelRule instanceof s.Rule?c=h.topLevelRule.name:c=h.topLevelRule;var o="Duplicate definition, rule: ->".concat(c,"<- is already defined in the grammar: ->").concat(h.grammarName,"<-");return o}}})(eo);var $a={},Da={},MF=Te&&Te.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Pm=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Da,"__esModule",{value:!0});Da.GastRefResolverVisitor=Da.resolveGrammar=void 0;var PF=dr,SF=Pm(Xt),LF=Pm(un),$F=Pt;function DF(e,t){var r=new Sm(e,t);return r.resolveRefs(),r.errors}Da.resolveGrammar=DF;var Sm=function(e){MF(t,e);function t(r,n){var a=e.call(this)||this;return a.nameToTopRule=r,a.errMsgProvider=n,a.errors=[],a}return t.prototype.resolveRefs=function(){var r=this;(0,SF.default)((0,LF.default)(this.nameToTopRule),function(n){r.currTopLevel=n,n.accept(r)})},t.prototype.visitNonTerminal=function(r){var n=this.nameToTopRule[r.nonTerminalName];if(n)r.referencedRule=n;else{var a=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,r);this.errors.push({message:a,type:PF.ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:r.nonTerminalName})}},t}($F.GAstVisitor);Da.GastRefResolverVisitor=Sm;var st={};function xF(e,t,r,n){for(var a=-1,i=e==null?0:e.length;++a<i;){var s=e[a];t(n,s,r(s),e)}return n}var kF=xF,UF=ta;function FF(e,t,r,n){return UF(e,function(a,i,s){t(n,a,r(a),s)}),n}var BF=FF,VF=kF,GF=BF,HF=Wr,WF=ct;function zF(e,t){return function(r,n){var a=WF(r)?VF:GF,i=t?t():{};return a(r,e,HF(n),i)}}var KF=zF,qF=pu,YF=KF,XF=Object.prototype,jF=XF.hasOwnProperty,QF=YF(function(e,t,r){jF.call(e,r)?e[r].push(t):qF(e,r,[t])}),Lm=QF,ZF=Nu,JF=ir;function e3(e,t){return ZF(JF(e,t),1)}var t3=e3,to={},At={},r3=gu,n3=Xi;function a3(e,t,r){var n=e==null?0:e.length;return n?(t=r||t===void 0?1:n3(t),t=n-t,r3(e,0,t<0?0:t)):[]}var Su=a3,ia=Te&&Te.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),oa=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(At,"__esModule",{value:!0});At.nextPossibleTokensAfter=At.possiblePathsFrom=At.NextTerminalAfterAtLeastOneSepWalker=At.NextTerminalAfterAtLeastOneWalker=At.NextTerminalAfterManySepWalker=At.NextTerminalAfterManyWalker=At.AbstractNextTerminalAfterProductionWalker=At.NextAfterTokenWalker=At.AbstractNextPossibleTokensWalker=void 0;var $m=qa,Ss=oa(Zi),zo=oa(Hr),Eh=oa(Su),Zt=oa(mu),i3=oa(Pu),o3=oa(Xt),jn=oa(Pn),s3=Tr,je=Pt,Dm=function(e){ia(t,e);function t(r,n){var a=e.call(this)||this;return a.topProd=r,a.path=n,a.possibleTokTypes=[],a.nextProductionName="",a.nextProductionOccurrence=0,a.found=!1,a.isAtEndOfPath=!1,a}return t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=(0,jn.default)(this.path.ruleStack).reverse(),this.occurrenceStack=(0,jn.default)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(r,n){n===void 0&&(n=[]),this.found||e.prototype.walk.call(this,r,n)},t.prototype.walkProdRef=function(r,n,a){if(r.referencedRule.name===this.nextProductionName&&r.idx===this.nextProductionOccurrence){var i=n.concat(a);this.updateExpectedNext(),this.walk(r.referencedRule,i)}},t.prototype.updateExpectedNext=function(){(0,zo.default)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}($m.RestWalker);At.AbstractNextPossibleTokensWalker=Dm;var l3=function(e){ia(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.path=n,a.nextTerminalName="",a.nextTerminalOccurrence=0,a.nextTerminalName=a.path.lastTok.name,a.nextTerminalOccurrence=a.path.lastTokOccurrence,a}return t.prototype.walkTerminal=function(r,n,a){if(this.isAtEndOfPath&&r.terminalType.name===this.nextTerminalName&&r.idx===this.nextTerminalOccurrence&&!this.found){var i=n.concat(a),s=new je.Alternative({definition:i});this.possibleTokTypes=(0,s3.first)(s),this.found=!0}},t}(Dm);At.NextAfterTokenWalker=l3;var ro=function(e){ia(t,e);function t(r,n){var a=e.call(this)||this;return a.topRule=r,a.occurrence=n,a.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},a}return t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}($m.RestWalker);At.AbstractNextTerminalAfterProductionWalker=ro;var c3=function(e){ia(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.walkMany=function(r,n,a){if(r.idx===this.occurrence){var i=(0,Ss.default)(n.concat(a));this.result.isEndOfRule=i===void 0,i instanceof je.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkMany.call(this,r,n,a)},t}(ro);At.NextTerminalAfterManyWalker=c3;var u3=function(e){ia(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.walkManySep=function(r,n,a){if(r.idx===this.occurrence){var i=(0,Ss.default)(n.concat(a));this.result.isEndOfRule=i===void 0,i instanceof je.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkManySep.call(this,r,n,a)},t}(ro);At.NextTerminalAfterManySepWalker=u3;var f3=function(e){ia(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.walkAtLeastOne=function(r,n,a){if(r.idx===this.occurrence){var i=(0,Ss.default)(n.concat(a));this.result.isEndOfRule=i===void 0,i instanceof je.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOne.call(this,r,n,a)},t}(ro);At.NextTerminalAfterAtLeastOneWalker=f3;var d3=function(e){ia(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.walkAtLeastOneSep=function(r,n,a){if(r.idx===this.occurrence){var i=(0,Ss.default)(n.concat(a));this.result.isEndOfRule=i===void 0,i instanceof je.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOneSep.call(this,r,n,a)},t}(ro);At.NextTerminalAfterAtLeastOneSepWalker=d3;function xm(e,t,r){r===void 0&&(r=[]),r=(0,jn.default)(r);var n=[],a=0;function i(c){return c.concat((0,Zt.default)(e,a+1))}function s(c){var o=xm(i(c),t,r);return n.concat(o)}for(;r.length<t&&a<e.length;){var f=e[a];if(f instanceof je.Alternative)return s(f.definition);if(f instanceof je.NonTerminal)return s(f.definition);if(f instanceof je.Option)n=s(f.definition);else if(f instanceof je.RepetitionMandatory){var h=f.definition.concat([new je.Repetition({definition:f.definition})]);return s(h)}else if(f instanceof je.RepetitionMandatoryWithSeparator){var h=[new je.Alternative({definition:f.definition}),new je.Repetition({definition:[new je.Terminal({terminalType:f.separator})].concat(f.definition)})];return s(h)}else if(f instanceof je.RepetitionWithSeparator){var h=f.definition.concat([new je.Repetition({definition:[new je.Terminal({terminalType:f.separator})].concat(f.definition)})]);n=s(h)}else if(f instanceof je.Repetition){var h=f.definition.concat([new je.Repetition({definition:f.definition})]);n=s(h)}else{if(f instanceof je.Alternation)return(0,o3.default)(f.definition,function(c){(0,zo.default)(c.definition)===!1&&(n=s(c.definition))}),n;if(f instanceof je.Terminal)r.push(f.terminalType);else throw Error("non exhaustive match")}a++}return n.push({partialPath:r,suffixDef:(0,Zt.default)(e,a)}),n}At.possiblePathsFrom=xm;function h3(e,t,r,n){var a="EXIT_NONE_TERMINAL",i=[a],s="EXIT_ALTERNATIVE",f=!1,h=t.length,c=h-n-1,o=[],l=[];for(l.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!(0,zo.default)(l);){var u=l.pop();if(u===s){f&&(0,i3.default)(l).idx<=c&&l.pop();continue}var d=u.def,g=u.idx,v=u.ruleStack,y=u.occurrenceStack;if(!(0,zo.default)(d)){var m=d[0];if(m===a){var b={idx:g,def:(0,Zt.default)(d),ruleStack:(0,Eh.default)(v),occurrenceStack:(0,Eh.default)(y)};l.push(b)}else if(m instanceof je.Terminal)if(g<h-1){var E=g+1,N=t[E];if(r(N,m.terminalType)){var b={idx:E,def:(0,Zt.default)(d),ruleStack:v,occurrenceStack:y};l.push(b)}}else if(g===h-1)o.push({nextTokenType:m.terminalType,nextTokenOccurrence:m.idx,ruleStack:v,occurrenceStack:y}),f=!0;else throw Error("non exhaustive match");else if(m instanceof je.NonTerminal){var R=(0,jn.default)(v);R.push(m.nonTerminalName);var C=(0,jn.default)(y);C.push(m.idx);var b={idx:g,def:m.definition.concat(i,(0,Zt.default)(d)),ruleStack:R,occurrenceStack:C};l.push(b)}else if(m instanceof je.Option){var O={idx:g,def:(0,Zt.default)(d),ruleStack:v,occurrenceStack:y};l.push(O),l.push(s);var T={idx:g,def:m.definition.concat((0,Zt.default)(d)),ruleStack:v,occurrenceStack:y};l.push(T)}else if(m instanceof je.RepetitionMandatory){var A=new je.Repetition({definition:m.definition,idx:m.idx}),L=m.definition.concat([A],(0,Zt.default)(d)),b={idx:g,def:L,ruleStack:v,occurrenceStack:y};l.push(b)}else if(m instanceof je.RepetitionMandatoryWithSeparator){var G=new je.Terminal({terminalType:m.separator}),A=new je.Repetition({definition:[G].concat(m.definition),idx:m.idx}),L=m.definition.concat([A],(0,Zt.default)(d)),b={idx:g,def:L,ruleStack:v,occurrenceStack:y};l.push(b)}else if(m instanceof je.RepetitionWithSeparator){var O={idx:g,def:(0,Zt.default)(d),ruleStack:v,occurrenceStack:y};l.push(O),l.push(s);var G=new je.Terminal({terminalType:m.separator}),H=new je.Repetition({definition:[G].concat(m.definition),idx:m.idx}),L=m.definition.concat([H],(0,Zt.default)(d)),T={idx:g,def:L,ruleStack:v,occurrenceStack:y};l.push(T)}else if(m instanceof je.Repetition){var O={idx:g,def:(0,Zt.default)(d),ruleStack:v,occurrenceStack:y};l.push(O),l.push(s);var H=new je.Repetition({definition:m.definition,idx:m.idx}),L=m.definition.concat([H],(0,Zt.default)(d)),T={idx:g,def:L,ruleStack:v,occurrenceStack:y};l.push(T)}else if(m instanceof je.Alternation)for(var Y=m.definition.length-1;Y>=0;Y--){var K=m.definition[Y],ce={idx:g,def:K.definition.concat((0,Zt.default)(d)),ruleStack:v,occurrenceStack:y};l.push(ce),l.push(s)}else if(m instanceof je.Alternative)l.push({idx:g,def:m.definition.concat((0,Zt.default)(d)),ruleStack:v,occurrenceStack:y});else if(m instanceof je.Rule)l.push(p3(m,g,v,y));else throw Error("non exhaustive match")}}return o}At.nextPossibleTokensAfter=h3;function p3(e,t,r,n){var a=(0,jn.default)(r);a.push(e.name);var i=(0,jn.default)(n);return i.push(1),{idx:t,def:e.definition,ruleStack:a,occurrenceStack:i}}(function(e){var t=Te&&Te.__extends||function(){var V=function(W,Q){return V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ie,de){ie.__proto__=de}||function(ie,de){for(var me in de)Object.prototype.hasOwnProperty.call(de,me)&&(ie[me]=de[me])},V(W,Q)};return function(W,Q){if(typeof Q!="function"&&Q!==null)throw new TypeError("Class extends value "+String(Q)+" is not a constructor or null");V(W,Q);function ie(){this.constructor=W}W.prototype=Q===null?Object.create(Q):(ie.prototype=Q.prototype,new ie)}}(),r=Te&&Te.__importDefault||function(V){return V&&V.__esModule?V:{default:V}};Object.defineProperty(e,"__esModule",{value:!0}),e.areTokenCategoriesNotUsed=e.isStrictPrefixOfPath=e.containsPath=e.getLookaheadPathsForOptionalProd=e.getLookaheadPathsForOr=e.lookAheadSequenceFromAlternatives=e.buildSingleAlternativeLookaheadFunction=e.buildAlternativesLookAheadFunc=e.buildLookaheadFuncForOptionalProd=e.buildLookaheadFuncForOr=e.getProdType=e.PROD_TYPE=void 0;var n=r(Hr),a=r(hn),i=r(ws),s=r(ir),f=r(Xt),h=r(Er),c=r(na),o=At,l=qa,u=aa,d=Pt,g=Pt,v;(function(V){V[V.OPTION=0]="OPTION",V[V.REPETITION=1]="REPETITION",V[V.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",V[V.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",V[V.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",V[V.ALTERNATION=5]="ALTERNATION"})(v=e.PROD_TYPE||(e.PROD_TYPE={}));function y(V){if(V instanceof d.Option)return v.OPTION;if(V instanceof d.Repetition)return v.REPETITION;if(V instanceof d.RepetitionMandatory)return v.REPETITION_MANDATORY;if(V instanceof d.RepetitionMandatoryWithSeparator)return v.REPETITION_MANDATORY_WITH_SEPARATOR;if(V instanceof d.RepetitionWithSeparator)return v.REPETITION_WITH_SEPARATOR;if(V instanceof d.Alternation)return v.ALTERNATION;throw Error("non exhaustive match")}e.getProdType=y;function m(V,W,Q,ie,de,me){var Oe=G(V,W,Q),we=ce(Oe)?u.tokenStructuredMatcherNoCategories:u.tokenStructuredMatcher;return me(Oe,ie,we,de)}e.buildLookaheadFuncForOr=m;function b(V,W,Q,ie,de,me){var Oe=H(V,W,de,Q),we=ce(Oe)?u.tokenStructuredMatcherNoCategories:u.tokenStructuredMatcher;return me(Oe[0],we,ie)}e.buildLookaheadFuncForOptionalProd=b;function E(V,W,Q,ie){var de=V.length,me=(0,i.default)(V,function(Se){return(0,i.default)(Se,function(J){return J.length===1})});if(W)return function(Se){for(var J=(0,s.default)(Se,function(z){return z.GATE}),$=0;$<de;$++){var P=V[$],k=P.length,ge=J[$];if(ge!==void 0&&ge.call(this)===!1)continue;e:for(var q=0;q<k;q++){for(var ye=P[q],X=ye.length,M=0;M<X;M++){var B=this.LA(M+1);if(Q(B,ye[M])===!1)continue e}return $}}};if(me&&!ie){var Oe=(0,s.default)(V,function(Se){return(0,a.default)(Se)}),we=(0,c.default)(Oe,function(Se,J,$){return(0,f.default)(J,function(P){(0,h.default)(Se,P.tokenTypeIdx)||(Se[P.tokenTypeIdx]=$),(0,f.default)(P.categoryMatches,function(k){(0,h.default)(Se,k)||(Se[k]=$)})}),Se},{});return function(){var Se=this.LA(1);return we[Se.tokenTypeIdx]}}else return function(){for(var Se=0;Se<de;Se++){var J=V[Se],$=J.length;e:for(var P=0;P<$;P++){for(var k=J[P],ge=k.length,q=0;q<ge;q++){var ye=this.LA(q+1);if(Q(ye,k[q])===!1)continue e}return Se}}}}e.buildAlternativesLookAheadFunc=E;function N(V,W,Q){var ie=(0,i.default)(V,function(J){return J.length===1}),de=V.length;if(ie&&!Q){var me=(0,a.default)(V);if(me.length===1&&(0,n.default)(me[0].categoryMatches)){var Oe=me[0],we=Oe.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===we}}else{var Se=(0,c.default)(me,function(J,$,P){return J[$.tokenTypeIdx]=!0,(0,f.default)($.categoryMatches,function(k){J[k]=!0}),J},[]);return function(){var J=this.LA(1);return Se[J.tokenTypeIdx]===!0}}}else return function(){e:for(var J=0;J<de;J++){for(var $=V[J],P=$.length,k=0;k<P;k++){var ge=this.LA(k+1);if(W(ge,$[k])===!1)continue e}return!0}return!1}}e.buildSingleAlternativeLookaheadFunction=N;var R=function(V){t(W,V);function W(Q,ie,de){var me=V.call(this)||this;return me.topProd=Q,me.targetOccurrence=ie,me.targetProdType=de,me}return W.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},W.prototype.checkIsTarget=function(Q,ie,de,me){return Q.idx===this.targetOccurrence&&this.targetProdType===ie?(this.restDef=de.concat(me),!0):!1},W.prototype.walkOption=function(Q,ie,de){this.checkIsTarget(Q,v.OPTION,ie,de)||V.prototype.walkOption.call(this,Q,ie,de)},W.prototype.walkAtLeastOne=function(Q,ie,de){this.checkIsTarget(Q,v.REPETITION_MANDATORY,ie,de)||V.prototype.walkOption.call(this,Q,ie,de)},W.prototype.walkAtLeastOneSep=function(Q,ie,de){this.checkIsTarget(Q,v.REPETITION_MANDATORY_WITH_SEPARATOR,ie,de)||V.prototype.walkOption.call(this,Q,ie,de)},W.prototype.walkMany=function(Q,ie,de){this.checkIsTarget(Q,v.REPETITION,ie,de)||V.prototype.walkOption.call(this,Q,ie,de)},W.prototype.walkManySep=function(Q,ie,de){this.checkIsTarget(Q,v.REPETITION_WITH_SEPARATOR,ie,de)||V.prototype.walkOption.call(this,Q,ie,de)},W}(l.RestWalker),C=function(V){t(W,V);function W(Q,ie,de){var me=V.call(this)||this;return me.targetOccurrence=Q,me.targetProdType=ie,me.targetRef=de,me.result=[],me}return W.prototype.checkIsTarget=function(Q,ie){Q.idx===this.targetOccurrence&&this.targetProdType===ie&&(this.targetRef===void 0||Q===this.targetRef)&&(this.result=Q.definition)},W.prototype.visitOption=function(Q){this.checkIsTarget(Q,v.OPTION)},W.prototype.visitRepetition=function(Q){this.checkIsTarget(Q,v.REPETITION)},W.prototype.visitRepetitionMandatory=function(Q){this.checkIsTarget(Q,v.REPETITION_MANDATORY)},W.prototype.visitRepetitionMandatoryWithSeparator=function(Q){this.checkIsTarget(Q,v.REPETITION_MANDATORY_WITH_SEPARATOR)},W.prototype.visitRepetitionWithSeparator=function(Q){this.checkIsTarget(Q,v.REPETITION_WITH_SEPARATOR)},W.prototype.visitAlternation=function(Q){this.checkIsTarget(Q,v.ALTERNATION)},W}(g.GAstVisitor);function O(V){for(var W=new Array(V),Q=0;Q<V;Q++)W[Q]=[];return W}function T(V){for(var W=[""],Q=0;Q<V.length;Q++){for(var ie=V[Q],de=[],me=0;me<W.length;me++){var Oe=W[me];de.push(Oe+"_"+ie.tokenTypeIdx);for(var we=0;we<ie.categoryMatches.length;we++){var Se="_"+ie.categoryMatches[we];de.push(Oe+Se)}}W=de}return W}function A(V,W,Q){for(var ie=0;ie<V.length;ie++)if(ie!==Q)for(var de=V[ie],me=0;me<W.length;me++){var Oe=W[me];if(de[Oe]===!0)return!1}return!0}function L(V,W){for(var Q=(0,s.default)(V,function($){return(0,o.possiblePathsFrom)([$],1)}),ie=O(Q.length),de=(0,s.default)(Q,function($){var P={};return(0,f.default)($,function(k){var ge=T(k.partialPath);(0,f.default)(ge,function(q){P[q]=!0})}),P}),me=Q,Oe=1;Oe<=W;Oe++){var we=me;me=O(we.length);for(var Se=function($){for(var P=we[$],k=0;k<P.length;k++){var ge=P[k].partialPath,q=P[k].suffixDef,ye=T(ge),X=A(de,ye,$);if(X||(0,n.default)(q)||ge.length===W){var M=ie[$];if(Y(M,ge)===!1){M.push(ge);for(var B=0;B<ye.length;B++){var z=ye[B];de[$][z]=!0}}}else{var re=(0,o.possiblePathsFrom)(q,Oe+1,ge);me[$]=me[$].concat(re),(0,f.default)(re,function(ne){var p=T(ne.partialPath);(0,f.default)(p,function(Ee){de[$][Ee]=!0})})}}},J=0;J<we.length;J++)Se(J)}return ie}e.lookAheadSequenceFromAlternatives=L;function G(V,W,Q,ie){var de=new C(V,v.ALTERNATION,ie);return W.accept(de),L(de.result,Q)}e.getLookaheadPathsForOr=G;function H(V,W,Q,ie){var de=new C(V,Q);W.accept(de);var me=de.result,Oe=new R(W,V,Q),we=Oe.startWalking(),Se=new d.Alternative({definition:me}),J=new d.Alternative({definition:we});return L([Se,J],ie)}e.getLookaheadPathsForOptionalProd=H;function Y(V,W){e:for(var Q=0;Q<V.length;Q++){var ie=V[Q];if(ie.length===W.length){for(var de=0;de<ie.length;de++){var me=W[de],Oe=ie[de],we=me===Oe||Oe.categoryMatchesMap[me.tokenTypeIdx]!==void 0;if(we===!1)continue e}return!0}}return!1}e.containsPath=Y;function K(V,W){return V.length<W.length&&(0,i.default)(V,function(Q,ie){var de=W[ie];return Q===de||de.categoryMatchesMap[Q.tokenTypeIdx]})}e.isStrictPrefixOfPath=K;function ce(V){return(0,i.default)(V,function(W){return(0,i.default)(W,function(Q){return(0,i.default)(Q,function(ie){return(0,n.default)(ie.categoryMatches)})})})}e.areTokenCategoriesNotUsed=ce})(to);var Lu=Te&&Te.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ht=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(st,"__esModule",{value:!0});st.checkPrefixAlternativesAmbiguities=st.validateSomeNonEmptyLookaheadPath=st.validateTooManyAlts=st.RepetitionCollector=st.validateAmbiguousAlternationAlternatives=st.validateEmptyOrAlternative=st.getFirstNoneTerminal=st.validateNoLeftRecursion=st.validateRuleIsOverridden=st.validateRuleDoesNotAlreadyExist=st.OccurrenceValidationCollector=st.identifyProductionForDuplicates=st.validateGrammar=void 0;var km=Ht(Zi),no=Ht(Hr),v3=Ht(mu),Um=Ht(hn),g3=Ht(Mu),m3=Ht(Ou),y3=Ht(wu),Qn=Ht(ir),Mi=Ht(Xt),E3=Ht(Lm),$u=Ht(na),_3=Ht(nm),b3=Ht(un),Du=Ht(dn),vr=Ht(t3),N3=Ht(Pn),Yr=dr,xu=Pt,xa=to,A3=At,br=Pt,ku=Pt,C3=Ht(Su),T3=Ht(Ps),R3=aa;function O3(e,t,r,n,a){var i=(0,vr.default)(e,function(d){return w3(d,n)}),s=(0,vr.default)(e,function(d){return Uu(d,d,n)}),f=[],h=[],c=[];(0,no.default)(s)&&(f=(0,vr.default)(e,function(d){return Hm(d,n)}),h=(0,vr.default)(e,function(d){return Wm(d,t,n)}),c=qm(e,t,n));var o=P3(e,r,n),l=(0,vr.default)(e,function(d){return Km(d,n)}),u=(0,vr.default)(e,function(d){return Gm(d,e,a,n)});return i.concat(c,s,f,h,o,l,u)}st.validateGrammar=O3;function w3(e,t){var r=new Vm;e.accept(r);var n=r.allProductions,a=(0,E3.default)(n,Fm),i=(0,_3.default)(a,function(f){return f.length>1}),s=(0,Qn.default)((0,b3.default)(i),function(f){var h=(0,km.default)(f),c=t.buildDuplicateFoundError(e,f),o=(0,xu.getProductionDslName)(h),l={message:c,type:Yr.ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:o,occurrence:h.idx},u=Bm(h);return u&&(l.parameter=u),l});return s}function Fm(e){return"".concat((0,xu.getProductionDslName)(e),"_#_").concat(e.idx,"_#_").concat(Bm(e))}st.identifyProductionForDuplicates=Fm;function Bm(e){return e instanceof br.Terminal?e.terminalType.name:e instanceof br.NonTerminal?e.nonTerminalName:""}var Vm=function(e){Lu(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.allProductions=[],r}return t.prototype.visitNonTerminal=function(r){this.allProductions.push(r)},t.prototype.visitOption=function(r){this.allProductions.push(r)},t.prototype.visitRepetitionWithSeparator=function(r){this.allProductions.push(r)},t.prototype.visitRepetitionMandatory=function(r){this.allProductions.push(r)},t.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.allProductions.push(r)},t.prototype.visitRepetition=function(r){this.allProductions.push(r)},t.prototype.visitAlternation=function(r){this.allProductions.push(r)},t.prototype.visitTerminal=function(r){this.allProductions.push(r)},t}(ku.GAstVisitor);st.OccurrenceValidationCollector=Vm;function Gm(e,t,r,n){var a=[],i=(0,$u.default)(t,function(f,h){return h.name===e.name?f+1:f},0);if(i>1){var s=n.buildDuplicateRuleNameError({topLevelRule:e,grammarName:r});a.push({message:s,type:Yr.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e.name})}return a}st.validateRuleDoesNotAlreadyExist=Gm;function I3(e,t,r){var n=[],a;return(0,Du.default)(t,e)||(a="Invalid rule override, rule: ->".concat(e,"<- cannot be overridden in the grammar: ->").concat(r,"<-")+"as it is not defined in any of the super grammars ",n.push({message:a,type:Yr.ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:e})),n}st.validateRuleIsOverridden=I3;function Uu(e,t,r,n){n===void 0&&(n=[]);var a=[],i=bi(t.definition);if((0,no.default)(i))return[];var s=e.name,f=(0,Du.default)(i,e);f&&a.push({message:r.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:n}),type:Yr.ParserDefinitionErrorType.LEFT_RECURSION,ruleName:s});var h=(0,y3.default)(i,n.concat([e])),c=(0,vr.default)(h,function(o){var l=(0,N3.default)(n);return l.push(o),Uu(e,o,r,l)});return a.concat(c)}st.validateNoLeftRecursion=Uu;function bi(e){var t=[];if((0,no.default)(e))return t;var r=(0,km.default)(e);if(r instanceof br.NonTerminal)t.push(r.referencedRule);else if(r instanceof br.Alternative||r instanceof br.Option||r instanceof br.RepetitionMandatory||r instanceof br.RepetitionMandatoryWithSeparator||r instanceof br.RepetitionWithSeparator||r instanceof br.Repetition)t=t.concat(bi(r.definition));else if(r instanceof br.Alternation)t=(0,Um.default)((0,Qn.default)(r.definition,function(s){return bi(s.definition)}));else if(!(r instanceof br.Terminal))throw Error("non exhaustive match");var n=(0,xu.isOptionalProd)(r),a=e.length>1;if(n&&a){var i=(0,v3.default)(e);return t.concat(bi(i))}else return t}st.getFirstNoneTerminal=bi;var Fu=function(e){Lu(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.alternations=[],r}return t.prototype.visitAlternation=function(r){this.alternations.push(r)},t}(ku.GAstVisitor);function Hm(e,t){var r=new Fu;e.accept(r);var n=r.alternations,a=(0,vr.default)(n,function(i){var s=(0,C3.default)(i.definition);return(0,vr.default)(s,function(f,h){var c=(0,A3.nextPossibleTokensAfter)([f],[],R3.tokenStructuredMatcher,1);return(0,no.default)(c)?[{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:i,emptyChoiceIdx:h}),type:Yr.ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:i.idx,alternative:h+1}]:[]})});return a}st.validateEmptyOrAlternative=Hm;function Wm(e,t,r){var n=new Fu;e.accept(n);var a=n.alternations;a=(0,m3.default)(a,function(s){return s.ignoreAmbiguities===!0});var i=(0,vr.default)(a,function(s){var f=s.idx,h=s.maxLookahead||t,c=(0,xa.getLookaheadPathsForOr)(f,e,h,s),o=M3(c,s,e,r),l=Ym(c,s,e,r);return o.concat(l)});return i}st.validateAmbiguousAlternationAlternatives=Wm;var zm=function(e){Lu(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.allProductions=[],r}return t.prototype.visitRepetitionWithSeparator=function(r){this.allProductions.push(r)},t.prototype.visitRepetitionMandatory=function(r){this.allProductions.push(r)},t.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.allProductions.push(r)},t.prototype.visitRepetition=function(r){this.allProductions.push(r)},t}(ku.GAstVisitor);st.RepetitionCollector=zm;function Km(e,t){var r=new Fu;e.accept(r);var n=r.alternations,a=(0,vr.default)(n,function(i){return i.definition.length>255?[{message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:i}),type:Yr.ParserDefinitionErrorType.TOO_MANY_ALTS,ruleName:e.name,occurrence:i.idx}]:[]});return a}st.validateTooManyAlts=Km;function qm(e,t,r){var n=[];return(0,Mi.default)(e,function(a){var i=new zm;a.accept(i);var s=i.allProductions;(0,Mi.default)(s,function(f){var h=(0,xa.getProdType)(f),c=f.maxLookahead||t,o=f.idx,l=(0,xa.getLookaheadPathsForOptionalProd)(o,a,h,c),u=l[0];if((0,no.default)((0,Um.default)(u))){var d=r.buildEmptyRepetitionError({topLevelRule:a,repetition:f});n.push({message:d,type:Yr.ParserDefinitionErrorType.NO_NON_EMPTY_LOOKAHEAD,ruleName:a.name})}})}),n}st.validateSomeNonEmptyLookaheadPath=qm;function M3(e,t,r,n){var a=[],i=(0,$u.default)(e,function(f,h,c){return t.definition[c].ignoreAmbiguities===!0||(0,Mi.default)(h,function(o){var l=[c];(0,Mi.default)(e,function(u,d){c!==d&&(0,xa.containsPath)(u,o)&&t.definition[d].ignoreAmbiguities!==!0&&l.push(d)}),l.length>1&&!(0,xa.containsPath)(a,o)&&(a.push(o),f.push({alts:l,path:o}))}),f},[]),s=(0,Qn.default)(i,function(f){var h=(0,Qn.default)(f.alts,function(o){return o+1}),c=n.buildAlternationAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:h,prefixPath:f.path});return{message:c,type:Yr.ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:t.idx,alternatives:f.alts}});return s}function Ym(e,t,r,n){var a=(0,$u.default)(e,function(s,f,h){var c=(0,Qn.default)(f,function(o){return{idx:h,path:o}});return s.concat(c)},[]),i=(0,T3.default)((0,vr.default)(a,function(s){var f=t.definition[s.idx];if(f.ignoreAmbiguities===!0)return[];var h=s.idx,c=s.path,o=(0,g3.default)(a,function(u){return t.definition[u.idx].ignoreAmbiguities!==!0&&u.idx<h&&(0,xa.isStrictPrefixOfPath)(u.path,c)}),l=(0,Qn.default)(o,function(u){var d=[u.idx+1,h+1],g=t.idx===0?"":t.idx,v=n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:d,prefixPath:u.path});return{message:v,type:Yr.ParserDefinitionErrorType.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:g,alternatives:d}});return l}));return i}st.checkPrefixAlternativesAmbiguities=Ym;function P3(e,t,r){var n=[],a=(0,Qn.default)(t,function(i){return i.name});return(0,Mi.default)(e,function(i){var s=i.name;if((0,Du.default)(a,s)){var f=r.buildNamespaceConflictError(i);n.push({message:f,type:Yr.ParserDefinitionErrorType.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:s})}}),n}var Xm=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($a,"__esModule",{value:!0});$a.validateGrammar=$a.resolveGrammar=void 0;var S3=Xm(Xt),jm=Xm(Im),L3=Da,$3=st,Qm=eo;function D3(e){var t=(0,jm.default)(e,{errMsgProvider:Qm.defaultGrammarResolverErrorProvider}),r={};return(0,S3.default)(e.rules,function(n){r[n.name]=n}),(0,L3.resolveGrammar)(r,t.errMsgProvider)}$a.resolveGrammar=D3;function x3(e){return e=(0,jm.default)(e,{errMsgProvider:Qm.defaultGrammarValidatorErrorProvider}),(0,$3.validateGrammar)(e.rules,e.maxLookahead,e.tokenTypes,e.errMsgProvider,e.grammarName)}$a.validateGrammar=x3;var Bu={},qt={},ao=Te&&Te.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),k3=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qt,"__esModule",{value:!0});qt.EarlyExitException=qt.NotAllInputParsedException=qt.NoViableAltException=qt.MismatchedTokenException=qt.isRecognitionException=void 0;var U3=k3(dn),Zm="MismatchedTokenException",Jm="NoViableAltException",e0="EarlyExitException",t0="NotAllInputParsedException",r0=[Zm,Jm,e0,t0];Object.freeze(r0);function F3(e){return(0,U3.default)(r0,e.name)}qt.isRecognitionException=F3;var Ls=function(e){ao(t,e);function t(r,n){var a=this.constructor,i=e.call(this,r)||this;return i.token=n,i.resyncedTokens=[],Object.setPrototypeOf(i,a.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,i.constructor),i}return t}(Error),B3=function(e){ao(t,e);function t(r,n,a){var i=e.call(this,r,n)||this;return i.previousToken=a,i.name=Zm,i}return t}(Ls);qt.MismatchedTokenException=B3;var V3=function(e){ao(t,e);function t(r,n,a){var i=e.call(this,r,n)||this;return i.previousToken=a,i.name=Jm,i}return t}(Ls);qt.NoViableAltException=V3;var G3=function(e){ao(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.name=t0,a}return t}(Ls);qt.NotAllInputParsedException=G3;var H3=function(e){ao(t,e);function t(r,n,a){var i=e.call(this,r,n)||this;return i.previousToken=a,i.name=e0,i}return t}(Ls);qt.EarlyExitException=H3;(function(e){var t=Te&&Te.__extends||function(){var b=function(E,N){return b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,C){R.__proto__=C}||function(R,C){for(var O in C)Object.prototype.hasOwnProperty.call(C,O)&&(R[O]=C[O])},b(E,N)};return function(E,N){if(typeof N!="function"&&N!==null)throw new TypeError("Class extends value "+String(N)+" is not a constructor or null");b(E,N);function R(){this.constructor=E}E.prototype=N===null?Object.create(N):(R.prototype=N.prototype,new R)}}(),r=Te&&Te.__importDefault||function(b){return b&&b.__esModule?b:{default:b}};Object.defineProperty(e,"__esModule",{value:!0}),e.attemptInRepetitionRecovery=e.Recoverable=e.InRuleRecoveryException=e.IN_RULE_RECOVERY_EXCEPTION=e.EOF_FOLLOW_KEY=void 0;var n=ra,a=r(Hr),i=r(Su),s=r(hn),f=r(ir),h=r(Iu),c=r(Er),o=r(dn),l=r(Pn),u=qt,d=ji,g=dr;e.EOF_FOLLOW_KEY={},e.IN_RULE_RECOVERY_EXCEPTION="InRuleRecoveryException";var v=function(b){t(E,b);function E(N){var R=b.call(this,N)||this;return R.name=e.IN_RULE_RECOVERY_EXCEPTION,R}return E}(Error);e.InRuleRecoveryException=v;var y=function(){function b(){}return b.prototype.initRecoverable=function(E){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=(0,c.default)(E,"recoveryEnabled")?E.recoveryEnabled:g.DEFAULT_PARSER_CONFIG.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=m)},b.prototype.getTokenToInsert=function(E){var N=(0,n.createTokenInstance)(E,"",NaN,NaN,NaN,NaN,NaN,NaN);return N.isInsertedInRecovery=!0,N},b.prototype.canTokenTypeBeInsertedInRecovery=function(E){return!0},b.prototype.canTokenTypeBeDeletedInRecovery=function(E){return!0},b.prototype.tryInRepetitionRecovery=function(E,N,R,C){for(var O=this,T=this.findReSyncTokenType(),A=this.exportLexerState(),L=[],G=!1,H=this.LA(1),Y=this.LA(1),K=function(){var ce=O.LA(0),V=O.errorMessageProvider.buildMismatchTokenMessage({expected:C,actual:H,previous:ce,ruleName:O.getCurrRuleFullName()}),W=new u.MismatchedTokenException(V,H,O.LA(0));W.resyncedTokens=(0,i.default)(L),O.SAVE_ERROR(W)};!G;)if(this.tokenMatcher(Y,C)){K();return}else if(R.call(this)){K(),E.apply(this,N);return}else this.tokenMatcher(Y,T)?G=!0:(Y=this.SKIP_TOKEN(),this.addToResyncTokens(Y,L));this.importLexerState(A)},b.prototype.shouldInRepetitionRecoveryBeTried=function(E,N,R){return!(R===!1||this.tokenMatcher(this.LA(1),E)||this.isBackTracking()||this.canPerformInRuleRecovery(E,this.getFollowsForInRuleRecovery(E,N)))},b.prototype.getFollowsForInRuleRecovery=function(E,N){var R=this.getCurrentGrammarPath(E,N),C=this.getNextPossibleTokenTypes(R);return C},b.prototype.tryInRuleRecovery=function(E,N){if(this.canRecoverWithSingleTokenInsertion(E,N)){var R=this.getTokenToInsert(E);return R}if(this.canRecoverWithSingleTokenDeletion(E)){var C=this.SKIP_TOKEN();return this.consumeToken(),C}throw new v("sad sad panda")},b.prototype.canPerformInRuleRecovery=function(E,N){return this.canRecoverWithSingleTokenInsertion(E,N)||this.canRecoverWithSingleTokenDeletion(E)},b.prototype.canRecoverWithSingleTokenInsertion=function(E,N){var R=this;if(!this.canTokenTypeBeInsertedInRecovery(E)||(0,a.default)(N))return!1;var C=this.LA(1),O=(0,h.default)(N,function(T){return R.tokenMatcher(C,T)})!==void 0;return O},b.prototype.canRecoverWithSingleTokenDeletion=function(E){if(!this.canTokenTypeBeDeletedInRecovery(E))return!1;var N=this.tokenMatcher(this.LA(2),E);return N},b.prototype.isInCurrentRuleReSyncSet=function(E){var N=this.getCurrFollowKey(),R=this.getFollowSetFromFollowKey(N);return(0,o.default)(R,E)},b.prototype.findReSyncTokenType=function(){for(var E=this.flattenFollowSet(),N=this.LA(1),R=2;;){var C=(0,h.default)(E,function(O){var T=(0,n.tokenMatcher)(N,O);return T});if(C!==void 0)return C;N=this.LA(R),R++}},b.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return e.EOF_FOLLOW_KEY;var E=this.getLastExplicitRuleShortName(),N=this.getLastExplicitRuleOccurrenceIndex(),R=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(E),idxInCallingRule:N,inRule:this.shortRuleNameToFullName(R)}},b.prototype.buildFullFollowKeyStack=function(){var E=this,N=this.RULE_STACK,R=this.RULE_OCCURRENCE_STACK;return(0,f.default)(N,function(C,O){return O===0?e.EOF_FOLLOW_KEY:{ruleName:E.shortRuleNameToFullName(C),idxInCallingRule:R[O],inRule:E.shortRuleNameToFullName(N[O-1])}})},b.prototype.flattenFollowSet=function(){var E=this,N=(0,f.default)(this.buildFullFollowKeyStack(),function(R){return E.getFollowSetFromFollowKey(R)});return(0,s.default)(N)},b.prototype.getFollowSetFromFollowKey=function(E){if(E===e.EOF_FOLLOW_KEY)return[n.EOF];var N=E.ruleName+E.idxInCallingRule+d.IN+E.inRule;return this.resyncFollows[N]},b.prototype.addToResyncTokens=function(E,N){return this.tokenMatcher(E,n.EOF)||N.push(E),N},b.prototype.reSyncTo=function(E){for(var N=[],R=this.LA(1);this.tokenMatcher(R,E)===!1;)R=this.SKIP_TOKEN(),this.addToResyncTokens(R,N);return(0,i.default)(N)},b.prototype.attemptInRepetitionRecovery=function(E,N,R,C,O,T,A){},b.prototype.getCurrentGrammarPath=function(E,N){var R=this.getHumanReadableRuleStack(),C=(0,l.default)(this.RULE_OCCURRENCE_STACK),O={ruleStack:R,occurrenceStack:C,lastTok:E,lastTokOccurrence:N};return O},b.prototype.getHumanReadableRuleStack=function(){var E=this;return(0,f.default)(this.RULE_STACK,function(N){return E.shortRuleNameToFullName(N)})},b}();e.Recoverable=y;function m(b,E,N,R,C,O,T){var A=this.getKeyForAutomaticLookahead(R,C),L=this.firstAfterRepMap[A];if(L===void 0){var G=this.getCurrRuleFullName(),H=this.getGAstProductions()[G],Y=new O(H,C);L=Y.startWalking(),this.firstAfterRepMap[A]=L}var K=L.token,ce=L.occurrence,V=L.isEndOfRule;this.RULE_STACK.length===1&&V&&K===void 0&&(K=n.EOF,ce=1),!(K===void 0||ce===void 0)&&this.shouldInRepetitionRecoveryBeTried(K,ce,T)&&this.tryInRepetitionRecovery(b,E,N,K)}e.attemptInRepetitionRecovery=m})(Bu);var ka={},$s={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getKeyForAutomaticLookahead=e.AT_LEAST_ONE_SEP_IDX=e.MANY_SEP_IDX=e.AT_LEAST_ONE_IDX=e.MANY_IDX=e.OPTION_IDX=e.OR_IDX=e.BITS_FOR_ALT_IDX=e.BITS_FOR_RULE_IDX=e.BITS_FOR_OCCURRENCE_IDX=e.BITS_FOR_METHOD_TYPE=void 0,e.BITS_FOR_METHOD_TYPE=4,e.BITS_FOR_OCCURRENCE_IDX=8,e.BITS_FOR_RULE_IDX=12,e.BITS_FOR_ALT_IDX=8,e.OR_IDX=1<<e.BITS_FOR_OCCURRENCE_IDX,e.OPTION_IDX=2<<e.BITS_FOR_OCCURRENCE_IDX,e.MANY_IDX=3<<e.BITS_FOR_OCCURRENCE_IDX,e.AT_LEAST_ONE_IDX=4<<e.BITS_FOR_OCCURRENCE_IDX,e.MANY_SEP_IDX=5<<e.BITS_FOR_OCCURRENCE_IDX,e.AT_LEAST_ONE_SEP_IDX=6<<e.BITS_FOR_OCCURRENCE_IDX;function t(r,n,a){return a|n|r}e.getKeyForAutomaticLookahead=t,32-e.BITS_FOR_ALT_IDX})($s);var W3=Te&&Te.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),n0=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ka,"__esModule",{value:!0});ka.collectMethods=ka.LooksAhead=void 0;var Qr=to,kn=n0(Xt),_h=n0(Er),bh=dr,Zr=$s,z3=Pt,ua=Pt,K3=function(){function e(){}return e.prototype.initLooksAhead=function(t){this.dynamicTokensEnabled=(0,_h.default)(t,"dynamicTokensEnabled")?t.dynamicTokensEnabled:bh.DEFAULT_PARSER_CONFIG.dynamicTokensEnabled,this.maxLookahead=(0,_h.default)(t,"maxLookahead")?t.maxLookahead:bh.DEFAULT_PARSER_CONFIG.maxLookahead,this.lookAheadFuncsCache=new Map},e.prototype.preComputeLookaheadFunctions=function(t){var r=this;(0,kn.default)(t,function(n){r.TRACE_INIT("".concat(n.name," Rule Lookahead"),function(){var a=a0(n),i=a.alternation,s=a.repetition,f=a.option,h=a.repetitionMandatory,c=a.repetitionMandatoryWithSeparator,o=a.repetitionWithSeparator;(0,kn.default)(i,function(l){var u=l.idx===0?"":l.idx;r.TRACE_INIT("".concat((0,ua.getProductionDslName)(l)).concat(u),function(){var d=(0,Qr.buildLookaheadFuncForOr)(l.idx,n,l.maxLookahead||r.maxLookahead,l.hasPredicates,r.dynamicTokensEnabled,r.lookAheadBuilderForAlternatives),g=(0,Zr.getKeyForAutomaticLookahead)(r.fullRuleNameToShort[n.name],Zr.OR_IDX,l.idx);r.setLaFuncCache(g,d)})}),(0,kn.default)(s,function(l){r.computeLookaheadFunc(n,l.idx,Zr.MANY_IDX,Qr.PROD_TYPE.REPETITION,l.maxLookahead,(0,ua.getProductionDslName)(l))}),(0,kn.default)(f,function(l){r.computeLookaheadFunc(n,l.idx,Zr.OPTION_IDX,Qr.PROD_TYPE.OPTION,l.maxLookahead,(0,ua.getProductionDslName)(l))}),(0,kn.default)(h,function(l){r.computeLookaheadFunc(n,l.idx,Zr.AT_LEAST_ONE_IDX,Qr.PROD_TYPE.REPETITION_MANDATORY,l.maxLookahead,(0,ua.getProductionDslName)(l))}),(0,kn.default)(c,function(l){r.computeLookaheadFunc(n,l.idx,Zr.AT_LEAST_ONE_SEP_IDX,Qr.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,l.maxLookahead,(0,ua.getProductionDslName)(l))}),(0,kn.default)(o,function(l){r.computeLookaheadFunc(n,l.idx,Zr.MANY_SEP_IDX,Qr.PROD_TYPE.REPETITION_WITH_SEPARATOR,l.maxLookahead,(0,ua.getProductionDslName)(l))})})})},e.prototype.computeLookaheadFunc=function(t,r,n,a,i,s){var f=this;this.TRACE_INIT("".concat(s).concat(r===0?"":r),function(){var h=(0,Qr.buildLookaheadFuncForOptionalProd)(r,t,i||f.maxLookahead,f.dynamicTokensEnabled,a,f.lookAheadBuilderForOptional),c=(0,Zr.getKeyForAutomaticLookahead)(f.fullRuleNameToShort[t.name],n,r);f.setLaFuncCache(c,h)})},e.prototype.lookAheadBuilderForOptional=function(t,r,n){return(0,Qr.buildSingleAlternativeLookaheadFunction)(t,r,n)},e.prototype.lookAheadBuilderForAlternatives=function(t,r,n,a){return(0,Qr.buildAlternativesLookAheadFunc)(t,r,n,a)},e.prototype.getKeyForAutomaticLookahead=function(t,r){var n=this.getLastExplicitRuleShortName();return(0,Zr.getKeyForAutomaticLookahead)(n,t,r)},e.prototype.getLaFuncFromCache=function(t){return this.lookAheadFuncsCache.get(t)},e.prototype.setLaFuncCache=function(t,r){this.lookAheadFuncsCache.set(t,r)},e}();ka.LooksAhead=K3;var q3=function(e){W3(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},r}return t.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},t.prototype.visitOption=function(r){this.dslMethods.option.push(r)},t.prototype.visitRepetitionWithSeparator=function(r){this.dslMethods.repetitionWithSeparator.push(r)},t.prototype.visitRepetitionMandatory=function(r){this.dslMethods.repetitionMandatory.push(r)},t.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.dslMethods.repetitionMandatoryWithSeparator.push(r)},t.prototype.visitRepetition=function(r){this.dslMethods.repetition.push(r)},t.prototype.visitAlternation=function(r){this.dslMethods.alternation.push(r)},t}(z3.GAstVisitor),Eo=new q3;function a0(e){Eo.reset(),e.accept(Eo);var t=Eo.dslMethods;return Eo.reset(),t}ka.collectMethods=a0;var Ds={},kr={};Object.defineProperty(kr,"__esModule",{value:!0});kr.addNoneTerminalToCst=kr.addTerminalToCst=kr.setNodeLocationFull=kr.setNodeLocationOnlyOffset=void 0;function Y3(e,t){isNaN(e.startOffset)===!0?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset&&(e.endOffset=t.endOffset)}kr.setNodeLocationOnlyOffset=Y3;function X3(e,t){isNaN(e.startOffset)===!0?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}kr.setNodeLocationFull=X3;function j3(e,t,r){e.children[r]===void 0?e.children[r]=[t]:e.children[r].push(t)}kr.addTerminalToCst=j3;function Q3(e,t,r){e.children[t]===void 0?e.children[t]=[r]:e.children[t].push(r)}kr.addNoneTerminalToCst=Q3;var i0={},xs={};Object.defineProperty(xs,"__esModule",{value:!0});xs.defineNameProp=void 0;var Z3="name";function J3(e,t){Object.defineProperty(e,Z3,{enumerable:!1,configurable:!0,writable:!1,value:t})}xs.defineNameProp=J3;(function(e){var t=Te&&Te.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(e,"__esModule",{value:!0}),e.validateRedundantMethods=e.validateMissingCstMethods=e.validateVisitor=e.CstVisitorDefinitionError=e.createBaseVisitorConstructorWithDefaults=e.createBaseSemanticVisitorConstructor=e.defaultVisit=void 0;var r=t(Hr),n=t(Ps),a=t(ct),i=t(ir),s=t(Xt),f=t(Mu),h=t(yr),c=t(Vi),o=t(Xa),l=t(dn),u=xs;function d(R,C){for(var O=(0,h.default)(R),T=O.length,A=0;A<T;A++)for(var L=O[A],G=R[L],H=G.length,Y=0;Y<H;Y++){var K=G[Y];K.tokenTypeIdx===void 0&&this[K.name](K.children,C)}}e.defaultVisit=d;function g(R,C){var O=function(){};(0,u.defineNameProp)(O,R+"BaseSemantics");var T={visit:function(A,L){if((0,a.default)(A)&&(A=A[0]),!(0,o.default)(A))return this[A.name](A.children,L)},validateVisitor:function(){var A=m(this,C);if(!(0,r.default)(A)){var L=(0,i.default)(A,function(G){return G.msg});throw Error("Errors Detected in CST Visitor <".concat(this.constructor.name,`>:
	`)+"".concat(L.join(`

`).replace(/\n/g,`
	`)))}}};return O.prototype=T,O.prototype.constructor=O,O._RULE_NAMES=C,O}e.createBaseSemanticVisitorConstructor=g;function v(R,C,O){var T=function(){};(0,u.defineNameProp)(T,R+"BaseSemanticsWithDefaults");var A=Object.create(O.prototype);return(0,s.default)(C,function(L){A[L]=d}),T.prototype=A,T.prototype.constructor=T,T}e.createBaseVisitorConstructorWithDefaults=v;var y;(function(R){R[R.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",R[R.MISSING_METHOD=1]="MISSING_METHOD"})(y=e.CstVisitorDefinitionError||(e.CstVisitorDefinitionError={}));function m(R,C){var O=b(R,C),T=N(R,C);return O.concat(T)}e.validateVisitor=m;function b(R,C){var O=(0,f.default)(C,function(A){return(0,c.default)(R[A])===!1}),T=(0,i.default)(O,function(A){return{msg:"Missing visitor method: <".concat(A,"> on ").concat(R.constructor.name," CST Visitor."),type:y.MISSING_METHOD,methodName:A}});return(0,n.default)(T)}e.validateMissingCstMethods=b;var E=["constructor","visit","validateVisitor"];function N(R,C){var O=[];for(var T in R)(0,c.default)(R[T])&&!(0,l.default)(E,T)&&!(0,l.default)(C,T)&&O.push({msg:"Redundant visitor method: <".concat(T,"> on ").concat(R.constructor.name,` CST Visitor
`)+`There is no Grammar Rule corresponding to this method's name.
`,type:y.REDUNDANT_METHOD,methodName:T});return O}e.validateRedundantMethods=N})(i0);var ks=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ds,"__esModule",{value:!0});Ds.TreeBuilder=void 0;var fa=kr,jt=ks(Au),eB=ks(Er),Nh=ks(yr),Ah=ks(Xa),Ch=i0,tB=dr,rB=function(){function e(){}return e.prototype.initTreeBuilder=function(t){if(this.CST_STACK=[],this.outputCst=t.outputCst,this.nodeLocationTracking=(0,eB.default)(t,"nodeLocationTracking")?t.nodeLocationTracking:tB.DEFAULT_PARSER_CONFIG.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=jt.default,this.cstFinallyStateUpdate=jt.default,this.cstPostTerminal=jt.default,this.cstPostNonTerminal=jt.default,this.cstPostRule=jt.default;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=fa.setNodeLocationFull,this.setNodeLocationFromNode=fa.setNodeLocationFull,this.cstPostRule=jt.default,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=jt.default,this.setNodeLocationFromNode=jt.default,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=fa.setNodeLocationOnlyOffset,this.setNodeLocationFromNode=fa.setNodeLocationOnlyOffset,this.cstPostRule=jt.default,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=jt.default,this.setNodeLocationFromNode=jt.default,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=jt.default,this.setNodeLocationFromNode=jt.default,this.cstPostRule=jt.default,this.setInitialNodeLocation=jt.default;else throw Error('Invalid <nodeLocationTracking> config option: "'.concat(t.nodeLocationTracking,'"'))},e.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(t){t.location={startOffset:NaN,endOffset:NaN}},e.prototype.setInitialNodeLocationOnlyOffsetRegular=function(t){t.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},e.prototype.setInitialNodeLocationFullRecovery=function(t){t.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.setInitialNodeLocationFullRegular=function(t){var r=this.LA(1);t.location={startOffset:r.startOffset,startLine:r.startLine,startColumn:r.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.cstInvocationStateUpdate=function(t){var r={name:t,children:Object.create(null)};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},e.prototype.cstFinallyStateUpdate=function(){this.CST_STACK.pop()},e.prototype.cstPostRuleFull=function(t){var r=this.LA(0),n=t.location;n.startOffset<=r.startOffset?(n.endOffset=r.endOffset,n.endLine=r.endLine,n.endColumn=r.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)},e.prototype.cstPostRuleOnlyOffset=function(t){var r=this.LA(0),n=t.location;n.startOffset<=r.startOffset?n.endOffset=r.endOffset:n.startOffset=NaN},e.prototype.cstPostTerminal=function(t,r){var n=this.CST_STACK[this.CST_STACK.length-1];(0,fa.addTerminalToCst)(n,r,t),this.setNodeLocationFromToken(n.location,r)},e.prototype.cstPostNonTerminal=function(t,r){var n=this.CST_STACK[this.CST_STACK.length-1];(0,fa.addNoneTerminalToCst)(n,r,t),this.setNodeLocationFromNode(n.location,t.location)},e.prototype.getBaseCstVisitorConstructor=function(){if((0,Ah.default)(this.baseCstVisitorConstructor)){var t=(0,Ch.createBaseSemanticVisitorConstructor)(this.className,(0,Nh.default)(this.gastProductionsCache));return this.baseCstVisitorConstructor=t,t}return this.baseCstVisitorConstructor},e.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if((0,Ah.default)(this.baseCstVisitorWithDefaultsConstructor)){var t=(0,Ch.createBaseVisitorConstructorWithDefaults)(this.className,(0,Nh.default)(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=t,t}return this.baseCstVisitorWithDefaultsConstructor},e.prototype.getLastExplicitRuleShortName=function(){var t=this.RULE_STACK;return t[t.length-1]},e.prototype.getPreviousExplicitRuleShortName=function(){var t=this.RULE_STACK;return t[t.length-2]},e.prototype.getLastExplicitRuleOccurrenceIndex=function(){var t=this.RULE_OCCURRENCE_STACK;return t[t.length-1]},e}();Ds.TreeBuilder=rB;var Us={};Object.defineProperty(Us,"__esModule",{value:!0});Us.LexerAdapter=void 0;var Th=dr,nB=function(){function e(){}return e.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(e.prototype,"input",{get:function(){return this.tokVector},set:function(t){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=t,this.tokVectorLength=t.length},enumerable:!1,configurable:!0}),e.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):Th.END_OF_FILE},e.prototype.LA=function(t){var r=this.currIdx+t;return r<0||this.tokVectorLength<=r?Th.END_OF_FILE:this.tokVector[r]},e.prototype.consumeToken=function(){this.currIdx++},e.prototype.exportLexerState=function(){return this.currIdx},e.prototype.importLexerState=function(t){this.currIdx=t},e.prototype.resetLexerState=function(){this.currIdx=-1},e.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},e.prototype.getLexerPosition=function(){return this.exportLexerState()},e}();Us.LexerAdapter=nB;var Fs={},o0=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Fs,"__esModule",{value:!0});Fs.RecognizerApi=void 0;var aB=o0(un),iB=o0(dn),oB=qt,Al=dr,sB=eo,lB=st,cB=Pt,uB=function(){function e(){}return e.prototype.ACTION=function(t){return t.call(this)},e.prototype.consume=function(t,r,n){return this.consumeInternal(r,t,n)},e.prototype.subrule=function(t,r,n){return this.subruleInternal(r,t,n)},e.prototype.option=function(t,r){return this.optionInternal(r,t)},e.prototype.or=function(t,r){return this.orInternal(r,t)},e.prototype.many=function(t,r){return this.manyInternal(t,r)},e.prototype.atLeastOne=function(t,r){return this.atLeastOneInternal(t,r)},e.prototype.CONSUME=function(t,r){return this.consumeInternal(t,0,r)},e.prototype.CONSUME1=function(t,r){return this.consumeInternal(t,1,r)},e.prototype.CONSUME2=function(t,r){return this.consumeInternal(t,2,r)},e.prototype.CONSUME3=function(t,r){return this.consumeInternal(t,3,r)},e.prototype.CONSUME4=function(t,r){return this.consumeInternal(t,4,r)},e.prototype.CONSUME5=function(t,r){return this.consumeInternal(t,5,r)},e.prototype.CONSUME6=function(t,r){return this.consumeInternal(t,6,r)},e.prototype.CONSUME7=function(t,r){return this.consumeInternal(t,7,r)},e.prototype.CONSUME8=function(t,r){return this.consumeInternal(t,8,r)},e.prototype.CONSUME9=function(t,r){return this.consumeInternal(t,9,r)},e.prototype.SUBRULE=function(t,r){return this.subruleInternal(t,0,r)},e.prototype.SUBRULE1=function(t,r){return this.subruleInternal(t,1,r)},e.prototype.SUBRULE2=function(t,r){return this.subruleInternal(t,2,r)},e.prototype.SUBRULE3=function(t,r){return this.subruleInternal(t,3,r)},e.prototype.SUBRULE4=function(t,r){return this.subruleInternal(t,4,r)},e.prototype.SUBRULE5=function(t,r){return this.subruleInternal(t,5,r)},e.prototype.SUBRULE6=function(t,r){return this.subruleInternal(t,6,r)},e.prototype.SUBRULE7=function(t,r){return this.subruleInternal(t,7,r)},e.prototype.SUBRULE8=function(t,r){return this.subruleInternal(t,8,r)},e.prototype.SUBRULE9=function(t,r){return this.subruleInternal(t,9,r)},e.prototype.OPTION=function(t){return this.optionInternal(t,0)},e.prototype.OPTION1=function(t){return this.optionInternal(t,1)},e.prototype.OPTION2=function(t){return this.optionInternal(t,2)},e.prototype.OPTION3=function(t){return this.optionInternal(t,3)},e.prototype.OPTION4=function(t){return this.optionInternal(t,4)},e.prototype.OPTION5=function(t){return this.optionInternal(t,5)},e.prototype.OPTION6=function(t){return this.optionInternal(t,6)},e.prototype.OPTION7=function(t){return this.optionInternal(t,7)},e.prototype.OPTION8=function(t){return this.optionInternal(t,8)},e.prototype.OPTION9=function(t){return this.optionInternal(t,9)},e.prototype.OR=function(t){return this.orInternal(t,0)},e.prototype.OR1=function(t){return this.orInternal(t,1)},e.prototype.OR2=function(t){return this.orInternal(t,2)},e.prototype.OR3=function(t){return this.orInternal(t,3)},e.prototype.OR4=function(t){return this.orInternal(t,4)},e.prototype.OR5=function(t){return this.orInternal(t,5)},e.prototype.OR6=function(t){return this.orInternal(t,6)},e.prototype.OR7=function(t){return this.orInternal(t,7)},e.prototype.OR8=function(t){return this.orInternal(t,8)},e.prototype.OR9=function(t){return this.orInternal(t,9)},e.prototype.MANY=function(t){this.manyInternal(0,t)},e.prototype.MANY1=function(t){this.manyInternal(1,t)},e.prototype.MANY2=function(t){this.manyInternal(2,t)},e.prototype.MANY3=function(t){this.manyInternal(3,t)},e.prototype.MANY4=function(t){this.manyInternal(4,t)},e.prototype.MANY5=function(t){this.manyInternal(5,t)},e.prototype.MANY6=function(t){this.manyInternal(6,t)},e.prototype.MANY7=function(t){this.manyInternal(7,t)},e.prototype.MANY8=function(t){this.manyInternal(8,t)},e.prototype.MANY9=function(t){this.manyInternal(9,t)},e.prototype.MANY_SEP=function(t){this.manySepFirstInternal(0,t)},e.prototype.MANY_SEP1=function(t){this.manySepFirstInternal(1,t)},e.prototype.MANY_SEP2=function(t){this.manySepFirstInternal(2,t)},e.prototype.MANY_SEP3=function(t){this.manySepFirstInternal(3,t)},e.prototype.MANY_SEP4=function(t){this.manySepFirstInternal(4,t)},e.prototype.MANY_SEP5=function(t){this.manySepFirstInternal(5,t)},e.prototype.MANY_SEP6=function(t){this.manySepFirstInternal(6,t)},e.prototype.MANY_SEP7=function(t){this.manySepFirstInternal(7,t)},e.prototype.MANY_SEP8=function(t){this.manySepFirstInternal(8,t)},e.prototype.MANY_SEP9=function(t){this.manySepFirstInternal(9,t)},e.prototype.AT_LEAST_ONE=function(t){this.atLeastOneInternal(0,t)},e.prototype.AT_LEAST_ONE1=function(t){return this.atLeastOneInternal(1,t)},e.prototype.AT_LEAST_ONE2=function(t){this.atLeastOneInternal(2,t)},e.prototype.AT_LEAST_ONE3=function(t){this.atLeastOneInternal(3,t)},e.prototype.AT_LEAST_ONE4=function(t){this.atLeastOneInternal(4,t)},e.prototype.AT_LEAST_ONE5=function(t){this.atLeastOneInternal(5,t)},e.prototype.AT_LEAST_ONE6=function(t){this.atLeastOneInternal(6,t)},e.prototype.AT_LEAST_ONE7=function(t){this.atLeastOneInternal(7,t)},e.prototype.AT_LEAST_ONE8=function(t){this.atLeastOneInternal(8,t)},e.prototype.AT_LEAST_ONE9=function(t){this.atLeastOneInternal(9,t)},e.prototype.AT_LEAST_ONE_SEP=function(t){this.atLeastOneSepFirstInternal(0,t)},e.prototype.AT_LEAST_ONE_SEP1=function(t){this.atLeastOneSepFirstInternal(1,t)},e.prototype.AT_LEAST_ONE_SEP2=function(t){this.atLeastOneSepFirstInternal(2,t)},e.prototype.AT_LEAST_ONE_SEP3=function(t){this.atLeastOneSepFirstInternal(3,t)},e.prototype.AT_LEAST_ONE_SEP4=function(t){this.atLeastOneSepFirstInternal(4,t)},e.prototype.AT_LEAST_ONE_SEP5=function(t){this.atLeastOneSepFirstInternal(5,t)},e.prototype.AT_LEAST_ONE_SEP6=function(t){this.atLeastOneSepFirstInternal(6,t)},e.prototype.AT_LEAST_ONE_SEP7=function(t){this.atLeastOneSepFirstInternal(7,t)},e.prototype.AT_LEAST_ONE_SEP8=function(t){this.atLeastOneSepFirstInternal(8,t)},e.prototype.AT_LEAST_ONE_SEP9=function(t){this.atLeastOneSepFirstInternal(9,t)},e.prototype.RULE=function(t,r,n){if(n===void 0&&(n=Al.DEFAULT_RULE_CONFIG),(0,iB.default)(this.definedRulesNames,t)){var a=sB.defaultGrammarValidatorErrorProvider.buildDuplicateRuleNameError({topLevelRule:t,grammarName:this.className}),i={message:a,type:Al.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:t};this.definitionErrors.push(i)}this.definedRulesNames.push(t);var s=this.defineRule(t,r,n);return this[t]=s,s},e.prototype.OVERRIDE_RULE=function(t,r,n){n===void 0&&(n=Al.DEFAULT_RULE_CONFIG);var a=(0,lB.validateRuleIsOverridden)(t,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(a);var i=this.defineRule(t,r,n);return this[t]=i,i},e.prototype.BACKTRACK=function(t,r){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{return t.apply(this,r),!0}catch(a){if((0,oB.isRecognitionException)(a))return!1;throw a}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},e.prototype.getGAstProductions=function(){return this.gastProductionsCache},e.prototype.getSerializedGastProductions=function(){return(0,cB.serializeGrammar)((0,aB.default)(this.gastProductionsCache))},e}();Fs.RecognizerApi=uB;var Bs={},Xr=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Bs,"__esModule",{value:!0});Bs.RecognizerEngine=void 0;var Rh=Xr(Hr),Cl=Xr(ct),Tl=Xr(hn),Oh=Xr(ws),fB=Xr(Cu),dB=Xr(Br),ai=Xr(Er),ii=Xr(un),wh=Xr(na),Ih=Xr(Pn),sr=$s,_o=qt,Mh=to,da=At,Ph=dr,hB=Bu,Sh=ra,oi=aa,pB=function(){function e(){}return e.prototype.initRecognizerEngine=function(t,r){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=oi.tokenStructuredMatcherNoCategories,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},(0,ai.default)(r,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if((0,Cl.default)(t)){if((0,Rh.default)(t))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof t[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if((0,Cl.default)(t))this.tokensMap=(0,wh.default)(t,function(f,h){return f[h.name]=h,f},{});else if((0,ai.default)(t,"modes")&&(0,Oh.default)((0,Tl.default)((0,ii.default)(t.modes)),oi.isTokenType)){var n=(0,Tl.default)((0,ii.default)(t.modes)),a=(0,fB.default)(n);this.tokensMap=(0,wh.default)(a,function(f,h){return f[h.name]=h,f},{})}else if((0,dB.default)(t))this.tokensMap=(0,Ih.default)(t);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=Sh.EOF;var i=(0,ai.default)(t,"modes")?(0,Tl.default)((0,ii.default)(t.modes)):(0,ii.default)(t),s=(0,Oh.default)(i,function(f){return(0,Rh.default)(f.categoryMatches)});this.tokenMatcher=s?oi.tokenStructuredMatcherNoCategories:oi.tokenStructuredMatcher,(0,oi.augmentTokenTypes)((0,ii.default)(this.tokensMap))},e.prototype.defineRule=function(t,r,n){if(this.selfAnalysisDone)throw Error("Grammar rule <".concat(t,`> may not be defined after the 'performSelfAnalysis' method has been called'
`)+"Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var a=(0,ai.default)(n,"resyncEnabled")?n.resyncEnabled:Ph.DEFAULT_RULE_CONFIG.resyncEnabled,i=(0,ai.default)(n,"recoveryValueFunc")?n.recoveryValueFunc:Ph.DEFAULT_RULE_CONFIG.recoveryValueFunc,s=this.ruleShortNameIdx<<sr.BITS_FOR_METHOD_TYPE+sr.BITS_FOR_OCCURRENCE_IDX;this.ruleShortNameIdx++,this.shortRuleNameToFull[s]=t,this.fullRuleNameToShort[t]=s;var f;this.outputCst===!0?f=function(){for(var o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];try{this.ruleInvocationStateUpdate(s,t,this.subruleIdx),r.apply(this,o);var u=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(u),u}catch(d){return this.invokeRuleCatch(d,a,i)}finally{this.ruleFinallyStateUpdate()}}:f=function(){for(var o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];try{return this.ruleInvocationStateUpdate(s,t,this.subruleIdx),r.apply(this,o)}catch(u){return this.invokeRuleCatch(u,a,i)}finally{this.ruleFinallyStateUpdate()}};var h=Object.assign(f,{ruleName:t,originalGrammarAction:r});return h},e.prototype.invokeRuleCatch=function(t,r,n){var a=this.RULE_STACK.length===1,i=r&&!this.isBackTracking()&&this.recoveryEnabled;if((0,_o.isRecognitionException)(t)){var s=t;if(i){var f=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(f))if(s.resyncedTokens=this.reSyncTo(f),this.outputCst){var h=this.CST_STACK[this.CST_STACK.length-1];return h.recoveredNode=!0,h}else return n();else{if(this.outputCst){var h=this.CST_STACK[this.CST_STACK.length-1];h.recoveredNode=!0,s.partialCstResult=h}throw s}}else{if(a)return this.moveToTerminatedState(),n();throw s}}else throw t},e.prototype.optionInternal=function(t,r){var n=this.getKeyForAutomaticLookahead(sr.OPTION_IDX,r);return this.optionInternalLogic(t,r,n)},e.prototype.optionInternalLogic=function(t,r,n){var a=this,i=this.getLaFuncFromCache(n),s;if(typeof t!="function"){s=t.DEF;var f=t.GATE;if(f!==void 0){var h=i;i=function(){return f.call(a)&&h.call(a)}}}else s=t;if(i.call(this)===!0)return s.call(this)},e.prototype.atLeastOneInternal=function(t,r){var n=this.getKeyForAutomaticLookahead(sr.AT_LEAST_ONE_IDX,t);return this.atLeastOneInternalLogic(t,r,n)},e.prototype.atLeastOneInternalLogic=function(t,r,n){var a=this,i=this.getLaFuncFromCache(n),s;if(typeof r!="function"){s=r.DEF;var f=r.GATE;if(f!==void 0){var h=i;i=function(){return f.call(a)&&h.call(a)}}}else s=r;if(i.call(this)===!0)for(var c=this.doSingleRepetition(s);i.call(this)===!0&&c===!0;)c=this.doSingleRepetition(s);else throw this.raiseEarlyExitException(t,Mh.PROD_TYPE.REPETITION_MANDATORY,r.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[t,r],i,sr.AT_LEAST_ONE_IDX,t,da.NextTerminalAfterAtLeastOneWalker)},e.prototype.atLeastOneSepFirstInternal=function(t,r){var n=this.getKeyForAutomaticLookahead(sr.AT_LEAST_ONE_SEP_IDX,t);this.atLeastOneSepFirstInternalLogic(t,r,n)},e.prototype.atLeastOneSepFirstInternalLogic=function(t,r,n){var a=this,i=r.DEF,s=r.SEP,f=this.getLaFuncFromCache(n);if(f.call(this)===!0){i.call(this);for(var h=function(){return a.tokenMatcher(a.LA(1),s)};this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,s,h,i,da.NextTerminalAfterAtLeastOneSepWalker],h,sr.AT_LEAST_ONE_SEP_IDX,t,da.NextTerminalAfterAtLeastOneSepWalker)}else throw this.raiseEarlyExitException(t,Mh.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,r.ERR_MSG)},e.prototype.manyInternal=function(t,r){var n=this.getKeyForAutomaticLookahead(sr.MANY_IDX,t);return this.manyInternalLogic(t,r,n)},e.prototype.manyInternalLogic=function(t,r,n){var a=this,i=this.getLaFuncFromCache(n),s;if(typeof r!="function"){s=r.DEF;var f=r.GATE;if(f!==void 0){var h=i;i=function(){return f.call(a)&&h.call(a)}}}else s=r;for(var c=!0;i.call(this)===!0&&c===!0;)c=this.doSingleRepetition(s);this.attemptInRepetitionRecovery(this.manyInternal,[t,r],i,sr.MANY_IDX,t,da.NextTerminalAfterManyWalker,c)},e.prototype.manySepFirstInternal=function(t,r){var n=this.getKeyForAutomaticLookahead(sr.MANY_SEP_IDX,t);this.manySepFirstInternalLogic(t,r,n)},e.prototype.manySepFirstInternalLogic=function(t,r,n){var a=this,i=r.DEF,s=r.SEP,f=this.getLaFuncFromCache(n);if(f.call(this)===!0){i.call(this);for(var h=function(){return a.tokenMatcher(a.LA(1),s)};this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,s,h,i,da.NextTerminalAfterManySepWalker],h,sr.MANY_SEP_IDX,t,da.NextTerminalAfterManySepWalker)}},e.prototype.repetitionSepSecondInternal=function(t,r,n,a,i){for(;n();)this.CONSUME(r),a.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,r,n,a,i],n,sr.AT_LEAST_ONE_SEP_IDX,t,i)},e.prototype.doSingleRepetition=function(t){var r=this.getLexerPosition();t.call(this);var n=this.getLexerPosition();return n>r},e.prototype.orInternal=function(t,r){var n=this.getKeyForAutomaticLookahead(sr.OR_IDX,r),a=(0,Cl.default)(t)?t:t.DEF,i=this.getLaFuncFromCache(n),s=i.call(this,a);if(s!==void 0){var f=a[s];return f.ALT.call(this)}this.raiseNoAltException(r,t.ERR_MSG)},e.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var t=this.LA(1),r=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:t,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new _o.NotAllInputParsedException(r,t))}},e.prototype.subruleInternal=function(t,r,n){var a;try{var i=n!==void 0?n.ARGS:void 0;return this.subruleIdx=r,a=t.apply(this,i),this.cstPostNonTerminal(a,n!==void 0&&n.LABEL!==void 0?n.LABEL:t.ruleName),a}catch(s){throw this.subruleInternalError(s,n,t.ruleName)}},e.prototype.subruleInternalError=function(t,r,n){throw(0,_o.isRecognitionException)(t)&&t.partialCstResult!==void 0&&(this.cstPostNonTerminal(t.partialCstResult,r!==void 0&&r.LABEL!==void 0?r.LABEL:n),delete t.partialCstResult),t},e.prototype.consumeInternal=function(t,r,n){var a;try{var i=this.LA(1);this.tokenMatcher(i,t)===!0?(this.consumeToken(),a=i):this.consumeInternalError(t,i,n)}catch(s){a=this.consumeInternalRecovery(t,r,s)}return this.cstPostTerminal(n!==void 0&&n.LABEL!==void 0?n.LABEL:t.name,a),a},e.prototype.consumeInternalError=function(t,r,n){var a,i=this.LA(0);throw n!==void 0&&n.ERR_MSG?a=n.ERR_MSG:a=this.errorMessageProvider.buildMismatchTokenMessage({expected:t,actual:r,previous:i,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new _o.MismatchedTokenException(a,r,i))},e.prototype.consumeInternalRecovery=function(t,r,n){if(this.recoveryEnabled&&n.name==="MismatchedTokenException"&&!this.isBackTracking()){var a=this.getFollowsForInRuleRecovery(t,r);try{return this.tryInRuleRecovery(t,a)}catch(i){throw i.name===hB.IN_RULE_RECOVERY_EXCEPTION?n:i}}else throw n},e.prototype.saveRecogState=function(){var t=this.errors,r=(0,Ih.default)(this.RULE_STACK);return{errors:t,lexerState:this.exportLexerState(),RULE_STACK:r,CST_STACK:this.CST_STACK}},e.prototype.reloadRecogState=function(t){this.errors=t.errors,this.importLexerState(t.lexerState),this.RULE_STACK=t.RULE_STACK},e.prototype.ruleInvocationStateUpdate=function(t,r,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(t),this.cstInvocationStateUpdate(r)},e.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},e.prototype.getCurrRuleFullName=function(){var t=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[t]},e.prototype.shortRuleNameToFullName=function(t){return this.shortRuleNameToFull[t]},e.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),Sh.EOF)},e.prototype.reset=function(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},e}();Bs.RecognizerEngine=pB;var Vs={},s0=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Vs,"__esModule",{value:!0});Vs.ErrorHandler=void 0;var Rl=qt,vB=s0(Er),Lh=s0(Pn),$h=to,gB=dr,mB=function(){function e(){}return e.prototype.initErrorHandler=function(t){this._errors=[],this.errorMessageProvider=(0,vB.default)(t,"errorMessageProvider")?t.errorMessageProvider:gB.DEFAULT_PARSER_CONFIG.errorMessageProvider},e.prototype.SAVE_ERROR=function(t){if((0,Rl.isRecognitionException)(t))return t.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:(0,Lh.default)(this.RULE_OCCURRENCE_STACK)},this._errors.push(t),t;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(e.prototype,"errors",{get:function(){return(0,Lh.default)(this._errors)},set:function(t){this._errors=t},enumerable:!1,configurable:!0}),e.prototype.raiseEarlyExitException=function(t,r,n){for(var a=this.getCurrRuleFullName(),i=this.getGAstProductions()[a],s=(0,$h.getLookaheadPathsForOptionalProd)(t,i,r,this.maxLookahead),f=s[0],h=[],c=1;c<=this.maxLookahead;c++)h.push(this.LA(c));var o=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:f,actual:h,previous:this.LA(0),customUserDescription:n,ruleName:a});throw this.SAVE_ERROR(new Rl.EarlyExitException(o,this.LA(1),this.LA(0)))},e.prototype.raiseNoAltException=function(t,r){for(var n=this.getCurrRuleFullName(),a=this.getGAstProductions()[n],i=(0,$h.getLookaheadPathsForOr)(t,a,this.maxLookahead),s=[],f=1;f<=this.maxLookahead;f++)s.push(this.LA(f));var h=this.LA(0),c=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:i,actual:s,previous:h,customUserDescription:r,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new Rl.NoViableAltException(c,this.LA(1),h))},e}();Vs.ErrorHandler=mB;var Gs={},l0=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.ContentAssist=void 0;var Dh=At,yB=l0(Zi),EB=l0(Xa),_B=function(){function e(){}return e.prototype.initContentAssist=function(){},e.prototype.computeContentAssist=function(t,r){var n=this.gastProductionsCache[t];if((0,EB.default)(n))throw Error("Rule ->".concat(t,"<- does not exist in this grammar."));return(0,Dh.nextPossibleTokensAfter)([n],r,this.tokenMatcher,this.maxLookahead)},e.prototype.getNextPossibleTokenTypes=function(t){var r=(0,yB.default)(t.ruleStack),n=this.getGAstProductions(),a=n[r],i=new Dh.NextAfterTokenWalker(a,t).startWalking();return i},e}();Gs.ContentAssist=_B;var Hs={},ja=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Hs,"__esModule",{value:!0});Hs.GastRecorder=void 0;var Ko=ja(Pu),bB=ja(ct),NB=ja(Eu),AB=ja(Xt),c0=ja(Vi),Ni=ja(Er),Sr=Pt,CB=Qi,u0=aa,f0=ra,TB=dr,RB=$s,Ws={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Ws);var xh=!0,kh=Math.pow(2,RB.BITS_FOR_OCCURRENCE_IDX)-1,d0=(0,f0.createToken)({name:"RECORDING_PHASE_TOKEN",pattern:CB.Lexer.NA});(0,u0.augmentTokenTypes)([d0]);var h0=(0,f0.createTokenInstance)(d0,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(h0);var OB={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}},wB=function(){function e(){}return e.prototype.initGastRecorder=function(t){this.recordingProdStack=[],this.RECORDING_PHASE=!1},e.prototype.enableRecording=function(){var t=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var r=function(a){var i=a>0?a:"";t["CONSUME".concat(i)]=function(s,f){return this.consumeInternalRecord(s,a,f)},t["SUBRULE".concat(i)]=function(s,f){return this.subruleInternalRecord(s,a,f)},t["OPTION".concat(i)]=function(s){return this.optionInternalRecord(s,a)},t["OR".concat(i)]=function(s){return this.orInternalRecord(s,a)},t["MANY".concat(i)]=function(s){this.manyInternalRecord(a,s)},t["MANY_SEP".concat(i)]=function(s){this.manySepFirstInternalRecord(a,s)},t["AT_LEAST_ONE".concat(i)]=function(s){this.atLeastOneInternalRecord(a,s)},t["AT_LEAST_ONE_SEP".concat(i)]=function(s){this.atLeastOneSepFirstInternalRecord(a,s)}},n=0;n<10;n++)r(n);t.consume=function(a,i,s){return this.consumeInternalRecord(i,a,s)},t.subrule=function(a,i,s){return this.subruleInternalRecord(i,a,s)},t.option=function(a,i){return this.optionInternalRecord(i,a)},t.or=function(a,i){return this.orInternalRecord(i,a)},t.many=function(a,i){this.manyInternalRecord(a,i)},t.atLeastOne=function(a,i){this.atLeastOneInternalRecord(a,i)},t.ACTION=t.ACTION_RECORD,t.BACKTRACK=t.BACKTRACK_RECORD,t.LA=t.LA_RECORD})},e.prototype.disableRecording=function(){var t=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var r=t,n=0;n<10;n++){var a=n>0?n:"";delete r["CONSUME".concat(a)],delete r["SUBRULE".concat(a)],delete r["OPTION".concat(a)],delete r["OR".concat(a)],delete r["MANY".concat(a)],delete r["MANY_SEP".concat(a)],delete r["AT_LEAST_ONE".concat(a)],delete r["AT_LEAST_ONE_SEP".concat(a)]}delete r.consume,delete r.subrule,delete r.option,delete r.or,delete r.many,delete r.atLeastOne,delete r.ACTION,delete r.BACKTRACK,delete r.LA})},e.prototype.ACTION_RECORD=function(t){},e.prototype.BACKTRACK_RECORD=function(t,r){return function(){return!0}},e.prototype.LA_RECORD=function(t){return TB.END_OF_FILE},e.prototype.topLevelRuleRecord=function(t,r){try{var n=new Sr.Rule({definition:[],name:t});return n.name=t,this.recordingProdStack.push(n),r.call(this),this.recordingProdStack.pop(),n}catch(a){if(a.KNOWN_RECORDER_ERROR!==!0)try{a.message=a.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw a}throw a}},e.prototype.optionInternalRecord=function(t,r){return si.call(this,Sr.Option,t,r)},e.prototype.atLeastOneInternalRecord=function(t,r){si.call(this,Sr.RepetitionMandatory,r,t)},e.prototype.atLeastOneSepFirstInternalRecord=function(t,r){si.call(this,Sr.RepetitionMandatoryWithSeparator,r,t,xh)},e.prototype.manyInternalRecord=function(t,r){si.call(this,Sr.Repetition,r,t)},e.prototype.manySepFirstInternalRecord=function(t,r){si.call(this,Sr.RepetitionWithSeparator,r,t,xh)},e.prototype.orInternalRecord=function(t,r){return IB.call(this,t,r)},e.prototype.subruleInternalRecord=function(t,r,n){if(qo(r),!t||(0,Ni.default)(t,"ruleName")===!1){var a=new Error("<SUBRULE".concat(Uh(r),"> argument is invalid")+" expecting a Parser method reference but got: <".concat(JSON.stringify(t),">")+`
 inside top level rule: <`.concat(this.recordingProdStack[0].name,">"));throw a.KNOWN_RECORDER_ERROR=!0,a}var i=(0,Ko.default)(this.recordingProdStack),s=t.ruleName,f=new Sr.NonTerminal({idx:r,nonTerminalName:s,label:n==null?void 0:n.LABEL,referencedRule:void 0});return i.definition.push(f),this.outputCst?OB:Ws},e.prototype.consumeInternalRecord=function(t,r,n){if(qo(r),!(0,u0.hasShortKeyProperty)(t)){var a=new Error("<CONSUME".concat(Uh(r),"> argument is invalid")+" expecting a TokenType reference but got: <".concat(JSON.stringify(t),">")+`
 inside top level rule: <`.concat(this.recordingProdStack[0].name,">"));throw a.KNOWN_RECORDER_ERROR=!0,a}var i=(0,Ko.default)(this.recordingProdStack),s=new Sr.Terminal({idx:r,terminalType:t,label:n==null?void 0:n.LABEL});return i.definition.push(s),h0},e}();Hs.GastRecorder=wB;function si(e,t,r,n){n===void 0&&(n=!1),qo(r);var a=(0,Ko.default)(this.recordingProdStack),i=(0,c0.default)(t)?t:t.DEF,s=new e({definition:[],idx:r});return n&&(s.separator=t.SEP),(0,Ni.default)(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(s),i.call(this),a.definition.push(s),this.recordingProdStack.pop(),Ws}function IB(e,t){var r=this;qo(t);var n=(0,Ko.default)(this.recordingProdStack),a=(0,bB.default)(e)===!1,i=a===!1?e:e.DEF,s=new Sr.Alternation({definition:[],idx:t,ignoreAmbiguities:a&&e.IGNORE_AMBIGUITIES===!0});(0,Ni.default)(e,"MAX_LOOKAHEAD")&&(s.maxLookahead=e.MAX_LOOKAHEAD);var f=(0,NB.default)(i,function(h){return(0,c0.default)(h.GATE)});return s.hasPredicates=f,n.definition.push(s),(0,AB.default)(i,function(h){var c=new Sr.Alternative({definition:[]});s.definition.push(c),(0,Ni.default)(h,"IGNORE_AMBIGUITIES")?c.ignoreAmbiguities=h.IGNORE_AMBIGUITIES:(0,Ni.default)(h,"GATE")&&(c.ignoreAmbiguities=!0),r.recordingProdStack.push(c),h.ALT.call(r),r.recordingProdStack.pop()}),Ws}function Uh(e){return e===0?"":"".concat(e)}function qo(e){if(e<0||e>kh){var t=new Error("Invalid DSL Method idx value: <".concat(e,`>
	`)+"Idx value must be a none negative value smaller than ".concat(kh+1));throw t.KNOWN_RECORDER_ERROR=!0,t}}var zs={},MB=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(zs,"__esModule",{value:!0});zs.PerformanceTracer=void 0;var PB=MB(Er),SB=Ka,LB=dr,$B=function(){function e(){}return e.prototype.initPerformanceTracer=function(t){if((0,PB.default)(t,"traceInitPerf")){var r=t.traceInitPerf,n=typeof r=="number";this.traceInitMaxIdent=n?r:1/0,this.traceInitPerf=n?r>0:r}else this.traceInitMaxIdent=0,this.traceInitPerf=LB.DEFAULT_PARSER_CONFIG.traceInitPerf;this.traceInitIndent=-1},e.prototype.TRACE_INIT=function(t,r){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log("".concat(n,"--> <").concat(t,">"));var a=(0,SB.timer)(r),i=a.time,s=a.value,f=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&f("".concat(n,"<-- <").concat(t,"> time: ").concat(i,"ms")),this.traceInitIndent--,s}else return r()},e}();zs.PerformanceTracer=$B;var Ks={};Object.defineProperty(Ks,"__esModule",{value:!0});Ks.applyMixins=void 0;function DB(e,t){t.forEach(function(r){var n=r.prototype;Object.getOwnPropertyNames(n).forEach(function(a){if(a!=="constructor"){var i=Object.getOwnPropertyDescriptor(n,a);i&&(i.get||i.set)?Object.defineProperty(e.prototype,a,i):e.prototype[a]=r.prototype[a]}})})}Ks.applyMixins=DB;(function(e){var t=Te&&Te.__extends||function(){var Y=function(K,ce){return Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(V,W){V.__proto__=W}||function(V,W){for(var Q in W)Object.prototype.hasOwnProperty.call(W,Q)&&(V[Q]=W[Q])},Y(K,ce)};return function(K,ce){if(typeof ce!="function"&&ce!==null)throw new TypeError("Class extends value "+String(ce)+" is not a constructor or null");Y(K,ce);function V(){this.constructor=K}K.prototype=ce===null?Object.create(ce):(V.prototype=ce.prototype,new V)}}(),r=Te&&Te.__importDefault||function(Y){return Y&&Y.__esModule?Y:{default:Y}};Object.defineProperty(e,"__esModule",{value:!0}),e.EmbeddedActionsParser=e.CstParser=e.Parser=e.EMPTY_ALT=e.ParserDefinitionErrorType=e.DEFAULT_RULE_CONFIG=e.DEFAULT_PARSER_CONFIG=e.END_OF_FILE=void 0;var n=r(Hr),a=r(ir),i=r(Xt),s=r(un),f=r(Er),h=r(Pn),c=Ka,o=Dr,l=ra,u=eo,d=$a,g=Bu,v=ka,y=Ds,m=Us,b=Fs,E=Bs,N=Vs,R=Gs,C=Hs,O=zs,T=Ks;e.END_OF_FILE=(0,l.createTokenInstance)(l.EOF,"",NaN,NaN,NaN,NaN,NaN,NaN),Object.freeze(e.END_OF_FILE),e.DEFAULT_PARSER_CONFIG=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:u.defaultParserErrorProvider,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),e.DEFAULT_RULE_CONFIG=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),function(Y){Y[Y.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",Y[Y.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",Y[Y.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",Y[Y.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",Y[Y.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",Y[Y.LEFT_RECURSION=5]="LEFT_RECURSION",Y[Y.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",Y[Y.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",Y[Y.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",Y[Y.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",Y[Y.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",Y[Y.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",Y[Y.TOO_MANY_ALTS=12]="TOO_MANY_ALTS"}(e.ParserDefinitionErrorType||(e.ParserDefinitionErrorType={}));function A(Y){return Y===void 0&&(Y=void 0),function(){return Y}}e.EMPTY_ALT=A;var L=function(){function Y(K,ce){this.definitionErrors=[],this.selfAnalysisDone=!1;var V=this;if(V.initErrorHandler(ce),V.initLexerAdapter(),V.initLooksAhead(ce),V.initRecognizerEngine(K,ce),V.initRecoverable(ce),V.initTreeBuilder(ce),V.initContentAssist(),V.initGastRecorder(ce),V.initPerformanceTracer(ce),(0,f.default)(ce,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=(0,f.default)(ce,"skipValidations")?ce.skipValidations:e.DEFAULT_PARSER_CONFIG.skipValidations}return Y.performSelfAnalysis=function(K){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")},Y.prototype.performSelfAnalysis=function(){var K=this;this.TRACE_INIT("performSelfAnalysis",function(){var ce;K.selfAnalysisDone=!0;var V=K.className;K.TRACE_INIT("toFastProps",function(){(0,c.toFastProperties)(K)}),K.TRACE_INIT("Grammar Recording",function(){try{K.enableRecording(),(0,i.default)(K.definedRulesNames,function(Q){var ie=K[Q],de=ie.originalGrammarAction,me;K.TRACE_INIT("".concat(Q," Rule"),function(){me=K.topLevelRuleRecord(Q,de)}),K.gastProductionsCache[Q]=me})}finally{K.disableRecording()}});var W=[];if(K.TRACE_INIT("Grammar Resolving",function(){W=(0,d.resolveGrammar)({rules:(0,s.default)(K.gastProductionsCache)}),K.definitionErrors=K.definitionErrors.concat(W)}),K.TRACE_INIT("Grammar Validations",function(){if((0,n.default)(W)&&K.skipValidations===!1){var Q=(0,d.validateGrammar)({rules:(0,s.default)(K.gastProductionsCache),maxLookahead:K.maxLookahead,tokenTypes:(0,s.default)(K.tokensMap),errMsgProvider:u.defaultGrammarValidatorErrorProvider,grammarName:V});K.definitionErrors=K.definitionErrors.concat(Q)}}),(0,n.default)(K.definitionErrors)&&(K.recoveryEnabled&&K.TRACE_INIT("computeAllProdsFollows",function(){var Q=(0,o.computeAllProdsFollows)((0,s.default)(K.gastProductionsCache));K.resyncFollows=Q}),K.TRACE_INIT("ComputeLookaheadFunctions",function(){K.preComputeLookaheadFunctions((0,s.default)(K.gastProductionsCache))})),!Y.DEFER_DEFINITION_ERRORS_HANDLING&&!(0,n.default)(K.definitionErrors))throw ce=(0,a.default)(K.definitionErrors,function(Q){return Q.message}),new Error(`Parser Definition Errors detected:
 `.concat(ce.join(`
-------------------------------
`)))})},Y.DEFER_DEFINITION_ERRORS_HANDLING=!1,Y}();e.Parser=L,(0,T.applyMixins)(L,[g.Recoverable,v.LooksAhead,y.TreeBuilder,m.LexerAdapter,E.RecognizerEngine,b.RecognizerApi,N.ErrorHandler,R.ContentAssist,C.GastRecorder,O.PerformanceTracer]);var G=function(Y){t(K,Y);function K(ce,V){V===void 0&&(V=e.DEFAULT_PARSER_CONFIG);var W=(0,h.default)(V);return W.outputCst=!0,Y.call(this,ce,W)||this}return K}(L);e.CstParser=G;var H=function(Y){t(K,Y);function K(ce,V){V===void 0&&(V=e.DEFAULT_PARSER_CONFIG);var W=(0,h.default)(V);return W.outputCst=!1,Y.call(this,ce,W)||this}return K}(L);e.EmbeddedActionsParser=H})(dr);var qs={},Ys={},xB=Te&&Te.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Qa=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ys,"__esModule",{value:!0});Ys.buildModel=void 0;var p0=Pt,di=Qa(ir),kB=Qa(hn),UB=Qa(un),FB=Qa(Eu),BB=Qa(Lm),VB=Qa(Rs);function GB(e){var t=new HB,r=(0,UB.default)(e);return(0,di.default)(r,function(n){return t.visitRule(n)})}Ys.buildModel=GB;var HB=function(e){xB(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.visitRule=function(r){var n=this.visitEach(r.definition),a=(0,BB.default)(n,function(s){return s.propertyName}),i=(0,di.default)(a,function(s,f){var h=!(0,FB.default)(s,function(o){return!o.canBeNull}),c=s[0].type;return s.length>1&&(c=(0,di.default)(s,function(o){return o.type})),{name:f,type:c,optional:h}});return{name:r.name,properties:i}},t.prototype.visitAlternative=function(r){return this.visitEachAndOverrideWith(r.definition,{canBeNull:!0})},t.prototype.visitOption=function(r){return this.visitEachAndOverrideWith(r.definition,{canBeNull:!0})},t.prototype.visitRepetition=function(r){return this.visitEachAndOverrideWith(r.definition,{canBeNull:!0})},t.prototype.visitRepetitionMandatory=function(r){return this.visitEach(r.definition)},t.prototype.visitRepetitionMandatoryWithSeparator=function(r){return this.visitEach(r.definition).concat({propertyName:r.separator.name,canBeNull:!0,type:bo(r.separator)})},t.prototype.visitRepetitionWithSeparator=function(r){return this.visitEachAndOverrideWith(r.definition,{canBeNull:!0}).concat({propertyName:r.separator.name,canBeNull:!0,type:bo(r.separator)})},t.prototype.visitAlternation=function(r){return this.visitEachAndOverrideWith(r.definition,{canBeNull:!0})},t.prototype.visitTerminal=function(r){return[{propertyName:r.label||r.terminalType.name,canBeNull:!1,type:bo(r)}]},t.prototype.visitNonTerminal=function(r){return[{propertyName:r.label||r.nonTerminalName,canBeNull:!1,type:bo(r)}]},t.prototype.visitEachAndOverrideWith=function(r,n){return(0,di.default)(this.visitEach(r),function(a){return(0,VB.default)({},a,n)})},t.prototype.visitEach=function(r){var n=this;return(0,kB.default)((0,di.default)(r,function(a){return n.visit(a)}))},t}(p0.GAstVisitor);function bo(e){return e instanceof p0.NonTerminal?{kind:"rule",name:e.referencedRule.name}:{kind:"token"}}var Xs={},WB=gu;function zB(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:WB(e,t,r)}var KB=zB,qB="\\ud800-\\udfff",YB="\\u0300-\\u036f",XB="\\ufe20-\\ufe2f",jB="\\u20d0-\\u20ff",QB=YB+XB+jB,ZB="\\ufe0e\\ufe0f",JB="\\u200d",e4=RegExp("["+JB+qB+QB+ZB+"]");function t4(e){return e4.test(e)}var v0=t4;function r4(e){return e.split("")}var n4=r4,g0="\\ud800-\\udfff",a4="\\u0300-\\u036f",i4="\\ufe20-\\ufe2f",o4="\\u20d0-\\u20ff",s4=a4+i4+o4,l4="\\ufe0e\\ufe0f",c4="["+g0+"]",bc="["+s4+"]",Nc="\\ud83c[\\udffb-\\udfff]",u4="(?:"+bc+"|"+Nc+")",m0="[^"+g0+"]",y0="(?:\\ud83c[\\udde6-\\uddff]){2}",E0="[\\ud800-\\udbff][\\udc00-\\udfff]",f4="\\u200d",_0=u4+"?",b0="["+l4+"]?",d4="(?:"+f4+"(?:"+[m0,y0,E0].join("|")+")"+b0+_0+")*",h4=b0+_0+d4,p4="(?:"+[m0+bc+"?",bc,y0,E0,c4].join("|")+")",v4=RegExp(Nc+"(?="+Nc+")|"+p4+h4,"g");function g4(e){return e.match(v4)||[]}var m4=g4,y4=n4,E4=v0,_4=m4;function b4(e){return E4(e)?_4(e):y4(e)}var N4=b4,A4=KB,C4=v0,T4=N4,R4=Kg;function O4(e){return function(t){t=R4(t);var r=C4(t)?T4(t):void 0,n=r?r[0]:t.charAt(0),a=r?A4(r,1).join(""):t.slice(1);return n[e]()+a}}var w4=O4,I4=w4,M4=I4("toUpperCase"),P4=M4,Za=Te&&Te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xs,"__esModule",{value:!0});Xs.genDts=void 0;var S4=Za(hn),L4=Za(ct),js=Za(ir),$4=Za(na),D4=Za(Cu),N0=Za(P4);function x4(e,t){var r=[];return r=r.concat('import type { CstNode, ICstVisitor, IToken } from "chevrotain";'),r=r.concat((0,S4.default)((0,js.default)(e,function(n){return k4(n)}))),t.includeVisitorInterface&&(r=r.concat(V4(t.visitorInterfaceName,e))),r.join(`

`)+`
`}Xs.genDts=x4;function k4(e){var t=U4(e),r=F4(e);return[t,r]}function U4(e){var t=A0(e.name),r=Vu(e.name);return"export interface ".concat(t,` extends CstNode {
  name: "`).concat(e.name,`";
  children: `).concat(r,`;
}`)}function F4(e){var t=Vu(e.name);return"export type ".concat(t,` = {
  `).concat((0,js.default)(e.properties,function(r){return B4(r)}).join(`
  `),`
};`)}function B4(e){var t=H4(e.type);return"".concat(e.name).concat(e.optional?"?":"",": ").concat(t,"[];")}function V4(e,t){return"export interface ".concat(e,`<IN, OUT> extends ICstVisitor<IN, OUT> {
  `).concat((0,js.default)(t,function(r){return G4(r)}).join(`
  `),`
}`)}function G4(e){var t=Vu(e.name);return"".concat(e.name,"(children: ").concat(t,", param?: IN): OUT;")}function H4(e){if((0,L4.default)(e)){var t=(0,D4.default)((0,js.default)(e,function(n){return Fh(n)})),r=(0,$4.default)(t,function(n,a){return n+" | "+a});return"("+r+")"}else return Fh(e)}function Fh(e){return e.kind==="token"?"IToken":A0(e.name)}function A0(e){return(0,N0.default)(e)+"CstNode"}function Vu(e){return(0,N0.default)(e)+"CstChildren"}var Yo=Te&&Te.__assign||function(){return Yo=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Yo.apply(this,arguments)};Object.defineProperty(qs,"__esModule",{value:!0});qs.generateCstDts=void 0;var W4=Ys,z4=Xs,K4={includeVisitorInterface:!0,visitorInterfaceName:"ICstNodeVisitor"};function q4(e,t){var r=Yo(Yo({},K4),t),n=(0,W4.buildModel)(e);return(0,z4.genDts)(n,r)}qs.generateCstDts=q4;var Qs={};Object.defineProperty(Qs,"__esModule",{value:!0});Qs.createSyntaxDiagramsCode=void 0;var Bh=Fi;function Y4(e,t){var r=t===void 0?{}:t,n=r.resourceBase,a=n===void 0?"https://unpkg.com/chevrotain@".concat(Bh.VERSION,"/diagrams/"):n,i=r.css,s=i===void 0?"https://unpkg.com/chevrotain@".concat(Bh.VERSION,"/diagrams/diagrams.css"):i,f=`
<!-- This is a generated file -->
<!DOCTYPE html>
<meta charset="utf-8">
<style>
  body {
    background-color: hsl(30, 20%, 95%)
  }
</style>

`,h=`
<link rel='stylesheet' href='`.concat(s,`'>
`),c=`
<script src='`.concat(a,`vendor/railroad-diagrams.js'><\/script>
<script src='`).concat(a,`src/diagrams_builder.js'><\/script>
<script src='`).concat(a,`src/diagrams_behavior.js'><\/script>
<script src='`).concat(a,`src/main.js'><\/script>
`),o=`
<div id="diagrams" align="center"></div>    
`,l=`
<script>
    window.serializedGrammar = `.concat(JSON.stringify(e,null,"  "),`;
<\/script>
`),u=`
<script>
    var diagramsDiv = document.getElementById("diagrams");
    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);
<\/script>
`;return f+h+c+o+l+u}Qs.createSyntaxDiagramsCode=Y4;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Parser=e.createSyntaxDiagramsCode=e.clearCache=e.generateCstDts=e.GAstVisitor=e.serializeProduction=e.serializeGrammar=e.Terminal=e.Rule=e.RepetitionWithSeparator=e.RepetitionMandatoryWithSeparator=e.RepetitionMandatory=e.Repetition=e.Option=e.NonTerminal=e.Alternative=e.Alternation=e.defaultLexerErrorProvider=e.NoViableAltException=e.NotAllInputParsedException=e.MismatchedTokenException=e.isRecognitionException=e.EarlyExitException=e.defaultParserErrorProvider=e.tokenName=e.tokenMatcher=e.tokenLabel=e.EOF=e.createTokenInstance=e.createToken=e.LexerDefinitionErrorType=e.Lexer=e.EMPTY_ALT=e.ParserDefinitionErrorType=e.EmbeddedActionsParser=e.CstParser=e.VERSION=void 0;var t=Fi;Object.defineProperty(e,"VERSION",{enumerable:!0,get:function(){return t.VERSION}});var r=dr;Object.defineProperty(e,"CstParser",{enumerable:!0,get:function(){return r.CstParser}}),Object.defineProperty(e,"EmbeddedActionsParser",{enumerable:!0,get:function(){return r.EmbeddedActionsParser}}),Object.defineProperty(e,"ParserDefinitionErrorType",{enumerable:!0,get:function(){return r.ParserDefinitionErrorType}}),Object.defineProperty(e,"EMPTY_ALT",{enumerable:!0,get:function(){return r.EMPTY_ALT}});var n=Qi;Object.defineProperty(e,"Lexer",{enumerable:!0,get:function(){return n.Lexer}}),Object.defineProperty(e,"LexerDefinitionErrorType",{enumerable:!0,get:function(){return n.LexerDefinitionErrorType}});var a=ra;Object.defineProperty(e,"createToken",{enumerable:!0,get:function(){return a.createToken}}),Object.defineProperty(e,"createTokenInstance",{enumerable:!0,get:function(){return a.createTokenInstance}}),Object.defineProperty(e,"EOF",{enumerable:!0,get:function(){return a.EOF}}),Object.defineProperty(e,"tokenLabel",{enumerable:!0,get:function(){return a.tokenLabel}}),Object.defineProperty(e,"tokenMatcher",{enumerable:!0,get:function(){return a.tokenMatcher}}),Object.defineProperty(e,"tokenName",{enumerable:!0,get:function(){return a.tokenName}});var i=eo;Object.defineProperty(e,"defaultParserErrorProvider",{enumerable:!0,get:function(){return i.defaultParserErrorProvider}});var s=qt;Object.defineProperty(e,"EarlyExitException",{enumerable:!0,get:function(){return s.EarlyExitException}}),Object.defineProperty(e,"isRecognitionException",{enumerable:!0,get:function(){return s.isRecognitionException}}),Object.defineProperty(e,"MismatchedTokenException",{enumerable:!0,get:function(){return s.MismatchedTokenException}}),Object.defineProperty(e,"NotAllInputParsedException",{enumerable:!0,get:function(){return s.NotAllInputParsedException}}),Object.defineProperty(e,"NoViableAltException",{enumerable:!0,get:function(){return s.NoViableAltException}});var f=Ji;Object.defineProperty(e,"defaultLexerErrorProvider",{enumerable:!0,get:function(){return f.defaultLexerErrorProvider}});var h=Pt;Object.defineProperty(e,"Alternation",{enumerable:!0,get:function(){return h.Alternation}}),Object.defineProperty(e,"Alternative",{enumerable:!0,get:function(){return h.Alternative}}),Object.defineProperty(e,"NonTerminal",{enumerable:!0,get:function(){return h.NonTerminal}}),Object.defineProperty(e,"Option",{enumerable:!0,get:function(){return h.Option}}),Object.defineProperty(e,"Repetition",{enumerable:!0,get:function(){return h.Repetition}}),Object.defineProperty(e,"RepetitionMandatory",{enumerable:!0,get:function(){return h.RepetitionMandatory}}),Object.defineProperty(e,"RepetitionMandatoryWithSeparator",{enumerable:!0,get:function(){return h.RepetitionMandatoryWithSeparator}}),Object.defineProperty(e,"RepetitionWithSeparator",{enumerable:!0,get:function(){return h.RepetitionWithSeparator}}),Object.defineProperty(e,"Rule",{enumerable:!0,get:function(){return h.Rule}}),Object.defineProperty(e,"Terminal",{enumerable:!0,get:function(){return h.Terminal}});var c=Pt;Object.defineProperty(e,"serializeGrammar",{enumerable:!0,get:function(){return c.serializeGrammar}}),Object.defineProperty(e,"serializeProduction",{enumerable:!0,get:function(){return c.serializeProduction}}),Object.defineProperty(e,"GAstVisitor",{enumerable:!0,get:function(){return c.GAstVisitor}});var o=qs;Object.defineProperty(e,"generateCstDts",{enumerable:!0,get:function(){return o.generateCstDts}});function l(){console.warn(`The clearCache function was 'soft' removed from the Chevrotain API.
	 It performs no action other than printing this message.
	 Please avoid using it as it will be completely removed in the future`)}e.clearCache=l;var u=Qs;Object.defineProperty(e,"createSyntaxDiagramsCode",{enumerable:!0,get:function(){return u.createSyntaxDiagramsCode}});var d=function(){function g(){throw new Error(`The Parser class has been deprecated, use CstParser or EmbeddedActionsParser instead.	
See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_7-0-0`)}return g}();e.Parser=d})(Cg);var Qe=jN(Cg);Qe.Alternation;Qe.Alternative;Qe.CstParser;Qe.EMPTY_ALT;Qe.EOF;Qe.EarlyExitException;const X4=Qe.EmbeddedActionsParser;Qe.GAstVisitor;const C0=Qe.Lexer;Qe.LexerDefinitionErrorType;Qe.MismatchedTokenException;Qe.NoViableAltException;Qe.NonTerminal;const j4=Qe.NotAllInputParsedException;Qe.Option;Qe.Parser;Qe.ParserDefinitionErrorType;Qe.Repetition;Qe.RepetitionMandatory;Qe.RepetitionMandatoryWithSeparator;Qe.RepetitionWithSeparator;Qe.Rule;Qe.Terminal;Qe.VERSION;Qe.clearCache;Qe.createSyntaxDiagramsCode;const Xe=Qe.createToken;Qe.createTokenInstance;Qe.defaultLexerErrorProvider;Qe.defaultParserErrorProvider;Qe.generateCstDts;Qe.isRecognitionException;Qe.serializeGrammar;Qe.serializeProduction;Qe.tokenLabel;Qe.tokenMatcher;Qe.tokenName;const Gu={},Q4=Xe({name:"WhiteSpace",pattern:/\s+/,group:C0.SKIPPED}),Z4=Xe({name:"String",pattern:/"(""|[^"])*"/}),J4=Xe({name:"SingleQuotedString",pattern:/'(''|[^'])*'/}),e6=Xe({name:"SheetQuoted",pattern:/'((?![\\/[\]*?:]).)+?'!/}),t6=Xe({name:"Function",pattern:/[A-Za-z_]+[A-Za-z_0-9.]*\(/}),r6=Xe({name:"FormulaErrorT",pattern:/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A/}),n6=Xe({name:"RefError",pattern:/#REF!/}),Hu=Xe({name:"Name",pattern:/[a-zA-Z_][a-zA-Z0-9_.?]*/}),a6=Xe({name:"Sheet",pattern:/[A-Za-z_.\d\u007F-\uFFFF]+!/}),i6=Xe({name:"Cell",pattern:/[$]?[A-Za-z]{1,3}[$]?[1-9][0-9]*/,longer_alt:Hu}),o6=Xe({name:"Number",pattern:/[0-9]+[.]?[0-9]*([eE][+-][0-9]+)?/}),s6=Xe({name:"Boolean",pattern:/TRUE|FALSE/i}),l6=Xe({name:"Column",pattern:/[$]?[A-Za-z]{1,3}/,longer_alt:Hu}),c6=Xe({name:"At",pattern:/@/}),u6=Xe({name:"Comma",pattern:/,/}),f6=Xe({name:"Colon",pattern:/:/}),d6=Xe({name:"Semicolon",pattern:/;/}),h6=Xe({name:"OpenParen",pattern:/\(/}),p6=Xe({name:"CloseParen",pattern:/\)/}),v6=Xe({name:"OpenSquareParen",pattern:/\[/}),g6=Xe({name:"CloseSquareParen",pattern:/]/}),m6=Xe({name:"exclamationMark",pattern:/!/}),y6=Xe({name:"OpenCurlyParen",pattern:/{/}),E6=Xe({name:"CloseCurlyParen",pattern:/}/}),_6=Xe({name:"QuoteS",pattern:/'/}),Vh=Xe({name:"MulOp",pattern:/\*/}),b6=Xe({name:"PlusOp",pattern:/\+/}),N6=Xe({name:"DivOp",pattern:/\//}),A6=Xe({name:"MinOp",pattern:/-/}),C6=Xe({name:"ConcatOp",pattern:/&/}),T6=Xe({name:"ExOp",pattern:/\^/}),R6=Xe({name:"PercentOp",pattern:/%/}),O6=Xe({name:"GtOp",pattern:/>/}),w6=Xe({name:"EqOp",pattern:/=/}),I6=Xe({name:"LtOp",pattern:/</}),M6=Xe({name:"NeqOp",pattern:/<>/}),P6=Xe({name:"GteOp",pattern:/>=/}),S6=Xe({name:"LteOp",pattern:/<=/}),Wu=[Q4,Z4,e6,J4,t6,r6,n6,a6,i6,s6,l6,Hu,o6,c6,u6,f6,d6,h6,p6,v6,g6,m6,y6,E6,_6,Vh,b6,N6,A6,C6,T6,Vh,R6,M6,P6,S6,O6,w6,I6],L6=new C0(Wu,{ensureOptimizations:!0});Wu.forEach(e=>{Gu[e.name]=e});const Ac=e=>{const t=L6.tokenize(e);if(t.errors.length>0){const r=t.errors[0],n=r.line,a=r.column;let i=`
${e.split(`
`)[n-1]}
`;i+=`${Array(a-1).fill(" ").join("")}^
`;const s={message:`${i}Error at position ${n}:${a}
${r.message}`,errorLocation:{line:n,column:a}};throw S.ERROR(r.message,s)}return t},{String:Gh,SheetQuoted:$6,Function:D6,FormulaErrorT:Hh,RefError:Wh,Cell:x6,Sheet:k6,Name:U6,Number:zh,Boolean:Kh,Column:F6,At:t8,Comma:No,Colon:B6,Semicolon:V6,OpenParen:G6,CloseParen:qh,OpenSquareParen:r8,CloseSquareParen:n8,ExclamationMark:a8,OpenCurlyParen:H6,CloseCurlyParen:W6,MulOp:z6,PlusOp:Ol,DivOp:K6,MinOp:wl,ConcatOp:q6,ExOp:Y6,PercentOp:X6,NeqOp:j6,GteOp:Q6,LteOp:Z6,GtOp:J6,EqOp:e5,LtOp:t5}=Gu;class T0 extends X4{constructor(r,n){super(Gu,{maxLookahead:1,skipValidations:!0});le(this,"utils");le(this,"binaryOperatorsPrecedence");le(this,"formulaWithPercentOp");le(this,"formulaWithUnaryOp");le(this,"formulaWithIntersect");le(this,"formulaWithRange");le(this,"formula");le(this,"referenceWithoutInfix");le(this,"paren");le(this,"constant");le(this,"functionCall");le(this,"constantArray");le(this,"formulaWithBinaryOp");le(this,"constantForArray");le(this,"plusMinusOp");le(this,"arguments");le(this,"referenceItem");le(this,"prefixName");le(this,"c1");this.utils=n,this.binaryOperatorsPrecedence=[["^"],["*","/"],["+","-"],["&"],["<",">","=","<>","<=",">="]];const a=this;a.RULE("formulaWithBinaryOp",()=>{const i=[],s=[a.SUBRULE(a.formulaWithPercentOp)];return a.MANY(()=>{i.push(a.OR(a.c1||(a.c1=[{ALT:()=>a.CONSUME(J6).image},{ALT:()=>a.CONSUME(e5).image},{ALT:()=>a.CONSUME(t5).image},{ALT:()=>a.CONSUME(j6).image},{ALT:()=>a.CONSUME(Q6).image},{ALT:()=>a.CONSUME(Z6).image},{ALT:()=>a.CONSUME(q6).image},{ALT:()=>a.CONSUME(Ol).image},{ALT:()=>a.CONSUME(wl).image},{ALT:()=>a.CONSUME(z6).image},{ALT:()=>a.CONSUME(K6).image},{ALT:()=>a.CONSUME(Y6).image}]))),s.push(a.SUBRULE2(a.formulaWithPercentOp))}),a.ACTION(()=>{for(const f of this.binaryOperatorsPrecedence)for(let h=0,c=i.length;h<c;h++){const o=i[h];!f.includes(o)||(i.splice(h,1),s.splice(h,2,this.utils.applyInfix(s[h],o,s[h+1])),h--,c--)}}),s[0]}),a.RULE("plusMinusOp",()=>a.OR([{ALT:()=>a.CONSUME(Ol).image},{ALT:()=>a.CONSUME(wl).image}])),a.RULE("formulaWithPercentOp",()=>{let i=a.SUBRULE(a.formulaWithUnaryOp);return a.OPTION(()=>{const s=a.CONSUME(X6).image;i=a.ACTION(()=>this.utils.applyPostfix(i,s))}),i}),a.RULE("formulaWithUnaryOp",()=>{const i=[];a.MANY(()=>{const f=a.OR([{ALT:()=>a.CONSUME(Ol).image},{ALT:()=>a.CONSUME(wl).image}]);i.push(f)});const s=a.SUBRULE(a.formulaWithIntersect);return i.length>0?a.ACTION(()=>this.utils.applyPrefix(i,s)):s}),a.RULE("formulaWithIntersect",()=>{const i=a.SUBRULE(a.formulaWithRange),s=[i];return a.MANY({GATE:()=>{const f=a.LA(0);return a.LA(1).startOffset>f.endOffset+1},DEF:()=>{s.push(a.SUBRULE3(a.formulaWithRange))}}),s.length>1?a.ACTION(()=>a.ACTION(()=>this.utils.applyIntersect(s))):i}),a.RULE("formulaWithRange",()=>{const i=a.SUBRULE(a.formula),s=[i];return a.MANY(()=>{a.CONSUME(B6),s.push(a.SUBRULE2(a.formula))}),s.length>1?a.ACTION(()=>a.ACTION(()=>this.utils.applyRange(s))):i}),a.RULE("formula",()=>a.OR9([{ALT:()=>a.SUBRULE(a.referenceWithoutInfix)},{ALT:()=>a.SUBRULE(a.paren)},{ALT:()=>a.SUBRULE(a.constant)},{ALT:()=>a.SUBRULE(a.functionCall)},{ALT:()=>a.SUBRULE(a.constantArray)}])),a.RULE("paren",()=>{a.CONSUME(G6);let i;const s=[];return s.push(a.SUBRULE(a.formulaWithBinaryOp)),a.MANY(()=>{a.CONSUME(No),s.push(a.SUBRULE2(a.formulaWithBinaryOp))}),s.length>1?i=a.ACTION(()=>this.utils.applyUnion(s)):i=s[0],a.CONSUME(qh),i}),a.RULE("constantArray",()=>{const i=[[]];let s=0;return a.CONSUME(H6),i[s].push(a.SUBRULE(a.constantForArray)),a.MANY(()=>{const f=a.OR([{ALT:()=>a.CONSUME(No).image},{ALT:()=>a.CONSUME(V6).image}]),h=a.SUBRULE2(a.constantForArray);f===","||(s++,i[s]=[]),i[s].push(h)}),a.CONSUME(W6),a.ACTION(()=>this.utils.toArray(i))}),a.RULE("constantForArray",()=>a.OR([{ALT:()=>{const i=a.OPTION(()=>a.SUBRULE(a.plusMinusOp)),s=a.CONSUME(zh).image,f=a.ACTION(()=>this.utils.toNumber(s));return i?a.ACTION(()=>this.utils.applyPrefix([i],f)):f}},{ALT:()=>{const i=a.CONSUME(Gh).image;return a.ACTION(()=>this.utils.toString(i))}},{ALT:()=>{const i=a.CONSUME(Kh).image;return a.ACTION(()=>this.utils.toBoolean(i))}},{ALT:()=>{const i=a.CONSUME(Hh).image;return a.ACTION(()=>this.utils.toError(i))}},{ALT:()=>{const i=a.CONSUME(Wh).image;return a.ACTION(()=>this.utils.toError(i))}}])),a.RULE("constant",()=>a.OR([{ALT:()=>{const i=a.CONSUME(zh).image;return a.ACTION(()=>this.utils.toNumber(i))}},{ALT:()=>{const i=a.CONSUME(Gh).image;return a.ACTION(()=>this.utils.toString(i))}},{ALT:()=>{const i=a.CONSUME(Kh).image;return a.ACTION(()=>this.utils.toBoolean(i))}},{ALT:()=>{const i=a.CONSUME(Hh).image;return a.ACTION(()=>this.utils.toError(i))}}])),a.RULE("functionCall",()=>{const i=a.CONSUME(D6).image.slice(0,-1),s=a.SUBRULE(a.arguments);return a.CONSUME(qh),a.ACTION(()=>r.callFunction(i,s))}),a.RULE("arguments",()=>{a.MANY2(()=>{a.CONSUME2(No)});const i=[];return a.OPTION(()=>{i.push(a.SUBRULE(a.formulaWithBinaryOp)),a.MANY(()=>{a.CONSUME1(No),i.push(null),a.OPTION3(()=>{i.pop(),i.push(a.SUBRULE2(a.formulaWithBinaryOp))})})}),i}),a.RULE("referenceWithoutInfix",()=>a.OR([{ALT:()=>a.SUBRULE(a.referenceItem)},{ALT:()=>{const i=a.SUBRULE(a.prefixName),s=a.SUBRULE2(a.formulaWithRange);return a.ACTION(()=>{if(this.utils.isFormulaError(s))return s;s.ref.sheet=i}),s}}])),a.RULE("referenceItem",()=>a.OR([{ALT:()=>{const i=a.CONSUME(x6).image;return a.ACTION(()=>this.utils.parseCellAddress(i))}},{ALT:()=>{const i=a.CONSUME(U6).image;return a.ACTION(()=>r.getVariable(i))}},{ALT:()=>{const i=a.CONSUME(F6).image;return a.ACTION(()=>this.utils.parseCol(i))}},{ALT:()=>{const i=a.CONSUME(Wh).image;return a.ACTION(()=>this.utils.toError(i))}}])),a.RULE("prefixName",()=>a.OR([{ALT:()=>a.CONSUME(k6).image.slice(0,-1)},{ALT:()=>a.CONSUME($6).image.slice(1,-2).replace(/''/g,"'")}])),this.performSelfAnalysis()}}const Yh=1048576,Xh=16384;class So{constructor(t){le(this,"context");le(this,"columnNameToNumber",t=>Xn.columnNameToNumber(t));le(this,"parseRow",t=>{const r=+t;if(!Number.isInteger(r))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+t}}});le(this,"parseRowRange",(t,r)=>({ref:{from:{col:null,row:Math.min(t,r)},to:{col:null,row:Math.max(t,r)}}}));le(this,"toArray",t=>t);le(this,"toNumber",t=>Number(t));le(this,"toString",t=>t.substring(1,t.length-1).replace(/""/g,'"'));le(this,"toBoolean",t=>t==="TRUE");le(this,"toError",t=>new S(t.toUpperCase()));le(this,"isFormulaError",t=>t instanceof S);this.context=t}parseCellAddress(t){const r=t.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{address:r[0],col:this.columnNameToNumber(r[2]),row:+r[4]}}}parseCol(t){return{ref:{col:this.columnNameToNumber(t),row:void 0}}}parseColRange(t,r){return t=this.columnNameToNumber(t),r=this.columnNameToNumber(r),{ref:{from:{col:Math.min(t,r),row:null},to:{col:Math.max(t,r),row:null}}}}_applyPrefix(t,r,n){return this.isFormulaError(r)?r:pA.unaryOp(t,r,n)}async applyPrefixAsync(t,r){const{val:n,isArray:a}=this.extractRefValue(await r);return this._applyPrefix(t,n,a)}applyPrefix(t,r){if(this.context.async)return this.applyPrefixAsync(t,r);const{val:n,isArray:a}=this.extractRefValue(r);return this._applyPrefix(t,n,a)}_applyPostfix(t,r,n){return this.isFormulaError(t)?t:vA.percentOp(t,n,r)}async applyPostfixAsync(t,r){const{val:n,isArray:a}=this.extractRefValue(await t);return this._applyPostfix(n,a,r)}applyPostfix(t,r){if(this.context.async)return this.applyPostfixAsync(t,r);const{val:n,isArray:a}=this.extractRefValue(t);return this._applyPostfix(n,a,r)}_applyInfix(t,r,n){const a=t.val,i=t.isArray,s=n.val,f=n.isArray;if(this.isFormulaError(a))return a;if(this.isFormulaError(s))return s;if(pl.compareOp.includes(r))return Ca.compareOp(a,r,s,i,f);if(pl.concatOp.includes(r))return Ca.concatOp(a,r,s,i,f);if(pl.mathOp.includes(r))return Ca.mathOp(a,r,s,i,f);throw new Error(`Unrecognized infix: ${r}`)}async applyInfixAsync(t,r,n){const a=this.extractRefValue(await t),i=this.extractRefValue(await n);return this._applyInfix(a,r,i)}applyInfix(t,r,n){if(this.context.async)return this.applyInfixAsync(t,r,n);const a=this.extractRefValue(t),i=this.extractRefValue(n);return this._applyInfix(a,r,i)}applyIntersect(t){if(this.isFormulaError(t[0]))return t[0];if(!t[0].ref)throw Error(`Expecting a reference, but got ${t[0]}.`);let r,n,a,i,s;const f=t.shift().ref,h=f.sheet;if(f.from)r=Math.max(f.from.row,f.to.row),a=Math.min(f.from.row,f.to.row),n=Math.max(f.from.col,f.to.col),i=Math.min(f.from.col,f.to.col);else{if(f.row===void 0||f.col===void 0)throw Error("Cannot intersect the whole row or column.");r=a=f.row,n=i=f.col}let c;return t.forEach(o=>{if(this.isFormulaError(o))return o;if(o=o.ref,!o)throw Error(`Expecting a reference, but got ${o}.`);if(o.from){const l=Math.max(o.from.row,o.to.row),u=Math.min(o.from.row,o.to.row),d=Math.max(o.from.col,o.to.col),g=Math.min(o.from.col,o.to.col);(u>r||l<a||g>n||d<i||h!==o.sheet)&&(c=S.NULL),r=Math.min(r,l),a=Math.max(a,u),n=Math.min(n,d),i=Math.max(i,g)}else{if(o.row===void 0||o.col===void 0)throw Error("Cannot intersect the whole row or column.");(o.row>r||o.row<a||o.col>n||o.col<i||h!==o.sheet)&&(c=S.NULL),r=a=o.row,n=i=o.col}}),c||(r===a&&n===i?s={ref:{sheet:h,row:r,col:n}}:s={ref:{sheet:h,from:{row:a,col:i},to:{row:r,col:n}}},s.ref.sheet||delete s.ref.sheet,s)}applyUnion(t){const r=new Yn;for(let n=0;n<t.length;n++){if(this.isFormulaError(t[n]))return t[n];r.add(this.extractRefValue(t[n]).val,t[n])}return r}applyRange(t){let r,n=-1,a=-1,i=Yh+1,s=Xh+1;return t.forEach(f=>{if(this.isFormulaError(f))return f;typeof f=="number"&&(f=this.parseRow(f)),f=f.ref,f.row===void 0&&(i=1,n=Yh),f.col===void 0&&(s=1,a=Xh),f.row>n&&(n=f.row),f.row<i&&(i=f.row),f.col>a&&(a=f.col),f.col<s&&(s=f.col)}),n===i&&a===s?r={ref:{row:n,col:a}}:r={ref:{from:{row:i,col:s},to:{row:n,col:a}}},r}extractRefValue(t){const r=t;let n=!1;return Array.isArray(r)&&(n=!0),t.ref?{val:this.context.retrieveRef(t),isArray:n}:{val:r,isArray:n}}static formatChevrotainError(t,r){let n,a,i="";return t instanceof j4?(n=t.token.startLine,a=t.token.startColumn):(n=t.previousToken.startLine,a=t.previousToken.startColumn+1),i+=`
${r.split(`
`)[n-1]}
`,i+=`${Array(a-1).fill(" ").join("")}^
`,i+=`Error at position ${n}:${a}
${t.message}`,t.errorLocation={line:n,column:a},S.ERROR(i,t)}}class r5{constructor(t,r=!1){le(this,"logs");le(this,"isTest");le(this,"utils");le(this,"onVariable");le(this,"functions");le(this,"onRange");le(this,"onCell");le(this,"funsNullAs0");le(this,"funsNeedContextAndNoDataRetrieve");le(this,"funsNeedContext");le(this,"funsPreserveRef");le(this,"parser");le(this,"position");le(this,"async");this.logs=[],this.isTest=r,this.utils=new So(this),t={functions:{},functionsNeedContext:{},onVariable:()=>null,onCell:()=>0,onRange:()=>[[0]],...t},this.onVariable=t.onVariable,this.functions={...An,...fc,...Ed,...yd,...Ye,...md,...Lt,...Dt,...gd,...CA,...t.functions,...t.functionsNeedContext},this.onRange=t.onRange,this.onCell=t.onCell,this.funsNullAs0=Object.keys(An).concat(Object.keys(Ye)).concat(Object.keys(Dt)).concat(Object.keys(md)).concat(Object.keys(yd)).concat(Object.keys(fc)).concat(Object.keys(gd)),this.funsNeedContextAndNoDataRetrieve=["ROW","ROWS","COLUMN","COLUMNS","SUMIF","INDEX","AVERAGEIF","IF"],this.funsNeedContext=[...Object.keys(t.functionsNeedContext),...this.funsNeedContextAndNoDataRetrieve,"INDEX","OFFSET","INDIRECT","IF","CHOOSE","WEBSERVICE"],this.funsPreserveRef=Object.keys(Ed),this.parser=new T0(this,this.utils)}static get allTokens(){return Wu}getCell(t){return t.sheet==null&&(t.sheet=this.position?this.position.sheet:void 0),this.onCell(t)}getRange(t){return t.sheet==null&&(t.sheet=this.position?this.position.sheet:void 0),this.onRange(t)}getVariable(t){const r={ref:this.onVariable(t,this.position.sheet,this.position)};return r.ref==null?S.NAME:r}retrieveRef(t){return bt.isRangeRef(t)?this.getRange(t.ref):bt.isCellRef(t)?this.getCell(t.ref):t}_callFunction(t,r){t.indexOf("_xlfn.")===0&&(t=t.slice(6)),t=t.toUpperCase();const n=this.funsNullAs0.includes(t)?0:"";if(this.funsNeedContextAndNoDataRetrieve.includes(t)||(r=r.map(a=>{if(a===null)return{value:n,isArray:!1,omitted:!0};const i=this.utils.extractRefValue(a);return this.funsPreserveRef.includes(t)?{value:i.val,isArray:i.isArray,ref:a.ref}:{value:i.val,isArray:i.isArray,isRangeRef:!!bt.isRangeRef(a),isCellRef:!!bt.isCellRef(a)}})),this.functions[t]){let a;try{!this.funsNeedContextAndNoDataRetrieve.includes(t)&&!this.funsNeedContext.includes(t)?a=this.functions[t](...r):a=this.functions[t](this,...r)}catch(i){if(i instanceof S)return i;throw i}if(a===void 0){if(this.isTest)return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}};throw S.NOT_IMPLEMENTED(t)}return a}if(this.isTest)return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}};throw S.NOT_IMPLEMENTED(t)}async callFunctionAsync(t,r){const n=[];for(const i of r)n.push(await i);const a=await this._callFunction(t,n);return bt.checkFunctionResult(a)}callFunction(t,r){if(this.async)return this.callFunctionAsync(t,r);const n=this._callFunction(t,r);return bt.checkFunctionResult(n)}supportedFunctions(){const t=[];return Object.keys(this.functions).forEach(n=>{try{if(this.functions[n](0,0,0,0,0,0,0,0,0,0,0)===void 0)return;t.push(n)}catch(a){a instanceof Error&&t.push(n)}}),t.sort()}checkFormulaResult(t,r=!1){const n=typeof t;if(n==="number"){if(isNaN(t))return S.VALUE;if(!isFinite(t))return S.NUM;t+=0}else if(n==="object"){if(t instanceof S)return t;if(r){if(t.ref&&(t=this.retrieveRef(t)),typeof t=="object"&&!Array.isArray(t)&&t!=null)return S.VALUE}else if(t.ref&&t.ref.row&&!t.ref.from)t=this.retrieveRef(t);else if(t.ref&&t.ref.from&&t.ref.from.col===t.ref.to.col)t=this.retrieveRef({ref:{row:t.ref.from.row,col:t.ref.from.col}});else if(Array.isArray(t))t=t[0][0];else return S.VALUE}return t}parse(t,r,n=!1){if(t.length===0)throw Error("Input must not be empty.");this.position=r,this.async=!1;const a=Ac(t);this.parser.input=a.tokens;let i;try{if(i=this.parser.formulaWithBinaryOp(),i=this.checkFormulaResult(i,n),i instanceof S)return i}catch(s){throw S.ERROR(s.message,s)}if(this.parser.errors.length>0){const s=this.parser.errors[0];throw So.formatChevrotainError(s,t)}return i}async parseAsync(t,r,n=!1){if(t.length===0)throw Error("Input must not be empty.");this.position=r,this.async=!0;const a=Ac(t);this.parser.input=a.tokens;let i;try{if(i=await this.parser.formulaWithBinaryOp(),i=this.checkFormulaResult(i,n),i instanceof S)return i}catch(s){throw S.ERROR(s.message,s)}if(this.parser.errors.length>0){const s=this.parser.errors[0];throw So.formatChevrotainError(s,t)}return i}}const jh=1048576,Qh=16384;class Zh{constructor(t){le(this,"context");le(this,"columnNameToNumber",t=>Xn.columnNameToNumber(t));le(this,"parseRow",t=>{const r=+t;if(!Number.isInteger(r))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+t}}});le(this,"toArray",t=>t);le(this,"toNumber",t=>Number(t));le(this,"toString",t=>t.substring(1,t.length-1).replace(/""/g,'"'));le(this,"toBoolean",t=>t==="TRUE");le(this,"toError",t=>new S(t.toUpperCase()));le(this,"isFormulaError",t=>t instanceof S);this.context=t}parseCellAddress(t){const r=t.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{col:this.columnNameToNumber(r[2]),row:+r[4]}}}parseCol(t){return{ref:{col:this.columnNameToNumber(t),row:void 0}}}applyPrefix(t,r){return this.extractRefValue(r),0}applyPostfix(t,r){return this.extractRefValue(t),0}applyInfix(t,r,n){return this.extractRefValue(t),this.extractRefValue(n),0}applyIntersect(t){if(this.isFormulaError(t[0]))return t[0];if(!t[0].ref)throw Error(`Expecting a reference, but got ${t[0]}.`);let r,n,a,i,s;const f=t.shift().ref,h=f.sheet;if(f.from)r=Math.max(f.from.row,f.to.row),a=Math.min(f.from.row,f.to.row),n=Math.max(f.from.col,f.to.col),i=Math.min(f.from.col,f.to.col);else{if(f.row===void 0||f.col===void 0)throw Error("Cannot intersect the whole row or column.");r=a=f.row,n=i=f.col}let c;return t.forEach(o=>{if(this.isFormulaError(o))return o;if(o=o.ref,!o)throw Error(`Expecting a reference, but got ${o}.`);if(o.from){const l=Math.max(o.from.row,o.to.row),u=Math.min(o.from.row,o.to.row),d=Math.max(o.from.col,o.to.col),g=Math.min(o.from.col,o.to.col);(u>r||l<a||g>n||d<i||h!==o.sheet)&&(c=S.NULL),r=Math.min(r,l),a=Math.max(a,u),n=Math.min(n,d),i=Math.max(i,g)}else{if(o.row===void 0||o.col===void 0)throw Error("Cannot intersect the whole row or column.");(o.row>r||o.row<a||o.col>n||o.col<i||h!==o.sheet)&&(c=S.NULL),r=a=o.row,n=i=o.col}}),c||(r===a&&n===i?s={ref:{sheet:h,row:r,col:n}}:s={ref:{sheet:h,from:{row:a,col:i},to:{row:r,col:n}}},s.ref.sheet||delete s.ref.sheet,s)}applyUnion(t){const r=new Yn;for(let n=0;n<t.length;n++){if(this.isFormulaError(t[n]))return t[n];r.add(this.extractRefValue(t[n]).val,t[n])}return r}applyRange(t){let r,n=-1,a=-1,i=jh+1,s=Qh+1;return t.forEach(f=>{if(this.isFormulaError(f))return f;typeof f=="number"&&(f=this.parseRow(f)),f=f.ref,f.row===void 0&&(i=1,n=jh),f.col===void 0&&(s=1,a=Qh),f.row>n&&(n=f.row),f.row<i&&(i=f.row),f.col>a&&(a=f.col),f.col<s&&(s=f.col)}),n===i&&a===s?r={ref:{row:n,col:a}}:r={ref:{from:{row:i,col:s},to:{row:n,col:a}}},r}extractRefValue(t){const r=Array.isArray(t);return t.ref?{val:this.context.retrieveRef(t),isArray:r}:{val:t,isArray:r}}}class n5{constructor(t){le(this,"data");le(this,"utils");le(this,"onVariable");le(this,"functions");le(this,"parser");le(this,"position");this.data=[],this.utils=new Zh(this),t={onVariable:()=>null,...t},this.utils=new Zh(this),this.onVariable=t.onVariable,this.functions={},this.parser=new T0(this,this.utils)}getCell(t){return t.row!=null&&(t.sheet==null&&(t.sheet=this.position?this.position.sheet:void 0),this.data.findIndex(n=>n.from&&n.from.row<=t.row&&n.to.row>=t.row&&n.from.col<=t.col&&n.to.col>=t.col||n.row===t.row&&n.col===t.col&&n.sheet===t.sheet)===-1&&this.data.push(t)),0}getRange(t){return t.from.row!=null&&(t.sheet==null&&(t.sheet=this.position?this.position.sheet:void 0),this.data.findIndex(n=>n.from&&n.from.row===t.from.row&&n.from.col===t.from.col&&n.to.row===t.to.row&&n.to.col===t.to.col)===-1&&this.data.push(t)),[[0]]}getVariable(t){const r={ref:this.onVariable(t,this.position.sheet)};return r.ref==null?S.NAME:(bt.isCellRef(r)?this.getCell(r.ref):this.getRange(r.ref),0)}retrieveRef(t){return bt.isRangeRef(t)?this.getRange(t.ref):bt.isCellRef(t)?this.getCell(t.ref):t}callFunction(t,r){return r.forEach(n=>{n!=null&&this.retrieveRef(n)}),{value:0,ref:{}}}checkFormulaResult(t){this.retrieveRef(t)}parse(t,r,n=!1){if(t.length===0)throw Error("Input must not be empty.");this.data=[],this.position=r;const a=Ac(t);this.parser.input=a.tokens;try{const i=this.parser.formulaWithBinaryOp();this.checkFormulaResult(i)}catch(i){if(!n)throw S.ERROR(i.message,i)}if(this.parser.errors.length>0&&!n){const i=this.parser.errors[0];throw So.formatChevrotainError(i,t)}return this.data}}class Un{constructor(t,r,n,a,i,s,f,h,c,o,l,u,d,g,v,y,m,b,E,N,R,C,O,T,A,L,G){le(this,"r");le(this,"c");le(this,"rs");le(this,"cs");le(this,"fd");le(this,"v");le(this,"mv");le(this,"s");le(this,"se");le(this,"t");le(this,"fs");le(this,"ff");le(this,"bl");le(this,"it");le(this,"ol");le(this,"cl");le(this,"ul");le(this,"bg");le(this,"bgt");le(this,"fc");le(this,"bdt");le(this,"bdb");le(this,"bdl");le(this,"bdr");le(this,"av");le(this,"ah");le(this,"cf");Object.assign(this,{r:t,c:r,v:n,mv:a,fd:i,s,se:f,t:h,rs:c,cs:o,fs:l,ff:u,bl:d,it:g,ol:v,cl:y,ul:m,bg:b,bgt:E,fc:N,bdt:R,bdb:C,bdl:O,bdr:T,av:A,ah:L,cf:G})}}var a5={id:String,editable:{type:Boolean,default:!0},type:{type:String,default:"primary"},size:{type:String,default:"normal"},border:{type:String,default:"full"},data:Array,alignH:{type:String,default:"center"},alignV:{type:String,default:"center"},minDimensions:{type:Array,default:[10,10]},resizeColumn:{type:Boolean,default:!0},resizeRow:{type:Boolean,default:!0},gridRowHeight:{type:Number},gridColumnWidth:{type:Number},loading:{type:Boolean,default:!1},functions:{type:Object,default:null},scrollY:{type:Object,default:{enable:!0,gt:60,oSize:0}}};let Jh;const ga=[],i5=500;function o5(){ga.length&&(ga.forEach(e=>{e.targetList.forEach(t=>{const{target:r,width:n,height:a}=t,i=r.clientWidth,s=r.clientHeight;(i&&n!==i||s&&a!==s)&&(t.width=i,t.height=s,setTimeout(e.callback))})}),R0())}function R0(){clearTimeout(Jh),Jh=setTimeout(o5,i5)}class s5{constructor(t){le(this,"targetList",[]);le(this,"callback");this.callback=t}observe(t){if(t){const{targetList:r}=this;r.some(n=>n.target===t)||r.push({target:t,width:t.clientWidth,height:t.clientHeight}),ga.length||R0(),ga.some(n=>n===this)||ga.push(this)}}disconnect(){ga.length=0}}function ep(e){return window.ResizeObserver?new window.ResizeObserver(e):new s5(e)}class li{constructor(t,r,n,a,i,s,f,h){le(this,"index");le(this,"type");le(this,"width");le(this,"renderWidth");le(this,"minWidth");le(this,"visible");le(this,"fixed");le(this,"fixedType");Object.assign(this,{index:t,type:r,width:n,renderWidth:a,minWidth:i,visible:s,fixed:f,fixedType:h})}}class Ao{constructor(t,r,n,a,i,s,f,h){le(this,"index");le(this,"type");le(this,"height");le(this,"renderHeight");le(this,"minHeight");le(this,"visible");le(this,"fixed");le(this,"fixedType");Object.assign(this,{index:t,type:r,height:n,renderHeight:a,minHeight:i,visible:s,fixed:f,fixedType:h})}}class l5{constructor(t){le(this,"_marked");le(this,"_edgeTo");le(this,"_cycle",[]);le(this,"_onStack");le(this,"dfs",(t,r)=>{this._marked[r]=!0,this._onStack[r]=!0,t.adj.get(r)&&t.adj.get(r).forEach(n=>{if(this._cycle===null||this._cycle===void 0||this._cycle.length===0){if(!this._marked[n])this._edgeTo[n]=r,this.dfs(t,n);else if(this._onStack[n]){for(let a=r;a!==n;a=this._edgeTo[a])this._cycle.push(a);this._cycle.push(n),this._cycle.push(r)}}}),this._onStack[r]=!1});le(this,"hasCycle",()=>this._cycle!==null&&this._cycle!==void 0&&this._cycle.length>0);this._marked=Array.from({length:t.v}),this._edgeTo=Array.from({length:t.v}),this._onStack=Array.from({length:t.v});for(let r=0;r<t.v;r++)this._marked[r]||this.dfs(t,r)}get onStack(){return this._onStack}set onStack(t){this._onStack=t}get cycle(){return this._cycle}set cycle(t){this._cycle=t}get edgeTo(){return this._edgeTo}set edgeTo(t){this._edgeTo=t}get marked(){return this._marked}set marked(t){this._marked=t}}class Co{constructor(t,r,n,a){this.data=t,this.prev=r,this.next=n,this.list=a}get value(){return this.data}get index(){if(!!this.list)return this.list.findIndex(t=>t===this.value)}insertBefore(t){return this.list!==null?this.list.insertBefore(this,t):new gr(t,this.data)}insertAfter(t){return this.list!==null?this.list.insertAfter(this,t):new gr(this.data,t)}remove(){if(this.list===null)throw new ReferenceError("Node does not belong to any list");return this.list.removeNode(this)}}class gr{constructor(...t){le(this,"head");le(this,"tail");le(this,"size");this.head=null,this.tail=null,this.size=0;for(let r=0;r<t.length;r++)this.append(t[r])}get length(){return this.size}static from(t){return new gr(...t)}get(t){const r=this.getNode(t);return r!==void 0?r.data:void 0}getNode(t){if(this.head===null||t<0||t>=this.length)return;const r=t<this.length/2,n=r?t:this.length-t-1,a=r?"next":"prev";let i=r?this.head:this.tail;for(let s=0;s<n;s++)i=i[a];return i}findNodeIndex(t){let r=0,n=this.head;for(;n;){if(t(n.data,r,this))return{index:r,node:n};n=n.next,r+=1}}findNode(t){const r=this.findNodeIndex(t);return r!==void 0?r.node:void 0}find(t){const r=this.findNodeIndex(t);return r!==void 0?r.node.data:void 0}findIndex(t){const r=this.findNodeIndex(t);return r!==void 0?r.index:-1}append(...t){for(const r of t){const n=new Co(r,this.tail,null,this);this.head===null&&(this.head=n),this.tail!==null&&(this.tail.next=n),this.tail=n,this.size+=1}return this}push(...t){return this.append(...t),this.length}prepend(...t){const r=Array.from(t).reverse();for(const n of r){const a=new Co(n,null,this.head,this);this.tail===null&&(this.tail=a),this.head!==null&&(this.head.prev=a),this.head=a,this.size+=1}return this}insertAt(t,r){if(this.head===null)return this.append(r);if(t<=0)return this.prepend(r);let n=this.head,a=0;for(;a<t-1&&n.next!==null;)a+=1,n=n.next;return n.insertAfter(r),this}removeNode(t){if(t.list!==this)throw new ReferenceError("Node does not belong to this list");return t.prev!==null&&(t.prev.next=t.next),t.next!==null&&(t.next.prev=t.prev),this.head===t&&(this.head=t.next),this.tail===t&&(this.tail=t.prev),this.size-=1,t.next=null,t.prev=null,t.list=null,t}removeAt(t){const r=this.getNode(t);return r!==void 0?this.removeNode(r):void 0}insertBefore(t,r){const n=new Co(r,t.prev,t,this);return t.prev===null&&(this.head=n),t.prev!==null&&(t.prev.next=n),t.prev=n,this.size+=1,this}sort(t){if(this.head===null||this.tail===null)return this;if(this.length<2)return this;const r=(n,a)=>{if(n===a)return;const i=a.data;let s=n,f=n;for(;s&&s!==a;){if(t(s.data,i)){if(s!==f){const c=f.data;f.data=s.data,s.data=c}f=f.next}s=s.next}a.data=f.data,f.data=i,n.next!==a.prev&&(f.prev&&f!==n&&r(n,f.prev),f.next&&f!==a&&r(f.next,a))};return r(this.head,this.tail),this}insertAfter(t,r){const n=new Co(r,t,t.next,this);return t.next===null&&(this.tail=n),t.next!==null&&(t.next.prev=n),t.next=n,this.size+=1,this}shift(){return this.removeFromAnyEnd(this.head)}pop(){return this.removeFromAnyEnd(this.tail)}merge(t){this.tail!==null&&(this.tail.next=t.head),t.head!==null&&(t.head.prev=this.tail),this.head=this.head||t.head,this.tail=t.tail||this.tail,this.size+=t.size,t.size=this.size,t.head=this.head,t.tail=this.tail}clear(){return this.head=null,this.tail=null,this.size=0,this}slice(t,r){const n=new gr;let a=r;if(this.head===null||this.tail===null)return n;(a===void 0||a<t)&&(a=this.length);let i=this.getNode(t);for(let s=0;s<a-t&&i!==null&&i!==void 0;s++)n.append(i.data),i=i.next;return n}reverse(){let t=this.head;for(;t;){const n=t.next;t.next=t.prev,t.prev=n,t=t.prev}const r=this.tail;return this.tail=this.head,this.head=r,this}forEach(t,r=!1){let n=r?this.length-1:0,a=r?this.tail:this.head;const i=r?-1:1,s=r?"prev":"next";for(;a;)t(a.data,n,this),a=a[s],n+=i}map(t,r=!1){const n=new gr;return this.forEach((a,i)=>n.append(t(a,i,this)),r),n}filter(t,r=!1){const n=new gr;return this.forEach((a,i)=>{t(a,i,this)&&n.append(a)},r),n}reduce(t,r,n=!1){let a=n?this.length-1:0;const i=n?-1:1,s=n?"prev":"next";let f=n?this.tail:this.head,h;if(r!==void 0)h=r;else if(f)h=f.data,f=f[s];else throw new TypeError("Reduce of empty LinkedList with no initial value");for(;f;)h=t(h,f.data,a,this),a+=i,f=f[s];return h}toArray(){return[...this]}toString(t=" "){return this.reduce((r,n)=>`${r}${t}${n}`)}*[Symbol.iterator](){let t=this.head;for(;t!==null;)yield t.data,t=t.next}removeFromAnyEnd(t){return t!==null?this.removeNode(t).data:void 0}}class c5{constructor(t){le(this,"_v");le(this,"_e");le(this,"_g");le(this,"_adj");le(this,"addEdge",(t,r)=>{this._adj.get(t).append(r),this._e++});this._g=t;const r=Object.keys(this._g);this._v=r.length,this._e=0,this._adj=gr.from([...Array.from({length:this._v},()=>new gr)]),this._adj.forEach((n,a)=>{this._g[r[a]].children.forEach(i=>{this.addEdge(a,r.indexOf(i))})})}get g(){return this._g}set g(t){this._g=t}get adj(){return this._adj}set adj(t){this._adj=t}get e(){return this._e}set e(t){this._e=t}get v(){return this._v}set v(t){this._v=t}}class u5{constructor(t){le(this,"_marked");le(this,"_pre");le(this,"_post");le(this,"_reversePost");le(this,"dfs",(t,r)=>{this._pre.append(r),this._marked[r]=!0,t.adj.get(r)&&t.adj.get(r).forEach(n=>{this._marked[n]||this.dfs(t,n)}),this._post.append(r),this._reversePost.push(r)});this._pre=new gr,this._post=new gr,this._reversePost=new gr,this._marked=Array.from({length:t.v});for(let r=0;r<t.v;r++)this._marked[r]||this.dfs(t,r)}get pre(){return this._pre}set pre(t){this._pre=t}get reversePost(){return this._reversePost}set reversePost(t){this._reversePost=t}get marked(){return this._marked}set marked(t){this._marked=t}get post(){return this._post}set post(t){this._post=t}}function tp(e){return e==="xxx-large"?20:e==="xx-large"?18:e==="x-large"?16:e==="large"?14:e==="normal"?12:e==="small"?10:e==="mini"?8:12}function Ot(e){return Object.prototype.toString.call(e)==="[object Object]"}function Pi(e,t){if(e){if(t==="xxx-large")return Math.max(44,e);if(t==="xx-large")return Math.max(40,e);if(t==="x-large")return Math.max(36,e);if(t==="large")return Math.max(32,e);if(t==="normal")return Math.max(28,e);if(t==="small")return Math.max(24,e);if(t==="mini")return Math.max(20,e)}else{if(t==="xxx-large")return 44;if(t==="xx-large")return 40;if(t==="x-large")return 36;if(t==="large")return 32;if(t==="normal")return 28;if(t==="small")return 24;if(t==="mini")return 20}return 28}function Xo(e,t){if(e){if(t==="xxx-large")return Math.max(180,e);if(t==="xx-large")return Math.max(168,e);if(t==="x-large")return Math.max(156,e);if(t==="large")return Math.max(144,e);if(t==="normal")return Math.max(132,e);if(t==="small")return Math.max(120,e);if(t==="mini")return Math.max(108,e)}else{if(t==="xxx-large")return 180;if(t==="xx-large")return 168;if(t==="x-large")return 156;if(t==="large")return 144;if(t==="normal")return 132;if(t==="small")return 120;if(t==="mini")return 108}return 132}function O0(e,t){const r=Object.keys(e);if(r.length===0)return{noErrorVertexes:e,errorMap:t};const n=Object.keys(t);let a=!1;for(let i=0;i<r.length;i++){if(e.hasOwnProperty(r[i])&&e[r[i]].children&&e[r[i]].children.length>0&&e[r[i]].children.find(f=>n.indexOf(f)>=0)!=null){a=!0,t[r[i]]=e[r[i]],delete e[r[i]];break}a&&O0(e,t)}return{noErrorVertexes:e,errorMap:t}}function w0(e,t){const r=Object.keys(e);let n;const a=new c5(e),i=new l5(a);if(i.hasCycle()){for(let s=0;s<i.cycle.length;s++)t.hasOwnProperty(r[i.cycle[s]])||(t[r[i.cycle[s]]]=[e[r[i.cycle[s]]]].concat()[0],delete e[r[i.cycle[s]]]);n=w0(e,t)}else{const s=new u5(a),f=[];s.reversePost&&s.reversePost.length>0&&s.reversePost.forEach(h=>{f.push(r[h])}),n={g:a,topological:f,noCycleVertexes:e,cycleVertexes:t}}return n}const f5=(e,t,r,n)=>{if(Object.keys(r).length&&Object.keys(n).length){let a=0,i=0;do n[`${a}`]===0?i+=0:r[`${a}`]?i+=r[`${a}`]:i+=t,a++;while(e>=i);return a-1}if(Object.keys(r).length){let a=0,i=0;do i+=r[`${a}`]?r[`${a}`]:t,a++;while(e>=i);return a-1}if(Object.keys(n).length){let a=0,i=0;do i+=n[`${a}`]===0?0:t,a++;while(e>=i);return a-1}return Math.floor(e/t)},d5=(e,t,r,n)=>{if(Object.keys(r).length&&Object.keys(n).length){let a=0,i=0;do n[`${a}`]===0?i+=0:r[`${a}`]?i+=r[`${a}`]:i+=t,a++;while(e>=i);return a-1}if(Object.keys(r).length){let a=0,i=0;do i+=r[`${a}`]?r[`${a}`]:t,a++;while(e>=i);return a-1}if(Object.keys(n).length){let a=0,i=0;do i+=n[`${a}`]===0?0:t,a++;while(e>=i);return a-1}return Math.floor(e/t)},Cc=(e,t,r,n,a)=>{let i=0;for(let s=e;s<=t;s++)Object.keys(a).length&&a[`${s}`]===0?i+=0:Object.keys(n).length&&n[`${s}`]?i+=n[`${s}`]:i+=r;return i},Ta=(e,t,r,n)=>{if(Object.keys(r).length&&Object.keys(n).length){let a=0,i=0;for(;e>a;)n[`${a}`]===0?i+=0:r[`${a}`]?i+=r[`${a}`]:i+=t,a++;return i}if(Object.keys(r).length){let a=0,i=0;for(;e>a;)i+=r[`${a}`]?r[`${a}`]:t,a++;return i}if(Object.keys(n).length){let a=0,i=0;for(;e>a;)i+=n[`${a}`]===0?0:t,a++;return i}return Math.max(0,e*t)},Tc=(e,t,r,n,a)=>{let i=0;for(let s=e;s<=t;s++)Object.keys(a).length&&a[`${s}`]===0?i+=0:Object.keys(n).length&&n[`${s+1}`]?i+=n[`${s+1}`]:i+=r;return i},Ra=(e,t,r,n)=>{if(Object.keys(r).length&&Object.keys(n).length){let a=1,i=0;for(;e>a;)n[`${a}`]===0?i+=0:r[`${a}`]?i+=r[`${a}`]:i+=t,a++;return i}if(Object.keys(r).length){let a=1,i=0;for(;e>a;)i+=r[`${a}`]?r[`${a}`]:t,a++;return i}if(Object.keys(n).length){let a=1,i=0;for(;e>a;)i+=n[`${a}`]===0?0:t,a++;return i}return Math.max(0,(e-1)*t)},h5=(e,t,r,n,a)=>{let i=0,s=0;for(;s<e;)s+=a[`${t+i}`]===0?0:n[`${t+i}`]?n[`${t+i}`]:r,i++;return i},p5=(e,t,r,n,a)=>{let i=0,s=0;for(;s<e;)s+=a[`${t+i}`]===0?0:n[`${t+i}`]?n[`${t+i}`]:r,i++;return i},rp=(e,t,r,n,a)=>{let i=0;if(Object.keys(n).length&&Object.keys(a).length){for(const s in Object.keys(n))n.hasOwnProperty(Object.keys(n)[s])&&(i+=n[Object.keys(n)[s]]-r);for(const s in Object.keys(a))a.hasOwnProperty(Object.keys(a)[s])&&(n[Object.keys(a)[s]]?i-=n[Object.keys(a)[s]]:i-=r)}else if(Object.keys(n).length)for(const s in Object.keys(n))n.hasOwnProperty(Object.keys(n)[s])&&(i+=n[Object.keys(n)[s]]-r);else if(Object.keys(a).length)for(const s in Object.keys(a))a.hasOwnProperty(Object.keys(a)[s])&&(i-=r);return e+(t-1)*r+i},v5=(e,t,r,n)=>{let a=0;if(Object.keys(r).length&&Object.keys(n).length){for(const i in Object.keys(r))r.hasOwnProperty(Object.keys(r)[i])&&(a+=r[Object.keys(r)[i]]-t);for(const i in Object.keys(n))n.hasOwnProperty(Object.keys(n)[i])&&(r[Object.keys(n)[i]]?a-=r[Object.keys(n)[i]]:a-=t)}if(Object.keys(r).length)for(const i in Object.keys(r))r.hasOwnProperty(Object.keys(r)[i])&&(a+=r[Object.keys(r)[i]]-t);if(Object.keys(n).length)for(const i in Object.keys(n))n.hasOwnProperty(Object.keys(n)[i])&&(a-=t);return e*t+a},To=(e,t)=>0;function g5(e,t=0,{start:r=!0,middle:n=!0,once:a=!1}={}){let i=0,s,f=!1;function h(...c){if(f)return;const o=Date.now()-i;i=Date.now(),r?(r=!1,e.apply(this,c),a&&h.cancel()):(n&&o<t||!n)&&(clearTimeout(s),s=setTimeout(()=>{i=Date.now(),e.apply(this,c),a&&h.cancel()},n?t-o:t))}return h.cancel=()=>{clearTimeout(s),f=!0},h}function np(e,t=0,{start:r=!1,middle:n=!1,once:a=!1}={}){return g5(e,t,{start:r,middle:n,once:a})}const m5=er.isFirefox?"DOMMouseScroll":"mousewheel",I0=[];function jo(e){const t=e.type===m5;I0.forEach(({type:r,cb:n})=>{(r===e.type||t&&r==="mousewheel")&&n(e)})}const St={on(e,t,r){r&&I0.push({comp:e,type:t,cb:r})},off(e,t){console.log(e,t)},trigger:jo};WN&&document.addEventListener("contextmenu",jo,!1);zN&&(window.addEventListener("mousedown",jo,!1),window.addEventListener("mousewheel",jo,!1));var ap=He({name:"VmaGrid",props:a5,emits:["update:data","change"],setup(e,t){const r=pt("VmaGridHeader"),n=pt("VmaGridBody"),a=pt("VmaGridStylePlugin"),i=pt("VmaGridBorderPlugin"),s=pt("VmaGridAlignPlugin"),f=be(),h=be(),c=be(),o=be(),l=be(),u=be(),d=be(),g=be(),v=be(),y=be(),m=be(),b=be(),E=be(),N=be(),R=be(),C=be(),O=be(),T=be(),A=be(),L=be(),G=be(),H=be(),Y=be(),K=be(),ce=be(),V=be(),W=be(),Q=be(),ie=be(),de=be(),me=be(),Oe=be(),we=be(),Se=be(),J=be(),$=be(),P=be(),k=be(),ge=be(),q=be(),ye=be(),X=be(),M=be(),B=be(),z=be(),re=be(),ne={refColumnResizeBar:f,refRowResizeBar:h,refGrid:c,refGridBody:o,refGridLeftFixedBody:l,refGridLeftFixedBodyScrollWrapper:u,refGridLeftFixedBodyX:g,refGridLeftFixedBodyY:d,refGridBodyX:y,refGridBodyY:v,refGridTopFixedBody:m,refGridBottomFixedBody:b,refGridLeftTopFixedBody:E,refGridBodyTable:N,refGridLeftFixedBodyTable:R,refGridTopFixedBodyTable:C,refGridBottomFixedBodyTable:O,refGridLeftTopFixedBodyTable:T,refGridBodyColgroup:A,refGridLeftFixedBodyColgroup:L,refGridTopFixedBodyColgroup:G,refGridBottomFixedBodyColgroup:H,refGridLeftTopFixedBodyColgroup:Y,refGridHeader:K,refGridLeftFixedHeader:ce,refGridLeftFixedHeaderX:V,refGridHeaderTable:W,refGridLeftFixedHeaderTable:Q,refGridHeaderColgroup:ie,refGridLeftFixedHeaderColgroup:de,refCurrentCellEditor:me,refCurrentCellBorderTop:Oe,refCurrentCellBorderRight:we,refCurrentCellBorderBottom:Se,refCurrentCellBorderLeft:J,refCurrentCellBorderCorner:$,refCurrentAreaBorderTop:P,refCurrentAreaBorderRight:k,refCurrentAreaBorderBottom:ge,refCurrentAreaBorderLeft:q,refCurrentAreaBorderCorner:ye,refGridCtxMenu:X,refColorPicker:M,refStylePlugin:B,refBorderPlugin:z,refAlignPlugin:re},p=kt({loading:!1,dimensionX:0,dimensionY:0,sheets:[],sheet:{},sheetData:[],sheetDataType:"map",sheetConfig:{rh:[],cw:[],rv:[],cv:[]},currentSheetData:[],columnConfigs:[],columnLeftFixedConfigs:[],rowConfigs:[],rowTopFixedConfigs:[],rowBottomFixedConfigs:[],headerColgroup:{},headerLeftFixedColgroup:{},headerTable:{},headerLeftFixedTable:{},bodyTable:[],footerTable:[],gridBodyScrollTop:0,gridBodyScrollLeft:0,overflowX:!1,overflowY:!1,scrollbarWidth:0,scrollbarHeight:0,gridWidth:0,tableWidth:0,gridHeight:0,gridHeaderWidth:0,gridLeftFixedHeaderWidth:0,gridHeaderTableWidth:0,gridHeaderHeight:0,gridLeftFixedHeaderHeight:0,gridHeaderTableHeight:0,gridBodyHeight:0,gridBodyTableHeight:0,gridFooterHeight:0,gridLeftFixedBodyHeight:0,gridLeftFixedBodyWidth:0,columns:{firstList:[],leftList:[],otherList:[]},rows:{topList:[],otherList:[]},cells:{errorMap:{},cycleMap:{},noCycleMap:{}},currentCell:null,currentCellBorderStyle:{transform:"translateX(0) translateY(0)",left:0,top:0,width:0,height:0},currentCellEditorStyle:{transform:"translateX(0) translateY(0)",display:"none",left:0,top:0,width:0,height:0},currentCellEditorActive:!1,currentCellEditorContent:null,currentAreaBorderStyle:{transform:"translateX(0) translateY(0)",left:0,top:0,width:0,height:0},startIndex:0,endIndex:0,startColIndex:0,endColIndex:0,lastScrollLeft:0,lastScrollTop:0,lastScrollTime:0,gridRowsHeightChanged:{},gridColumnsWidthChanged:{},gridRowsVisibleChanged:{},gridColumnsVisibleChanged:{},ctxMenuStore:{selected:null,visible:!1,showChild:!1,selectChild:null,list:[],style:null},currentAreaStatus:!1});let Ee;const x={uId:Ct.create().toString(),props:e,context:t,reactiveData:p,getRefs:()=>ne},pe=xe(()=>Xo(e.gridColumnWidth,e.size)),ue=xe(()=>Pi(e.gridRowHeight,e.size)),Me=xe(()=>Math.max(tp(e.size)+p.endIndex.toString().length*tp(e.size),40)),Ce=(_e,oe,ve)=>_e?oe&&ve?"11":ve?"10":oe?"9":"8":oe&&ve?"3":ve?"2":oe?"1":"0",Pe=()=>{const _e=c.value.clientWidth,oe=c.value.clientHeight,ve=o.value.clientWidth,te=o.value.clientHeight,se=o.value.offsetWidth,F=o.value.offsetHeight,{firstList:_,leftList:I}=p.columns;p.gridWidth=_e,p.gridHeight=oe,p.gridHeaderHeight=W.value.clientHeight,p.gridHeaderTableHeight=p.gridHeaderHeight,p.gridHeaderTableWidth=p.tableWidth,p.gridHeaderWidth=p.gridWidth,p.gridLeftFixedHeaderWidth=_.concat(I).reduce((nt,Le)=>nt+(Le.visible?typeof Le.renderWidth=="string"?pe.value:Le.renderWidth:0),0),p.gridBodyHeight=p.gridHeight-p.gridHeaderHeight,p.overflowX=F>te,p.overflowY=se>ve,p.scrollbarWidth=Math.max(se-ve,0),p.scrollbarHeight=Math.max(F-te,0);const{columnConfigs:Re,scrollbarWidth:We,tableWidth:rt}=p;if(ie.value.children&&ie.value.children.length&&(Array.from(ie.value.children).forEach((nt,Le)=>{const $e=nt.attributes.idx.value;$e===0?nt.style.width=`${Me.value}px`:$e<Re.length?nt.style.width=`${Re[$e].visible?typeof Re[$e].renderWidth=="string"?pe.value:Re[$e].renderWidth:0}px`:nt.style.width=`${We}px`}),Array.from(A.value.children).forEach((nt,Le)=>{const $e=nt.attributes.idx.value;$e===0?nt.style.width=`${Me.value}px`:$e<Re.length&&(nt.style.width=`${Re[$e].visible?typeof Re[$e].renderWidth=="string"?pe.value:Re[$e].renderWidth:0}px`)})),de.value.children&&de.value.children.length&&(Array.from(de.value.children).forEach((nt,Le)=>{const $e=nt.attributes.idx.value;$e===0?nt.style.width=`${Me.value}px`:$e<Re.length?nt.style.width=`${Re[$e].visible?typeof Re[$e].renderWidth=="string"?pe.value:Re[$e].renderWidth:0}px`:nt.style.width=`${We}px`}),Array.from(L.value.children).forEach((nt,Le)=>{const $e=nt.attributes.idx.value;$e===0?nt.style.width=`${Me.value}px`:$e<Re.length&&(nt.style.width=`${Re[$e].visible?typeof Re[$e].renderWidth=="string"?pe.value:Re[$e].renderWidth:0}px`)})),Q.value.style.width=`${rt+We}px`,l.value.style.width=`${p.gridLeftFixedHeaderWidth}px`,l.value.style.height=`${p.gridBodyHeight-p.scrollbarHeight}px`,g.value.style.width=`${rp(Me.value,p.columnConfigs.length,pe.value,p.gridColumnsWidthChanged,p.gridColumnsVisibleChanged)}px`,V.value.style.width=`${rp(Me.value,p.columnConfigs.length,pe.value,p.gridColumnsWidthChanged,p.gridColumnsVisibleChanged)+We}px`,d.value.style.height=`${v5(p.rowConfigs.length,ue.value,p.gridRowsHeightChanged,p.gridRowsVisibleChanged)}px`,y.value.style.width=g.value.style.width,v.value.style.height=d.value.style.height,l.value.style.top=`${p.gridHeaderHeight}px`,N.value&&(N.value.style.width=`${p.tableWidth}px`,R.value.style.width=`${p.tableWidth}px`),W.value&&(W.value.style.width=`${p.tableWidth+p.scrollbarWidth}px`),x.calcCurrentCellPosition(),p.currentArea&&Object.keys(p.currentArea).length>1){const nt=x.reactiveData.currentArea.start.c>x.reactiveData.currentArea.end.c?x.reactiveData.currentArea.end.c:x.reactiveData.currentArea.start.c,Le=x.reactiveData.currentArea.end.c<x.reactiveData.currentArea.start.c?x.reactiveData.currentArea.start.c:x.reactiveData.currentArea.end.c,$e=x.reactiveData.currentArea.start.r>x.reactiveData.currentArea.end.r?x.reactiveData.currentArea.end.r:x.reactiveData.currentArea.start.r,Ze=x.reactiveData.currentArea.end.r<x.reactiveData.currentArea.start.r?x.reactiveData.currentArea.start.r:x.reactiveData.currentArea.end.r;ht(()=>{N.value.querySelectorAll(".cell-active").forEach((yt,tr)=>{yt.classList.remove("cell-active")});for(let yt=$e;yt<=Ze;yt++)for(let tr=nt;tr<=Le;tr++)N.value.querySelectorAll(`td[row="${yt}"][col="${tr+1}"]`).forEach(Sn=>{Sn.classList.add("cell-active")})})}},Ae=()=>{let _e=0;const{firstList:oe,otherList:ve}=p.columns;oe.forEach(te=>{_e+=Me.value,te.renderWidth=Me.value}),ve.forEach(te=>{_e+=te.visible?typeof te.renderWidth=="string"?pe.value:te.renderWidth:0}),p.tableWidth=_e,ht(()=>{Pe()})},fe=()=>{const _e=[],oe=[],ve=[];p.startColIndex!==0&&_e.push(p.columnConfigs[0]);for(let te=p.startColIndex;te<=p.endColIndex&&!(te>p.columnConfigs.length-1);te++){const se=p.columnConfigs[te];te===0?_e.push(se):se.visible&&(ve.push(se),se.fixed==="left"&&oe.push(se))}Object.assign(p.columns,{firstList:_e,leftList:oe,otherList:ve}),ht(()=>{Ae()})},D=()=>{const oe=`${Ra(p.startColIndex,pe.value,p.gridColumnsWidthChanged,p.gridColumnsVisibleChanged)}px`,te=`${Ta(p.startIndex,ue.value,p.gridRowsHeightChanged,p.gridRowsVisibleChanged)}px`;if(N.value&&(N.value.style.transform=`translateX(${oe}) translateY(${te})`,N.value.style.width=`${p.tableWidth}px`,R.value.style.transform=`translateY(${te})`,R.value.style.width=`${p.tableWidth}px`),W.value&&(W.value.style.transform=`translateX(${oe})`,W.value.style.width=`${p.tableWidth+p.scrollbarWidth}px`),p.currentArea&&Object.keys(p.currentArea).length>1){const se=x.reactiveData.currentArea.start.c>x.reactiveData.currentArea.end.c?x.reactiveData.currentArea.end.c:x.reactiveData.currentArea.start.c,F=x.reactiveData.currentArea.end.c<x.reactiveData.currentArea.start.c?x.reactiveData.currentArea.start.c:x.reactiveData.currentArea.end.c,_=x.reactiveData.currentArea.start.r>x.reactiveData.currentArea.end.r?x.reactiveData.currentArea.end.r:x.reactiveData.currentArea.start.r,I=x.reactiveData.currentArea.end.r<x.reactiveData.currentArea.start.r?x.reactiveData.currentArea.start.r:x.reactiveData.currentArea.end.r;ht(()=>{N.value.querySelectorAll(".cell-active").forEach((Re,We)=>{Re.classList.remove("cell-active")});for(let Re=_;Re<=I;Re++)for(let We=se;We<=F;We++)N.value.querySelectorAll(`td[row="${Re}"][col="${We+1}"]`).forEach(rt=>{rt.classList.add("cell-active")})})}},U=_e=>new Promise(oe=>{const ve=_e.scrollLeft,te=d5(ve,pe.value,p.gridColumnsWidthChanged,p.gridColumnsVisibleChanged),se=o.value.clientWidth,F=Math.max(Math.ceil(se/pe.value),h5(se,te,pe.value,p.gridColumnsWidthChanged,p.gridColumnsVisibleChanged)),_={startColIndex:Math.max(0,te+1-5),endColIndex:te+F+1+5},{startColIndex:I,endColIndex:Re}=_,{startColIndex:We,endColIndex:rt}=p;(te<=0||te>=Re-F-1-5)&&(We!==I||rt!==Re)&&(p.startColIndex=I,p.endColIndex=Re,D()),oe()}),ae=_e=>new Promise(oe=>{const ve=_e.scrollTop,te=f5(ve,ue.value,p.gridRowsHeightChanged,p.gridRowsVisibleChanged),se=o.value.clientHeight||c.value.clientHeight,F=Math.max(Math.ceil(se/ue.value),p5(se,te,ue.value,p.gridRowsHeightChanged,p.gridRowsVisibleChanged)),_={startIndex:Math.max(0,te+1-5),endIndex:te+F+1+5},{startIndex:I,endIndex:Re}=_,{startIndex:We,endIndex:rt}=p;(te<=0||te>=Re-F-1-5)&&(We!==I||rt!==Re)&&(p.startIndex=I,p.endIndex=Re,D()),oe()}),Z=np(_e=>{U(_e).then(()=>{fe()})},50),ee=np(_e=>{ae(_e).then(()=>{Pe()})},50),Ne=()=>ht().then(()=>{U(o.value).then(()=>{ae(o.value).then(()=>{fe()})})});Object.assign(x,{updateColumn:(_e,oe,ve)=>{if(_e==="hideColumn"&&(p.columnConfigs[ve].visible=!1,p.gridColumnsVisibleChanged[`${ve-1}`]=0,p.currentCell&&Object.keys(p.currentCell).length>0&&p.currentCell.c===Number(ve)-1&&(p.currentCell={}),x.recalculate(!0).then(()=>{x.calcCurrentCellPosition()})),_e==="showAllColumns"){if(Object.keys(p.gridColumnsVisibleChanged).length)for(const te in Object.keys(p.gridColumnsVisibleChanged))p.gridColumnsVisibleChanged.hasOwnProperty(Object.keys(p.gridColumnsVisibleChanged)[te])&&(p.columnConfigs[parseInt(Object.keys(p.gridColumnsVisibleChanged)[te],10)+1].visible=!0);p.gridColumnsVisibleChanged={},x.recalculate(!0).then(()=>{x.calcCurrentCellPosition()})}if(_e==="showFrontColumns"){if(Object.keys(p.gridColumnsVisibleChanged).length){let te=1;const se=[];for(;p.gridColumnsVisibleChanged.hasOwnProperty(`${Number(ve)-te-1}`);)p.columnConfigs[Number(ve)-te].visible=!0,se.push(`${Number(ve)-te-1}`),te++;const F={};Object.keys(p.gridColumnsVisibleChanged).map(_=>(se.indexOf(_)<0&&(F[_]=p.gridColumnsVisibleChanged[_]),null)),p.gridColumnsVisibleChanged=F}x.recalculate(!0).then(()=>{x.calcCurrentCellPosition()})}if(_e==="showBackColumns"){if(Object.keys(p.gridColumnsVisibleChanged).length){let te=1;const se=[];for(;p.gridColumnsVisibleChanged.hasOwnProperty(`${Number(ve)+te-1}`);)p.columnConfigs[Number(ve)+te].visible=!0,se.push(`${Number(ve)+te-1}`),te++;const F={};Object.keys(p.gridColumnsVisibleChanged).map(_=>(se.indexOf(_)<0&&(F[_]=p.gridColumnsVisibleChanged[_]),null)),p.gridColumnsVisibleChanged=F}x.recalculate(!0).then(()=>{x.calcCurrentCellPosition()})}if(_e==="insertFirstColumn"){if(p.columnConfigs.map(F=>(F.index>=1&&(F.index+=1),F)),p.columnConfigs.splice(1,0,new li(1,null,null,"default",null,!0,!1,"center")),p.currentArea&&Object.keys(p.currentArea).length>1){const F=p.currentArea.start.c>p.currentArea.end.c?p.currentArea.end.c:p.currentArea.start.c,_=p.currentArea.end.c<p.currentArea.start.c?p.currentArea.start.c:p.currentArea.end.c;1-1<=F?(p.currentArea.start.c+=1,p.currentArea.end.c+=1):1-1>F&&1-1<=_&&(p.currentArea.end.c+=1)}const te={};Object.keys(p.gridColumnsVisibleChanged).map(F=>{if(Number(F)>=1){const _=Number(F)+1;te[_]=p.gridColumnsVisibleChanged[F]}else te[F]=p.gridColumnsVisibleChanged[F];return null}),p.gridColumnsVisibleChanged=te;const se={};Object.keys(p.gridColumnsWidthChanged).map(F=>{if(Number(F)>=1){const _=Number(F)+1;se[_]=p.gridColumnsWidthChanged[F]}else se[F]=p.gridColumnsWidthChanged[F];return null}),p.gridColumnsWidthChanged=se,p.currentSheetData.map((F,_)=>(F.map(I=>(I.c>=1-1&&(I.c+=1),null)),F.splice(Number(1-1),0,new Un(_,1-1,null,null,null,!1,null,0,1,1,null,null,!1,!1,!1,!1,!1,null,"0",null,!1,!1,!1,!1,null,null,null)),null)),x.recalculate(!0).then(()=>{x.calc()}).then(()=>{x.calcCurrentCellPosition()})}if(_e==="insertColumnBefore"){if(p.columnConfigs.map(F=>(F.index>=ve&&(F.index+=1),F)),p.columnConfigs.splice(ve,0,new li(Number(ve),null,null,"default",null,!0,!1,"center")),p.currentArea&&Object.keys(p.currentArea).length>1){const F=p.currentArea.start.c>p.currentArea.end.c?p.currentArea.end.c:p.currentArea.start.c,_=p.currentArea.end.c<p.currentArea.start.c?p.currentArea.start.c:p.currentArea.end.c;Number(ve)-1<=F?(p.currentArea.start.c+=1,p.currentArea.end.c+=1):Number(ve)-1>F&&Number(ve)-1<=_&&(p.currentArea.end.c+=1)}const te={};Object.keys(p.gridColumnsVisibleChanged).map(F=>{if(Number(F)>=ve){const _=Number(F)+1;te[_]=p.gridColumnsVisibleChanged[F]}else te[F]=p.gridColumnsVisibleChanged[F];return null}),p.gridColumnsVisibleChanged=te;const se={};Object.keys(p.gridColumnsWidthChanged).map(F=>{if(Number(F)>=ve){const _=Number(F)+1;se[_]=p.gridColumnsWidthChanged[F]}else se[F]=p.gridColumnsWidthChanged[F];return null}),p.gridColumnsWidthChanged=se,p.currentSheetData.map((F,_)=>(F.map(I=>(I.c>=ve-1&&(I.c+=1),null)),F.splice(Number(ve-1),0,new Un(_,Number(ve)-1,null,null,null,!1,null,0,1,1,null,null,!1,!1,!1,!1,!1,null,"0",null,!1,!1,!1,!1,null,null,null)),null)),x.recalculate(!0).then(()=>{x.calc()}).then(()=>{x.calcCurrentCellPosition()})}if(_e==="insertColumnAfter"){if(p.columnConfigs.map(F=>(F.index>ve&&(F.index+=1),F)),p.columnConfigs.splice(Number(ve)+1,0,new li(Number(ve)+1,null,null,"default",null,!0,!1,"center")),p.currentArea&&Object.keys(p.currentArea).length>1){const F=p.currentArea.start.c>p.currentArea.end.c?p.currentArea.end.c:p.currentArea.start.c,_=p.currentArea.end.c<p.currentArea.start.c?p.currentArea.start.c:p.currentArea.end.c;Number(ve)-1<F?(p.currentArea.start.c+=1,p.currentArea.end.c+=1):Number(ve)-1>=F&&Number(ve)-1<_&&(p.currentArea.end.c+=1)}const te={};Object.keys(p.gridColumnsVisibleChanged).map(F=>{if(Number(F)>=ve){const _=Number(F)+1;te[_]=p.gridColumnsVisibleChanged[F]}else te[F]=p.gridColumnsVisibleChanged[F];return null}),p.gridColumnsVisibleChanged=te;const se={};Object.keys(p.gridColumnsWidthChanged).map(F=>{if(Number(F)>ve){const _=Number(F)+1;se[_]=p.gridColumnsWidthChanged[F]}else se[F]=p.gridColumnsWidthChanged[F];return null}),p.gridColumnsWidthChanged=se,p.currentSheetData.map((F,_)=>(F.map(I=>(I.c>ve-1&&(I.c+=1),null)),F.splice(Number(ve),0,new Un(_,Number(ve),null,null,null,!1,null,0,1,1,null,null,!1,!1,!1,!1,!1,null,"0",null,!1,!1,!1,!1,null,null,null)),null)),x.recalculate(!0).then(()=>{x.calc()}).then(()=>{x.calcCurrentCellPosition()})}if(_e==="deleteColumn"){if(p.columnConfigs.splice(Number(ve),1),p.columnConfigs.map(F=>(F.index>ve&&(F.index-=1),F)),p.currentArea&&Object.keys(p.currentArea).length>1){const F=p.currentArea.start.c>p.currentArea.end.c?p.currentArea.end.c:p.currentArea.start.c,_=p.currentArea.end.c<p.currentArea.start.c?p.currentArea.start.c:p.currentArea.end.c;Number(ve)-1<F?(p.currentArea.start.c-=1,p.currentArea.end.c-=1):Number(ve)-1>=F&&Number(ve)-1<=_&&(p.currentArea.end.c-=1)}const te={};Object.keys(p.gridColumnsVisibleChanged).map(F=>{if(Number(F)!==Number(ve)-1)if(Number(F)>=Number(ve)){const _=Number(F)-1;te[_]=p.gridColumnsVisibleChanged[F]}else te[F]=p.gridColumnsVisibleChanged[F];return null}),p.gridColumnsVisibleChanged=te;const se={};if(Object.keys(p.gridColumnsWidthChanged).map(F=>{if(Number(F)!==Number(ve))if(Number(F)>=Number(ve)){const _=Number(F)-1;se[_]=p.gridColumnsWidthChanged[F]}else se[F]=p.gridColumnsWidthChanged[F];return null}),p.gridColumnsWidthChanged=se,p.currentSheetData.map((F,_)=>(F.splice(Number(ve)-1,1),F.map(I=>(I.c>ve-1&&(I.c-=1),null)),null)),p.currentCell&&Object.keys(p.currentCell).length>0){const{c:F}=p.currentCell;F===Number(ve)-1&&(p.currentCell={})}x.recalculate(!0).then(()=>{x.calc()}).then(()=>{x.calcCurrentCellPosition()})}},updateRow:(_e,oe,ve)=>{if(_e==="hideRow"&&(p.rowConfigs[oe].visible=!1,p.gridRowsVisibleChanged[`${oe}`]=0,p.currentCell&&Object.keys(p.currentCell).length>0&&p.currentCell.r===Number(oe)&&(p.currentCell={}),x.recalculate(!0).then(()=>{x.calcCurrentCellPosition()})),_e==="showAllRows"){if(Object.keys(p.gridRowsVisibleChanged).length)for(const te in Object.keys(p.gridRowsVisibleChanged))p.gridRowsVisibleChanged.hasOwnProperty(Object.keys(p.gridRowsVisibleChanged)[te])&&(p.rowConfigs[parseInt(Object.keys(p.gridRowsVisibleChanged)[te],10)].visible=!0);p.gridRowsVisibleChanged={},x.recalculate(!0).then(()=>{x.calcCurrentCellPosition()})}if(_e==="showUpRows"){if(Object.keys(p.gridRowsVisibleChanged).length){let te=1;const se=[];for(;p.gridRowsVisibleChanged.hasOwnProperty(`${Number(oe)-te}`);)p.rowConfigs[Number(oe)-te].visible=!0,se.push(`${Number(oe)-te}`),te++;const F={};Object.keys(p.gridRowsVisibleChanged).map(_=>(se.indexOf(_)<0&&(F[_]=p.gridRowsVisibleChanged[_]),null)),p.gridRowsVisibleChanged=F}x.recalculate(!0).then(()=>{x.calcCurrentCellPosition()})}if(_e==="showDownRows"){if(Object.keys(p.gridRowsVisibleChanged).length){let te=1;const se=[];for(;p.gridRowsVisibleChanged.hasOwnProperty(`${Number(oe)+te}`);)p.rowConfigs[Number(oe)+te].visible=!0,se.push(`${Number(oe)+te}`),te++;const F={};Object.keys(p.gridRowsVisibleChanged).map(_=>(se.indexOf(_)<0&&(F[_]=p.gridRowsVisibleChanged[_]),null)),p.gridRowsVisibleChanged=F}x.recalculate(!0).then(()=>{x.calcCurrentCellPosition()})}if(_e==="insertFirstRow"){if(p.rowConfigs.map(_=>(_.index>=0&&(_.index+=1),_)),p.rowConfigs.splice(0,0,new Ao(0,null,null,"default",null,!0,!1,"center")),p.currentArea&&Object.keys(p.currentArea).length>1){const _=p.currentArea.start.r>p.currentArea.end.r?p.currentArea.end.r:p.currentArea.start.r,I=p.currentArea.end.r<p.currentArea.start.r?p.currentArea.start.r:p.currentArea.end.r;_>=0?(p.currentArea.start.r+=1,p.currentArea.end.r+=1):Number(oe)>_&&Number(oe)<=I&&(p.currentArea.end.r+=1)}const te={};Object.keys(p.gridRowsVisibleChanged).map(_=>{if(Number(_)>=0){const I=Number(_)+1;te[I]=p.gridRowsVisibleChanged[_]}else te[_]=p.gridRowsVisibleChanged[_];return null}),p.gridRowsVisibleChanged=te;const se={};Object.keys(p.gridRowsHeightChanged).map(_=>{if(Number(_)>=0){const I=Number(_)+1;se[I]=p.gridRowsHeightChanged[_]}else se[_]=p.gridRowsHeightChanged[_];return null}),p.gridRowsHeightChanged=se,p.currentSheetData.map((_,I)=>(_.map(Re=>(Re.r>=0&&(Re.r+=1),null)),null));const F=[];for(let _=0;_<p.columnConfigs.length-1;_++)F.push(new Un(0,_,null,null,null,!1,null,0,1,1,null,null,!1,!1,!1,!1,!1,null,"0",null,!1,!1,!1,!1,null,null,null));p.currentSheetData.splice(0,0,F),x.recalculate(!0).then(()=>{x.calc()}).then(()=>{x.calcCurrentCellPosition()})}if(_e==="insertRowBefore"){if(p.rowConfigs.map(_=>(_.index>=oe&&(_.index+=1),_)),p.rowConfigs.splice(oe,0,new Ao(Number(oe),null,null,"default",null,!0,!1,"center")),p.currentArea&&Object.keys(p.currentArea).length>1){const _=p.currentArea.start.r>p.currentArea.end.r?p.currentArea.end.r:p.currentArea.start.r,I=p.currentArea.end.r<p.currentArea.start.r?p.currentArea.start.r:p.currentArea.end.r;Number(oe)<=_?(p.currentArea.start.r+=1,p.currentArea.end.r+=1):Number(oe)>_&&Number(oe)<=I&&(p.currentArea.end.r+=1)}const te={};Object.keys(p.gridRowsVisibleChanged).map(_=>{if(Number(_)>=oe){const I=Number(_)+1;te[I]=p.gridRowsVisibleChanged[_]}else te[_]=p.gridRowsVisibleChanged[_];return null}),p.gridRowsVisibleChanged=te;const se={};Object.keys(p.gridRowsHeightChanged).map(_=>{if(Number(_)>=oe){const I=Number(_)+1;se[I]=p.gridRowsHeightChanged[_]}else se[_]=p.gridRowsHeightChanged[_];return null}),p.gridRowsHeightChanged=se,p.currentSheetData.map((_,I)=>(_.map(Re=>(Re.r>=oe&&(Re.r+=1),null)),null));const F=[];for(let _=0;_<p.columnConfigs.length-1;_++)F.push(new Un(Number(oe),_,null,null,null,!1,null,0,1,1,null,null,!1,!1,!1,!1,!1,null,"0",null,!1,!1,!1,!1,null,null,null));p.currentSheetData.splice(Number(oe),0,F),x.recalculate(!0).then(()=>{x.calc()}).then(()=>{x.calcCurrentCellPosition()})}if(_e==="insertRowAfter"){if(p.rowConfigs.map(_=>(_.index>oe&&(_.index+=1),_)),p.rowConfigs.splice(Number(oe)+1,0,new Ao(Number(oe)+1,null,null,"default",null,!0,!1,"center")),p.currentArea&&Object.keys(p.currentArea).length>1){const _=p.currentArea.start.r>p.currentArea.end.r?p.currentArea.end.r:p.currentArea.start.r,I=p.currentArea.end.r<p.currentArea.start.r?p.currentArea.start.r:p.currentArea.end.r;Number(oe)<_?(p.currentArea.start.r+=1,p.currentArea.end.r+=1):Number(oe)>=_&&Number(oe)<=I&&(p.currentArea.end.r+=1)}const te={};Object.keys(p.gridRowsVisibleChanged).map(_=>{if(Number(_)>oe){const I=Number(_)+1;te[I]=p.gridRowsVisibleChanged[_]}else te[_]=p.gridRowsVisibleChanged[_];return null}),p.gridRowsVisibleChanged=te;const se={};Object.keys(p.gridRowsHeightChanged).map(_=>{if(Number(_)>oe){const I=Number(_)+1;se[I]=p.gridRowsHeightChanged[_]}else se[_]=p.gridRowsHeightChanged[_];return null}),p.gridRowsHeightChanged=se,p.currentSheetData.map((_,I)=>(_.map(Re=>(Re.r>oe&&(Re.r+=1),null)),null));const F=[];for(let _=0;_<p.columnConfigs.length-1;_++)F.push(new Un(Number(oe)+1,_,null,null,null,!1,null,0,1,1,null,null,!1,!1,!1,!1,!1,null,"0",null,!1,!1,!1,!1,null,null,null));p.currentSheetData.splice(Number(oe)+1,0,F),x.recalculate(!0).then(()=>{x.calc()}).then(()=>{x.calcCurrentCellPosition()})}if(_e==="deleteRow"){if(p.rowConfigs.splice(Number(oe),1),p.rowConfigs.map(F=>(F.index>oe&&(F.index-=1),F)),p.currentArea&&Object.keys(p.currentArea).length>1){const F=p.currentArea.start.r>p.currentArea.end.r?p.currentArea.end.r:p.currentArea.start.r,_=p.currentArea.end.r<p.currentArea.start.r?p.currentArea.start.r:p.currentArea.end.r;Number(oe)<F?(p.currentArea.start.r-=1,p.currentArea.end.r-=1):Number(oe)>=F&&Number(oe)<=_&&(p.currentArea.end.r-=1)}const te={};Object.keys(p.gridRowsVisibleChanged).map(F=>{if(Number(F)!==Number(oe))if(Number(F)>Number(oe)){const _=Number(F)-1;te[_]=p.gridRowsVisibleChanged[F]}else te[F]=p.gridRowsVisibleChanged[F];return null}),p.gridRowsVisibleChanged=te;const se={};if(Object.keys(p.gridRowsHeightChanged).map(F=>{if(Number(F)!==Number(oe))if(Number(F)>Number(oe)){const _=Number(F)-1;se[_]=p.gridRowsHeightChanged[F]}else se[F]=p.gridRowsHeightChanged[F];return null}),p.gridRowsHeightChanged=se,p.currentSheetData.map((F,_)=>(F.map(I=>(I.r>oe&&(I.r-=1),null)),null)),p.currentSheetData.splice(Number(oe),1),p.currentCell&&Object.keys(p.currentCell).length>0){const{r:F}=p.currentCell;F===Number(oe)&&(p.currentCell={})}x.recalculate(!0).then(()=>{x.calc()}).then(()=>{x.calcCurrentCellPosition()})}},updateCell:(_e,oe,ve,te,se,F)=>{if(_e==="cellFrontColor")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].fc=F;if(_e==="cellBackColor")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].bg=F,p.currentSheetData[Number(_)][Number(I)].bgt=Ce(!!p.currentSheetData[Number(_)][Number(I)].bg,!!p.currentSheetData[Number(_)][Number(I)].bdb||p.currentSheetData[Number(_)][Number(I)+1]&&!!p.currentSheetData[Number(_)][Number(I)+1].bdt,!!p.currentSheetData[Number(_)][Number(I)].bdr||p.currentSheetData[Number(_)][Number(I)+1]&&!!p.currentSheetData[Number(_)][Number(I)+1].bdl);if(_e==="updateCellFontSize")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].fs=Number(F);if(_e==="updateCellFontFamily")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].ff=F;if(_e==="updateCellFontStyle"){if(F==="bl"){const _=p.currentCell.bl;for(let I=Number(oe);I<=Number(te);I++)for(let Re=Number(ve)-1;Re<=Number(se)-1;Re++)p.currentSheetData[Number(I)][Number(Re)].bl=!_}if(F==="it"){const _=p.currentCell.it;for(let I=Number(oe);I<=Number(te);I++)for(let Re=Number(ve)-1;Re<=Number(se)-1;Re++)p.currentSheetData[Number(I)][Number(Re)].it=!_}if(F==="ol"){const _=p.currentCell.ol;for(let I=Number(oe);I<=Number(te);I++)for(let Re=Number(ve)-1;Re<=Number(se)-1;Re++)p.currentSheetData[Number(I)][Number(Re)].ol=!_}if(F==="cl"){const _=p.currentCell.cl;for(let I=Number(oe);I<=Number(te);I++)for(let Re=Number(ve)-1;Re<=Number(se)-1;Re++)p.currentSheetData[Number(I)][Number(Re)].cl=!_}if(F==="ul"){const _=p.currentCell.ul;for(let I=Number(oe);I<=Number(te);I++)for(let Re=Number(ve)-1;Re<=Number(se)-1;Re++)p.currentSheetData[Number(I)][Number(Re)].ul=!_}}if(_e==="updateCellBorder"){if(F==="top"||F==="out"||F==="all"||F==="none"){p.currentCell.bdt;for(let _=Number(oe)-1;_<=Number(oe);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(oe)][Number(I)].bdt=F!=="none",Number(_)>=0&&(p.currentSheetData[Number(_)][Number(I)].bgt=Ce(!!p.currentSheetData[Number(_)][Number(I)].bg,!!p.currentSheetData[Number(_)][Number(I)].bdb||(Number(_)+1<p.rowConfigs.length?!!p.currentSheetData[Number(_)+1][Number(I)].bdt:!1),!!p.currentSheetData[Number(_)][Number(I)].bdr||(Number(I)+1<p.columnConfigs.length-1?!!p.currentSheetData[Number(_)][Number(I)+1].bdl:!1)))}if(F==="bottom"||F==="out"||F==="all"||F==="none"){p.currentCell.bdb;for(let _=Number(te);_<=Number(te)+1;_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(te)][Number(I)].bdb=F!=="none",_<p.rowConfigs.length&&(p.currentSheetData[Number(_)][Number(I)].bgt=Ce(!!p.currentSheetData[Number(_)][Number(I)].bg,!!p.currentSheetData[Number(_)][Number(I)].bdb||(Number(_)+1<p.rowConfigs.length?!!p.currentSheetData[Number(_)+1][Number(I)].bdt:!1),!!p.currentSheetData[Number(_)][Number(I)].bdr||(Number(I)+1<p.columnConfigs.length-1?!!p.currentSheetData[Number(_)][Number(I)+1].bdl:!1)))}if(F==="left"||F==="out"||F==="all"||F==="none"){p.currentCell.bdl;for(let _=Number(oe);_<=Number(te);_++){p.currentSheetData[Number(_)][Number(Number(ve)-1)].bdl=F!=="none";for(let I=Number(ve)-1-1;I<=Number(ve)-1;I++)Number(I)>=0&&(p.currentSheetData[Number(_)][Number(I)].bgt=Ce(!!p.currentSheetData[Number(_)][Number(I)].bg,!!p.currentSheetData[Number(_)][Number(I)].bdb||(Number(_)+1<p.rowConfigs.length?!!p.currentSheetData[Number(_)+1][Number(I)].bdt:!1),!!p.currentSheetData[Number(_)][Number(I)].bdr||(Number(I)+1<p.columnConfigs.length-1?!!p.currentSheetData[Number(_)][Number(I)+1].bdl:!1)))}}if(F==="right"||F==="out"||F==="all"||F==="none"){p.currentCell.bdr;for(let _=Number(oe);_<=Number(te);_++){p.currentSheetData[Number(_)][Number(se)-1].bdr=F!=="none";for(let I=Number(se)-1;I<=Number(se)-1+1;I++)I<p.columnConfigs.length-1&&(p.currentSheetData[Number(_)][Number(I)].bgt=Ce(!!p.currentSheetData[Number(_)][Number(I)].bg,!!p.currentSheetData[Number(_)][Number(I)].bdb||(Number(_)+1<p.rowConfigs.length?!!p.currentSheetData[Number(_)+1][Number(I)].bdt:!1),!!p.currentSheetData[Number(_)][Number(I)].bdr||(Number(I)+1<p.columnConfigs.length-1?!!p.currentSheetData[Number(_)][Number(I)+1].bdl:!1)))}}if(F==="inner"||F==="all"||F==="none"){for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].bdt=F!=="none",Number(_)>=0&&(p.currentSheetData[Number(_)][Number(I)].bgt=Ce(!!p.currentSheetData[Number(_)][Number(I)].bg,!!p.currentSheetData[Number(_)][Number(I)].bdb||(Number(_)+1<p.rowConfigs.length?!!p.currentSheetData[Number(_)+1][Number(I)].bdt:!1),!!p.currentSheetData[Number(_)][Number(I)].bdr||(Number(I)+1<p.columnConfigs.length-1?!!p.currentSheetData[Number(_)][Number(I)+1].bdl:!1)));for(let _=Number(oe);_<=Number(te)-1;_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].bdb=F!=="none",_<p.rowConfigs.length&&(p.currentSheetData[Number(_)][Number(I)].bgt=Ce(!!p.currentSheetData[Number(_)][Number(I)].bg,!!p.currentSheetData[Number(_)][Number(I)].bdb||(Number(_)+1<p.rowConfigs.length?!!p.currentSheetData[Number(_)+1][Number(I)].bdt:!1),!!p.currentSheetData[Number(_)][Number(I)].bdr||(Number(I)+1<p.columnConfigs.length-1?!!p.currentSheetData[Number(_)][Number(I)+1].bdl:!1)));for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].bdl=F!=="none",Number(I)>=0&&(p.currentSheetData[Number(_)][Number(I)].bgt=Ce(!!p.currentSheetData[Number(_)][Number(I)].bg,!!p.currentSheetData[Number(_)][Number(I)].bdb||(Number(_)+1<p.rowConfigs.length?!!p.currentSheetData[Number(_)+1][Number(I)].bdt:!1),!!p.currentSheetData[Number(_)][Number(I)].bdr||(Number(I)+1<p.columnConfigs.length-1?!!p.currentSheetData[Number(_)][Number(I)+1].bdl:!1)));for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1-1;I++)p.currentSheetData[Number(_)][Number(I)].bdr=F!=="none",I<p.columnConfigs.length-1&&(p.currentSheetData[Number(_)][Number(I)].bgt=Ce(!!p.currentSheetData[Number(_)][Number(I)].bg,!!p.currentSheetData[Number(_)][Number(I)].bdb||(Number(_)+1<p.rowConfigs.length?!!p.currentSheetData[Number(_)+1][Number(I)].bdt:!1),!!p.currentSheetData[Number(_)][Number(I)].bdr||(Number(I)+1<p.columnConfigs.length-1?!!p.currentSheetData[Number(_)][Number(I)+1].bdl:!1)))}if(p.currentArea&&Object.keys(p.currentArea).length>1){const _=x.reactiveData.currentArea.start.c>x.reactiveData.currentArea.end.c?x.reactiveData.currentArea.end.c:x.reactiveData.currentArea.start.c,I=x.reactiveData.currentArea.end.c<x.reactiveData.currentArea.start.c?x.reactiveData.currentArea.start.c:x.reactiveData.currentArea.end.c,Re=x.reactiveData.currentArea.start.r>x.reactiveData.currentArea.end.r?x.reactiveData.currentArea.end.r:x.reactiveData.currentArea.start.r,We=x.reactiveData.currentArea.end.r<x.reactiveData.currentArea.start.r?x.reactiveData.currentArea.start.r:x.reactiveData.currentArea.end.r;ht(()=>{N.value.querySelectorAll(".cell-active").forEach((rt,nt)=>{rt.classList.remove("cell-active")});for(let rt=Re;rt<=We;rt++)for(let nt=_;nt<=I;nt++)N.value.querySelectorAll(`td[row="${rt}"][col="${nt+1}"]`).forEach(Le=>{Le.classList.add("cell-active")})})}}if(_e==="updateCellAlign"){if(F==="avt")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].av="top";if(F==="avm")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].av="middle";if(F==="avb")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].av="bottom";if(F==="ahl")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].ah="left";if(F==="ahc")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].ah="center";if(F==="ahr")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].ah="right"}if(_e==="updateCellFormat"){if(F==="general")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].cf={fd:"",t:"g"};if(F==="date")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].cf={fd:"yyyy-mm-dd",t:"dd"};if(F==="time")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].cf={fd:"hh:mm:ss",t:"dt"};if(F==="fraction")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].cf={fd:"0/00",t:"df"};if(F==="scientific-notation")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].cf={fd:"0.00E+0",t:"ds"};if(F==="number")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].cf={fd:"#,##0.00;-#,##0.00;0",t:"dn"};if(F==="string")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].cf={fd:"@",t:"s"};if(F==="percent")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].cf={fd:"#,##0.00%",t:"dp"}}if(_e==="updateCellFastFormat"){if(F==="decimal-places-add"){for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)if(p.currentSheetData[Number(_)][Number(I)].cf&&p.currentSheetData[Number(_)][Number(I)].cf.t&&(p.currentSheetData[Number(_)][Number(I)].cf.t==="dp"||p.currentSheetData[Number(_)][Number(I)].cf.t==="ds"||p.currentSheetData[Number(_)][Number(I)].cf.t==="dn")&&new RegExp("0[.]*[0]*[;,%E]","g").test(p.currentSheetData[Number(_)][Number(I)].cf.fd)){if(console.log(p.currentSheetData[Number(_)][Number(I)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0]),p.currentSheetData[Number(_)][Number(I)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0].length===2){const We=p.currentSheetData[Number(_)][Number(I)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0],rt=`${We.slice(0,1)}.0${We.slice(1)}`;p.currentSheetData[Number(_)][Number(I)].cf.fd=p.currentSheetData[Number(_)][Number(I)].cf.fd.replaceAll(We,rt)}else if(p.currentSheetData[Number(_)][Number(I)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0].length>2){const We=p.currentSheetData[Number(_)][Number(I)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0];console.log(We);const rt=`${We.slice(0,p.currentSheetData[Number(_)][Number(I)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0].length-1)}0${We.slice(p.currentSheetData[Number(_)][Number(I)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0].length-1)}`;console.log(rt),p.currentSheetData[Number(_)][Number(I)].cf.fd=p.currentSheetData[Number(_)][Number(I)].cf.fd.replaceAll(We,rt)}}}if(F==="decimal-places-reduce"){for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)if(p.currentSheetData[Number(_)][Number(I)].cf&&p.currentSheetData[Number(_)][Number(I)].cf.t&&(p.currentSheetData[Number(_)][Number(I)].cf.t==="dp"||p.currentSheetData[Number(_)][Number(I)].cf.t==="ds"||p.currentSheetData[Number(_)][Number(I)].cf.t==="dn")&&new RegExp("0[.]*[0]*[;,%E]","g").test(p.currentSheetData[Number(_)][Number(I)].cf.fd)&&p.currentSheetData[Number(_)][Number(I)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0].length>3){const We=p.currentSheetData[Number(_)][Number(I)].cf.fd.match(/0[.]*[0]*[;,%E]/g)[0];let rt=We.slice(0,We.length-2)+We.slice(We.length-1,We.length);rt.length===3&&(rt=rt.slice(0,1)+rt.slice(2)),p.currentSheetData[Number(_)][Number(I)].cf.fd=p.currentSheetData[Number(_)][Number(I)].cf.fd.replaceAll(We,rt)}}if(F==="thousandths")for(let _=Number(oe);_<=Number(te);_++)for(let I=Number(ve)-1;I<=Number(se)-1;I++)p.currentSheetData[Number(_)][Number(I)].cf&&p.currentSheetData[Number(_)][Number(I)].cf.t&&(p.currentSheetData[Number(_)][Number(I)].cf.t==="dn"||p.currentSheetData[Number(_)][Number(I)].cf.t==="dp")&&(p.currentSheetData[Number(_)][Number(I)].cf.t==="dn"&&(p.currentSheetData[Number(_)][Number(I)].cf.fd.indexOf(",")>=0?p.currentSheetData[Number(_)][Number(I)].cf.fd=p.currentSheetData[Number(_)][Number(I)].cf.fd.replaceAll(",",""):p.currentSheetData[Number(_)][Number(I)].cf.fd=p.currentSheetData[Number(_)][Number(I)].cf.fd.replaceAll("###","#,##")),p.currentSheetData[Number(_)][Number(I)].cf.t==="dp"&&(p.currentSheetData[Number(_)][Number(I)].cf.fd.indexOf(",")>=0?p.currentSheetData[Number(_)][Number(I)].cf.fd=p.currentSheetData[Number(_)][Number(I)].cf.fd.replaceAll(",",""):p.currentSheetData[Number(_)][Number(I)].cf.fd=p.currentSheetData[Number(_)][Number(I)].cf.fd.replaceAll("###","#,##")))}},getCell:(_e,oe,ve)=>_e==="cellFrontColor"?p.currentSheetData[Number(oe)][Number(ve)-1].fc:_e==="cellBackColor"?p.currentSheetData[Number(oe)][Number(ve)-1].bg:null,calcCurrentCellDisplay:()=>{if(p.currentCell){const{r:_e,c:oe}=p.currentCell;_e<=p.endIndex&&_e>=p.startIndex&&oe<=p.endColIndex&&oe>=p.startColIndex&&p.currentCellEditorActive?p.currentCellEditorStyle.display="block":p.currentCellEditorStyle.display="none"}else p.currentCellEditorStyle.display="none"},calcCurrentCellPosition:()=>{if(p.currentCell){const _e=Ra(p.startColIndex,pe.value,p.gridColumnsWidthChanged,p.gridColumnsVisibleChanged),oe=Ta(p.startIndex,ue.value,p.gridRowsHeightChanged,p.gridRowsVisibleChanged);ht(()=>{const{r:ve,c:te}=p.currentCell;N.value.querySelectorAll(`td[row="${ve}"][col="${te+1}"]`).forEach(se=>{const F=`${_e+se.offsetLeft}px`,_=`${oe+se.offsetTop}px`,I=`${_e+se.offsetLeft-1}px`,Re=`${oe+se.offsetTop-1}px`;p.currentCellEditorStyle.transform=`translateX(${F}) translateY(${_})`,p.currentCellEditorStyle.height=`${se.offsetHeight}px`,p.currentCellEditorStyle.width=`${se.offsetWidth}px`,p.currentCellBorderStyle.transform=`translateX(${I}) translateY(${Re})`,p.currentCellBorderStyle.height=`${se.offsetHeight}px`,p.currentCellBorderStyle.width=`${se.offsetWidth}px`})})}if(p.currentArea&&Object.keys(p.currentArea).length>1){const _e=x.reactiveData.currentArea.start.c>x.reactiveData.currentArea.end.c?x.reactiveData.currentArea.end.c:x.reactiveData.currentArea.start.c,oe=x.reactiveData.currentArea.end.c<x.reactiveData.currentArea.start.c?x.reactiveData.currentArea.start.c:x.reactiveData.currentArea.end.c,ve=x.reactiveData.currentArea.start.r>x.reactiveData.currentArea.end.r?x.reactiveData.currentArea.end.r:x.reactiveData.currentArea.start.r,te=x.reactiveData.currentArea.end.r<x.reactiveData.currentArea.start.r?x.reactiveData.currentArea.start.r:x.reactiveData.currentArea.end.r,se=Ra(p.startColIndex,pe.value,p.gridColumnsWidthChanged,p.gridColumnsVisibleChanged),F=Ta(p.startIndex,ue.value,p.gridRowsHeightChanged,p.gridRowsVisibleChanged);ht(()=>{N.value.querySelectorAll(`td[row="${ve}"][col="${_e+1}"]`).forEach(_=>{const I=`${se+_.offsetLeft-1}px`,Re=`${F+_.offsetTop-1}px`;p.currentAreaBorderStyle.transform=`translateX(${I}) translateY(${Re})`;const We=Tc(_e,oe,pe.value,x.reactiveData.gridColumnsWidthChanged,x.reactiveData.gridColumnsVisibleChanged),rt=Cc(ve,te,ue.value,x.reactiveData.gridRowsHeightChanged,x.reactiveData.gridRowsVisibleChanged);x.reactiveData.currentAreaBorderStyle.height=`${rt}px`,x.reactiveData.currentAreaBorderStyle.width=`${We}px`})})}},triggerScrollXEvent:_e=>{const oe=_e.currentTarget||_e.target;Z(oe)},triggerScrollYEvent:_e=>{const oe=_e.currentTarget||_e.target;ee(oe)},recalculate:_e=>(fe(),_e?Ne().then(()=>(fe(),Ne())):Ne()),getParentElem(){const _e=c.value;if(x){const oe=x.getRefs().refGrid.value;return oe?oe.parentNode:null}return _e?_e.parentNode:null},calc:()=>{const _e=[];p.cells.errorMap={},p.cells.cycleMap={},p.cells.noCycleMap={};const oe={row:1,col:1,sheet:p.sheet.name},ve=new n5({}),te=[];p.currentSheetData.forEach(Le=>{Le.forEach($e=>{let Ze=!1,yt=!0,tr=null,Sn=null;if($e&&$e.v&&typeof $e.v=="string"&&$e.v.trim().startsWith("=")){Ze=!0,tr="#DEPPARSEERROR!";try{Sn=ve.parse($e.v.trim().substring(1),oe),yt=!1,tr=null}catch{console.error(`parse error: ${$e.c-1}_${$e.r}`)}yt&&te.push(`${$e.c-1}_${$e.r}`),Sn!==null&&Sn.find(zu=>zu.row>p.rowConfigs.length||zu.col>p.columnConfigs.length)&&(tr="#REFERROR!",te.push(`${$e.c-1}_${$e.r}`),yt=!0,Sn=null),$e.mv=Ze?yt?tr:null:$e&&$e.v?$e.v:null,$e.fd=Ze?yt?null:Sn:null,$e.se=tr,_e.push($e)}else $e.mv=$e.v})});const se={};_e.forEach(Le=>{te.indexOf(`${Le.c}_${Le.r}`)>=0?p.cells.errorMap[`${Le.c}_${Le.r}`]={c:Le.c,r:Le.r,children:[],ref:Le}:(se[`${Le.c}_${Le.r}`]={c:Le.c,r:Le.r,children:[],ref:Le},Le.fd&&Le.fd.length>0&&Le.fd.forEach($e=>{if($e.hasOwnProperty("from")||$e.hasOwnProperty("to"))for(let Ze=$e.from.row;Ze<=$e.to.row;Ze++)for(let yt=$e.from.col;yt<=$e.to.col;yt++)se.hasOwnProperty(`${yt-1}_${Ze-1}`)||te.indexOf(`${yt-1}_${Ze-1}`)<0&&(se[`${yt-1}_${Ze-1}`]={c:yt-1,r:Ze-1,children:[],ref:p.currentSheetData[Ze-1][yt-1]}),se[`${Le.c}_${Le.r}`].children.indexOf(`${yt-1}_${Ze-1}`)<0&&se[`${Le.c}_${Le.r}`].children.push(`${yt-1}_${Ze-1}`);else se.hasOwnProperty(`${$e.col-1}_${$e.row-1}`)||te.indexOf(`${$e.col-1}_${$e.row-1}`)<0&&(se[`${$e.col-1}_${$e.row-1}`]={c:$e.col-1,r:$e.row-1,children:[],ref:p.currentSheetData[$e.row-1][$e.col-1]}),se[`${Le.c}_${Le.r}`].children.indexOf(`${$e.col-1}_${$e.row-1}`)<0&&se[`${Le.c}_${Le.r}`].children.push(`${$e.col-1}_${$e.row-1}`)}))}),console.time("filterVertexes");const{noErrorVertexes:F}=O0(se,p.cells.errorMap),_=Object.keys(p.cells.errorMap);if(_.length>0)for(let Le=0;Le<_.length;Le++)p.cells.errorMap[_[Le]].ref.se!==null?p.cells.errorMap[_[Le]].ref.mv=p.cells.errorMap[_[Le]].ref.se:(p.cells.errorMap[_[Le]].ref.mv="#REFERROR!",p.cells.errorMap[_[Le]].ref.se="#REFERROR!");const{topological:I,noCycleVertexes:Re,cycleVertexes:We}=w0(F,{});p.cells.cycleMap=We,p.cells.noCycleMap=Re;const rt=Object.keys(We);for(let Le=0;Le<rt.length;Le++)We[rt[Le]].ref.mv="#CYCLEERROR!";const nt=new r5({functions:e.functions,onCell:Le=>p.currentSheetData[Le.row-1][Le.col-1].mv,onRange:Le=>{const $e=[];for(let Ze=Le.from.row-1;Ze<Le.to.row;Ze++){const yt=[];for(let tr=Le.from.col-1;tr<Le.to.col;tr++)yt.push(p.currentSheetData[Ze][tr].mv);$e.push(yt)}return $e}});for(let Le=0;Le<I.length;Le++)if(Re[I[Le]]&&Re[I[Le]].ref&&Re[I[Le]].ref.v&&typeof Re[I[Le]].ref.v=="string"&&Re[I[Le]].ref.v.trim().startsWith("=")){let $e=!0;try{let Ze=nt.parse(Re[I[Le]].ref.v.trim().substring(1),{row:1,col:1});Ze&&Ze.result&&(Ze=Ze.result),typeof Ze=="number"||typeof Ze=="string"?Re[I[Le]].ref.mv=Ze:Re[I[Le]].ref.mv=`${Ze}`,$e=!1}catch(Ze){console.error(I[Le],Ze)}$e&&(Re[I[Le]].ref.mv="#ERROR!",Re[I[Le]].ref.se="#ERROR!")}console.timeEnd("filterVertexes")}}),fs.hooks.forEach(_e=>{if(_e.setupGrid){const oe=_e.setupGrid(x);oe&&typeof oe=="object"&&Object.assign(x,oe)}});const Ge=()=>new Promise(_e=>{p.sheet=e.data.find(te=>te.status===1),p.sheet===void 0&&e.data.length>0&&(p.sheet=e.data[0]),p.dimensionX=e.minDimensions[1],p.dimensionY=e.minDimensions[0],p.columnConfigs=[],p.rowConfigs=[],p.currentSheetData=[],p.currentCell=null,p.currentCellEditorActive=!1,p.currentCellEditorContent=null,p.currentCellEditorStyle={transform:"translateX(0) translateY(0)",display:"none",left:0,top:0,width:0,height:0},p.currentCellBorderStyle={transform:"translateX(0) translateY(0)",left:0,top:0,width:0,height:0},p.currentArea={},p.currentAreaStatus=!1,p.currentAreaBorderStyle={transform:"translateX(0) translateY(0)",left:0,top:0,width:0,height:0},p.sheet.r&&p.sheet.r>p.dimensionY&&(p.dimensionY=p.sheet.r),p.sheet.c&&p.sheet.c>p.dimensionX&&(p.dimensionX=p.sheet.c),p.sheet.dataType&&p.sheet.dataType==="table"?p.sheetDataType="table":p.sheetDataType="map",p.sheet.data&&(p.sheetData=p.sheet.data,p.sheetDataType==="map"&&p.sheetData.map(te=>{te.r&&te.r>p.dimensionY&&(p.dimensionY=te.r),te.c&&te.c>p.dimensionX&&(p.dimensionX=te.c)}),p.sheetDataType==="table"&&(p.sheetData.length>p.dimensionY&&(p.dimensionY=p.sheetData.length),p.sheetData.length>0&&p.sheetData[0].length>p.dimensionX&&(p.dimensionX=p.sheetData[0].length))),p.sheet.config&&(p.sheetConfig=p.sheet.config);const oe=[...Array(p.dimensionX.valueOf())];p.columnConfigs.push(new li(0,null,null,"default",null,!0,!1,"center")),oe.forEach((te,se)=>{let F=null,_=!1;if(p.sheetConfig.cw&&p.sheetConfig.cw.length){for(let I=0;I<p.sheetConfig.cw.length;I++)if(p.sheetConfig.cw[I].hasOwnProperty("c")&&Pr(p.sheetConfig.cw[I].c)&&p.sheetConfig.cw[I].hasOwnProperty("w")&&Pr(p.sheetConfig.cw[I].w)&&Number(p.sheetConfig.cw[I].c)===se+1){F=p.sheetConfig.cw[I].w,p.gridColumnsWidthChanged[`${se+1}`]=p.sheetConfig.cw[I].w;break}}if(p.sheetConfig.cv&&p.sheetConfig.cv.length){for(let I=0;I<p.sheetConfig.cv.length;I++)if(p.sheetConfig.cv[I].hasOwnProperty("c")&&Pr(p.sheetConfig.cv[I].c)&&p.sheetConfig.cv[I].hasOwnProperty("v")&&Pr(p.sheetConfig.cv[I].v)&&p.sheetConfig.cv[I].v===0&&Number(p.sheetConfig.cv[I].c)-1===se){_=!0,p.gridColumnsVisibleChanged[`${se}`]=p.sheetConfig.cv[I].v;break}}p.columnConfigs.push(new li(se+1,null,null,F||"default",null,!_,!1,"center"))}),console.log(p.columnConfigs),p.startColIndex=0,p.endColIndex=0;const ve=[...Array(p.dimensionY.valueOf())];ve.forEach((te,se)=>{let F=null,_=!1;if(p.sheetConfig.rh&&p.sheetConfig.rh.length){for(let I=0;I<p.sheetConfig.rh.length;I++)if(p.sheetConfig.rh[I].hasOwnProperty("r")&&Pr(p.sheetConfig.rh[I].r)&&p.sheetConfig.rh[I].hasOwnProperty("h")&&Pr(p.sheetConfig.rh[I].h)&&Number(p.sheetConfig.rh[I].r)-1===se){F=p.sheetConfig.rh[I].h,p.gridRowsHeightChanged[`${se}`]=p.sheetConfig.rh[I].h;break}}if(p.sheetConfig.rv&&p.sheetConfig.rv.length){for(let I=0;I<p.sheetConfig.rv.length;I++)if(p.sheetConfig.rv[I].hasOwnProperty("r")&&Pr(p.sheetConfig.rv[I].r)&&p.sheetConfig.rv[I].hasOwnProperty("v")&&Pr(p.sheetConfig.rv[I].v)&&p.sheetConfig.rv[I].v===0&&Number(p.sheetConfig.rv[I].r)-1===se){_=!0,p.gridRowsVisibleChanged[`${se}`]=p.sheetConfig.rv[I].v;break}}p.rowConfigs.push(new Ao(se,null,null,F||"default",null,!_,!1,"center"))}),console.log(p.rowConfigs),p.startIndex=0,p.endIndex=0,p.currentSheetData=new Array(ve.length).fill(null).map(()=>new Array(oe.length-1).fill(null)),p.rowConfigs.forEach(te=>{p.columnConfigs.forEach((se,F)=>{if(F>0){let _,I,Re;p.sheetDataType==="map"&&(_=p.sheetData.find(We=>We.r===te.index+1&&We.c===se.index),I=p.sheetData.find(We=>We.r===te.index+1&&We.c===se.index+1),Re=p.sheetData.find(We=>We.r===te.index+1+1&&We.c===se.index)),p.sheetDataType==="table"&&(_=p.sheetData[te.index]&&p.sheetData[te.index][se.index-1]?p.sheetData[te.index][se.index-1]:null,I=p.sheetData[te.index]&&p.sheetData[te.index][se.index]?p.sheetData[te.index][se.index]:null,Re=p.sheetData[te.index+1]&&p.sheetData[te.index][se.index-1]?p.sheetData[te.index+1][se.index-1]:null),p.currentSheetData[te.index][se.index-1]=new Un(te.index,se.index-1,p.sheetDataType==="map"||Ot(_)?_&&_.v?_.v:null:_,null,null,!1,null,0,1,1,p.sheetDataType==="map"?_&&_.fs?_.fs:null:Ot(_)&&_&&_.fs?_.fs:null,p.sheetDataType==="map"?_&&_.ff?_.ff:null:Ot(_)&&_&&_.ff?_.ff:null,!!((p.sheetDataType==="map"||Ot(_))&&_&&_.bl),!!((p.sheetDataType==="map"||Ot(_))&&_&&_.it),!!((p.sheetDataType==="map"||Ot(_))&&_&&_.ol),!!((p.sheetDataType==="map"||Ot(_))&&_&&_.cl),!!((p.sheetDataType==="map"||Ot(_))&&_&&_.ul),p.sheetDataType==="map"?_&&_.bg?_.bg:null:Ot(_)&&_&&_.bg?_.bg:null,Ce(p.sheetDataType==="map"?_&&_.bg?_.bg:null:Ot(_)&&_&&_.bg?_.bg:null,(p.sheetDataType==="map"||Ot(Re)?Re&&Re.bdt:null)||(p.sheetDataType==="map"||Ot(_)?_&&_.bdb:null),(p.sheetDataType==="map"||Ot(I)?I&&I.bdl:null)||(p.sheetDataType==="map"||Ot(_)?_&&_.bdr:null)),_&&_.fc?_.fc:null,!!((p.sheetDataType==="map"||Ot(_))&&_&&_.bdt),!!((p.sheetDataType==="map"||Ot(_))&&_&&_.bdb),!!((p.sheetDataType==="map"||Ot(_))&&_&&_.bdl),!!((p.sheetDataType==="map"||Ot(_))&&_&&_.bdr),p.sheetDataType==="map"?_&&_.av?_.av:null:Ot(_)&&_&&_.av?_.av:null,p.sheetDataType==="map"?_&&_.ah?_.ah:null:Ot(_)&&_&&_.ah?_.ah:null,p.sheetDataType==="map"?_&&_.cf?_.cf:null:Ot(_)&&_&&_.cf?_.cf:null)}})}),console.log(p.currentSheetData),_e()}),ke=_e=>{if(x.closeMenu){const{ctxMenuStore:oe}=p,ve=X.value;oe.visible&&ve&&!er.getEventTargetNode(_e,ve).flag&&x.closeMenu()}},Ue=()=>{x.closeMenu&&x.closeMenu(),x.recalculate(!0)},Rt=_e=>{if(x.closeMenu){const{ctxMenuStore:oe}=p,ve=X.value;oe.visible&&ve&&!er.getEventTargetNode(_e,ve).flag&&x.closeMenu()}},Wt=_e=>{if(x.closeMenu){const{ctxMenuStore:oe}=p,ve=X.value;oe.visible&&ve&&!er.getEventTargetNode(_e,ve).flag&&x.closeMenu()}};ar(()=>e.size,()=>{x.recalculate(!0).then(()=>{x.calcCurrentCellPosition()}).finally(()=>{St.on(x,"mousewheel",ke),St.on(x,"mousedown",Rt),St.on(x,"keydown",Wt),St.on(x,"resize",Ue),x.handleContextmenuEvent&&St.on(x,"contextmenu",x.handleContextmenuEvent)})}),ar(()=>p.currentCell,()=>{x.calcCurrentCellPosition()},{deep:!0}),ar(()=>p.currentCellEditorActive,()=>{x.calcCurrentCellDisplay()}),ar(()=>e.data,()=>{console.log(e.data),Ge().then(()=>{x.recalculate(!0).then(()=>{const _e=c.value,oe=x.getParentElem();Ee=ep(()=>{x.recalculate(!0)}),_e&&Ee.observe(_e),oe&&Ee.observe(oe),St.on(x,"mousewheel",ke),St.on(x,"mousedown",Rt),St.on(x,"keydown",Wt),St.on(x,"resize",Ue),x.handleContextmenuEvent&&St.on(x,"contextmenu",x.handleContextmenuEvent)}).finally(()=>{x.calc()})})},{deep:!0}),Ut(()=>{Ge().then(()=>{x.recalculate(!0).then(()=>{const _e=c.value,oe=x.getParentElem();Ee=ep(()=>{x.recalculate(!0)}),_e&&Ee.observe(_e),oe&&Ee.observe(oe),St.on(x,"mousewheel",ke),St.on(x,"mousedown",Rt),St.on(x,"keydown",Wt),St.on(x,"resize",Ue),x.handleContextmenuEvent&&St.on(x,"contextmenu",x.handleContextmenuEvent)}).finally(()=>{x.calc()})})}),xi(()=>{Ee&&Ee.disconnect(),x.closeMenu&&x.closeMenu()}),ki(()=>{St.off(x,"mousedown"),St.off(x,"mousewheel"),St.off(x,"keydown"),St.off(x,"resize"),St.off(x,"contextmenu")});const or=()=>j("div",{ref:c,class:["vma-grid",`${e.size}`,`${e.type}`,{"overflow-x":p.overflowX,"overflow-y":p.overflowY}]},[e.resizeColumn?j("div",{ref:f,class:["column-resize-bar",`${e.type}`],style:p.overflowX?{height:`calc(100% - ${p.scrollbarHeight}px)`}:{}}):gt(),e.resizeRow?j("div",{ref:h,class:["row-resize-bar",`${e.type}`],style:p.overflowY?{width:`calc(100% - ${p.scrollbarWidth}px)`}:{}}):gt(),j(pt("VmaGridCtxMenu"),{ref:X}),j(r,{uid:x.uId,class:["left"],style:{height:`${p.gridHeaderHeight}px`,width:`${p.gridLeftFixedHeaderWidth}px`},fixedType:"left",type:e.type}),j(r,{uid:x.uId,class:["center"],style:{height:`${p.gridHeaderHeight}px`,width:`${p.gridHeaderWidth}px`},fixedType:"center",type:e.type}),j(n,{uid:x.uId,class:["left-top"],fixedType:"left-top",type:e.type}),j(n,{uid:x.uId,class:["left"],fixedType:"left",type:e.type}),j(n,{uid:x.uId,class:["top"],fixedType:"top",type:e.type}),j(n,{uid:x.uId,class:["center"],style:{height:`${p.gridBodyHeight}px`},fixedType:"center",type:e.type}),a.name?j(a,{type:"font-size",ref:B}):gt(),i.name?j(i,{type:"foo",ref:z}):gt(),s.name?j(s,{type:"foo",ref:re}):gt()]);return x.renderVN=or,Nt("$vmaCalcGrid",x),x},render(){return this.renderVN()}}),ip=He({name:"VmaGridHeader",props:{fixedType:{type:String,default:"center"},type:{type:String,default:"default"}},setup(e,t){const r=mt("$vmaCalcGrid",{}),{refGridHeader:n,refGridLeftFixedHeader:a,refGridLeftFixedHeaderX:i,refGridHeaderTable:s,refGridLeftFixedHeaderTable:f,refGridHeaderColgroup:h,refGridLeftFixedHeaderColgroup:c}=r.getRefs(),o=pt("VmaGridCell"),l=kt({}),u={uId:Ct.create().toString(),props:e,context:t,reactiveData:l},d=()=>{const y=[];r.reactiveData.startColIndex!==0&&y.push(j("col",{idx:0,style:{width:`${r.reactiveData.columnConfigs[0].renderWidth}px`}}));for(let m=r.reactiveData.startColIndex;m<=r.reactiveData.endColIndex&&!(m>r.reactiveData.columnConfigs.length-1);m++)y.push(j("col",{idx:m,style:{width:`${r.reactiveData.columnConfigs[m].renderWidth}px`}}));return y},g=()=>{const y=[],m=[];r.reactiveData.startColIndex!==0&&m.push(j(o,{cat:"grid-corner",type:`${e.type}`,r:0,c:0,row:0,col:0}));for(let b=r.reactiveData.startColIndex;b<=r.reactiveData.endColIndex&&!(b>r.reactiveData.columnConfigs.length-1);b++)if(b===0)m.push(j(o,{cat:"grid-corner",type:`${e.type}`,r:0,c:0,row:0,col:0}));else{const E=r.reactiveData.columnConfigs[b];m.push(j(o,{cat:"column-indicator",type:`${e.type}`,r:0,c:E.index,row:0,col:E.index}))}return m.concat(r.reactiveData.scrollbarWidth?[j(o,{cat:"gutter-corner",type:`${e.type}`,r:0,c:r.reactiveData.columnConfigs.length,row:0,col:r.reactiveData.columnConfigs.length})]:[gt()]),y.push(j("tr",{style:{height:`${Pi(r.props.gridRowHeight,r.props.size)}px`}},m)),y},v=()=>j("div",{ref:e.fixedType==="center"?n:a,class:["header-wrapper",`${e.type}`]},[j("div",{ref:i,style:{float:"left",height:"1px",marginTop:"-1px"}}),j("table",{ref:e.fixedType==="center"?s:f,class:["header",`${e.type}`]},[j("colgroup",{ref:e.fixedType==="center"?h:c},d().concat(r.reactiveData.scrollbarWidth?[j("col",{idx:r.reactiveData.columnConfigs.length,style:{width:`${r.reactiveData.scrollbarWidth}px`}})]:[gt()])),j("thead",{class:[`${e.type}`]},g())])]);return u.renderVN=v,Nt("$vmaCalcGridHeader",u),u},render(){return this.renderVN()}}),op=He({name:"VmaGridBody",props:{fixedType:{type:String,default:"center"},type:{type:String,default:"default"}},setup(e,t){const r=mt("$vmaCalcGrid",{}),{refGridBody:n,refGridLeftFixedBody:a,refGridLeftFixedBodyX:i,refGridLeftFixedBodyY:s,refGridBodyX:f,refGridBodyY:h,refGridTopFixedBody:c,refGridLeftFixedBodyScrollWrapper:o,refGridLeftTopFixedBody:l,refGridBodyTable:u,refGridLeftFixedBodyTable:d,refGridBodyColgroup:g,refGridLeftFixedBodyColgroup:v,refGridHeader:y,refCurrentCellEditor:m,refCurrentCellBorderTop:b,refCurrentCellBorderRight:E,refCurrentCellBorderBottom:N,refCurrentCellBorderLeft:R,refCurrentCellBorderCorner:C,refCurrentAreaBorderTop:O,refCurrentAreaBorderRight:T,refCurrentAreaBorderBottom:A,refCurrentAreaBorderLeft:L,refCurrentAreaBorderCorner:G}=r.getRefs(),{columnConfigs:H,rowConfigs:Y}=r.reactiveData,K=pt("VmaGridCell"),ce=xe(()=>Pi(r.props.gridRowHeight,r.props.size)),V=xe(()=>Xo(r.props.gridColumnWidth,r.props.size)),W=kt({}),Q={uId:Ct.create().toString(),props:e,context:t,reactiveData:W},ie=pt("VmaGridTextarea");xe(()=>H),xe(()=>Y);const de=()=>{const re=[];r.reactiveData.startColIndex!==0&&re.push(j("col",{idx:0}));for(let ne=r.reactiveData.startColIndex;ne<=r.reactiveData.endColIndex&&!(ne>r.reactiveData.columnConfigs.length-1);ne++)re.push(j("col",{idx:ne}));return re},me=()=>{const re=[];for(let ne=r.reactiveData.startIndex;ne<=r.reactiveData.endIndex&&!(ne>r.reactiveData.rowConfigs.length-1);ne++){const p=r.reactiveData.rowConfigs[ne],Ee=[];r.reactiveData.startColIndex!==0&&Ee.push(j(K,{cat:"row-indicator",type:`${e.type}`,r:p.index,c:0,row:p.index,col:0}));for(let x=r.reactiveData.startColIndex;x<=r.reactiveData.endColIndex&&!(x>r.reactiveData.columnConfigs.length-1);x++)if(x===0)Ee.push(j(K,{cat:"row-indicator",type:`${e.type}`,r:p.index,c:0,row:p.index,col:0,id:`${p.index}_0`}));else{const pe=r.reactiveData.columnConfigs[x];Ee.push(j(K,{cat:"normal",type:`${e.type}`,r:p.index,c:pe.index,row:p.index,col:pe.index,id:`${p.index}_${pe.index}`,cf:r.reactiveData.currentSheetData[p.index][pe.index-1].cf}))}re.push(j("tr",{row:ne,style:{height:p.visible?typeof p.renderHeight=="string"?`${ce.value}px`:`${p.renderHeight}px`:0}},Ee))}return re},Oe=re=>{e.fixedType==="center"?(y.value.scrollLeft=n.value.scrollLeft,o.value.scrollTop=n.value.scrollTop):e.fixedType==="left"&&(n.value.scrollTop=o.value.scrollTop),r.triggerScrollXEvent(re),r.triggerScrollYEvent(re)};let we,Se=0,J=0,$=0,P=!1,k=0,ge=0,q=0,ye=!1;const X=(re,ne,p)=>{const Ee=ye===p?Math.max(0,k-q):0;ye=p,k=Math.abs(p?ne-Ee:ne+Ee),ge=0,q=0,clearTimeout(we);const x=()=>{if(q<k){ge=Math.max(5,Math.floor(ge*1.5)),q+=ge,q>k&&(ge-=q-k);const{scrollTop:pe,clientHeight:ue,scrollHeight:Me}=n.value,Ce=pe+ge*(p?-1:1);n.value.scrollTop=Ce,a.value.scrollTop=Ce,(p?Ce<Me-ue:Ce>=0)&&(we=setTimeout(x,10))}};x()},M=(re,ne,p)=>{const Ee=P===p?Math.max(0,Se-$):0;P=p,Se=Math.abs(p?ne-Ee:ne+Ee),J=0,$=0,clearTimeout(we);const x=()=>{if($<Se){J=Math.max(5,Math.floor(J*1.5)),$+=J,$>Se&&(J-=$-Se);const{scrollLeft:pe,clientWidth:ue,scrollWidth:Me}=n.value,Ce=pe+J*(p?-1:1);n.value.scrollLeft=Ce,(p?Ce<Me-ue:Ce>=0)&&(we=setTimeout(x,10))}};x()},B=re=>{e.fixedType==="center"?(n.value.onscroll=Oe,o.value.onscroll=null):e.fixedType==="left"&&(n.value.onscroll=null,o.value.onscroll=Oe);const{deltaX:ne,deltaY:p}=re,Ee=p<0,x=ne<0,pe=e.fixedType==="left"?a.value:n.value;let ue=!1;(ne===0&&Ee?pe.scrollTop<=0:pe.scrollTop>=pe.scrollHeight-pe.clientHeight-10*ce.value)&&(ue=!0);let Me=!1;if((p===0&&x?pe.scrollLeft<=0:pe.scrollLeft>=pe.scrollWidth-pe.clientWidth-10*V.value)&&(Me=!0),!(Me&&ue)){if(!Me){const{lastScrollLeft:Ce}=r.reactiveData,Pe=pe.scrollLeft+ne;Pe!==Ce&&(re.preventDefault(),r.reactiveData.lastScrollLeft=Pe,r.reactiveData.lastScrollTime=Date.now(),M(re,ne,x),r.triggerScrollXEvent(re))}if(!ue){const{lastScrollTop:Ce}=r.reactiveData,Pe=pe.scrollTop+p;Pe!==Ce&&(re.preventDefault(),r.reactiveData.lastScrollTop=Pe,r.reactiveData.lastScrollTime=Date.now(),X(re,p,Ee),r.triggerScrollYEvent(re))}}};Ut(()=>{ht(()=>{e.fixedType==="left"?(n.value.onscroll=null,o.value.onscroll=Oe):e.fixedType==="center"&&(n.value.onscroll=Oe,o.value.onscroll=null)})}),xi(()=>{n&&n.value&&(n.value.onscroll=null),o&&o.value&&(o.value.onscroll=null)});const z=()=>j("div",{ref:e.fixedType==="center"?n:e.fixedType==="left"?a:e.fixedType==="top"?c:l,class:["body-wrapper"],onWheel:B},[e.fixedType==="left"?j("div",{ref:o,class:["fixed-wrapper"],style:{height:`${r.reactiveData.gridBodyHeight-r.reactiveData.scrollbarHeight}px`}},[j("div",{ref:s,style:{float:"left",width:0}}),j("div",{ref:i,style:{float:"left",height:"1px",marginTop:"-1px"}}),j("table",{ref:d,class:["body"]},[j("colgroup",{ref:v},de()),j("tbody",{},me())])]):e.fixedType==="center"?[j("div",{ref:h,style:{float:"left",width:0}}),j("div",{ref:f,style:{float:"left",height:"1px",marginTop:"-1px"}}),j("table",{ref:u,class:["body"]},[j("colgroup",{ref:g},de()),j("tbody",{},me())])]:gt(),e.fixedType==="center"?j(ie,{ref:m,class:["cell-editor"],size:r.props.size,type:r.props.type,modelValue:r.reactiveData.currentCellEditorContent,"onUpdate:modelValue":re=>{r.reactiveData.currentCellEditorContent=re},style:{display:r.reactiveData.currentCellEditorStyle.display,transform:r.reactiveData.currentCellEditorStyle.transform,height:r.reactiveData.currentCellEditorStyle.height,width:r.reactiveData.currentCellEditorStyle.width,left:r.reactiveData.currentCellEditorStyle.left,top:r.reactiveData.currentCellEditorStyle.top},onChange:()=>{r.reactiveData.currentCell.v=Pr(r.reactiveData.currentCellEditorContent)?Number(r.reactiveData.currentCellEditorContent):r.reactiveData.currentCellEditorContent},onBlur:()=>{ht(()=>{r.calc()})}}):gt(),e.fixedType==="center"?[j("div",{ref:R,class:["current-cell-border","left",`${e.type}`],style:{transform:r.reactiveData.currentCellBorderStyle.transform,left:r.reactiveData.currentCellBorderStyle.left,top:r.reactiveData.currentCellBorderStyle.top,height:r.reactiveData.currentCellBorderStyle.height,display:(r.reactiveData.currentCell&&Object.keys(r.reactiveData.currentCell).length>0,"none")}}),j("div",{ref:b,class:["current-cell-border","top",`${e.type}`],style:{transform:r.reactiveData.currentCellBorderStyle.transform,left:r.reactiveData.currentCellBorderStyle.left,top:r.reactiveData.currentCellBorderStyle.top,width:r.reactiveData.currentCellBorderStyle.width,display:(r.reactiveData.currentCell&&Object.keys(r.reactiveData.currentCell).length>0,"none")}}),j("div",{ref:E,class:["current-cell-border","right",`${e.type}`],style:{transform:r.reactiveData.currentCellBorderStyle.transform,left:r.reactiveData.currentCellBorderStyle.left+r.reactiveData.currentCellBorderStyle.width,top:r.reactiveData.currentCellBorderStyle.top,height:r.reactiveData.currentCellBorderStyle.height,display:(r.reactiveData.currentCell&&Object.keys(r.reactiveData.currentCell).length>0,"none")}}),j("div",{ref:N,class:["current-cell-border","bottom",`${e.type}`],style:{transform:r.reactiveData.currentCellBorderStyle.transform,left:r.reactiveData.currentCellBorderStyle.left,top:r.reactiveData.currentCellBorderStyle.top+r.reactiveData.currentCellBorderStyle.height,width:r.reactiveData.currentCellBorderStyle.width,display:(r.reactiveData.currentCell&&Object.keys(r.reactiveData.currentCell).length>0,"none")}}),j("div",{ref:C,class:["current-cell-border","corner",`${e.type}`],style:{transform:r.reactiveData.currentCellBorderStyle.transform,left:`calc(${r.reactiveData.currentCellBorderStyle.left+r.reactiveData.currentCellBorderStyle.width} - 3px)`,top:`calc(${r.reactiveData.currentCellBorderStyle.top+r.reactiveData.currentCellBorderStyle.height} - 3px)`,display:(r.reactiveData.currentCell&&Object.keys(r.reactiveData.currentCell).length>0,"none")}})]:gt(),e.fixedType==="center"?[j("div",{ref:L,class:["current-area-border","left",`${e.type}`],style:{transform:r.reactiveData.currentAreaBorderStyle.transform,left:r.reactiveData.currentAreaBorderStyle.left,top:r.reactiveData.currentAreaBorderStyle.top,height:r.reactiveData.currentAreaBorderStyle.height,display:r.reactiveData.currentArea&&Object.keys(r.reactiveData.currentArea).length>0?"block":"none"}}),j("div",{ref:O,class:["current-area-border","top",`${e.type}`],style:{transform:r.reactiveData.currentAreaBorderStyle.transform,left:r.reactiveData.currentAreaBorderStyle.left,top:r.reactiveData.currentAreaBorderStyle.top,width:r.reactiveData.currentAreaBorderStyle.width,display:r.reactiveData.currentArea&&Object.keys(r.reactiveData.currentArea).length>0?"block":"none"}}),j("div",{ref:T,class:["current-area-border","right",`${e.type}`],style:{transform:r.reactiveData.currentAreaBorderStyle.transform,left:r.reactiveData.currentAreaBorderStyle.left+r.reactiveData.currentAreaBorderStyle.width,top:r.reactiveData.currentAreaBorderStyle.top,height:r.reactiveData.currentAreaBorderStyle.height,display:r.reactiveData.currentArea&&Object.keys(r.reactiveData.currentArea).length>0?"block":"none"}}),j("div",{ref:A,class:["current-area-border","bottom",`${e.type}`],style:{transform:r.reactiveData.currentAreaBorderStyle.transform,left:r.reactiveData.currentAreaBorderStyle.left,top:r.reactiveData.currentAreaBorderStyle.top+r.reactiveData.currentAreaBorderStyle.height,width:r.reactiveData.currentAreaBorderStyle.width,display:r.reactiveData.currentArea&&Object.keys(r.reactiveData.currentArea).length>0?"block":"none"}}),j("div",{ref:G,class:["current-area-border","corner",`${e.type}`],style:{transform:r.reactiveData.currentAreaBorderStyle.transform,left:`calc(${r.reactiveData.currentAreaBorderStyle.left+r.reactiveData.currentAreaBorderStyle.width} - 3px)`,top:`calc(${r.reactiveData.currentAreaBorderStyle.top+r.reactiveData.currentAreaBorderStyle.height} - 3px)`,display:r.reactiveData.currentArea&&Object.keys(r.reactiveData.currentArea).length>0?"block":"none"}})]:gt()]);return Q.renderVN=z,Nt("$vmaCalcGridBody",Q),Q},render(){return this.renderVN()}});const y5=e=>{let t=e,r="";do{t--;const n=t%26;r+=String.fromCharCode(n+65),t=Math.trunc((t-n)/26)}while(t>0);return r.split("").reverse().join("")};var sp=He({name:"VmaGridCell",props:{type:{type:String,default:"default"},cat:{type:String,default:"normal"},r:Number,c:Number,rs:{type:Number,default:1},cs:{type:Number,default:1},cf:{type:Object,default:()=>({fd:"General",t:"g"})}},setup(e,t){const r=mt("$vmaCalcGrid",{}),n=pt("VmaGridIcon"),{refGridHeader:a,refGridBodyTable:i,refGridLeftFixedBody:s,refRowResizeBar:f,refColumnResizeBar:h,refCurrentCellEditor:c}=r.getRefs(),{currentSheetData:o}=r.reactiveData;nE(()=>e.cat==="normal"&&e.c?{cellBgType:o[e.r][e.c-1]&&o[e.r][e.c-1].bgt?o[e.r][e.c-1].bgt:"0",cellBgCustom:o[e.r][e.c-1]&&o[e.r][e.c-1].bg?o[e.r][e.c-1].bg:""}:{cellBgType:"",cellBgCustom:""});const l=kt({}),u={uId:Ct.create().toString(),props:e,context:t,reactiveData:l},d=xe(()=>Pi(r.props.gridRowHeight,r.props.size)),g=xe(()=>Xo(r.props.gridColumnWidth,r.props.size)),v=T=>{const A=o[e.r][e.c-1];if(A.cf&&A.cf.t&&A.cf.t!=="g"){const L=Number(A.mv);try{isNaN(L)?T=Aa.format(A.cf.fd,A.mv):T=Aa.format(A.cf.fd,L)}catch(G){console.error(G)}}return T},y=()=>{const T=o[e.r][e.c-1];return T&&T.mv?v(T.mv):null},m=()=>{let T="";return e.cat==="column-indicator"&&(T=y5(e.c.valueOf())),e.cat==="row-indicator"&&(T=(e.r+1).toString()),e.cat==="normal"&&(T=y()),j("span",{class:["cell-content"]},T)},b=T=>{const A=er.getEventTargetNode(T,i,"normal",L=>L.attributes.hasOwnProperty("row")&&L.attributes.hasOwnProperty("col"));if(A&&A.flag){const L=A.targetElem;r.reactiveData.currentArea.end={r:Number(L.attributes.row.value),c:Number(L.attributes.col.value)-1};const G=r.reactiveData.currentArea.start.c>r.reactiveData.currentArea.end.c?r.reactiveData.currentArea.end.c:r.reactiveData.currentArea.start.c,H=r.reactiveData.currentArea.end.c<r.reactiveData.currentArea.start.c?r.reactiveData.currentArea.start.c:r.reactiveData.currentArea.end.c,Y=r.reactiveData.currentArea.start.r>r.reactiveData.currentArea.end.r?r.reactiveData.currentArea.end.r:r.reactiveData.currentArea.start.r,K=r.reactiveData.currentArea.end.r<r.reactiveData.currentArea.start.r?r.reactiveData.currentArea.start.r:r.reactiveData.currentArea.end.r,ce=Ra(r.reactiveData.startColIndex,g.value,r.reactiveData.gridColumnsWidthChanged,r.reactiveData.gridColumnsVisibleChanged),V=Ta(r.reactiveData.startIndex,d.value,r.reactiveData.gridRowsHeightChanged,r.reactiveData.gridRowsVisibleChanged);ht(()=>{i.value.querySelectorAll(`td[row="${Y}"][col="${G+1}"]`).forEach(W=>{const Q=`${ce+W.offsetLeft-1}px`,ie=`${V+W.offsetTop-1}px`;r.reactiveData.currentAreaBorderStyle.transform=`translateX(${Q}) translateY(${ie})`;const de=Tc(G,H,g.value,r.reactiveData.gridColumnsWidthChanged,r.reactiveData.gridColumnsVisibleChanged),me=Cc(Y,K,d.value,r.reactiveData.gridRowsHeightChanged,r.reactiveData.gridRowsVisibleChanged);r.reactiveData.currentAreaBorderStyle.height=`${me}px`,r.reactiveData.currentAreaBorderStyle.width=`${de}px`}),i.value.querySelectorAll(".cell-active").forEach((W,Q)=>{W.classList.remove("cell-active")});for(let W=Y;W<=K;W++)for(let Q=G;Q<=H;Q++)i.value.querySelectorAll(`td[row="${W}"][col="${Q+1}"]`).forEach(ie=>{ie.classList.add("cell-active")})})}},E=T=>{const A=document.onmousemove,L=document.onmouseup,G=H=>{H.stopPropagation(),H.preventDefault(),b(H)};document.onmousemove=G,document.onmouseup=H=>{document.onmousemove=A,document.onmouseup=L;const Y=er.getEventTargetNode(H,i,"normal",K=>K.attributes.hasOwnProperty("row")&&K.attributes.hasOwnProperty("col"));if(Y&&Y.flag){const K=Y.targetElem;r.reactiveData.currentArea.end={r:Number(K.attributes.row.value),c:Number(K.attributes.col.value)-1};const ce=r.reactiveData.currentArea.start.c>r.reactiveData.currentArea.end.c?r.reactiveData.currentArea.end.c:r.reactiveData.currentArea.start.c,V=r.reactiveData.currentArea.end.c<r.reactiveData.currentArea.start.c?r.reactiveData.currentArea.start.c:r.reactiveData.currentArea.end.c,W=r.reactiveData.currentArea.start.r>r.reactiveData.currentArea.end.r?r.reactiveData.currentArea.end.r:r.reactiveData.currentArea.start.r,Q=r.reactiveData.currentArea.end.r<r.reactiveData.currentArea.start.r?r.reactiveData.currentArea.start.r:r.reactiveData.currentArea.end.r,ie=Ra(r.reactiveData.startColIndex,g.value,r.reactiveData.gridColumnsWidthChanged,r.reactiveData.gridColumnsVisibleChanged),de=Ta(r.reactiveData.startIndex,d.value,r.reactiveData.gridRowsHeightChanged,r.reactiveData.gridRowsVisibleChanged);ht(()=>{i.value.querySelectorAll(`td[row="${W}"][col="${ce+1}"]`).forEach(me=>{const Oe=`${ie+me.offsetLeft-1}px`,we=`${de+me.offsetTop-1}px`;r.reactiveData.currentAreaBorderStyle.transform=`translateX(${Oe}) translateY(${we})`;const Se=Tc(ce,V,g.value,r.reactiveData.gridColumnsWidthChanged,r.reactiveData.gridColumnsVisibleChanged),J=Cc(W,Q,d.value,r.reactiveData.gridRowsHeightChanged,r.reactiveData.gridRowsVisibleChanged);r.reactiveData.currentAreaBorderStyle.height=`${J}px`,r.reactiveData.currentAreaBorderStyle.width=`${Se}px`}),i.value.querySelectorAll(".cell-active").forEach((me,Oe)=>{me.classList.remove("cell-active")});for(let me=W;me<=Q;me++)for(let Oe=ce;Oe<=V;Oe++)i.value.querySelectorAll(`td[row="${me}"][col="${Oe+1}"]`).forEach(we=>{we.classList.add("cell-active")})})}}},N=T=>{const{clientX:A}=T,L=document.onmousemove,G=document.onmouseup,H=T.target,Y=a.value,K=er.getOffsetPos(H,Y),ce=H.clientWidth,V=Xo(r.props.gridColumnWidth,r.props.size),W=Ra(r.reactiveData.startColIndex,g.value,r.reactiveData.gridColumnsWidthChanged,r.reactiveData.gridColumnsVisibleChanged),Q=ce,ie=K.left+Math.floor(Q)+W,de=H.parentNode,me=Math.max(K.left-de.clientWidth+Q,0);let Oe=0;const we=h.value;we.style.left=`${K.left+Q+W}px`,we.style.display="block";const Se=J=>{J.stopPropagation(),J.preventDefault();const $=J.clientX-A,P=ie+$;Oe=Math.max(P,me),we.style.left=`${Oe}px`,we.style.display="block"};document.onmousemove=Se,document.onmouseup=()=>{if(document.onmousemove=L,document.onmouseup=G,we.style.display="none",H.parentElement.getAttribute("col")){const J=r.reactiveData.columnConfigs.find($=>$.index===parseInt(H.parentElement.getAttribute("col"),10));J&&(J.renderWidth=Math.max(H.parentElement.clientWidth+Oe-ie,6),r.reactiveData.gridColumnsWidthChanged[`${J.index}`]=J.renderWidth,r.reactiveData.gridWidth+=J.renderWidth-V)}H.parentElement.style.width=`${Math.max(H.parentElement.clientWidth+Oe-ie,6)}px`,r.recalculate(!0).then(()=>{ht(()=>{r.calcCurrentCellPosition(),r.calcCurrentCellDisplay()})})}},R=T=>{const{clientY:A}=T,L=document.onmousemove,G=document.onmouseup,H=T.target,Y=s.value,K=er.getOffsetPos(H,Y),ce=H.clientHeight,V=Pi(r.props.gridRowHeight,r.props.size),W=Ta(r.reactiveData.startIndex,d.value,r.reactiveData.gridRowsHeightChanged,r.reactiveData.gridRowsVisibleChanged),Q=ce,ie=K.top+Math.floor(Q)+W,de=H.parentNode,me=Math.max(K.top-de.clientHeight+Q,0);let Oe=0;const we=f.value;we.style.top=`${K.top+a.value.clientHeight+Q+W}px`,we.style.display="block";const Se=J=>{J.stopPropagation(),J.preventDefault();const $=J.clientY-A,P=ie+$;Oe=Math.max(P,me),we.style.top=`${Oe+a.value.clientHeight}px`,we.style.display="block"};document.onmousemove=Se,document.onmouseup=()=>{if(document.onmousemove=L,document.onmouseup=G,we.style.display="none",H.parentElement.getAttribute("row")){const J=r.reactiveData.rowConfigs.find($=>$.index===parseInt(H.parentElement.getAttribute("row"),10));J&&(J.renderHeight=Math.max(H.parentElement.clientHeight+Oe-ie,6),r.reactiveData.gridRowsHeightChanged[`${J.index}`]=J.renderHeight,r.reactiveData.gridHeight+=J.renderHeight-V)}H.parentElement.parentElement.style.height=`${Math.max(H.parentElement.clientHeight+Oe-ie,6)}px`,r.recalculate(!0).then(()=>{ht(()=>{r.calcCurrentCellPosition(),r.calcCurrentCellDisplay()})})}},C=()=>{if(e.cat==="row-indicator")return[j("div",{class:["cell",`${e.type}`],style:{display:"flex",justifyContent:"center",alignItems:"center"}},m()),r.props.resizeRow?j("div",{class:["row-resize-handler",`${e.type}`],onMousedown:A=>{R(A),A.stopPropagation()}}):gt(),j("div",{style:{display:r.reactiveData.gridRowsVisibleChanged&&Object.keys(r.reactiveData.gridRowsVisibleChanged).length>0&&r.reactiveData.gridRowsVisibleChanged.hasOwnProperty(`${e.r-1}`)?"block":"none"},class:["row-hide-info-upward"],onClick:A=>{const G=A.target.parentElement.parentElement;r.updateRow("showUpRows",G.attributes.row.value,G.attributes.col.value)}},j(n,{name:"ellipsis-h",size:r.props.size,translateY:To(r.props.size),scaleX:.7,scaleY:.7})),j("div",{style:{display:r.reactiveData.gridRowsVisibleChanged&&Object.keys(r.reactiveData.gridRowsVisibleChanged).length>0&&r.reactiveData.gridRowsVisibleChanged.hasOwnProperty(`${e.r+1}`)?"block":"none"},class:["row-hide-info-downward"],onClick:A=>{const G=A.target.parentElement.parentElement;r.updateRow("showDownRows",G.attributes.row.value,G.attributes.col.value)}},j(n,{name:"ellipsis-h",size:r.props.size,translateY:To(r.props.size),scaleX:.7,scaleY:.7}))];if(e.cat==="column-indicator")return[j("div",{class:["cell",`${e.type}`],style:{display:"flex",justifyContent:"center",alignItems:"center"}},m()),r.props.resizeRow?j("div",{class:["column-resize-handler",`${e.type}`],onMousedown:A=>{N(A),A.stopPropagation()}}):gt(),j("div",{style:{display:r.reactiveData.gridColumnsVisibleChanged&&Object.keys(r.reactiveData.gridColumnsVisibleChanged).length>0&&r.reactiveData.gridColumnsVisibleChanged.hasOwnProperty(`${e.c-1-1}`)?"block":"none"},class:["column-hide-info-frontward"],onClick:A=>{const G=A.target.parentElement.parentElement;r.updateColumn("showFrontColumns",G.attributes.row.value,G.attributes.col.value)}},j(n,{name:"ellipsis-h",size:r.props.size,translateY:To(r.props.size),scaleX:.7,scaleY:.7})),j("div",{style:{display:r.reactiveData.gridColumnsVisibleChanged&&Object.keys(r.reactiveData.gridColumnsVisibleChanged).length>0&&r.reactiveData.gridColumnsVisibleChanged.hasOwnProperty(`${e.c}`)?"block":"none"},class:["column-hide-info-backward"],onClick:A=>{const G=A.target.parentElement.parentElement;r.updateColumn("showBackColumns",G.attributes.row.value,G.attributes.col.value)}},j(n,{name:"ellipsis-h",size:r.props.size,translateY:To(r.props.size),scaleX:.7,scaleY:.7}))];if(e.cat==="grid-corner")return[j("div",{class:["cell",`${e.type}`]},j("div",{class:["corner"]}))];const T=[];return o[e.r][e.c-1].cl&&T.push("line-through"),o[e.r][e.c-1].ul&&T.push("underline"),o[e.r][e.c-1].ol&&T.push("overline"),j("div",{class:["cell",`${e.type}`],style:{display:"flex",justifyContent:o[e.r][e.c-1]&&o[e.r][e.c-1].ah?o[e.r][e.c-1].ah==="left"?"flex-start":o[e.r][e.c-1].ah==="right"?"flex-end":"center":r.props.alignH==="left"?"flex-start":r.props.alignH==="right"?"flex-end":"center",alignItems:o[e.r][e.c-1]&&o[e.r][e.c-1].av?o[e.r][e.c-1].av==="top"?"flex-start":o[e.r][e.c-1].av==="bottom"?"flex-end":"center":r.props.alignV==="top"?"flex-start":r.props.alignV==="bottom"?"flex-end":"center",fontSize:o[e.r][e.c-1].fs?`${o[e.r][e.c-1].fs}px`:null,fontFamily:o[e.r][e.c-1].ff?`${o[e.r][e.c-1].ff}`:null,fontStyle:o[e.r][e.c-1].it?"italic":null,fontWeight:o[e.r][e.c-1].bl?"bold":null,textDecoration:T.length>0?T.join(" "):null,color:o[e.r][e.c-1].fc},onMouseup:()=>{r.reactiveData.currentAreaStatus=!1},onMousedown:A=>{if(r.reactiveData.currentAreaStatus=!0,r.reactiveData.currentCellEditorActive=!1,r.reactiveData.currentCell=o[e.r][e.c-1],r.reactiveData.currentCellEditorContent=o[e.r][e.c-1].v,r.reactiveData.currentArea&&Object.keys(r.reactiveData.currentArea).length>1&&A.button===2){const L=er.getEventTargetNode(A,i,"normal",G=>G.attributes.hasOwnProperty("row")&&G.attributes.hasOwnProperty("col"));if(L&&L.flag){const G=L.targetElem,H=G.attributes.row.value,Y=G.attributes.col.value,K=r.reactiveData.currentArea.start.c>r.reactiveData.currentArea.end.c?r.reactiveData.currentArea.end.c:r.reactiveData.currentArea.start.c,ce=r.reactiveData.currentArea.end.c<r.reactiveData.currentArea.start.c?r.reactiveData.currentArea.start.c:r.reactiveData.currentArea.end.c,V=r.reactiveData.currentArea.start.r>r.reactiveData.currentArea.end.r?r.reactiveData.currentArea.end.r:r.reactiveData.currentArea.start.r,W=r.reactiveData.currentArea.end.r<r.reactiveData.currentArea.start.r?r.reactiveData.currentArea.start.r:r.reactiveData.currentArea.end.r;Number(H)>=V&&Number(H)<=W&&Number(Y-1)>=K&&Number(Y-1)<=ce||(r.reactiveData.currentArea={},r.reactiveData.currentArea.start={r:Number(e.r),c:Number(e.c)-1},ht(()=>{E()}))}}else r.reactiveData.currentArea={},r.reactiveData.currentArea.start={r:Number(e.r),c:Number(e.c)-1},ht(()=>{E()})},onDblclick:()=>{r.reactiveData.currentCellEditorActive=!0,ht(()=>{c.value.$el.querySelectorAll("textarea").forEach(A=>{A.focus()})})}},m())},O=()=>j(e.cat==="normal"||e.cat==="row-indicator"?"td":"th",{rowspan:e.rs,colspan:e.cs,class:[e.cat,`${e.type}`,`cell-bg-${e.cat==="normal"&&e.c&&o[e.r][e.c-1]&&o[e.r][e.c-1].bgt?o[e.r][e.c-1].bgt:"0"}`,{"column-indicator-active":e.cat==="column-indicator"&&r.reactiveData.currentArea&&Object.keys(r.reactiveData.currentArea).length>1&&(e.c-1>=r.reactiveData.currentArea.start.c&&e.c-1<=r.reactiveData.currentArea.end.c||e.c-1>=r.reactiveData.currentArea.end.c&&e.c-1<=r.reactiveData.currentArea.start.c),"row-indicator-active":e.cat==="row-indicator"&&r.reactiveData.currentArea&&Object.keys(r.reactiveData.currentArea).length>1&&(e.r>=r.reactiveData.currentArea.start.r&&e.r<=r.reactiveData.currentArea.end.r||e.r>=r.reactiveData.currentArea.end.r&&e.r<=r.reactiveData.currentArea.start.r)}],style:{overflow:"hidden"}},C());return u.renderVN=O,Nt("$vmaCalcGridCell",u),u},render(){return this.renderVN()}});const E5={install(e){e.component(ap.name,ap),e.component(ip.name,ip),e.component(op.name,op),e.component(sp.name,sp)}};var lp=He({name:"VmaGridFoobarPlugin",props:{type:{type:String,default:"foo"}},setup(e,t){const r={uId:Ct.create().toString(),props:e,context:t};Object.assign(r,{foobar:i=>`foobar plugin ${i}`});const a=()=>j("div",{class:["vma-grid-foobar-plugin",e.type]});return r.renderVN=a,Nt("$vmaGridFoobarPlugin",r),r},render(){return this.renderVN()}});const _5={install(e){e.component(lp.name,lp)}};var cp=He({name:"VmaGridStylePlugin",props:{type:{type:String,default:"font-size"}},setup(e,t){const r={uId:Ct.create().toString(),props:e,context:t};Object.assign(r,{foobar:i=>`foobar plugin ${i}`,fontSize:()=>{const i=[];return i.push("8"),i.push("9"),i.push("10"),i.push("11"),i.push("12"),i.push("14"),i.push("16"),i.push("18"),i.push("20"),i.push("22"),i.push("24"),i.push("26"),i.push("28"),i.push("36"),i.push("48"),i.push("72"),i},fontFamily:()=>{const i=[];return i.push("Times New Roman"),i.push("Arial"),i.push("Tahoma"),i.push("Verdana"),i.push("\u5FAE\u8F6F\u96C5\u9ED1"),i.push("\u5B8B\u4F53"),i.push("\u9ED1\u4F53"),i.push("\u6977\u4F53"),i.push("\u4EFF\u5B8B"),i.push("\u65B0\u5B8B\u4F53"),i.push("\u534E\u6587\u65B0\u9B4F"),i.push("\u534E\u6587\u884C\u6977"),i.push("\u534E\u6587\u96B6\u4E66"),i},fontStyle:()=>{const i={};return i.bl="\u7C97\u4F53",i.it="\u659C\u4F53",i.ol="\u4E0A\u5212\u7EBF",i.cl="\u4E2D\u5212\u7EBF",i.ul="\u4E0B\u5212\u7EBF",i}});const a=()=>gt();return r.renderVN=a,Nt("$vmaGridStylePlugin",r),r},render(){return this.renderVN()}});const b5={install(e){e.component(cp.name,cp)}};var up=He({name:"VmaGridBorderPlugin",props:{type:{type:String,default:"foo"}},setup(e,t){const r={uId:Ct.create().toString(),props:e,context:t};Object.assign(r,{foobar:i=>`foobar plugin ${i}`,out:()=>"\u5916\u4FA7\u6846\u7EBF",outBolder:()=>"\u7C97\u5916\u4FA7\u6846\u7EBF",inner:()=>"\u5185\u90E8\u6846\u7EBF",all:()=>"\u6240\u6709\u6846\u7EBF",none:()=>"\u65E0\u6846\u7EBF",left:()=>"\u5DE6\u6846\u7EBF",right:()=>"\u53F3\u6846\u7EBF",top:()=>"\u4E0A\u6846\u7EBF",bottom:()=>"\u4E0B\u6846\u7EBF"});const a=()=>gt();return r.renderVN=a,Nt("$vmaGridBorderPlugin",r),r},render(){return this.renderVN()}});const N5={install(e){e.component(up.name,up)}};var fp=He({name:"VmaGridAlignPlugin",props:{type:{type:String,default:"foo"}},setup(e,t){const r={uId:Ct.create().toString(),props:e,context:t};Object.assign(r,{vertical:()=>{const i={};return i.avt="\u5782\u76F4\u5C45\u4E0A",i.avm="\u5782\u76F4\u5C45\u4E2D",i.avb="\u5782\u76F4\u5C45\u4E0B",i},horizontal:()=>{const i={};return i.ahl="\u6C34\u5E73\u5C45\u5DE6",i.ahc="\u6C34\u5E73\u5C45\u4E2D",i.ahr="\u6C34\u5E73\u5C45\u53F3",i}});const a=()=>gt();return r.renderVN=a,Nt("$vmaGridAlignPlugin",r),r},render(){return this.renderVN()}});const A5={install(e){e.component(fp.name,fp)}},C5=[_5,b5,N5,A5],T5=[wN,IN,MN,PN,SN,LN,$N,YN,XN,E5];function R5(e,t){T5.forEach(r=>r.install(e)),C5.forEach(r=>r.install(e))}fs.install=R5;var O5=CN({enhance:({app:e,router:t,siteData:r})=>{e.use(fs)}});const Il=[k_,G_,j_,ub,gb,Cb,yN,O5],w5=[["v-8daa1a0e","/",{title:"\u9996\u9875"},["/index.html","/README.md"]],["v-2f4d3eda","/basic/grid-button.html",{title:""},["/basic/grid-button","/basic/grid-button.md"]],["v-7f75cc29","/basic/grid-checkbox.html",{title:""},["/basic/grid-checkbox","/basic/grid-checkbox.md"]],["v-13863eb3","/basic/grid-icon.html",{title:"\u56FE\u6807"},["/basic/grid-icon","/basic/grid-icon.md"]],["v-12fb0d8a","/basic/grid-loading.html",{title:"Loading"},["/basic/grid-loading","/basic/grid-loading.md"]],["v-90541d2a","/basic/grid-radio.html",{title:""},["/basic/grid-radio","/basic/grid-radio.md"]],["v-0016c312","/basic/grid-textarea.html",{title:""},["/basic/grid-textarea","/basic/grid-textarea.md"]],["v-5107b6ce","/basic/grid.html",{title:""},["/basic/grid","/basic/grid.md"]],["v-1a1874fc","/formula/",{title:"Vue 3 + Typescript + Vite"},["/formula/index.html","/formula/README.md"]],["v-e0e76f98","/formula/modules.html",{title:"vma-grid"},["/formula/modules","/formula/modules.md"]],["v-a9cea3dc","/formula/classes/index.DepParser.html",{title:"Class: DepParser"},["/formula/classes/index.DepParser","/formula/classes/index.DepParser.md"]],["v-44208220","/formula/classes/index.FormulaError.html",{title:"Class: FormulaError"},["/formula/classes/index.FormulaError","/formula/classes/index.FormulaError.md"]],["v-6da1d8db","/formula/classes/index.FormulaParser.html",{title:"Class: FormulaParser"},["/formula/classes/index.FormulaParser","/formula/classes/index.FormulaParser.md"]],["v-cf6e5f3c","/formula/modules/formulas.html",{title:"Module: formulas"},["/formula/modules/formulas","/formula/modules/formulas.md"]],["v-201aed0a","/formula/modules/",{title:"Module: index"},["/formula/modules/index.html","/formula/modules/index.md"]],["v-3706649a","/404.html",{title:""},["/404"]]];var I5=()=>w5.reduce((e,[t,r,n,a])=>(e.push({name:t,path:r,component:If,meta:n},...a.map(i=>({path:i,redirect:r}))),e),[{name:"404",path:"/:catchAll(.*)",component:If}]),M5=KE,P5=()=>{const e=M_({history:M5(vE(Cn.value.base)),routes:I5(),scrollBehavior:(t,r,n)=>n||(t.hash?{el:t.hash}:{top:0})});return e.beforeResolve(async(t,r)=>{var n;(t.path!==r.path||r===Jr)&&([tn.value]=await Promise.all([Bn.resolvePageData(t.name),(n=ln[t.name])==null?void 0:n.__asyncLoader()]))}),e},S5=e=>{e.component("ClientOnly",CE),e.component("Content",TE)},L5=(e,t)=>{const r=xe(()=>Bn.resolveRouteLocale(Cn.value.locales,t.currentRoute.value.path)),n=xe(()=>Bn.resolveSiteLocaleData(Cn.value,r.value)),a=xe(()=>Bn.resolvePageFrontmatter(tn.value)),i=xe(()=>Bn.resolvePageHeadTitle(tn.value,n.value)),s=xe(()=>Bn.resolvePageHead(i.value,a.value,n.value)),f=xe(()=>Bn.resolvePageLang(tn.value));return e.provide(_E,r),e.provide(NE,n),e.provide(gE,a),e.provide(yE,i),e.provide(bv,s),e.provide(Nv,f),Object.defineProperties(e.config.globalProperties,{$frontmatter:{get:()=>a.value},$head:{get:()=>s.value},$headTitle:{get:()=>i.value},$lang:{get:()=>f.value},$page:{get:()=>tn.value},$routeLocale:{get:()=>r.value},$site:{get:()=>Cn.value},$siteLocale:{get:()=>n.value},$withBase:{get:()=>RE}}),{pageData:tn,pageFrontmatter:a,pageHead:s,pageHeadTitle:i,pageLang:f,routeLocale:r,siteData:Cn,siteLocaleData:n}},$5=()=>{const e=Qc(),t=mE(),r=EE(),n=be([]),a=()=>{t.value.forEach(s=>{const f=D5(s);f&&n.value.push(f)})},i=()=>{document.documentElement.lang=r.value,n.value.forEach(s=>{s.parentNode===document.head&&document.head.removeChild(s)}),n.value.splice(0,n.value.length),t.value.forEach(s=>{const f=x5(s);f!==null&&(document.head.appendChild(f),n.value.push(f))})};Nt(AE,i),Ut(()=>{a(),i(),ar(()=>e.path,()=>i())})},D5=([e,t,r=""])=>{const n=Object.entries(t).map(([f,h])=>Ke(h)?`[${f}="${h}"]`:h===!0?`[${f}]`:"").join(""),a=`head > ${e}${n}`;return Array.from(document.querySelectorAll(a)).find(f=>f.innerText===r)||null},x5=([e,t,r])=>{if(!Ke(e))return null;const n=document.createElement(e);return gv(t)&&Object.entries(t).forEach(([a,i])=>{Ke(i)?n.setAttribute(a,i):i===!0&&n.setAttribute(a,"")}),Ke(r)&&n.appendChild(document.createTextNode(r)),n},k5=dE,U5=async()=>{var r;const e=k5({name:"VuepressApp",setup(){var n;$5();for(const a of Il)(n=a.setup)==null||n.call(a);return()=>[j(xv),...Il.flatMap(({rootComponents:a=[]})=>a.map(i=>j(i)))]}}),t=P5();S5(e),L5(e,t);for(const n of Il)await((r=n.enhance)==null?void 0:r.call(n,{app:e,router:t,siteData:Cn}));return e.use(t),{app:e,router:t}};U5().then(({app:e,router:t})=>{t.isReady().then(()=>{e.mount("#app")})});export{gv as $,vv as A,K5 as B,q5 as C,wb as D,X5 as E,S as F,J5 as G,bt as H,Si as I,j as J,Q5 as K,j5 as L,Kc as M,ar as N,V5 as O,z5 as P,mv as Q,vE as R,jc as S,w as T,Ke as U,uN as V,Ut as W,Qo as X,us as Y,e8 as Z,ag as _,H5 as a,Z5 as a0,ht as a1,xi as a2,W5 as a3,ki as a4,dN as a5,kt as b,sv as c,U5 as createVueApp,He as d,pt as e,Mt as f,uv as g,Hc as h,hg as i,Or as j,Rb as k,xe as l,Ve as m,Jt as n,is as o,G5 as p,gt as q,be as r,Qc as s,B0 as t,Y5 as u,B5 as v,x1 as w,lv as x,Oy as y,jp as z};
